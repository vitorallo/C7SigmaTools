// Description: Dopplepaymer In-Memory Malware Implant.
// This query identifies processes with command line launch strings.
// Which match the pattern used in Dopplepaymer ransomware attacks.
// Required Connectors: MicrosoftThreatProtection (Types: DeviceProcessEvents)

DeviceProcessEvents
| where Timestamp > ago(7d)
| where ProcessCommandLine startswith "-q -s {{" and ProcessCommandLine contains "}} -p "