// Title: Malicious Driver Load By Name
// Author: Nasreddine Bencherchali (Nextron Systems)
// Date: 2022-10-03
// Level: medium
// Description: Detects loading of known malicious drivers via the file name of the drivers.This table contains information about driver load events on Windows devices. To have this table present in Microsoft Sentinel, ensure that the required data connectors for Windows security logs are enabled and collecting data from the relevant devices.
// Tags: attack.privilege-escalation, attack.t1543.003, attack.t1068
// ================================================================== 

DeviceDriverEvents
| where ImageLoaded endswith "\\wfshbr64.sys" or ImageLoaded endswith "\\ktmutil7odm.sys" or ImageLoaded endswith "\\ktes.sys" or ImageLoaded endswith "\\a26363e7b02b13f2b8d697abb90cd5c3.sys" or ImageLoaded endswith "\\kt2.sys" or ImageLoaded endswith "\\4748696211bd56c2d93c21cab91e82a5.sys" or ImageLoaded endswith "\\malicious.sys" or ImageLoaded endswith "\\a236e7d654cd932b7d11cb604629a2d0.sys" or ImageLoaded endswith "\\spwizimgvt.sys" or ImageLoaded endswith "\\c94f405c5929cfcccc8ad00b42c95083.sys" or ImageLoaded endswith "\\fur.sys" or ImageLoaded endswith "\\wantd.sys" or ImageLoaded endswith "\\windbg.sys" or ImageLoaded endswith "\\4118b86e490aed091b1a219dba45f332.sys" or ImageLoaded endswith "\\gmer64.sys" or ImageLoaded endswith "\\1fc7aeeff3ab19004d2e53eae8160ab1.sys" or ImageLoaded endswith "\\poortry2.sys" or ImageLoaded endswith "\\wintapix.sys" or ImageLoaded endswith "\\daxin_blank6.sys" or ImageLoaded endswith "\\6771b13a53b9c7449d4891e427735ea2.sys" or ImageLoaded endswith "\\blacklotus_driver.sys" or ImageLoaded endswith "\\air_system10.sys" or ImageLoaded endswith "\\dkrtk.sys" or ImageLoaded endswith "\\7.sys" or ImageLoaded endswith "\\sense5ext.sys" or ImageLoaded endswith "\\ktgn.sys" or ImageLoaded endswith "\\ndislan.sys" or ImageLoaded endswith "\\nlslexicons0024uvn.sys" or ImageLoaded endswith "\\be6318413160e589080df02bb3ca6e6a.sys" or ImageLoaded endswith "\\4.sys" or ImageLoaded endswith "\\wantd_2.sys" or ImageLoaded endswith "\\e29f6311ae87542b3d693c1f38e4e3ad.sys" or ImageLoaded endswith "\\daxin_blank3.sys" or ImageLoaded endswith "\\gftkyj64.sys" or ImageLoaded endswith "\\daxin_blank2.sys" or ImageLoaded endswith "\\wantd_4.sys" or ImageLoaded endswith "\\reddriver.sys" or ImageLoaded endswith "\\834761775.sys" or ImageLoaded endswith "\\mlgbbiicaihflrnh.sys" or ImageLoaded endswith "\\mjj0ge.sys" or ImageLoaded endswith "\\daxin_blank.sys" or ImageLoaded endswith "\\daxin_blank5.sys" or ImageLoaded endswith "\\poortry1.sys" or ImageLoaded endswith "\\msqpq.sys" or ImageLoaded endswith "\\mimidrv.sys" or ImageLoaded endswith "\\e939448b28a4edc81f1f974cebf6e7d2.sys" or ImageLoaded endswith "\\prokiller64.sys" or ImageLoaded endswith "\\nodedriver.sys" or ImageLoaded endswith "\\wantd_3.sys" or ImageLoaded endswith "\\lctka.sys" or ImageLoaded endswith "\\kapchelper_x64.sys" or ImageLoaded endswith "\\daxin_blank4.sys" or ImageLoaded endswith "\\a9df5964635ef8bd567ae487c3d214c4.sys" or ImageLoaded endswith "\\wantd_6.sys" or ImageLoaded endswith "\\ntbios.sys" or ImageLoaded endswith "\\wantd_5.sys" or ImageLoaded endswith "\\pciecubed.sys" or ImageLoaded endswith "\\mimikatz.sys" or ImageLoaded endswith "\\nqrmq.sys" or ImageLoaded endswith "\\2.sys" or ImageLoaded endswith "\\poortry.sys" or ImageLoaded endswith "\\ntbios_2.sys" or ImageLoaded endswith "\\fgme.sys" or ImageLoaded endswith "\\telephonuafy.sys" or ImageLoaded endswith "\\typelibde.sys" or ImageLoaded endswith "\\daxin_blank1.sys" or ImageLoaded endswith "\\ef0e1725aaf0c6c972593f860531a2ea.sys" or ImageLoaded endswith "\\5a4fe297c7d42539303137b6d75b150d.sys"