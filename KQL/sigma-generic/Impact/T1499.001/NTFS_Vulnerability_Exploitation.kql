// Title: NTFS Vulnerability Exploitation
// Author: Florian Roth (Nextron Systems)
// Date: 2021-01-11
// Level: high
// Description: This the exploitation of a NTFS vulnerability as reported without many details via TwitterThe SecurityEvent table in Microsoft Sentinel contains Windows security event logs. Ensure that the Windows Security Events data connector is enabled in Sentinel to have access to this table.
// Tags: attack.impact, attack.t1499.001
// ================================================================== 

SecurityEvent
| where (InitiatingProcessVersionInfoFileDescription contains "contains a corrupted file record" and InitiatingProcessVersionInfoFileDescription contains "The name of the file is \"\\\"") and Origin =~ "File System Driver" and Provider_Name =~ "Ntfs"