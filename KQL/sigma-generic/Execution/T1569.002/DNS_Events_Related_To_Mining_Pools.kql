// Title: DNS Events Related To Mining Pools
// Author: Saw Winn Naung, Azure-Sentinel, @neu5ron
// Date: 2021-08-19
// Level: low
// Description: Identifies clients that may be performing DNS lookups associated with common currency mining pools.The DnsEvents table in Microsoft Sentinel contains DNS-related events. To have this table present, ensure that DNS logs are being collected and sent to Sentinel, and that the necessary connectors or data sources are configured to ingest Zeek DNS logs.
// Tags: attack.execution, attack.t1569.002, attack.impact, attack.t1496
// ================================================================== 

DnsEvents
| where (query endswith "monerohash.com" or query endswith "do-dear.com" or query endswith "xmrminerpro.com" or query endswith "secumine.net" or query endswith "xmrpool.com" or query endswith "minexmr.org" or query endswith "hashanywhere.com" or query endswith "xmrget.com" or query endswith "mininglottery.eu" or query endswith "minergate.com" or query endswith "moriaxmr.com" or query endswith "multipooler.com" or query endswith "moneropools.com" or query endswith "xmrpool.eu" or query endswith "coolmining.club" or query endswith "supportxmr.com" or query endswith "minexmr.com" or query endswith "hashvault.pro" or query endswith "xmrpool.net" or query endswith "crypto-pool.fr" or query endswith "xmr.pt" or query endswith "miner.rocks" or query endswith "walpool.com" or query endswith "herominers.com" or query endswith "gntl.co.uk" or query endswith "semipool.com" or query endswith "coinfoundry.org" or query endswith "cryptoknight.cc" or query endswith "fairhash.org" or query endswith "baikalmine.com" or query endswith "tubepool.xyz" or query endswith "fairpool.xyz" or query endswith "asiapool.io" or query endswith "coinpoolit.webhop.me" or query endswith "nanopool.org" or query endswith "moneropool.com" or query endswith "miner.center" or query endswith "prohash.net" or query endswith "poolto.be" or query endswith "cryptoescrow.eu" or query endswith "monerominers.net" or query endswith "cryptonotepool.org" or query endswith "extrmepool.org" or query endswith "webcoin.me" or query endswith "kippo.eu" or query endswith "hashinvest.ws" or query endswith "monero.farm" or query endswith "linux-repository-updates.com" or query endswith "1gh.com" or query endswith "dwarfpool.com" or query endswith "hash-to-coins.com" or query endswith "pool-proxy.com" or query endswith "hashfor.cash" or query endswith "fairpool.cloud" or query endswith "litecoinpool.org" or query endswith "mineshaft.ml" or query endswith "abcxyz.stream" or query endswith "moneropool.ru" or query endswith "cryptonotepool.org.uk" or query endswith "extremepool.org" or query endswith "extremehash.com" or query endswith "hashinvest.net" or query endswith "unipool.pro" or query endswith "crypto-pools.org" or query endswith "monero.net" or query endswith "backup-pool.com" or query endswith "mooo.com" or query endswith "freeyy.me" or query endswith "cryptonight.net" or query endswith "shscrypto.net") and (not(((answers in~ ("127.0.0.1", "0.0.0.0")) or rejected =~ "true")))