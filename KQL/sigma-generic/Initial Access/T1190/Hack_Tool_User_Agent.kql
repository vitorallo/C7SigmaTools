// Title: Hack Tool User Agent
// Author: Florian Roth (Nextron Systems)
// Date: 2017-07-08
// Level: high
// Description: Detects suspicious user agent strings user by hack tools in proxy logsThis table contains proxy logs, which can be queried for information related to web traffic and user activity. Ensure that the necessary connectors are set up to collect proxy logs in Sentinel.
// Tags: attack.initial-access, attack.t1190, attack.credential-access, attack.t1110
// ================================================================== 

ProxyLog
| where ''c-useragent'' contains "(hydra)" or ''c-useragent'' contains " arachni/" or ''c-useragent'' contains " BFAC " or ''c-useragent'' contains " brutus " or ''c-useragent'' contains " cgichk " or ''c-useragent'' contains "core-project/1.0" or ''c-useragent'' contains " crimscanner/" or ''c-useragent'' contains "datacha0s" or ''c-useragent'' contains "dirbuster" or ''c-useragent'' contains "domino hunter" or ''c-useragent'' contains "dotdotpwn" or ''c-useragent'' contains "FHScan Core" or ''c-useragent'' contains "floodgate" or ''c-useragent'' contains "get-minimal" or ''c-useragent'' contains "gootkit auto-rooter scanner" or ''c-useragent'' contains "grendel-scan" or ''c-useragent'' contains " inspath " or ''c-useragent'' contains "internet ninja" or ''c-useragent'' contains "jaascois" or ''c-useragent'' contains " zmeu " or ''c-useragent'' contains "masscan" or ''c-useragent'' contains " metis " or ''c-useragent'' contains "morfeus fucking scanner" or ''c-useragent'' contains "n-stealth" or ''c-useragent'' contains "nsauditor" or ''c-useragent'' contains "pmafind" or ''c-useragent'' contains "security scan" or ''c-useragent'' contains "springenwerk" or ''c-useragent'' contains "teh forest lobster" or ''c-useragent'' contains "toata dragostea" or ''c-useragent'' contains " vega/" or ''c-useragent'' contains "voideye" or ''c-useragent'' contains "webshag" or ''c-useragent'' contains "webvulnscan" or ''c-useragent'' contains " whcc/" or ''c-useragent'' contains " Havij" or ''c-useragent'' contains "absinthe" or ''c-useragent'' contains "bsqlbf" or ''c-useragent'' contains "mysqloit" or ''c-useragent'' contains "pangolin" or ''c-useragent'' contains "sql power injector" or ''c-useragent'' contains "sqlmap" or ''c-useragent'' contains "sqlninja" or ''c-useragent'' contains "uil2pn" or ''c-useragent'' contains "ruler" or ''c-useragent'' contains "Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)"