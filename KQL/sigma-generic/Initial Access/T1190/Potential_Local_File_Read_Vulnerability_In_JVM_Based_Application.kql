// Title: Potential Local File Read Vulnerability In JVM Based Application
// Author: Moti Harmats
// Date: 2023-02-11
// Level: high
// Description: Detects potential local file read vulnerability in JVM based apps.
// If the exceptions are caused due to user input and contain path traversal payloads then it's a red flag.
// This table contains application logs including error logs. Ensure that the necessary connectors are set up to collect application logs with LOG_LEVEL=ERROR and above.
// Tags: attack.initial-access, attack.t1190
// ================================================================== 

AppRequests
| where "FileNotFoundException" and "/../../.."