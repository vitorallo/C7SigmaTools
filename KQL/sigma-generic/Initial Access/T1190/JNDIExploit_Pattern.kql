// Title: JNDIExploit Pattern
// Author: Florian Roth (Nextron Systems)
// Date: 2021-12-12
// Level: high
// Description: Detects exploitation attempt using the JNDI-Exploit-KitThis table contains web server logs, which can be queried for information related to web server activity. Ensure that the appropriate connectors are set up in Sentinel to collect web server logs.
// Tags: attack.initial-access, attack.t1190
// ================================================================== 

WebBrowserAccessLogs
| where "/Basic/Command/Base64/" or "/Basic/ReverseShell/" or "/Basic/TomcatMemshell" or "/Basic/JettyMemshell" or "/Basic/WeblogicMemshell" or "/Basic/JBossMemshell" or "/Basic/WebsphereMemshell" or "/Basic/SpringMemshell" or "/Deserialization/URLDNS/" or "/Deserialization/CommonsCollections1/Dnslog/" or "/Deserialization/CommonsCollections2/Command/Base64/" or "/Deserialization/CommonsBeanutils1/ReverseShell/" or "/Deserialization/Jre8u20/TomcatMemshell" or "/TomcatBypass/Dnslog/" or "/TomcatBypass/Command/" or "/TomcatBypass/ReverseShell/" or "/TomcatBypass/TomcatMemshell" or "/TomcatBypass/SpringMemshell" or "/GroovyBypass/Command/" or "/WebsphereBypass/Upload/"