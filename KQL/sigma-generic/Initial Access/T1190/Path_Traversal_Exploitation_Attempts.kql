// Title: Path Traversal Exploitation Attempts
// Author: Subhash Popuri (@pbssubhash), Florian Roth (Nextron Systems), Thurein Oo, Nasreddine Bencherchali (Nextron Systems)
// Date: 2021-09-25
// Level: medium
// Description: Detects path traversal exploitation attemptsThe WebBrowserStats table in Microsoft Sentinel contains web server logs. To have this table present, ensure that you have the necessary connectors or data sources configured in Sentinel to collect web server logs.
// Tags: attack.initial-access, attack.t1190
// ================================================================== 

WebBrowserStats
| where ''cs-uri-query'' contains "../../../../../lib/password" or ''cs-uri-query'' contains "../../../../windows/" or ''cs-uri-query'' contains "../../../etc/" or ''cs-uri-query'' contains "..%252f..%252f..%252fetc%252f" or ''cs-uri-query'' contains "..%c0%af..%c0%af..%c0%afetc%c0%af" or ''cs-uri-query'' contains "%252e%252e%252fetc%252f"