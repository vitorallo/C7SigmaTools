// Title: Potential XXE Exploitation Attempt In JVM Based Application
// Author: Moti Harmats
// Date: 2023-02-11
// Level: high
// Description: Detects XML parsing issues, if the application expects to work with XML make sure that the parser is initialized safely.This table contains information about application requests, including error logs with LOG_LEVEL=ERROR and above. Ensure that the necessary connectors are set up to collect application logs with the specified log level.
// Tags: attack.initial-access, attack.t1190
// ================================================================== 

AppRequests
| where "SAXParseException" or "DOMException"