// Title: Outdated Dependency Or Vulnerability Alert Disabled
// Author: Muhammad Faisal (@faisalusuf)
// Date: 2023-01-27
// Level: high
// Description: Dependabot performs a scan to detect insecure dependencies, and sends Dependabot alerts.
// This rule detects when an organization owner disables Dependabot alerts private repositories or Dependabot security updates for all repositories.
// This table contains audit logs for the Github service. To query this table in Microsoft Sentinel, ensure that the Github connector is installed and properly configured to ingest audit logs.
// Tags: attack.initial-access, attack.t1195.001
// ================================================================== 

GithubAuditLogs
| where action in~ ("dependabot_alerts_new_repos.disable", "dependabot_alerts.disable", "dependabot_security_updates_new_repos.disable", "dependabot_security_updates.disable", "repository_vulnerability_alerts.disable")