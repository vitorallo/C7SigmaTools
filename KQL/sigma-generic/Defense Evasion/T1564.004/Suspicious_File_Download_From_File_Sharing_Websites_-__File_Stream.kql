// Title: Suspicious File Download From File Sharing Websites -  File Stream
// Author: Florian Roth (Nextron Systems)
// Date: 2022-08-24
// Level: high
// Description: Detects the download of suspicious file type from a well-known file and paste sharing domainThe SecurityEvent table in Microsoft Sentinel contains Windows security event logs, which can be queried for events related to creating stream hash in the 'category' field.
// Tags: attack.defense-evasion, attack.s0139, attack.t1564.004
// ================================================================== 

SecurityEvent
| where (Contents contains ".githubusercontent.com" or Contents contains "anonfiles.com" or Contents contains "cdn.discordapp.com" or Contents contains "ddns.net" or Contents contains "dl.dropboxusercontent.com" or Contents contains "ghostbin.co" or Contents contains "glitch.me" or Contents contains "gofile.io" or Contents contains "hastebin.com" or Contents contains "mediafire.com" or Contents contains "mega.nz" or Contents contains "onrender.com" or Contents contains "pages.dev" or Contents contains "paste.ee" or Contents contains "pastebin.com" or Contents contains "pastebin.pl" or Contents contains "pastetext.net" or Contents contains "pixeldrain.com" or Contents contains "privatlab.com" or Contents contains "privatlab.net" or Contents contains "send.exploit.in" or Contents contains "sendspace.com" or Contents contains "storage.googleapis.com" or Contents contains "storjshare.io" or Contents contains "supabase.co" or Contents contains "temp.sh" or Contents contains "transfer.sh" or Contents contains "trycloudflare.com" or Contents contains "ufile.io" or Contents contains "w3spaces.com" or Contents contains "workers.dev") and (TargetFilename contains ".cpl:Zone" or TargetFilename contains ".dll:Zone" or TargetFilename contains ".exe:Zone" or TargetFilename contains ".hta:Zone" or TargetFilename contains ".lnk:Zone" or TargetFilename contains ".one:Zone" or TargetFilename contains ".vbe:Zone" or TargetFilename contains ".vbs:Zone" or TargetFilename contains ".xll:Zone")