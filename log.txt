Found 2987 rule files to process.
Processing: sigma/rules/macos/file_event/file_event_macos_emond_launch_daemon.yml
MacOS Emond Launch Daemon ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "/etc/emond.d/rules/" and FolderPath endswith ".plist") or FolderPath contains "/private/var/db/emondClients/"

----------------------------------------
Processing: sigma/rules/macos/file_event/file_event_macos_susp_startup_item_created.yml
Startup Item File Created - MacOS ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".plist" and (FolderPath startswith "/Library/StartupItems/" or FolderPath startswith "/System/Library/StartupItems")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_applescript.yml
MacOS Scripting Interpreter AppleScript ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -e " or ProcessCommandLine contains ".scpt" or ProcessCommandLine contains ".js") and FolderPath endswith "/osascript"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_find_cred_in_files.yml
Credentials In Files ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "password" and FolderPath endswith "/grep") or ProcessCommandLine contains "laZagne"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_local_account.yml
Local System Accounts Discovery - MacOs ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "list" and ProcessCommandLine contains "/users") and FolderPath endswith "/dscl") or ((ProcessCommandLine contains "-q" and ProcessCommandLine contains "user") and FolderPath endswith "/dscacheutil") or ProcessCommandLine contains "'x:0:'" or ((ProcessCommandLine contains "/etc/passwd" or ProcessCommandLine contains "/etc/sudoers") and FolderPath endswith "/cat") or FolderPath endswith "/id" or (ProcessCommandLine contains "-u" and FolderPath endswith "/lsof")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_sysadminctl_enable_guest_account.yml
Guest Account Enabled Via Sysadminctl ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -guestAccount" and ProcessCommandLine contains " on") and FolderPath endswith "/sysadminctl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_clear_system_logs.yml
Indicator Removal on Host - Clear Mac System Logs ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/rm" or FolderPath endswith "/unlink" or FolderPath endswith "/shred") and (ProcessCommandLine contains "/var/log" or (ProcessCommandLine contains "/Users/" and ProcessCommandLine contains "/Library/Logs/"))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_launchctl_execution.yml
Launch Agent/Daemon Execution Via Launchctl ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "submit" or ProcessCommandLine contains "load" or ProcessCommandLine contains "start") and FolderPath endswith "/launchctl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_system_network_connections_discovery.yml
System Network Connections Discovery - MacOs ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/who" or FolderPath endswith "/w" or FolderPath endswith "/last" or FolderPath endswith "/lsof" or FolderPath endswith "/netstat"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_change_file_time_attr.yml
File Time Attribute Change ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-t" or ProcessCommandLine contains "-acmr" or ProcessCommandLine contains "-d" or ProcessCommandLine contains "-r") and FolderPath endswith "/touch"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_ioreg_discovery.yml
System Information Discovery Using Ioreg ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-l" or ProcessCommandLine contains "-c") and (ProcessCommandLine contains "AppleAHCIDiskDriver" or ProcessCommandLine contains "IOPlatformExpertDevice" or ProcessCommandLine contains "Oracle" or ProcessCommandLine contains "Parallels" or ProcessCommandLine contains "USB Vendor Name" or ProcessCommandLine contains "VirtualBox" or ProcessCommandLine contains "VMware") and (FolderPath endswith "/ioreg" or ProcessCommandLine contains "ioreg")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_tmutil_exclude_file_from_backup.yml
New File Exclusion Added To Time Machine Via Tmutil - MacOS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "addexclusion" and (FolderPath endswith "/tmutil" or ProcessCommandLine contains "tmutil")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_payload_decoded_and_decrypted.yml
Payload Decoded and Decrypted via Built-in Utilities ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/Volumes/" and ProcessCommandLine contains "enc" and ProcessCommandLine contains "-base64" and ProcessCommandLine contains " -d ") and FolderPath endswith "/openssl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_hdiutil_create.yml
Disk Image Creation Via Hdiutil - MacOS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "create" and FolderPath endswith "/hdiutil"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_tmutil_delete_backup.yml
Time Machine Backup Deletion Attempt Via Tmutil - MacOS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "delete" and (FolderPath endswith "/tmutil" or ProcessCommandLine contains "tmutil")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_jxa_in_memory_execution.yml
JXA In-memory Execution Via OSAScript ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -l " and ProcessCommandLine contains "JavaScript") or ProcessCommandLine contains ".js") and (ProcessCommandLine contains "osascript" and ProcessCommandLine contains " -e " and ProcessCommandLine contains "eval" and ProcessCommandLine contains "NSData.dataWithContentsOfURL")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_installer_susp_child_process.yml
Suspicious Installer Package Child Process ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "preinstall" or ProcessCommandLine contains "postinstall") and (FolderPath endswith "/sh" or FolderPath endswith "/bash" or FolderPath endswith "/dash" or FolderPath endswith "/python" or FolderPath endswith "/ruby" or FolderPath endswith "/perl" or FolderPath endswith "/php" or FolderPath endswith "/javascript" or FolderPath endswith "/osascript" or FolderPath endswith "/tclsh" or FolderPath endswith "/curl" or FolderPath endswith "/wget") and (InitiatingProcessFolderPath endswith "/package_script_service" or InitiatingProcessFolderPath endswith "/installer")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_csrutil_disable.yml
System Integrity Protection (SIP) Disabled ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "disable" and FolderPath endswith "/csrutil"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_persistence_via_plistbuddy.yml
Potential Persistence Via PlistBuddy ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "LaunchAgents" or ProcessCommandLine contains "LaunchDaemons") and (ProcessCommandLine contains "RunAtLoad" and ProcessCommandLine contains "true") and FolderPath endswith "/PlistBuddy"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_system_profiler_discovery.yml
System Information Discovery Using System_Profiler ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "SPApplicationsDataType" or ProcessCommandLine contains "SPHardwareDataType" or ProcessCommandLine contains "SPNetworkDataType" or ProcessCommandLine contains "SPUSBDataType") and (FolderPath endswith "/system_profiler" or ProcessCommandLine contains "system_profiler")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_macos_firmware_activity.yml
Suspicious MacOS Firmware Activity ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "setpasswd" or ProcessCommandLine contains "full" or ProcessCommandLine contains "delete" or ProcessCommandLine contains "check") and FolderPath =~ "/usr/sbin/firmwarepasswd"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_create_hidden_account.yml
Hidden User Creation ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "create" and FolderPath endswith "/dscl") and (ProcessCommandLine contains "UniqueID" and ProcessCommandLine matches regex "([0-9]|[1-9][0-9]|[1-4][0-9]{2})")) or ((ProcessCommandLine contains "create" and FolderPath endswith "/dscl") and (ProcessCommandLine contains "IsHidden" and (ProcessCommandLine contains "true" or ProcessCommandLine contains "yes" or ProcessCommandLine contains "1")))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_xattr_gatekeeper_bypass.yml
Gatekeeper Bypass via Xattr ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-d" and ProcessCommandLine contains "com.apple.quarantine") and FolderPath endswith "/xattr"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_base64_decode.yml
Decode Base64 Encoded Text -MacOs ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-d" and FolderPath =~ "/usr/bin/base64"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_system_network_discovery.yml
System Network Discovery - macOS ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "/arp" or FolderPath endswith "/ifconfig" or FolderPath endswith "/netstat" or FolderPath endswith "/networksetup" or FolderPath endswith "/socketfilterfw") or ((ProcessCommandLine contains "/Library/Preferences/com.apple.alf" and ProcessCommandLine contains "read") and FolderPath =~ "/usr/bin/defaults")) and (not(InitiatingProcessFolderPath endswith "/wifivelocityd"))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_sysctl_discovery.yml
System Information Discovery Via Sysctl - MacOS ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "hw." or ProcessCommandLine contains "kern." or ProcessCommandLine contains "machdep.") and (FolderPath endswith "/sysctl" or ProcessCommandLine contains "sysctl")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_local_groups.yml
Local Groups Discovery - MacOs ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-q" and ProcessCommandLine contains "group") and FolderPath endswith "/dscacheutil") or (ProcessCommandLine contains "/etc/group" and FolderPath endswith "/cat") or ((ProcessCommandLine contains "-list" and ProcessCommandLine contains "/groups") and FolderPath endswith "/dscl")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_split_file_into_pieces.yml
Split A File Into Pieces ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/split"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_dseditgroup_add_to_admin_group.yml
User Added To Admin Group Via DseditGroup ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -o edit " and ProcessCommandLine contains " -a " and ProcessCommandLine contains " -t user" and ProcessCommandLine contains "admin") and FolderPath endswith "/dseditgroup"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_in_memory_download_and_compile.yml
Potential In-Memory Download And Compile Of Payloads ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "osacompile" and ProcessCommandLine contains "curl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_sysadminctl_add_user_to_admin_group.yml
User Added To Admin Group Via Sysadminctl ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -addUser " and ProcessCommandLine contains " -admin ") and FolderPath endswith "/sysadminctl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_hdiutil_mount.yml
Disk Image Mounting Via Hdiutil - MacOS ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "attach " or ProcessCommandLine contains "mount ") and FolderPath endswith "/hdiutil"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_system_shutdown_reboot.yml
System Shutdown/Reboot - MacOs ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/shutdown" or FolderPath endswith "/reboot" or FolderPath endswith "/halt"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_dscl_add_user_to_admin_group.yml
User Added To Admin Group Via Dscl ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -append " and ProcessCommandLine contains " /Groups/admin " and ProcessCommandLine contains " GroupMembership ") and FolderPath endswith "/dscl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_binary_padding.yml
Binary Padding - MacOS ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "if=/dev/zero" or ProcessCommandLine contains "if=/dev/random" or ProcessCommandLine contains "if=/dev/urandom") and FolderPath endswith "/dd") or (ProcessCommandLine contains "-s +" and FolderPath endswith "/truncate")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_chflags_hidden_flag.yml
Hidden Flag Set On File/Directory Via Chflags - MacOS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "hidden " and FolderPath endswith "/chflags"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_security_software_discovery.yml
Security Software Discovery - MacOs ---> KQL Query:
DeviceProcessEvents
| where FolderPath =~ "/usr/bin/grep" and ((ProcessCommandLine contains "nessusd" or ProcessCommandLine contains "santad" or ProcessCommandLine contains "CbDefense" or ProcessCommandLine contains "falcond" or ProcessCommandLine contains "td-agent" or ProcessCommandLine contains "packetbeat" or ProcessCommandLine contains "filebeat" or ProcessCommandLine contains "auditbeat" or ProcessCommandLine contains "osqueryd" or ProcessCommandLine contains "BlockBlock" or ProcessCommandLine contains "LuLu") or (ProcessCommandLine contains "Little" and ProcessCommandLine contains "Snitch"))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_xcsset_malware_infection.yml
Potential XCSSET Malware Infection ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains "/sys/log.php" or ProcessCommandLine contains "/sys/prepod.php" or ProcessCommandLine contains "/sys/bin/Pods") and FolderPath endswith "/curl" and InitiatingProcessFolderPath endswith "/bash") and ProcessCommandLine contains "https://") or (((ProcessCommandLine contains "/Users/" and ProcessCommandLine contains "/Library/Group Containers/") and FolderPath endswith "/osacompile" and InitiatingProcessFolderPath endswith "/bash") or ((ProcessCommandLine contains "LSUIElement" and ProcessCommandLine contains "/Users/" and ProcessCommandLine contains "/Library/Group Containers/") and FolderPath endswith "/plutil" and InitiatingProcessFolderPath endswith "/bash") or ((ProcessCommandLine contains "-r" and ProcessCommandLine contains "/Users/" and ProcessCommandLine contains "/Library/Group Containers/") and FolderPath endswith "/zip"))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_dsenableroot_enable_root_account.yml
Root Account Enable Via Dsenableroot ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/dsenableroot" and (not(ProcessCommandLine contains " -d "))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_network_sniffing.yml
Network Sniffing - MacOs ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/tcpdump" or FolderPath endswith "/tshark"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_jamf_usage.yml
JAMF MDM Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "createAccount" or ProcessCommandLine contains "manage" or ProcessCommandLine contains "removeFramework" or ProcessCommandLine contains "removeMdmProfile" or ProcessCommandLine contains "resetPassword" or ProcessCommandLine contains "setComputerName") and FolderPath endswith "/jamf"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_browser_child_process.yml
Suspicious Browser Child Process - MacOS ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "/bash" or FolderPath endswith "/curl" or FolderPath endswith "/dash" or FolderPath endswith "/ksh" or FolderPath endswith "/osascript" or FolderPath endswith "/perl" or FolderPath endswith "/php" or FolderPath endswith "/pwsh" or FolderPath endswith "/python" or FolderPath endswith "/sh" or FolderPath endswith "/tcsh" or FolderPath endswith "/wget" or FolderPath endswith "/zsh") and (InitiatingProcessFolderPath contains "com.apple.WebKit.WebContent" or InitiatingProcessFolderPath contains "firefox" or InitiatingProcessFolderPath contains "Google Chrome Helper" or InitiatingProcessFolderPath contains "Google Chrome" or InitiatingProcessFolderPath contains "Microsoft Edge" or InitiatingProcessFolderPath contains "Opera" or InitiatingProcessFolderPath contains "Safari" or InitiatingProcessFolderPath contains "Tor Browser")) and (not(((((ProcessCommandLine contains "/Volumes/Google Chrome/Google Chrome.app/Contents/Frameworks/" and ProcessCommandLine contains "/Resources/install.sh") or (ProcessCommandLine contains "/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/" and ProcessCommandLine contains "/Resources/keystone_promote_preflight.sh") or (ProcessCommandLine contains "/Applications/Google Chrome.app/Contents/Frameworks/Google Chrome Framework.framework/" and ProcessCommandLine contains "/Resources/keystone_promote_postflight.sh")) and (InitiatingProcessFolderPath contains "Google Chrome Helper" or InitiatingProcessFolderPath contains "Google Chrome")) or ((ProcessCommandLine contains "/Users/" and ProcessCommandLine contains "/Library/Application Support/Google/Chrome/recovery/" and ProcessCommandLine contains "/ChromeRecovery") and (InitiatingProcessFolderPath contains "Google Chrome Helper" or InitiatingProcessFolderPath contains "Google Chrome")) or ProcessCommandLine contains "--defaults-torrc" or ProcessCommandLine =~ "*/Library/Application Support/Microsoft/MAU*/Microsoft AutoUpdate.app/Contents/MacOS/msupdate*" or ((ProcessCommandLine contains "IOPlatformExpertDevice" or ProcessCommandLine contains "hw.model") and InitiatingProcessFolderPath contains "Microsoft Edge")))) and (not((ProcessCommandLine =~ "" or isnull(ProcessCommandLine))))

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_space_after_filename.yml
Space After Filename - macOS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith " " or FolderPath endswith " "

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_remote_system_discovery.yml
Macos Remote System Discovery ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-a" and FolderPath endswith "/arp") or ((ProcessCommandLine contains " 10." or ProcessCommandLine contains " 192.168." or ProcessCommandLine contains " 172.16." or ProcessCommandLine contains " 172.17." or ProcessCommandLine contains " 172.18." or ProcessCommandLine contains " 172.19." or ProcessCommandLine contains " 172.20." or ProcessCommandLine contains " 172.21." or ProcessCommandLine contains " 172.22." or ProcessCommandLine contains " 172.23." or ProcessCommandLine contains " 172.24." or ProcessCommandLine contains " 172.25." or ProcessCommandLine contains " 172.26." or ProcessCommandLine contains " 172.27." or ProcessCommandLine contains " 172.28." or ProcessCommandLine contains " 172.29." or ProcessCommandLine contains " 172.30." or ProcessCommandLine contains " 172.31." or ProcessCommandLine contains " 127." or ProcessCommandLine contains " 169.254.") and FolderPath endswith "/ping")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_create_account.yml
Creation Of A Local User Account ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "create" and FolderPath endswith "/dscl") or (ProcessCommandLine contains "addUser" and FolderPath endswith "/sysadminctl")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_histfile_operations.yml
Suspicious History File Operations ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".bash_history" or ProcessCommandLine contains ".zsh_history" or ProcessCommandLine contains ".zhistory" or ProcessCommandLine contains ".history" or ProcessCommandLine contains ".sh_history" or ProcessCommandLine contains "fish_history"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_jamf_susp_child.yml
JAMF MDM Potential Suspicious Child Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/bash" or FolderPath endswith "/sh") and InitiatingProcessFolderPath endswith "/jamf"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_network_service_scanning.yml
MacOS Network Service Scanning ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "/nc" or FolderPath endswith "/netcat") and (not(ProcessCommandLine contains "l"))) or (FolderPath endswith "/nmap" or FolderPath endswith "/telnet")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_tail_base64_decode_from_image.yml
Potential Base64 Decoded From Images ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "base64" and ProcessCommandLine contains "-d" and ProcessCommandLine contains ">") and (ProcessCommandLine contains ".avif" or ProcessCommandLine contains ".gif" or ProcessCommandLine contains ".jfif" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".pjp" or ProcessCommandLine contains ".pjpeg" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".svg" or ProcessCommandLine contains ".webp") and FolderPath endswith "/bash" and (ProcessCommandLine contains "tail" and ProcessCommandLine contains "-c")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_tmutil_disable_backup.yml
Time Machine Backup Disabled Via Tmutil - MacOS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "disable" and (FolderPath endswith "/tmutil" or ProcessCommandLine contains "tmutil")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_find_execution.yml
Potential Discovery Activity Using Find - MacOS ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-perm -4000" or ProcessCommandLine contains "-perm -2000" or ProcessCommandLine contains "-perm 0777" or ProcessCommandLine contains "-perm -222" or ProcessCommandLine contains "-perm -o w" or ProcessCommandLine contains "-perm -o x" or ProcessCommandLine contains "-perm -u=s" or ProcessCommandLine contains "-perm -g=s") and FolderPath endswith "/find"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_gui_input_capture.yml
GUI Input Capture - macOS ---> KQL Query:
DeviceProcessEvents
| where FolderPath =~ "/usr/sbin/osascript" and (ProcessCommandLine contains "-e" and ProcessCommandLine contains "display" and ProcessCommandLine contains "dialog" and ProcessCommandLine contains "answer") and (ProcessCommandLine contains "admin" or ProcessCommandLine contains "administrator" or ProcessCommandLine contains "authenticate" or ProcessCommandLine contains "authentication" or ProcessCommandLine contains "credentials" or ProcessCommandLine contains "pass" or ProcessCommandLine contains "password" or ProcessCommandLine contains "unlock")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_wizardupdate_malware_infection.yml
Potential WizardUpdate Malware Infection ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "=$(curl " and ProcessCommandLine contains "eval") and FolderPath endswith "/sh") or (ProcessCommandLine contains "_intermediate_agent_" and FolderPath endswith "/curl")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml
Disable Security Tools ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "unload" and FolderPath =~ "/bin/launchctl") and (ProcessCommandLine contains "com.objective-see.lulu.plist" or ProcessCommandLine contains "com.objective-see.blockblock.plist" or ProcessCommandLine contains "com.google.santad.plist" or ProcessCommandLine contains "com.carbonblack.defense.daemon.plist" or ProcessCommandLine contains "com.carbonblack.daemon.plist" or ProcessCommandLine contains "at.obdev.littlesnitchd.plist" or ProcessCommandLine contains "com.tenablesecurity.nessusagent.plist" or ProcessCommandLine contains "com.opendns.osx.RoamingClientConfigUpdater.plist" or ProcessCommandLine contains "com.crowdstrike.falcond.plist" or ProcessCommandLine contains "com.crowdstrike.userdaemon.plist" or ProcessCommandLine contains "osquery" or ProcessCommandLine contains "filebeat" or ProcessCommandLine contains "auditbeat" or ProcessCommandLine contains "packetbeat" or ProcessCommandLine contains "td-agent")) or (ProcessCommandLine contains "disable" and FolderPath =~ "/usr/sbin/spctl")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_nscurl_usage.yml
File Download Via Nscurl - MacOS ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--download " or ProcessCommandLine contains "--download-directory " or ProcessCommandLine contains "--output " or ProcessCommandLine contains "-dir " or ProcessCommandLine contains "-dl " or ProcessCommandLine contains "-ld" or ProcessCommandLine contains "-o ") and FolderPath endswith "/nscurl"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_creds_from_keychain.yml
Credentials from Password Stores - Keychain ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "find-certificate" or ProcessCommandLine contains " export ") and FolderPath =~ "/usr/bin/security") or (ProcessCommandLine contains " dump-keychain " or ProcessCommandLine contains " login-keychain ")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_susp_execution_macos_script_editor.yml
Suspicious Execution via macOS Script Editor ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "/curl" or FolderPath endswith "/bash" or FolderPath endswith "/sh" or FolderPath endswith "/zsh" or FolderPath endswith "/dash" or FolderPath endswith "/fish" or FolderPath endswith "/osascript" or FolderPath endswith "/mktemp" or FolderPath endswith "/chmod" or FolderPath endswith "/php" or FolderPath endswith "/nohup" or FolderPath endswith "/openssl" or FolderPath endswith "/plutil" or FolderPath endswith "/PlistBuddy" or FolderPath endswith "/xattr" or FolderPath endswith "/sqlite" or FolderPath endswith "/funzip" or FolderPath endswith "/popen") or (FolderPath contains "python" or FolderPath contains "perl")) and InitiatingProcessFolderPath endswith "/Script Editor"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_csrutil_status.yml
System Integrity Protection (SIP) Enumeration ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "status" and FolderPath endswith "/csrutil"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_office_susp_child_processes.yml
Suspicious Microsoft Office Child Process - MacOS ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/bash" or FolderPath endswith "/curl" or FolderPath endswith "/dash" or FolderPath endswith "/fish" or FolderPath endswith "/osacompile" or FolderPath endswith "/osascript" or FolderPath endswith "/sh" or FolderPath endswith "/zsh" or FolderPath endswith "/python" or FolderPath endswith "/python3" or FolderPath endswith "/wget") and (InitiatingProcessFolderPath contains "Microsoft Word" or InitiatingProcessFolderPath contains "Microsoft Excel" or InitiatingProcessFolderPath contains "Microsoft PowerPoint" or InitiatingProcessFolderPath contains "Microsoft OneNote")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_clipboard_data_via_osascript.yml
Clipboard Data Collection Via OSAScript ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "osascript" and ProcessCommandLine contains " -e " and ProcessCommandLine contains "clipboard"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_suspicious_applet_behaviour.yml
Osacompile Execution By Potentially Suspicious Applet/Osascript ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "osacompile" and (InitiatingProcessFolderPath endswith "/applet" or InitiatingProcessFolderPath endswith "/osascript")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_screencapture.yml
Screen Capture - macOS ---> KQL Query:
DeviceProcessEvents
| where FolderPath =~ "/usr/sbin/screencapture"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_osacompile_runonly_execution.yml
OSACompile Run-Only Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "osacompile" and ProcessCommandLine contains " -x " and ProcessCommandLine contains " -e "

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_swvers_discovery.yml
System Information Discovery Using sw_vers ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/sw_vers" and (ProcessCommandLine contains "-buildVersion" or ProcessCommandLine contains "-productName" or ProcessCommandLine contains "-productVersion")

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_remote_access_tools_teamviewer_incoming_connection.yml
Remote Access Tool - Team Viewer Session Started On MacOS Host ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith "/TeamViewer_Desktop --IPCport 5939 --Module 1" and FolderPath endswith "/TeamViewer_Desktop" and InitiatingProcessFolderPath endswith "/TeamViewer_Service"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_file_and_directory_discovery.yml
File and Directory Discovery - MacOS ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine matches regex "(.){200,}" and FolderPath =~ "/usr/bin/file") or FolderPath =~ "/usr/bin/find" or FolderPath =~ "/usr/bin/mdfind" or (ProcessCommandLine contains "-R" and FolderPath =~ "/bin/ls") or FolderPath =~ "/tree"

----------------------------------------
Processing: sigma/rules/macos/process_creation/proc_creation_macos_schedule_task_job_cron.yml
Scheduled Cron Task/Job - MacOs ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/tmp/" and FolderPath endswith "/crontab"

----------------------------------------
Processing: sigma/rules/category/database/db_anomalous_query.yml
Sigma Transformation Error for 'Suspicious SQL Query': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/category/antivirus/av_hacktool.yml
Sigma Transformation Error for 'Antivirus Hacktool Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/category/antivirus/av_ransomware.yml
Sigma Transformation Error for 'Antivirus Ransomware Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/category/antivirus/av_webshell.yml
Sigma Transformation Error for 'Antivirus Web Shell Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/category/antivirus/av_relevant_files.yml
Sigma Transformation Error for 'Antivirus Relevant File Paths Alerts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/category/antivirus/av_exploiting.yml
Sigma Transformation Error for 'Antivirus Exploitation Framework Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/category/antivirus/av_password_dumper.yml
Sigma Transformation Error for 'Antivirus Password Dumper Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_pwndrop.yml
Sigma Transformation Error for 'PwnDrp Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_telegram_api.yml
Sigma Transformation Error for 'Telegram API Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_empty.yml
Sigma Transformation Error for 'HTTP Request With Empty User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_susp.yml
Sigma Transformation Error for 'Suspicious User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_bitsadmin_susp_ip.yml
Sigma Transformation Error for 'Bitsadmin to Uncommon IP Server Address': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_hktl_baby_shark_default_agent_url.yml
Sigma Transformation Error for 'HackTool - BabyShark Agent Default URL Pattern': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_cryptominer.yml
Sigma Transformation Error for 'Crypto Miner User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_pua_advanced_ip_scanner_update_check.yml
Sigma Transformation Error for 'PUA - Advanced IP/Port Scanner Update Check': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_susp_flash_download_loc.yml
Sigma Transformation Error for 'Flash Player Update from Suspicious Location': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_raw_paste_service_access.yml
Sigma Transformation Error for 'Raw Paste Service Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_download_susp_tlds_whitelist.yml
Sigma Transformation Error for 'Download From Suspicious TLD - Whitelist': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_rclone.yml
Sigma Transformation Error for 'Rclone Activity via Proxy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_download_susp_tlds_blacklist.yml
Sigma Transformation Error for 'Download From Suspicious TLD - Blacklist': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_hacktool.yml
Sigma Transformation Error for 'Hack Tool User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_downloadcradle_webdav.yml
Sigma Transformation Error for 'Windows WebDAV User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_susp_ipfs_cred_harvest.yml
Sigma Transformation Error for 'Suspicious Network Communication With IPFS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_malware.yml
Sigma Transformation Error for 'Malware User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_webdav_external_execution.yml
Sigma Transformation Error for 'Suspicious External WebDAV Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_frameworks.yml
Sigma Transformation Error for 'Exploit Framework User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_hktl_cobalt_strike_malleable_c2_requests.yml
Sigma Transformation Error for 'HackTool - CobaltStrike Malleable Profile Patterns - Proxy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_download_susp_dyndns.yml
Sigma Transformation Error for 'Download from Suspicious Dyndns Hosts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_susp_base64.yml
Sigma Transformation Error for 'Potential Base64 Encoded User-Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_bitsadmin_susp_tld.yml
Sigma Transformation Error for 'Bitsadmin to Uncommon TLD': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_apt.yml
Sigma Transformation Error for 'APT User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_f5_tm_utility_bash_api_request.yml
Sigma Transformation Error for 'F5 BIG-IP iControl Rest API Command Execution - Proxy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_base64_encoded.yml
Sigma Transformation Error for 'Suspicious Base64 Encoded User-Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_hktl_empire_ua_uri_patterns.yml
Sigma Transformation Error for 'HackTool - Empire UserAgent URI Combo': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/proxy_generic/proxy_ua_powershell.yml
Sigma Transformation Error for 'Windows PowerShell User Agent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/product/nginx/web_nginx_core_dump.yml
Sigma Transformation Error for 'Nginx Core Dump': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/product/apache/web_apache_threading_error.yml
Sigma Transformation Error for 'Apache Threading Error': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/product/apache/web_apache_segfault.yml
Sigma Transformation Error for 'Apache Segmentation Fault': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_susp_windows_path_uri.yml
Sigma Transformation Error for 'Suspicious Windows Strings In URI': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_jndi_exploit.yml
Sigma Transformation Error for 'JNDIExploit Pattern': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_path_traversal_exploitation_attempt.yml
Sigma Transformation Error for 'Path Traversal Exploitation Attempts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_f5_tm_utility_bash_api_request.yml
Sigma Transformation Error for 'F5 BIG-IP iControl Rest API Command Execution - Webserver': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_susp_useragents.yml
Sigma Transformation Error for 'Suspicious User-Agents Related To Recon Tools': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_java_payload_in_access_logs.yml
Sigma Transformation Error for 'Java Payload Strings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_webshell_regeorg.yml
Sigma Transformation Error for 'Webshell ReGeorg Detection Via Web Logs': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_ssti_in_access_logs.yml
Sigma Transformation Error for 'Server Side Template Injection Strings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_sql_injection_in_access_logs.yml
Sigma Transformation Error for 'SQL Injection Strings In URI': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_iis_tilt_shortname_scan.yml
Sigma Transformation Error for 'Successful IIS Shortname Fuzzing Scan': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_xss_in_access_logs.yml
Sigma Transformation Error for 'Cross Site Scripting Strings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_source_code_enumeration.yml
Sigma Transformation Error for 'Source Code Enumeration Detection by Keyword': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/web/webserver_generic/web_win_webshells_in_access_logs.yml
Sigma Transformation Error for 'Windows Webshell Strings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/huawei/bgp/huawei_bgp_auth_failed.yml
Sigma Transformation Error for 'Huawei BGP Authentication Failures': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_net_sniff.yml
Sigma Transformation Error for 'Cisco Sniffing': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_dos.yml
Sigma Transformation Error for 'Cisco Denial of Service': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_input_capture.yml
Sigma Transformation Error for 'Cisco Show Commands Input': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_modify_config.yml
Sigma Transformation Error for 'Cisco Modify Configuration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_disable_logging.yml
Sigma Transformation Error for 'Cisco Disabling Logging': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_clear_logs.yml
Sigma Transformation Error for 'Cisco Clear Logs': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_discovery.yml
Sigma Transformation Error for 'Cisco Discovery': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_crypto_actions.yml
Sigma Transformation Error for 'Cisco Crypto Commands': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_file_deletion.yml
Sigma Transformation Error for 'Cisco File Deletion': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_moving_data.yml
Sigma Transformation Error for 'Cisco Stage Data': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_collect_data.yml
Sigma Transformation Error for 'Cisco Collect Data': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/aaa/cisco_cli_local_accounts.yml
Sigma Transformation Error for 'Cisco Local Accounts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/ldp/cisco_ldp_md5_auth_failed.yml
Sigma Transformation Error for 'Cisco LDP Authentication Failures': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/cisco/bgp/cisco_bgp_md5_auth_failed.yml
Sigma Transformation Error for 'Cisco BGP Authentication Failures': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/firewall/net_firewall_cleartext_protocols.yml
Sigma Transformation Error for 'Cleartext Protocol Usage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_smb_converted_win_lm_namedpipe.yml
Sigma Transformation Error for 'First Time Seen Remote Named Pipe - Zeek': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_rdp_public_listener.yml
Sigma Transformation Error for 'Publicly Accessible RDP Service': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dns_susp_zbit_flag.yml
Sigma Transformation Error for 'Suspicious DNS Z Flag Bit Set': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dns_mining_pools.yml
Sigma Transformation Error for 'DNS Events Related To Mining Pools': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dce_rpc_potential_petit_potam_efs_rpc_call.yml
Sigma Transformation Error for 'Potential PetitPotam Attack Via EFS RPC Calls': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_http_omigod_no_auth_rce.yml
Sigma Transformation Error for 'OMIGOD HTTP No Authentication RCE': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_smb_converted_win_susp_raccess_sensitive_fext.yml
Sigma Transformation Error for 'Suspicious Access to Sensitive File Extensions - Zeek': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dns_nkn.yml
Sigma Transformation Error for 'New Kind of Network (NKN) Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dce_rpc_printnightmare_print_driver_install.yml
Sigma Transformation Error for 'Possible PrintNightmare Print Driver Install': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_susp_kerberos_rc4.yml
Sigma Transformation Error for 'Kerberos Network Traffic RC4 Ticket Encryption': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_http_executable_download_from_webdav.yml
Sigma Transformation Error for 'Executable from Webdav': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dns_torproxy.yml
Sigma Transformation Error for 'DNS TOR Proxies': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dce_rpc_smb_spoolss_named_pipe.yml
Sigma Transformation Error for 'SMB Spoolss Name Piped Usage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_smb_converted_win_impacket_secretdump.yml
Sigma Transformation Error for 'Possible Impacket SecretDump Remote Activity - Zeek': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_smb_converted_win_atsvc_task.yml
Sigma Transformation Error for 'Remote Task Creation via ATSVC Named Pipe - Zeek': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_http_webdav_put_request.yml
Sigma Transformation Error for 'WebDav Put Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dce_rpc_mitre_bzar_persistence.yml
Sigma Transformation Error for 'MITRE BZAR Indicators for Persistence': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_smb_converted_win_susp_psexec.yml
Sigma Transformation Error for 'Suspicious PsExec Execution - Zeek': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_smb_converted_win_transferring_files_with_credential_data.yml
Sigma Transformation Error for 'Transferring Files with Credential Data via Network Shares - Zeek': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml
Sigma Transformation Error for 'MITRE BZAR Indicators for Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml
Sigma Transformation Error for 'Default Cobalt Strike Certificate': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/zeek/zeek_http_susp_file_ext_from_susp_tld.yml
Sigma Transformation Error for 'HTTP Request to Low Reputation TLD or Suspicious File Extension': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/juniper/bgp/juniper_bgp_missing_md5.yml
Sigma Transformation Error for 'Juniper BGP Missing MD5': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_mal_cobaltstrike.yml
Sigma Transformation Error for 'Cobalt Strike DNS Beaconing': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_susp_txt_exec_strings.yml
Sigma Transformation Error for 'DNS TXT Answer with Possible Execution Strings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_susp_b64_queries.yml
Sigma Transformation Error for 'Suspicious DNS Query with B64 Encoded String': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_wannacry_killswitch_domain.yml
Sigma Transformation Error for 'Wannacry Killswitch Domain': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_external_service_interaction_domains.yml
Sigma Transformation Error for 'DNS Query to External Service Interaction Domains': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_susp_telegram_api.yml
Sigma Transformation Error for 'Telegram Bot API Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/network/dns/net_dns_pua_cryptocoin_mining_xmr.yml
Sigma Transformation Error for 'Monero Crypto Coin Mining Pool Lookup': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/compliance/netflow_cleartext_protocols.yml
Sigma Transformation Error for 'Cleartext Protocol Usage Via Netflow': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/compliance/host_without_firewall.yml
Sigma Transformation Error for 'Host Without Firewall': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/compliance/default_credentials_usage.yml
Sigma Transformation Error for 'Default Credentials Usage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_triple_cross_rootkit_persistence.yml
Triple Cross eBPF Rootkit Default Persistence ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "ebpfbackdoor"

----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_doas_conf_creation.yml
Linux Doas Conf File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "/etc/doas.conf"

----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_persistence_sudoers_files.yml
Persistence Via Sudoers Files ---> KQL Query:
DeviceFileEvents
| where FolderPath startswith "/etc/sudoers.d/"

----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_susp_shell_script_under_profile_directory.yml
Potentially Suspicious Shell Script Creation in Profile Folder ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "/etc/profile.d/" and (FolderPath endswith ".csh" or FolderPath endswith ".sh")

----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_wget_download_file_in_tmp_dir.yml
Wget Creating Files in Tmp Directory ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "/wget" and (FolderPath startswith "/tmp/" or FolderPath startswith "/var/tmp/")

----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_persistence_cron_files.yml
Persistence Via Cron Files ---> KQL Query:
DeviceFileEvents
| where (FolderPath startswith "/etc/cron.d/" or FolderPath startswith "/etc/cron.daily/" or FolderPath startswith "/etc/cron.hourly/" or FolderPath startswith "/etc/cron.monthly/" or FolderPath startswith "/etc/cron.weekly/" or FolderPath startswith "/var/spool/cron/crontabs/") or (FolderPath contains "/etc/cron.allow" or FolderPath contains "/etc/cron.deny" or FolderPath contains "/etc/crontab")

----------------------------------------
Processing: sigma/rules/linux/file_event/file_event_lnx_triple_cross_rootkit_lock_file.yml
Triple Cross eBPF Rootkit Default LockFile ---> KQL Query:
DeviceFileEvents
| where FolderPath =~ "/tmp/rootlog"

----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_masquerading_crond.yml
Sigma Transformation Error for 'Masquerading as Linux Crond Process': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_hidden_binary_execution.yml
Sigma Transformation Error for 'Use Of Hidden Paths Or Files': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_clipboard_collection.yml
Sigma Transformation Error for 'Clipboard Collection with Xclip Tool - Auditd': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_dd_delete_file.yml
Sigma Transformation Error for 'Overwriting the File with Dev Zero or Null': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_chattr_immutable_removal.yml
Sigma Transformation Error for 'Remove Immutable File Attribute - Auditd': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_bpfdoor_port_redirect.yml
Sigma Transformation Error for 'Bpfdoor TCP Ports Redirect': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_file_or_folder_permissions.yml
Sigma Transformation Error for 'File or Folder Permissions Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_system_info_discovery.yml
Sigma Transformation Error for 'System Information Discovery - Auditd': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_steghide_embed_steganography.yml
Sigma Transformation Error for 'Steganography Hide Files with Steghide': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_change_file_time_attr.yml
Sigma Transformation Error for 'File Time Attribute Change - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_data_compressed.yml
Sigma Transformation Error for 'Data Compressed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_bpfdoor_file_accessed.yml
Sigma Transformation Error for 'BPFDoor Abnormal Process ID or Lock File Accessed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_audio_capture.yml
Sigma Transformation Error for 'Audio Capture': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_auditing_config_change.yml
Sigma Transformation Error for 'Auditing Configuration Changes on Linux Host': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_network_service_scanning.yml
Sigma Transformation Error for 'Linux Network Service Scanning - Auditd': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_screencapture_import.yml
Sigma Transformation Error for 'Screen Capture with Import Tool': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_coinminer.yml
Sigma Transformation Error for 'Possible Coin Miner CPU Priority Param': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_susp_histfile_operations.yml
Sigma Transformation Error for 'Suspicious History File Operations - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_screencaputre_xwd.yml
Sigma Transformation Error for 'Screen Capture with Xwd': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_systemd_service_creation.yml
Sigma Transformation Error for 'Systemd Service Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_user_discovery.yml
Sigma Transformation Error for 'System Owner or User Discovery - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_modify_system_firewall.yml
Sigma Transformation Error for 'Modify System Firewall': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_susp_cmds.yml
Sigma Transformation Error for 'Suspicious Commands Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_load_module_insmod.yml
Sigma Transformation Error for 'Loading of Kernel Module via Insmod': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_system_info_discovery2.yml
Sigma Transformation Error for 'System and Hardware Information Discovery': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_logging_config_change.yml
Sigma Transformation Error for 'Logging Configuration Changes on Linux Host': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_network_sniffing.yml
Sigma Transformation Error for 'Network Sniffing - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_steghide_extract_steganography.yml
Sigma Transformation Error for 'Steganography Extract Files with Steghide': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_binary_padding.yml
Sigma Transformation Error for 'Binary Padding - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_capabilities_discovery.yml
Sigma Transformation Error for 'Linux Capabilities Discovery': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_unix_shell_configuration_modification.yml
Sigma Transformation Error for 'Unix Shell Configuration Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_disable_system_firewall.yml
Sigma Transformation Error for 'Disable System Firewall': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml
Sigma Transformation Error for 'Suspicious C2 Activities': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_clipboard_image_collection.yml
Sigma Transformation Error for 'Clipboard Collection of Image Data with Xclip Tool': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_create_account.yml
Sigma Transformation Error for 'Creation Of An User Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_split_file_into_pieces.yml
Sigma Transformation Error for 'Split A File Into Pieces - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_system_shutdown_reboot.yml
Sigma Transformation Error for 'System Shutdown/Reboot - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_ld_so_preload_mod.yml
Sigma Transformation Error for 'Modification of ld.so.preload': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_susp_exe_folders.yml
Sigma Transformation Error for 'Program Executions in Suspicious Folders': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_web_rce.yml
Sigma Transformation Error for 'Webshell Remote Command Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_data_exfil_wget.yml
Sigma Transformation Error for 'Data Exfiltration with Wget': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_hidden_zip_files_steganography.yml
Sigma Transformation Error for 'Steganography Hide Zip Information in Picture File': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_unzip_hidden_zip_files_steganography.yml
Sigma Transformation Error for 'Steganography Unzip Hidden Information From Picture File': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_find_cred_in_files.yml
Sigma Transformation Error for 'Credentials In Files - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_susp_service_reload_or_restart.yml
Sigma Transformation Error for 'Service Reload or Start - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml
Sigma Transformation Error for 'Password Policy Discovery - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_hidden_files_directories.yml
Sigma Transformation Error for 'Hidden Files and Directories': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/auditd/lnx_auditd_keylogging_with_pam_d.yml
Sigma Transformation Error for 'Linux Keylogging with Pam.d': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_triple_cross_rootkit_execve_hijack.yml
Triple Cross eBPF Rootkit Execve Hijack ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "execve_hijack" and FolderPath endswith "/sudo"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_storage_discovery.yml
ESXi Storage Information Discovery Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " get" or ProcessCommandLine contains " list") and (ProcessCommandLine contains "storage" and FolderPath endswith "/esxcli")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_bpftrace_unsafe_option_usage.yml
BPFtrace Unsafe Option Usage ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--unsafe" and FolderPath endswith "bpftrace"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_ssm_agent_abuse.yml
Potential Linux Amazon SSM Agent Hijacking ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-register " and ProcessCommandLine contains "-code " and ProcessCommandLine contains "-id " and ProcessCommandLine contains "-region ") and FolderPath endswith "/amazon-ssm-agent"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_mkfifo_named_pipe_creation.yml
Named Pipe Created Via Mkfifo ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/mkfifo"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_curl_usage.yml
Curl Usage on Linux ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/curl"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_perl_reverse_shell.yml
Potential Perl Reverse Shell Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "fdopen(" and ProcessCommandLine contains "::Socket::INET") or (ProcessCommandLine contains "Socket" and ProcessCommandLine contains "connect" and ProcessCommandLine contains "open" and ProcessCommandLine contains "exec")) and (ProcessCommandLine contains " -e " and FolderPath endswith "/perl")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_at_command.yml
Scheduled Task/Job At ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/at" or FolderPath endswith "/atd"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_env_shell_invocation.yml
Shell Invocation via Env Command - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "/bin/bash" or ProcessCommandLine endswith "/bin/dash" or ProcessCommandLine endswith "/bin/fish" or ProcessCommandLine endswith "/bin/sh" or ProcessCommandLine endswith "/bin/zsh") and FolderPath endswith "/env"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_malware_gobrat_grep_payload_discovery.yml
Potential GobRAT File Discovery Via Grep ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "apached" or ProcessCommandLine contains "frpc" or ProcessCommandLine contains "sshd.sh" or ProcessCommandLine contains "zone.arm") and FolderPath endswith "/grep"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_java_children.yml
Suspicious Java Children Processes ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "bash" or ProcessCommandLine contains "dash" or ProcessCommandLine contains "ksh" or ProcessCommandLine contains "zsh" or ProcessCommandLine contains "csh" or ProcessCommandLine contains "fish" or ProcessCommandLine contains "curl" or ProcessCommandLine contains "wget" or ProcessCommandLine contains "python") and InitiatingProcessFolderPath endswith "/java"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_find_shell_execution.yml
Shell Execution via Find - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/dash" or ProcessCommandLine contains "/bin/fish" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/zsh") and ((ProcessCommandLine contains " . " and ProcessCommandLine contains "-exec") and FolderPath endswith "/find")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_security_tools_disabling.yml
Disabling Security Tools ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "cbdaemon" and ProcessCommandLine contains "stop") and FolderPath endswith "/service") or ((ProcessCommandLine contains "cbdaemon" and ProcessCommandLine contains "off") and FolderPath endswith "/chkconfig") or ((ProcessCommandLine contains "cbdaemon" and ProcessCommandLine contains "stop") and FolderPath endswith "/systemctl") or ((ProcessCommandLine contains "cbdaemon" and ProcessCommandLine contains "disable") and FolderPath endswith "/systemctl") or ((ProcessCommandLine contains "stop" and ProcessCommandLine contains "falcon-sensor") and FolderPath endswith "/systemctl") or ((ProcessCommandLine contains "disable" and ProcessCommandLine contains "falcon-sensor") and FolderPath endswith "/systemctl") or ((ProcessCommandLine contains "firewalld" and ProcessCommandLine contains "stop") and FolderPath endswith "/systemctl") or ((ProcessCommandLine contains "firewalld" and ProcessCommandLine contains "disable") and FolderPath endswith "/systemctl") or ((ProcessCommandLine contains "iptables" and ProcessCommandLine contains "stop") and FolderPath endswith "/service") or ((ProcessCommandLine contains "ip6tables" and ProcessCommandLine contains "stop") and FolderPath endswith "/service") or ((ProcessCommandLine contains "iptables" and ProcessCommandLine contains "stop") and FolderPath endswith "/chkconfig") or ((ProcessCommandLine contains "ip6tables" and ProcessCommandLine contains "stop") and FolderPath endswith "/chkconfig") or (ProcessCommandLine contains "0" and FolderPath endswith "/setenforce")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_local_groups.yml
Local Groups Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/groups" or (ProcessCommandLine contains "/etc/group" and (FolderPath endswith "/cat" or FolderPath endswith "/head" or FolderPath endswith "/tail" or FolderPath endswith "/more"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_system_network_connections_discovery.yml
System Network Connections Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/who" or FolderPath endswith "/w" or FolderPath endswith "/last" or FolderPath endswith "/lsof" or FolderPath endswith "/netstat") and (not((FolderPath endswith "/who" and InitiatingProcessCommandLine contains "/usr/bin/landscape-sysinfo")))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_crontab_removal.yml
Remove Scheduled Cron Task/Job ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -r" and FolderPath endswith "crontab"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_pnscan_binary_cli_pattern.yml
Pnscan Binary Data Transmission Activity ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "-(W|R)\\s?(\\s|"|')([0-9a-fA-F]{2}\\s?){2,20}(\\s|"|')"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_crontab_enumeration.yml
Crontab Enumeration ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -l" and FolderPath endswith "/crontab"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_execution_tmp_folder.yml
Potentially Suspicious Execution From Tmp Folder ---> KQL Query:
DeviceProcessEvents
| where FolderPath startswith "/tmp/"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_doas_execution.yml
Linux Doas Tool Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/doas"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_apt_shell_execution.yml
Shell Invocation via Apt - Linux ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "APT::Update::Pre-Invoke::=" and (FolderPath endswith "/apt" or FolderPath endswith "/apt-get")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_install_root_certificate.yml
Install Root Certificate ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/update-ca-certificates" or FolderPath endswith "/update-ca-trust"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_services_stop_and_disable.yml
Disable Or Stop Services ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "stop" or ProcessCommandLine contains "disable") and (FolderPath endswith "/service" or FolderPath endswith "/systemctl" or FolderPath endswith "/chkconfig")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_hktl_execution.yml
Linux HackTool Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "/cobaltstrike" or FolderPath contains "/teamserver") or (FolderPath endswith "/crackmapexec" or FolderPath endswith "/havoc" or FolderPath endswith "/merlin-agent" or FolderPath endswith "/merlinServer-Linux-x64" or FolderPath endswith "/msfconsole" or FolderPath endswith "/msfvenom" or FolderPath endswith "/ps-empire server" or FolderPath endswith "/ps-empire" or FolderPath endswith "/sliver-client" or FolderPath endswith "/sliver-server" or FolderPath endswith "/Villain.py") or (FolderPath endswith "/aircrack-ng" or FolderPath endswith "/bloodhound-python" or FolderPath endswith "/bpfdos" or FolderPath endswith "/ebpfki" or FolderPath endswith "/evil-winrm" or FolderPath endswith "/hashcat" or FolderPath endswith "/hoaxshell.py" or FolderPath endswith "/hydra" or FolderPath endswith "/john" or FolderPath endswith "/ncrack" or FolderPath endswith "/nxc-ubuntu-latest" or FolderPath endswith "/pidhide" or FolderPath endswith "/pspy32" or FolderPath endswith "/pspy32s" or FolderPath endswith "/pspy64" or FolderPath endswith "/pspy64s" or FolderPath endswith "/setoolkit" or FolderPath endswith "/sqlmap" or FolderPath endswith "/writeblocker") or FolderPath contains "/linpeas" or (FolderPath endswith "/autorecon" or FolderPath endswith "/httpx" or FolderPath endswith "/legion" or FolderPath endswith "/naabu" or FolderPath endswith "/netdiscover" or FolderPath endswith "/nuclei" or FolderPath endswith "/recon-ng") or FolderPath contains "/sniper" or (FolderPath endswith "/dirb" or FolderPath endswith "/dirbuster" or FolderPath endswith "/eyewitness" or FolderPath endswith "/feroxbuster" or FolderPath endswith "/ffuf" or FolderPath endswith "/gobuster" or FolderPath endswith "/wfuzz" or FolderPath endswith "/whatweb") or (FolderPath endswith "/joomscan" or FolderPath endswith "/nikto" or FolderPath endswith "/wpscan")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_netcat_reverse_shell.yml
Potential Netcat Reverse Shell Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c " or ProcessCommandLine contains " -e ") and (FolderPath endswith "/nc" or FolderPath endswith "/ncat") and (ProcessCommandLine contains " ash" or ProcessCommandLine contains " bash" or ProcessCommandLine contains " bsh" or ProcessCommandLine contains " csh" or ProcessCommandLine contains " ksh" or ProcessCommandLine contains " pdksh" or ProcessCommandLine contains " sh" or ProcessCommandLine contains " tcsh" or ProcessCommandLine contains "/bin/ash" or ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/bsh" or ProcessCommandLine contains "/bin/csh" or ProcessCommandLine contains "/bin/ksh" or ProcessCommandLine contains "/bin/pdksh" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/tcsh" or ProcessCommandLine contains "/bin/zsh" or ProcessCommandLine contains "$IFSash" or ProcessCommandLine contains "$IFSbash" or ProcessCommandLine contains "$IFSbsh" or ProcessCommandLine contains "$IFScsh" or ProcessCommandLine contains "$IFSksh" or ProcessCommandLine contains "$IFSpdksh" or ProcessCommandLine contains "$IFSsh" or ProcessCommandLine contains "$IFStcsh" or ProcessCommandLine contains "$IFSzsh")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_base64_shebang_cli.yml
Linux Base64 Encoded Shebang In CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "IyEvYmluL2Jhc2" or ProcessCommandLine contains "IyEvYmluL2Rhc2" or ProcessCommandLine contains "IyEvYmluL3pza" or ProcessCommandLine contains "IyEvYmluL2Zpc2" or ProcessCommandLine contains "IyEvYmluL3No"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_file_and_directory_discovery.yml
File and Directory Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine matches regex "(.){200,}" and FolderPath endswith "/file") or FolderPath endswith "/find" or FolderPath endswith "/findmnt" or FolderPath endswith "/mlocate" or (ProcessCommandLine contains "-R" and FolderPath endswith "/ls") or FolderPath endswith "/tree"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_remote_access_tools_teamviewer_incoming_connection.yml
Remote Access Tool - Team Viewer Session Started On Linux Host ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith "/TeamViewer_Desktop --IPCport 5939 --Module 1" and FolderPath endswith "/TeamViewer_Desktop" and InitiatingProcessFolderPath endswith "/TeamViewer_Service"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_awk_shell_spawn.yml
Suspicious Invocation of Shell via AWK - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/dash" or ProcessCommandLine contains "/bin/fish" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/zsh") and (ProcessCommandLine contains "BEGIN {system" and (FolderPath endswith "/awk" or FolderPath endswith "/gawk" or FolderPath endswith "/mawk" or FolderPath endswith "/nawk"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_python_pty_spawn.yml
Python Spawning Pretty TTY Via PTY Module ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "import pty" or ProcessCommandLine contains "from pty ") and ProcessCommandLine contains "spawn" and ((FolderPath endswith "/python" or FolderPath endswith "/python2" or FolderPath endswith "/python3") or (FolderPath contains "/python2." or FolderPath contains "/python3."))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_permission_change_admin.yml
ESXi Admin Permission Assigned To Account Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "system" and (ProcessCommandLine contains " permission " and ProcessCommandLine contains " set" and ProcessCommandLine contains "Admin") and FolderPath endswith "/esxcli"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_sensitive_file_access.yml
Potential Suspicious Change To Sensitive/Critical Files ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains ">" and (FolderPath endswith "/cat" or FolderPath endswith "/echo" or FolderPath endswith "/grep" or FolderPath endswith "/head" or FolderPath endswith "/more" or FolderPath endswith "/tail")) or (FolderPath endswith "/emacs" or FolderPath endswith "/nano" or FolderPath endswith "/sed" or FolderPath endswith "/vi" or FolderPath endswith "/vim")) and (ProcessCommandLine contains "/bin/login" or ProcessCommandLine contains "/bin/passwd" or ProcessCommandLine contains "/boot/" or (ProcessCommandLine contains "/etc/" and ProcessCommandLine contains ".conf") or ProcessCommandLine contains "/etc/cron." or ProcessCommandLine contains "/etc/crontab" or ProcessCommandLine contains "/etc/hosts" or ProcessCommandLine contains "/etc/init.d" or ProcessCommandLine contains "/etc/sudoers" or ProcessCommandLine contains "/opt/bin/" or ProcessCommandLine contains "/sbin" or ProcessCommandLine contains "/usr/bin/" or ProcessCommandLine contains "/usr/local/bin/")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_curl_useragent.yml
Suspicious Curl Change User Agents - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -A " or ProcessCommandLine contains " --user-agent ") and FolderPath endswith "/curl"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_clear_syslog.yml
Commands to Clear or Remove the Syslog ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "rm /var/log/syslog" or ProcessCommandLine contains "rm -r /var/log/syslog" or ProcessCommandLine contains "rm -f /var/log/syslog" or ProcessCommandLine contains "rm -rf /var/log/syslog" or ProcessCommandLine contains "unlink /var/log/syslog" or ProcessCommandLine contains "unlink -r /var/log/syslog" or ProcessCommandLine contains "unlink -f /var/log/syslog" or ProcessCommandLine contains "unlink -rf /var/log/syslog" or ProcessCommandLine contains "mv /var/log/syslog" or ProcessCommandLine contains " >/var/log/syslog" or ProcessCommandLine contains " > /var/log/syslog"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_security_software_discovery.yml
Security Software Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "nessusd" or ProcessCommandLine contains "td-agent" or ProcessCommandLine contains "packetbeat" or ProcessCommandLine contains "filebeat" or ProcessCommandLine contains "auditbeat" or ProcessCommandLine contains "osqueryd" or ProcessCommandLine contains "cbagentd" or ProcessCommandLine contains "falcond") and (FolderPath endswith "/grep" or FolderPath endswith "/egrep")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_wget_download_suspicious_directory.yml
Download File To Potentially Suspicious Directory Via Wget ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/wget" and (ProcessCommandLine matches regex "\\s-O\\s" or ProcessCommandLine contains "--output-document") and ProcessCommandLine contains "/tmp/"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_python_reverse_shell.yml
Python Reverse Shell Execution Via PTY And Socket Modules ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c " and ProcessCommandLine contains "import" and ProcessCommandLine contains "pty" and ProcessCommandLine contains "socket" and ProcessCommandLine contains "spawn" and ProcessCommandLine contains ".connect") and FolderPath contains "python"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_cp_passwd_or_shadow_tmp.yml
Copy Passwd Or Shadow From TMP Path ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "passwd" or ProcessCommandLine contains "shadow") and FolderPath endswith "/cp" and ProcessCommandLine contains "/tmp/"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_clear_logs.yml
Clear Linux Logs ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/var/log" or ProcessCommandLine contains "/var/spool/mail") and (FolderPath endswith "/rm" or FolderPath endswith "/shred" or FolderPath endswith "/unlink")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_file_deletion.yml
File Deletion ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/rm" or FolderPath endswith "/shred" or FolderPath endswith "/unlink"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_network_utilities_execution.yml
Linux Network Service Scanning Tools Execution ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "/nc" or FolderPath endswith "/ncat" or FolderPath endswith "/netcat" or FolderPath endswith "/socat") and (not((ProcessCommandLine contains " --listen " or ProcessCommandLine contains " -l ")))) or (FolderPath endswith "/autorecon" or FolderPath endswith "/hping" or FolderPath endswith "/hping2" or FolderPath endswith "/hping3" or FolderPath endswith "/naabu" or FolderPath endswith "/nmap" or FolderPath endswith "/nping" or FolderPath endswith "/telnet" or FolderPath endswith "/zenmap")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_capsh_shell_invocation.yml
Capsh Shell Invocation - Linux ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith " --" and FolderPath endswith "/capsh"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_inod_listing.yml
Potential Container Discovery Via Inodes Listing ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -" and ProcessCommandLine contains "i") and (ProcessCommandLine contains " -" and ProcessCommandLine contains "d")) and ProcessCommandLine endswith " /" and FolderPath endswith "/ls"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_dockerenv_recon.yml
Docker Container Discovery Via Dockerenv Listing ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith ".dockerenv" and (FolderPath endswith "/cat" or FolderPath endswith "/dir" or FolderPath endswith "/find" or FolderPath endswith "/ls" or FolderPath endswith "/stat" or FolderPath endswith "/test" or FolderPath endswith "grep")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_git_clone.yml
Suspicious Git Clone - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " clone " and FolderPath endswith "/git") and (ProcessCommandLine contains "exploit" or ProcessCommandLine contains "Vulns" or ProcessCommandLine contains "vulnerability" or ProcessCommandLine contains "RCE" or ProcessCommandLine contains "RemoteCodeExecution" or ProcessCommandLine contains "Invoke-" or ProcessCommandLine contains "CVE-" or ProcessCommandLine contains "poc-" or ProcessCommandLine contains "ProofOfConcept" or ProcessCommandLine contains "proxyshell" or ProcessCommandLine contains "log4shell" or ProcessCommandLine contains "eternalblue" or ProcessCommandLine contains "eternal-blue" or ProcessCommandLine contains "MS17-")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_bpf_kprob_tracing_enabled.yml
Enable BPF Kprobes Tracing ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/myprobe/enable" or ProcessCommandLine contains "/myretprobe/enable") and (ProcessCommandLine contains "echo 1 >" and ProcessCommandLine contains "/sys/kernel/debug/tracing/events/kprobes/")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_bash_interactive_shell.yml
Bash Interactive Shell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -i " and FolderPath endswith "/bash"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_grep_os_arch_discovery.yml
OS Architecture Discovery Via Grep ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "aarch64" or ProcessCommandLine endswith "arm" or ProcessCommandLine endswith "i386" or ProcessCommandLine endswith "i686" or ProcessCommandLine endswith "mips" or ProcessCommandLine endswith "x86_64") and FolderPath endswith "/grep"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_shell_script_exec_from_susp_location.yml
Execution Of Script Located In Potentially Suspicious Directory ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -c " and (FolderPath endswith "/bash" or FolderPath endswith "/csh" or FolderPath endswith "/dash" or FolderPath endswith "/fish" or FolderPath endswith "/ksh" or FolderPath endswith "/sh" or FolderPath endswith "/zsh") and ProcessCommandLine contains "/tmp/"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_userdel.yml
User Has Been Deleted Via Userdel ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/userdel"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_ssh_shell_execution.yml
Shell Invocation Via Ssh - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/dash" or ProcessCommandLine contains "/bin/fish" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/zsh" or ProcessCommandLine contains "sh 0<&2 1>&2" or ProcessCommandLine contains "sh 1>&2 0<&2") and ((ProcessCommandLine contains "ProxyCommand=;" or ProcessCommandLine contains "permitlocalcommand=yes" or ProcessCommandLine contains "localhost") and FolderPath endswith "/ssh")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_cve_2022_26134_atlassian_confluence.yml
Atlassian Confluence CVE-2022-26134 ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "bash" or ProcessCommandLine contains "dash" or ProcessCommandLine contains "ksh" or ProcessCommandLine contains "zsh" or ProcessCommandLine contains "csh" or ProcessCommandLine contains "fish" or ProcessCommandLine contains "curl" or ProcessCommandLine contains "wget" or ProcessCommandLine contains "python") and InitiatingProcessFolderPath endswith "/java" and InitiatingProcessFolderPath startswith "/opt/atlassian/confluence/"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_gcc_shell_execution.yml
Shell Execution GCC  - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/bash,-s" or ProcessCommandLine contains "/bin/dash,-s" or ProcessCommandLine contains "/bin/fish,-s" or ProcessCommandLine contains "/bin/sh,-s" or ProcessCommandLine contains "/bin/zsh,-s") and (ProcessCommandLine contains "-wrapper" and (FolderPath endswith "/c89" or FolderPath endswith "/c99" or FolderPath endswith "/gcc"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_base64_execution.yml
Linux Base64 Encoded Pipe to Shell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "base64 " and ((ProcessCommandLine contains "| bash " or ProcessCommandLine contains "| sh " or ProcessCommandLine contains "|bash " or ProcessCommandLine contains "|sh ") or (ProcessCommandLine endswith " |sh" or ProcessCommandLine endswith "| bash" or ProcessCommandLine endswith "| sh" or ProcessCommandLine endswith "|bash"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_webshell_detection.yml
Linux Webshell Indicators ---> KQL Query:
DeviceProcessEvents
| where ((InitiatingProcessFolderPath endswith "/httpd" or InitiatingProcessFolderPath endswith "/lighttpd" or InitiatingProcessFolderPath endswith "/nginx" or InitiatingProcessFolderPath endswith "/apache2" or InitiatingProcessFolderPath endswith "/node" or InitiatingProcessFolderPath endswith "/caddy") or (InitiatingProcessCommandLine contains "/bin/java" and InitiatingProcessCommandLine contains "tomcat") or (InitiatingProcessCommandLine contains "/bin/java" and InitiatingProcessCommandLine contains "websphere")) and (FolderPath endswith "/whoami" or FolderPath endswith "/ifconfig" or FolderPath endswith "/ip" or FolderPath endswith "/bin/uname" or FolderPath endswith "/bin/cat" or FolderPath endswith "/bin/crontab" or FolderPath endswith "/hostname" or FolderPath endswith "/iptables" or FolderPath endswith "/netstat" or FolderPath endswith "/pwd" or FolderPath endswith "/route")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yml
Sigma Transformation Error for 'OMIGOD SCX RunAsProvider ExecuteShellCommand': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_nohup_susp_execution.yml
Suspicious Nohup Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/tmp/" and FolderPath endswith "/nohup"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_php_reverse_shell.yml
Potential PHP Reverse Shell ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ash" or ProcessCommandLine contains "bash" or ProcessCommandLine contains "bsh" or ProcessCommandLine contains "csh" or ProcessCommandLine contains "ksh" or ProcessCommandLine contains "pdksh" or ProcessCommandLine contains "sh" or ProcessCommandLine contains "tcsh" or ProcessCommandLine contains "zsh") and (ProcessCommandLine contains " -r " and ProcessCommandLine contains "fsockopen") and FolderPath contains "/php"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_curl_fileupload.yml
Suspicious Curl File Upload - Linux ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " --form" or ProcessCommandLine contains " --upload-file " or ProcessCommandLine contains " --data " or ProcessCommandLine contains " --data-") or ProcessCommandLine matches regex "\\s-[FTd]\\s") and FolderPath endswith "/curl") and (not((ProcessCommandLine contains "://localhost" or ProcessCommandLine contains "://127.0.0.1")))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_system_discovery.yml
ESXi System Information Discovery Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " get" or ProcessCommandLine contains " list") and (ProcessCommandLine contains "system" and FolderPath endswith "/esxcli")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_nohup.yml
Nohup Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/nohup"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_mkfifo_named_pipe_creation_susp_location.yml
Potentially Suspicious Named Pipe Created Via Mkfifo ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /tmp/" and FolderPath endswith "/mkfifo"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_find_execution.yml
Potential Discovery Activity Using Find - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-perm -4000" or ProcessCommandLine contains "-perm -2000" or ProcessCommandLine contains "-perm 0777" or ProcessCommandLine contains "-perm -222" or ProcessCommandLine contains "-perm -o w" or ProcessCommandLine contains "-perm -o x" or ProcessCommandLine contains "-perm -u=s" or ProcessCommandLine contains "-perm -g=s") and FolderPath endswith "/find"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_ruby_reverse_shell.yml
Potential Ruby Reverse Shell ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " ash" or ProcessCommandLine contains " bash" or ProcessCommandLine contains " bsh" or ProcessCommandLine contains " csh" or ProcessCommandLine contains " ksh" or ProcessCommandLine contains " pdksh" or ProcessCommandLine contains " sh" or ProcessCommandLine contains " tcsh") and (ProcessCommandLine contains " -e" and ProcessCommandLine contains "rsocket" and ProcessCommandLine contains "TCPSocket") and FolderPath contains "ruby"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_python_shell_os_system.yml
Inline Python Execution - Spawn Shell Via OS System Library ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/dash" or ProcessCommandLine contains "/bin/fish" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/zsh") and (ProcessCommandLine contains " -c " and ProcessCommandLine contains "os.system(")) and ((FolderPath endswith "/python" or FolderPath endswith "/python2" or FolderPath endswith "/python3") or (FolderPath contains "/python2." or FolderPath contains "/python3."))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_schedule_task_job_cron.yml
Scheduled Cron Task/Job - Linux ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/tmp/" and FolderPath endswith "crontab"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_git_shell_execution.yml
Shell Execution via Git - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "bash 0<&1" or ProcessCommandLine contains "dash 0<&1" or ProcessCommandLine contains "sh 0<&1") and (InitiatingProcessCommandLine contains " -p " and InitiatingProcessCommandLine contains "help") and InitiatingProcessFolderPath endswith "/git"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_iptables_flush_ufw.yml
Flush Iptables Ufw Chain ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/iptables" or FolderPath endswith "/xtables-legacy-multi" or FolderPath endswith "/iptables-legacy-multi" or FolderPath endswith "/ip6tables" or FolderPath endswith "/ip6tables-legacy-multi") and (ProcessCommandLine contains "-F" or ProcessCommandLine contains "-Z" or ProcessCommandLine contains "-X") and (ProcessCommandLine contains "ufw-logging-deny" or ProcessCommandLine contains "ufw-logging-allow" or ProcessCommandLine contains "ufw6-logging-deny" or ProcessCommandLine contains "ufw6-logging-allow")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_cat_sudoers.yml
Cat Sudoers ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /etc/sudoers" and (FolderPath endswith "/cat" or FolderPath endswith "grep" or FolderPath endswith "/head" or FolderPath endswith "/tail" or FolderPath endswith "/more")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_usermod_susp_group.yml
User Added To Root/Sudoers Group Using Usermod ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-aG root" or ProcessCommandLine contains "-aG sudoers") and FolderPath endswith "/usermod"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_system_network_discovery.yml
System Network Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/etc/resolv.conf" or (FolderPath endswith "/firewall-cmd" or FolderPath endswith "/ufw" or FolderPath endswith "/iptables" or FolderPath endswith "/netstat" or FolderPath endswith "/ss" or FolderPath endswith "/ip" or FolderPath endswith "/ifconfig" or FolderPath endswith "/systemd-resolve" or FolderPath endswith "/route")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_network_discovery.yml
ESXi Network Configuration Discovery Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " get" or ProcessCommandLine contains " list") and (ProcessCommandLine contains "network" and FolderPath endswith "/esxcli")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_mount_hidepid.yml
Mount Execution With Hidepid Parameter ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "hidepid=2" and ProcessCommandLine contains " -o ") and FolderPath endswith "/mount"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_touch_susp.yml
Touch Suspicious Service File ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -t " and ProcessCommandLine endswith ".service" and FolderPath endswith "/touch"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_setgid_setuid.yml
Setuid and Setgid ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " chmod u+s" or ProcessCommandLine contains " chmod g+s") and ProcessCommandLine contains "chown root"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_rsync_shell_execution.yml
Shell Execution via Rsync - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/ash " or ProcessCommandLine contains "/bash " or ProcessCommandLine contains "/dash " or ProcessCommandLine contains "/csh " or ProcessCommandLine contains "/sh " or ProcessCommandLine contains "/zsh " or ProcessCommandLine contains "/tcsh " or ProcessCommandLine contains "/ksh " or ProcessCommandLine contains "'ash " or ProcessCommandLine contains "'bash " or ProcessCommandLine contains "'dash " or ProcessCommandLine contains "'csh " or ProcessCommandLine contains "'sh " or ProcessCommandLine contains "'zsh " or ProcessCommandLine contains "'tcsh " or ProcessCommandLine contains "'ksh ") and (ProcessCommandLine contains " -e " and (FolderPath endswith "/rsync" or FolderPath endswith "/rsyncd"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_chattr_immutable_removal.yml
Remove Immutable File Attribute ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -i " and FolderPath endswith "/chattr"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_discovery.yml
ESXi VM List Discovery Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "vm process" and ProcessCommandLine endswith " list" and FolderPath endswith "/esxcli"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_dd_file_overwrite.yml
DD File Overwrite ---> KQL Query:
DeviceProcessEvents
| where (FolderPath in~ ("/bin/dd", "/usr/bin/dd")) and ProcessCommandLine contains "of=" and (ProcessCommandLine contains "if=/dev/zero" or ProcessCommandLine contains "if=/dev/null")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_history_delete.yml
History File Deletion ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/rm" or FolderPath endswith "/unlink" or FolderPath endswith "/shred") and ((ProcessCommandLine contains "/.bash_history" or ProcessCommandLine contains "/.zsh_history") or (ProcessCommandLine endswith "_history" or ProcessCommandLine endswith ".history" or ProcessCommandLine endswith "zhistory"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_capa_discovery.yml
Capabilities Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -r " or ProcessCommandLine contains " /r " or ProcessCommandLine contains " r " or ProcessCommandLine contains " r " or ProcessCommandLine contains " r ") and FolderPath endswith "/getcap"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_kill.yml
ESXi VM Kill Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "vm process" and ProcessCommandLine contains "kill") and FolderPath endswith "/esxcli"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_container_residence_discovery.yml
Container Residence Discovery Via Proc Virtual FS ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "awk" or FolderPath endswith "/cat" or FolderPath endswith "grep" or FolderPath endswith "/head" or FolderPath endswith "/less" or FolderPath endswith "/more" or FolderPath endswith "/nl" or FolderPath endswith "/tail") and (ProcessCommandLine contains "/proc/2/" or (ProcessCommandLine contains "/proc/" and (ProcessCommandLine endswith "/cgroup" or ProcessCommandLine endswith "/sched")))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_xterm_reverse_shell.yml
Potential Xterm Reverse Shell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-display" and ProcessCommandLine endswith ":1" and FolderPath contains "xterm"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_recon_indicators.yml
Linux Recon Indicators ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -name .htpasswd" or ProcessCommandLine contains " -perm -4000 "

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_remote_system_discovery.yml
Linux Remote System Discovery ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-a" and FolderPath endswith "/arp") or ((ProcessCommandLine contains " 10." or ProcessCommandLine contains " 192.168." or ProcessCommandLine contains " 172.16." or ProcessCommandLine contains " 172.17." or ProcessCommandLine contains " 172.18." or ProcessCommandLine contains " 172.19." or ProcessCommandLine contains " 172.20." or ProcessCommandLine contains " 172.21." or ProcessCommandLine contains " 172.22." or ProcessCommandLine contains " 172.23." or ProcessCommandLine contains " 172.24." or ProcessCommandLine contains " 172.25." or ProcessCommandLine contains " 172.26." or ProcessCommandLine contains " 172.27." or ProcessCommandLine contains " 172.28." or ProcessCommandLine contains " 172.29." or ProcessCommandLine contains " 172.30." or ProcessCommandLine contains " 172.31." or ProcessCommandLine contains " 127." or ProcessCommandLine contains " 169.254.") and FolderPath endswith "/ping")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_local_account.yml
Local System Accounts Discovery - Linux ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/lastlog" or ProcessCommandLine contains "'x:0:'" or ((ProcessCommandLine contains "/etc/passwd" or ProcessCommandLine contains "/etc/shadow" or ProcessCommandLine contains "/etc/sudoers" or ProcessCommandLine contains "/etc/spwd.db" or ProcessCommandLine contains "/etc/pwd.db" or ProcessCommandLine contains "/etc/master.passwd") and (FolderPath endswith "/cat" or FolderPath endswith "/ed" or FolderPath endswith "/head" or FolderPath endswith "/more" or FolderPath endswith "/nano" or FolderPath endswith "/tail" or FolderPath endswith "/vi" or FolderPath endswith "/vim" or FolderPath endswith "/less" or FolderPath endswith "/emacs" or FolderPath endswith "/sqlite3" or FolderPath endswith "/makemap")) or FolderPath endswith "/id" or (ProcessCommandLine contains "-u" and FolderPath endswith "/lsof")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_remove_package.yml
Linux Package Uninstall ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "remove" or ProcessCommandLine contains "purge") and (FolderPath endswith "/apt" or FolderPath endswith "/apt-get")) or ((ProcessCommandLine contains "--remove " or ProcessCommandLine contains " -r ") and FolderPath endswith "/dpkg") or (ProcessCommandLine contains " -e " and FolderPath endswith "/rpm") or ((ProcessCommandLine contains "erase" or ProcessCommandLine contains "remove") and FolderPath endswith "/yum")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_shell_child_process_from_parent_tmp_folder.yml
Shell Execution Of Process Located In Tmp Directory ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/bash" or FolderPath endswith "/csh" or FolderPath endswith "/dash" or FolderPath endswith "/fish" or FolderPath endswith "/ksh" or FolderPath endswith "/sh" or FolderPath endswith "/zsh") and InitiatingProcessFolderPath startswith "/tmp/"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_nice_shell_execution.yml
Shell Execution via Nice - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "/bin/bash" or ProcessCommandLine endswith "/bin/dash" or ProcessCommandLine endswith "/bin/fish" or ProcessCommandLine endswith "/bin/sh" or ProcessCommandLine endswith "/bin/zsh") and FolderPath endswith "/nice"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_pipe_shell.yml
Linux Shell Pipe to Shell ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine startswith "sh -c " or ProcessCommandLine startswith "bash -c ") and ((ProcessCommandLine contains "| bash " or ProcessCommandLine contains "| sh " or ProcessCommandLine contains "|bash " or ProcessCommandLine contains "|sh ") or (ProcessCommandLine endswith "| bash" or ProcessCommandLine endswith "| sh" or ProcessCommandLine endswith "|bash" or ProcessCommandLine endswith " |sh"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_crypto_mining.yml
Linux Crypto Mining Indicators ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " --cpu-priority=" or ProcessCommandLine contains "--donate-level=0" or ProcessCommandLine contains " -o pool." or ProcessCommandLine contains " --nicehash" or ProcessCommandLine contains " --algo=rx/0 " or ProcessCommandLine contains "stratum+tcp://" or ProcessCommandLine contains "stratum+udp://" or ProcessCommandLine contains "sh -c /sbin/modprobe msr allow_writes=on" or ProcessCommandLine contains "LS1kb25hdGUtbGV2ZWw9" or ProcessCommandLine contains "0tZG9uYXRlLWxldmVsP" or ProcessCommandLine contains "tLWRvbmF0ZS1sZXZlbD" or ProcessCommandLine contains "c3RyYXR1bSt0Y3A6Ly" or ProcessCommandLine contains "N0cmF0dW0rdGNwOi8v" or ProcessCommandLine contains "zdHJhdHVtK3RjcDovL" or ProcessCommandLine contains "c3RyYXR1bSt1ZHA6Ly" or ProcessCommandLine contains "N0cmF0dW0rdWRwOi8v" or ProcessCommandLine contains "zdHJhdHVtK3VkcDovL"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executescript.yml
Sigma Transformation Error for 'OMIGOD SCX RunAsProvider ExecuteScript': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_install_suspicioua_packages.yml
Suspicious Package Installed - Linux ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "install" and (FolderPath endswith "/apt" or FolderPath endswith "/apt-get")) or ((ProcessCommandLine contains "--install" or ProcessCommandLine contains "-i") and FolderPath endswith "/dpkg") or (ProcessCommandLine contains "-i" and FolderPath endswith "/rpm") or ((ProcessCommandLine contains "localinstall" or ProcessCommandLine contains "install") and FolderPath endswith "/yum")) and (ProcessCommandLine contains "nmap" or ProcessCommandLine contains " nc" or ProcessCommandLine contains "netcat" or ProcessCommandLine contains "wireshark" or ProcessCommandLine contains "tshark" or ProcessCommandLine contains "openconnect" or ProcessCommandLine contains "proxychains")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_base64_decode.yml
Decode Base64 Encoded Text ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-d" and FolderPath endswith "/base64"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_sudo_cve_2019_14287.yml
Sudo Privilege Escalation CVE-2019-14287 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -u#"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_proxy_connection.yml
Connection Proxy ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "http_proxy=" or ProcessCommandLine contains "https_proxy="

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_clipboard_collection.yml
Clipboard Collection with Xclip Tool ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-sel" and ProcessCommandLine contains "clip" and ProcessCommandLine contains "-o") and FolderPath contains "xclip"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_rsync_shell_spawn.yml
Suspicious Invocation of Shell via Rsync ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "/ash" or FolderPath endswith "/bash" or FolderPath endswith "/csh" or FolderPath endswith "/dash" or FolderPath endswith "/ksh" or FolderPath endswith "/sh" or FolderPath endswith "/tcsh" or FolderPath endswith "/zsh") and (InitiatingProcessFolderPath endswith "/rsync" or InitiatingProcessFolderPath endswith "/rsyncd")) and (not(ProcessCommandLine contains " -e "))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_groupdel.yml
Group Has Been Deleted Via Groupdel ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/groupdel"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_user_account_creation.yml
ESXi Account Creation Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "system " and ProcessCommandLine contains "account " and ProcessCommandLine contains "add ") and FolderPath endswith "/esxcli"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_cve_2022_33891_spark_shell_command_injection.yml
Apache Spark Shell Command Injection - ProcessCreation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "id -Gn `" or ProcessCommandLine contains "id -Gn '") and InitiatingProcessFolderPath endswith "\\bash"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_vsan_discovery.yml
ESXi VSAN Information Discovery Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " get" or ProcessCommandLine contains " list") and (ProcessCommandLine contains "vsan" and FolderPath endswith "/esxcli")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_disable_ufw.yml
Ufw Force Stop Using Ufw-Init ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-ufw-init" and ProcessCommandLine contains "force-stop") or (ProcessCommandLine contains "ufw" and ProcessCommandLine contains "disable")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_chmod_directories.yml
Chmod Suspicious Directory ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/tmp/" or ProcessCommandLine contains "/.Library/" or ProcessCommandLine contains "/etc/" or ProcessCommandLine contains "/opt/") and FolderPath endswith "/chmod"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_system_info_discovery.yml
System Information Discovery ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "/uname" or FolderPath endswith "/hostname" or FolderPath endswith "/uptime" or FolderPath endswith "/lspci" or FolderPath endswith "/dmidecode" or FolderPath endswith "/lscpu" or FolderPath endswith "/lsmod"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_flock_shell_execution.yml
Shell Execution via Flock - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/dash" or ProcessCommandLine contains "/bin/fish" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/zsh") and (ProcessCommandLine contains " -u " and FolderPath endswith "/flock")

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_vim_shell_execution.yml
Vim GTFOBin Abuse - Linux ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ":!/" or ProcessCommandLine contains ":lua " or ProcessCommandLine contains ":py " or ProcessCommandLine contains "/bin/bash" or ProcessCommandLine contains "/bin/dash" or ProcessCommandLine contains "/bin/fish" or ProcessCommandLine contains "/bin/sh" or ProcessCommandLine contains "/bin/zsh") and ((ProcessCommandLine contains " --cmd" or ProcessCommandLine contains " -c ") and (FolderPath endswith "/rvim" or FolderPath endswith "/vim" or FolderPath endswith "/vimdiff"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_history_recon.yml
Print History File Contents ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "/cat" or FolderPath endswith "/head" or FolderPath endswith "/tail" or FolderPath endswith "/more") and ((ProcessCommandLine contains "/.bash_history" or ProcessCommandLine contains "/.zsh_history") or (ProcessCommandLine endswith "_history" or ProcessCommandLine endswith ".history" or ProcessCommandLine endswith "zhistory"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_syslog_config_change.yml
ESXi Syslog Configuration Change Via ESXCLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " set" and (ProcessCommandLine contains "system" and ProcessCommandLine contains "syslog" and ProcessCommandLine contains "config") and FolderPath endswith "/esxcli"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_dd_process_injection.yml
Potential Linux Process Code Injection Via DD Utility ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "of=" and ProcessCommandLine contains "/proc/" and ProcessCommandLine contains "/mem") and FolderPath endswith "/dd"

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_susp_interactive_bash.yml
Interactive Bash Suspicious Children ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessCommandLine =~ "bash -i" and ((ProcessCommandLine contains "-c import " or ProcessCommandLine contains "base64" or ProcessCommandLine contains "pty.spawn") or (FolderPath endswith "whoami" or FolderPath endswith "iptables" or FolderPath endswith "/ncat" or FolderPath endswith "/nc" or FolderPath endswith "/netcat"))

----------------------------------------
Processing: sigma/rules/linux/process_creation/proc_creation_lnx_triple_cross_rootkit_install.yml
Triple Cross eBPF Rootkit Install Commands ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " qdisc " or ProcessCommandLine contains " filter ") and (ProcessCommandLine contains " tc " and ProcessCommandLine contains " enp0s3 ") and FolderPath endswith "/sudo"

----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_file_copy.yml
Sigma Transformation Error for 'Remote File Copy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_shell_clear_cmd_history.yml
Sigma Transformation Error for 'Linux Command History Tampering': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_shellshock.yml
Sigma Transformation Error for 'Shellshock Expression': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_apt_equationgroup_lnx.yml
Sigma Transformation Error for 'Equation Group Indicators': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_nimbuspwn_privilege_escalation_exploit.yml
Sigma Transformation Error for 'Nimbuspwn Exploitation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_privileged_user_creation.yml
Sigma Transformation Error for 'Privileged User Has Been Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_buffer_overflows.yml
Sigma Transformation Error for 'Buffer Overflow Attempts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_symlink_etc_passwd.yml
Sigma Transformation Error for 'Symlink Etc Passwd': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_shell_susp_rev_shells.yml
Sigma Transformation Error for 'Suspicious Reverse Shell Command Line': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_susp_dev_tcp.yml
Sigma Transformation Error for 'Suspicious Use of /dev/tcp': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_shell_susp_commands.yml
Sigma Transformation Error for 'Suspicious Activity in Shell Commands': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_clear_syslog.yml
Sigma Transformation Error for 'Commands to Clear or Remove the Syslog - Builtin': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_ldso_preload_injection.yml
Sigma Transformation Error for 'Code Injection by ld.so Preload': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_potential_susp_ebpf_activity.yml
Sigma Transformation Error for 'Potential Suspicious BPF Activity - Linux': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_space_after_filename_.yml
Sigma Transformation Error for 'Space After Filename': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_susp_jexboss.yml
Sigma Transformation Error for 'JexBoss Command Sequence': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/lnx_shell_susp_log_entries.yml
Sigma Transformation Error for 'Suspicious Log Entries': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/vsftpd/lnx_vsftpd_susp_error_messages.yml
Sigma Transformation Error for 'Suspicious VSFTPD Error Messages': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/syslog/lnx_syslog_security_tools_disabling_syslog.yml
Sigma Transformation Error for 'Disabling Security Tools - Builtin': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/syslog/lnx_syslog_susp_named.yml
Sigma Transformation Error for 'Suspicious Named Error': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/auth/lnx_auth_pwnkit_local_privilege_escalation.yml
Sigma Transformation Error for 'PwnKit Local Privilege Escalation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/sshd/lnx_sshd_susp_ssh.yml
Sigma Transformation Error for 'Suspicious OpenSSH Daemon Error': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/sshd/lnx_sshd_ssh_cve_2018_15473.yml
Sigma Transformation Error for 'SSHD Error Message CVE-2018-15473': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/guacamole/lnx_guacamole_susp_guacamole.yml
Sigma Transformation Error for 'Guacamole Two Users Sharing Session Anomaly': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/sudo/lnx_sudo_cve_2019_14287_user.yml
Sigma Transformation Error for 'Sudo Privilege Escalation CVE-2019-14287 - Builtin': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/clamav/lnx_clamav_relevant_message.yml
Sigma Transformation Error for 'Relevant ClamAV Message': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/builtin/cron/lnx_cron_crontab_file_modification.yml
Sigma Transformation Error for 'Modifying Crontab': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/linux/network_connection/net_connection_lnx_domain_localtonet_tunnel.yml
Communication To LocaltoNet Tunneling Service Initiated - Linux ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".localto.net" or RemoteUrl endswith ".localtonet.com"

----------------------------------------
Processing: sigma/rules/linux/network_connection/net_connection_lnx_crypto_mining_indicators.yml
Linux Crypto Mining Pool Connections ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl in~ ("pool.minexmr.com", "fr.minexmr.com", "de.minexmr.com", "sg.minexmr.com", "ca.minexmr.com", "us-west.minexmr.com", "pool.supportxmr.com", "mine.c3pool.com", "xmr-eu1.nanopool.org", "xmr-eu2.nanopool.org", "xmr-us-east1.nanopool.org", "xmr-us-west1.nanopool.org", "xmr-asia1.nanopool.org", "xmr-jp1.nanopool.org", "xmr-au1.nanopool.org", "xmr.2miners.com", "xmr.hashcity.org", "xmr.f2pool.com", "xmrpool.eu", "pool.hashvault.pro", "moneroocean.stream", "monerocean.stream")

----------------------------------------
Processing: sigma/rules/linux/network_connection/net_connection_lnx_susp_malware_callback_port.yml
Potentially Suspicious Malware Callback Communication - Linux ---> KQL Query:
DeviceNetworkEvents
| where (RemotePort in~ ("888", "999", "2200", "2222", "4000", "4444", "6789", "8531", "50501", "51820")) and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7"))))

----------------------------------------
Processing: sigma/rules/linux/network_connection/net_connection_lnx_back_connect_shell_dev.yml
Linux Reverse Shell Indicator ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "/bin/bash" and (not((RemoteIP in~ ("127.0.0.1", "0.0.0.0"))))

----------------------------------------
Processing: sigma/rules/linux/network_connection/net_connection_lnx_ngrok_tunnel.yml
Communication To Ngrok Tunneling Service - Linux ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl contains "tunnel.us.ngrok.com" or RemoteUrl contains "tunnel.eu.ngrok.com" or RemoteUrl contains "tunnel.ap.ngrok.com" or RemoteUrl contains "tunnel.au.ngrok.com" or RemoteUrl contains "tunnel.sa.ngrok.com" or RemoteUrl contains "tunnel.jp.ngrok.com" or RemoteUrl contains "tunnel.in.ngrok.com"

----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_prt_access.yml
Sigma Transformation Error for 'Primary Refresh Token Access Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_malware_linked_ip.yml
Sigma Transformation Error for 'Sign-In From Malware Infected IP': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_malicious_ip_address_suspicious.yml
Sigma Transformation Error for 'Malicious IP Address Sign-In Suspicious': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anonymous_ip_address.yml
Sigma Transformation Error for 'Anonymous IP Address': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_inbox_forwarding_rule.yml
Sigma Transformation Error for 'Suspicious Inbox Forwarding Identity Protection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_new_coutry_region.yml
Sigma Transformation Error for 'New Country': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_suspicious_browser.yml
Sigma Transformation Error for 'Suspicious Browser Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_malicious_ip_address.yml
Sigma Transformation Error for 'Malicious IP Address Sign-In Failure Rate': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_unfamilar_sign_in.yml
Sigma Transformation Error for 'Unfamiliar Sign-In Properties': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_threat_intel.yml
Sigma Transformation Error for 'Azure AD Threat Intelligence': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anomalous_token.yml
Sigma Transformation Error for 'Anomalous Token': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_token_issuer_anomaly.yml
Sigma Transformation Error for 'SAML Token Issuer Anomaly': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_impossible_travel.yml
Sigma Transformation Error for 'Impossible Travel': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_atypical_travel.yml
Sigma Transformation Error for 'Atypical Travel': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anomalous_user.yml
Sigma Transformation Error for 'Anomalous User Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_leaked_credentials.yml
Sigma Transformation Error for 'Azure AD Account Credential Leaked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_inbox_manipulation.yml
Sigma Transformation Error for 'Suspicious Inbox Manipulation Rules': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_anonymous_ip_activity.yml
Sigma Transformation Error for 'Activity From Anonymous IP Address': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/identity_protection/azure_identity_protection_password_spray.yml
Sigma Transformation Error for 'Password Spray Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_frequent_activation.yml
Sigma Transformation Error for 'Roles Activated Too Frequently': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_no_mfa_required.yml
Sigma Transformation Error for 'Roles Activation Doesn't Require MFA': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_account_stale.yml
Sigma Transformation Error for 'Stale Accounts In A Privileged Role': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_not_used.yml
Sigma Transformation Error for 'Roles Are Not Being Used': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_too_many_global_admins.yml
Sigma Transformation Error for 'Too Many Global Admins': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_invalid_license.yml
Sigma Transformation Error for 'Invalid PIM License': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/privileged_identity_management/azure_pim_role_assigned_outside_of_pim.yml
Sigma Transformation Error for 'Roles Assigned Outside PIM': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_user_password_change.yml
Sigma Transformation Error for 'Password Reset By User Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_pim_change_settings.yml
Sigma Transformation Error for 'Changes To PIM Settings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_aad_secops_ca_policy_updatedby_bad_actor.yml
Sigma Transformation Error for 'CA Policy Updated by Non Approved Actor': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_privileged_account_creation.yml
Sigma Transformation Error for 'Privileged Account Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_end_user_consent_blocked.yml
Sigma Transformation Error for 'End User Consent Blocked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_tap_added.yml
Sigma Transformation Error for 'Temporary Access Pass Added To An Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_account_created_deleted.yml
Sigma Transformation Error for 'Account Created And Deleted Within A Close Time Frame': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_priviledged_role_assignment_bulk_change.yml
Sigma Transformation Error for 'Bulk Deletion Changes To Privileged Account Permissions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_appid_uri_changes.yml
Sigma Transformation Error for 'Application AppID Uri Configuration Changes': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_priviledged_role_assignment_add.yml
Sigma Transformation Error for 'User Added To Privilege Role': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_uri_modifications.yml
Sigma Transformation Error for 'Application URI Configuration Changes': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_aad_secops_new_ca_policy_addedby_bad_actor.yml
Sigma Transformation Error for 'New CA Policy by Non-approved Actor': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_user_account_mfa_disable.yml
Sigma Transformation Error for 'Multi Factor Authentication Disabled For User Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_guest_to_member.yml
Sigma Transformation Error for 'User State Changed From Guest To Member': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_permissions_msft.yml
Sigma Transformation Error for 'App Granted Microsoft Permissions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_credential_added.yml
Sigma Transformation Error for 'Added Credentials to Existing Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_role_added.yml
Sigma Transformation Error for 'App Assigned To Azure RBAC/Microsoft Entra Role': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_guest_users_invited_to_tenant_by_non_approved_inviters.yml
Sigma Transformation Error for 'Guest Users Invited To Tenant By Non Approved Inviters': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_end_user_consent.yml
Sigma Transformation Error for 'End User Consent': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_change_to_authentication_method.yml
Sigma Transformation Error for 'Change to Authentication Method': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_pim_activation_approve_deny.yml
Sigma Transformation Error for 'PIM Approvals And Deny Elevation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_users_added_to_device_admin_roles.yml
Sigma Transformation Error for 'Users Added to Global or Device Admin Roles': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_federation_modified.yml
Sigma Transformation Error for 'Azure Domain Federation Settings Modified': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_privileged_permissions.yml
Sigma Transformation Error for 'App Granted Privileged Delegated Or App Permissions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_owner_added.yml
Sigma Transformation Error for 'Added Owner To Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_group_user_removal_ca_modification.yml
Sigma Transformation Error for 'User Removed From Group With CA Policy Modification Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_auditlogs_laps_credential_dumping.yml
Sigma Transformation Error for 'Windows LAPS Credential Dump From Entra ID': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_subscription_permissions_elevation_via_auditlogs.yml
Sigma Transformation Error for 'Azure Subscription Permission Elevation Via AuditLogs': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_aad_secops_ca_policy_removedby_bad_actor.yml
Sigma Transformation Error for 'CA Policy Removed by Non Approved Actor': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_guest_invite_failure.yml
Sigma Transformation Error for 'Guest User Invited By Non Approved Inviters': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_bitlocker_key_retrieval.yml
Sigma Transformation Error for 'Bitlocker Key Retrieval': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_update_risk_and_mfa_registration_policy.yml
Sigma Transformation Error for 'User Risk and MFA Registration Policy Updated': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_certificate_based_authencation_enabled.yml
Sigma Transformation Error for 'Certificate-Based Authentication Enabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_pim_alerts_disabled.yml
Sigma Transformation Error for 'PIM Alert Setting Changes To Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_group_user_addition_ca_modification.yml
Sigma Transformation Error for 'User Added To Group With CA Policy Modification Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_device_registration_policy_changes.yml
Sigma Transformation Error for 'Changes to Device Registration Policy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_app_delegated_permissions_all_users.yml
Sigma Transformation Error for 'Delegated Permissions Granted For All Users': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/audit_logs/azure_ad_new_root_ca_added.yml
Sigma Transformation Error for 'New Root Certificate Authority Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_only_single_factor_auth_required.yml
Sigma Transformation Error for 'Azure AD Only Single Factor Authentication Required': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_sign_ins_from_unknown_devices.yml
Sigma Transformation Error for 'Sign-ins by Unknown Devices': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_mfa_denies.yml
Sigma Transformation Error for 'Multifactor Authentication Denied': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_conditional_access_failure.yml
Sigma Transformation Error for 'Sign-in Failure Due to Conditional Access Requirements Not Met': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_risky_sign_ins_with_singlefactorauth_from_unknown_devices.yml
Sigma Transformation Error for 'Suspicious SignIns From A Non Registered Device': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_mfa_interrupted.yml
Sigma Transformation Error for 'Multifactor Authentication Interrupted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_auth_failure_increase.yml
Sigma Transformation Error for 'Increased Failed Authentications Of Any Type': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_auth_sucess_increase.yml
Sigma Transformation Error for 'Measurable Increase Of Successful Authentications': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_azurehound_discovery.yml
Sigma Transformation Error for 'Discovery Using AzureHound': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_sign_ins_from_noncompliant_devices.yml
Sigma Transformation Error for 'Sign-ins from Non-Compliant Devices': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_legacy_authentication_protocols.yml
Sigma Transformation Error for 'Use of Legacy Authentication Protocols': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_device_registration_or_join_without_mfa.yml
Sigma Transformation Error for 'Device Registration or Join Without MFA': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_user_login_blocked_by_conditional_access.yml
Sigma Transformation Error for 'User Access Blocked by Azure Conditional Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_failed_auth_from_countries_you_do_not_operate_out_of.yml
Sigma Transformation Error for 'Failed Authentications From Countries You Do Not Operate Out Of': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_suspicious_signin_bypassing_mfa.yml
Sigma Transformation Error for 'Potential MFA Bypass Using Legacy Client Authentication': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_unusual_authentication_interruption.yml
Sigma Transformation Error for 'Azure Unusual Authentication Interruption': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_app_ropc_authentication.yml
Sigma Transformation Error for 'Applications That Are Using ROPC Authentication Flow': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_users_authenticating_to_other_azure_ad_tenants.yml
Sigma Transformation Error for 'Users Authenticating To Other Azure AD Tenants': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_app_device_code_authentication.yml
Sigma Transformation Error for 'Application Using Device Code Authentication Flow': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_account_lockout.yml
Sigma Transformation Error for 'Account Lockout': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_auth_to_important_apps_using_single_factor_auth.yml
Sigma Transformation Error for 'Authentications To Important Apps Using Single Factor Authentication': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_login_to_disabled_account.yml
Sigma Transformation Error for 'Login to Disabled Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_blocked_account_attempt.yml
Sigma Transformation Error for 'Account Disabled or Blocked for Sign in Attempts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/signin_logs/azure_ad_authentications_from_countries_you_do_not_operate_out_of.yml
Sigma Transformation Error for 'Successful Authentications From Countries You Do Not Operate Out Of': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_pods_deleted.yml
Sigma Transformation Error for 'Azure Kubernetes Pods Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_device_no_longer_managed_or_compliant.yml
Sigma Transformation Error for 'Azure Device No Longer Managed or Compliant': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_creating_number_of_resources_detection.yml
Sigma Transformation Error for 'Number Of Resource Creation Or Deployment Activities': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_vpn_connection_modified_or_deleted.yml
Sigma Transformation Error for 'Azure VPN Connection Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_network_firewall_rule_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Firewall Rule Configuration Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_app_credential_modification.yml
Sigma Transformation Error for 'Azure Application Credential Modified': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_mfa_disabled.yml
Sigma Transformation Error for 'Disabled MFA to Bypass Authentication Mechanisms': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_network_virtual_device_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Virtual Network Device Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_cluster_created_or_deleted.yml
Sigma Transformation Error for 'Azure Kubernetes Cluster Created or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_aadhybridhealth_adfs_new_server.yml
Sigma Transformation Error for 'Azure Active Directory Hybrid Health AD FS New Server': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_new_cloudshell_created.yml
Sigma Transformation Error for 'Azure New CloudShell Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_owner_removed_from_application_or_service_principal.yml
Sigma Transformation Error for 'Azure Owner Removed From Application or Service Principal': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_events_deleted.yml
Sigma Transformation Error for 'Azure Kubernetes Events Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_service_account_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Kubernetes Service Account Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_keyvault_key_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Keyvault Key Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_network_policy_change.yml
Sigma Transformation Error for 'Azure Kubernetes Network Policy Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_cronjob.yml
Sigma Transformation Error for 'Azure Kubernetes CronJob': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_firewall_rule_collection_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Firewall Rule Collection Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_application_security_group_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Application Security Group Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_container_registry_created_or_deleted.yml
Sigma Transformation Error for 'Azure Container Registry Created or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_suppression_rule_created.yml
Sigma Transformation Error for 'Azure Suppression Rule Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_firewall_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Firewall Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_secret_or_config_object_access.yml
Sigma Transformation Error for 'Azure Kubernetes Secret or Config Object Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_keyvault_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Key Vault Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_device_or_configuration_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Device or Configuration Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_subscription_permissions_elevation_via_activitylogs.yml
Sigma Transformation Error for 'Azure Subscription Permission Elevation Via ActivityLogs': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_aadhybridhealth_adfs_service_delete.yml
Sigma Transformation Error for 'Azure Active Directory Hybrid Health AD FS Service Delete': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_dns_zone_modified_or_deleted.yml
Sigma Transformation Error for 'Azure DNS Zone Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_service_principal_created.yml
Sigma Transformation Error for 'Azure Service Principal Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_service_principal_removed.yml
Sigma Transformation Error for 'Azure Service Principal Removed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_role_access.yml
Sigma Transformation Error for 'Azure Kubernetes Sensitive Role Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_ad_user_added_to_admin_role.yml
Sigma Transformation Error for 'User Added to an Administrator's Azure AD Role': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_network_p2s_vpn_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Point-to-site VPN Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_application_gateway_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Application Gateway Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_rolebinding_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Kubernetes RoleBinding/ClusterRoleBinding Modified and Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_application_deleted.yml
Sigma Transformation Error for 'Azure Application Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_kubernetes_admission_controller.yml
Sigma Transformation Error for 'Azure Kubernetes Admission Controller': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_granting_permission_detection.yml
Sigma Transformation Error for 'Granting Of Permissions To An Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_rare_operations.yml
Sigma Transformation Error for 'Rare Subscription-level Operations In Azure': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_network_security_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Network Security Configuration Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_network_firewall_policy_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Network Firewall Policy Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_virtual_network_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Virtual Network Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/azure/activity_logs/azure_keyvault_secrets_modified_or_deleted.yml
Sigma Transformation Error for 'Azure Keyvault Secrets Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/cisco/duo/cisco_duo_mfa_bypass_via_bypass_code.yml
Sigma Transformation Error for 'Cisco Duo Successful MFA Authentication Via Bypass Code': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_dns_zone_modified_or_deleted.yml
Sigma Transformation Error for 'Google Cloud DNS Zone Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_sql_database_modified_or_deleted.yml
Sigma Transformation Error for 'Google Cloud SQL Database Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_firewall_rule_modified_or_deleted.yml
Sigma Transformation Error for 'Google Cloud Firewall Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_service_account_disabled_or_deleted.yml
Sigma Transformation Error for 'Google Cloud Service Account Disabled or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_kubernetes_secrets_modified_or_deleted.yml
Sigma Transformation Error for 'Google Cloud Kubernetes Secrets Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_kubernetes_rolebinding.yml
Sigma Transformation Error for 'Google Cloud Kubernetes RoleBinding': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_kubernetes_admission_controller.yml
Sigma Transformation Error for 'Google Cloud Kubernetes Admission Controller': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_vpn_tunnel_modified_or_deleted.yml
Sigma Transformation Error for 'Google Cloud VPN Tunnel Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_access_policy_deleted.yml
Sigma Transformation Error for 'GCP Access Policy Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_dlp_re_identifies_sensitive_information.yml
Sigma Transformation Error for 'Google Cloud Re-identifies Sensitive Information': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_breakglass_container_workload_deployed.yml
Sigma Transformation Error for 'GCP Break-glass Container Workload Deployed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_bucket_modified_or_deleted.yml
Sigma Transformation Error for 'Google Cloud Storage Buckets Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_bucket_enumeration.yml
Sigma Transformation Error for 'Google Cloud Storage Buckets Enumeration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_full_network_traffic_packet_capture.yml
Sigma Transformation Error for 'Google Full Network Traffic Packet Capture': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_service_account_modified.yml
Sigma Transformation Error for 'Google Cloud Service Account Modified': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/audit/gcp_kubernetes_cronjob.yml
Sigma Transformation Error for 'Google Cloud Kubernetes CronJob': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_application_removed.yml
Sigma Transformation Error for 'Google Workspace Application Removed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_user_granted_admin_privileges.yml
Sigma Transformation Error for 'Google Workspace User Granted Admin Privileges': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_application_access_levels_modified.yml
Sigma Transformation Error for 'Google Workspace Application Access Level Modified': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_role_modified_or_deleted.yml
Sigma Transformation Error for 'Google Workspace Role Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_granted_domain_api_access.yml
Sigma Transformation Error for 'Google Workspace Granted Domain API Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_role_privilege_deleted.yml
Sigma Transformation Error for 'Google Workspace Role Privilege Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/gcp/gworkspace/gcp_gworkspace_mfa_disabled.yml
Sigma Transformation Error for 'Google Workspace MFA Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/onelogin/onelogin_user_account_locked.yml
Sigma Transformation Error for 'OneLogin User Account Locked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/onelogin/onelogin_assumed_another_user.yml
Sigma Transformation Error for 'OneLogin User Assumed Another User': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_disabled_outdated_dependency_or_vulnerability.yml
Sigma Transformation Error for 'Outdated Dependency Or Vulnerability Alert Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_delete_action_invoked.yml
Sigma Transformation Error for 'Github Delete Action Invoked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_new_secret_created.yml
Sigma Transformation Error for 'Github New Secret Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_new_org_member.yml
Sigma Transformation Error for 'New Github Organization Member Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_push_protection_disabled.yml
Sigma Transformation Error for 'Github Push Protection Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_ssh_certificate_config_changed.yml
Sigma Transformation Error for 'Github SSH Certificate Configuration Changed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_push_protection_bypass_detected.yml
Sigma Transformation Error for 'Github Push Protection Bypass Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_outside_collaborator_detected.yml
Sigma Transformation Error for 'Github Outside Collaborator Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_disable_high_risk_configuration.yml
Sigma Transformation Error for 'Github High Risk Configuration Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_repo_or_org_transferred.yml
Sigma Transformation Error for 'Github Repository/Organization Transferred': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_fork_private_repos_enabled_or_cleared.yml
Sigma Transformation Error for 'Github Fork Private Repositories Setting Enabled/Cleared': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_secret_scanning_feature_disabled.yml
Sigma Transformation Error for 'Github Secret Scanning Feature Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/github/github_self_hosted_runner_changes_detected.yml
Sigma Transformation Error for 'Github Self Hosted Runner Changes Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/exchange/microsoft365_new_federated_domain_added_exchange.yml
Sigma Transformation Error for 'New Federated Domain Added - Exchange': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_pst_export_alert.yml
Sigma Transformation Error for 'PST Export Alert Using eDiscovery Alert': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_pst_export_alert_using_new_compliancesearchaction.yml
Sigma Transformation Error for 'PST Export Alert Using New-ComplianceSearchAction': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_susp_inbox_forwarding.yml
Sigma Transformation Error for 'Suspicious Inbox Forwarding': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_activity_from_anonymous_ip_addresses.yml
Sigma Transformation Error for 'Activity from Anonymous IP Addresses': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_activity_by_terminated_user.yml
Sigma Transformation Error for 'Activity Performed by Terminated User': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_data_exfiltration_to_unsanctioned_app.yml
Sigma Transformation Error for 'Data Exfiltration to Unsanctioned Apps': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_unusual_volume_of_file_deletion.yml
Sigma Transformation Error for 'Microsoft 365 - Unusual Volume of File Deletion': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_activity_from_infrequent_country.yml
Sigma Transformation Error for 'Activity from Infrequent Country': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_susp_oauth_app_file_download_activities.yml
Sigma Transformation Error for 'Suspicious OAuth App File Download Activities': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_logon_from_risky_ip_address.yml
Sigma Transformation Error for 'Logon from a Risky IP Address': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_potential_ransomware_activity.yml
Sigma Transformation Error for 'Microsoft 365 - Potential Ransomware Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_user_restricted_from_sending_email.yml
Sigma Transformation Error for 'Microsoft 365 - User Restricted from Sending Email': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_management/microsoft365_impossible_travel_activity.yml
Sigma Transformation Error for 'Microsoft 365 - Impossible Travel Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/threat_detection/microsoft365_from_susp_ip_addresses.yml
Sigma Transformation Error for 'Activity from Suspicious IP Addresses': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/audit/microsoft365_disabling_mfa.yml
Sigma Transformation Error for 'Disabling Multi Factor Authentication': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/audit/microsoft365_new_federated_domain_added_audit.yml
Sigma Transformation Error for 'New Federated Domain Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/m365/audit/microsoft365_bypass_conditional_access.yml
Sigma Transformation Error for 'Azure Login Bypassing Conditional Access Policies': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_admin_activity_from_proxy_query.yml
Sigma Transformation Error for 'Okta Admin Functions Access Through Proxy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_admin_role_assigned_to_user_or_group.yml
Sigma Transformation Error for 'Okta Admin Role Assigned to an User or Group': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_unauthorized_access_to_app.yml
Sigma Transformation Error for 'Okta Unauthorized Access to App': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_security_threat_detected.yml
Sigma Transformation Error for 'Okta Security Threat Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_user_account_locked_out.yml
Sigma Transformation Error for 'Okta User Account Locked Out': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_mfa_reset_or_deactivated.yml
Sigma Transformation Error for 'Okta MFA Reset or Deactivated': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_api_token_created.yml
Sigma Transformation Error for 'Okta API Token Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_identity_provider_created.yml
Sigma Transformation Error for 'Okta Identity Provider Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_suspicious_activity_enduser_report.yml
Sigma Transformation Error for 'Okta Suspicious Activity Reported by End-user': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_application_sign_on_policy_modified_or_deleted.yml
Sigma Transformation Error for 'Okta Application Sign-On Policy Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_network_zone_deactivated_or_deleted.yml
Sigma Transformation Error for 'Okta Network Zone Deactivated or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_policy_modified_or_deleted.yml
Sigma Transformation Error for 'Okta Policy Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_password_in_alternateid_field.yml
Sigma Transformation Error for 'Potential Okta Password in AlternateID Field': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_application_modified_or_deleted.yml
Sigma Transformation Error for 'Okta Application Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_new_behaviours_admin_console.yml
Sigma Transformation Error for 'Okta New Admin Console Behaviours': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_user_created.yml
Sigma Transformation Error for 'New Okta User Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_fastpass_phishing_detection.yml
Sigma Transformation Error for 'Okta FastPass Phishing Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_admin_role_assignment_created.yml
Sigma Transformation Error for 'Okta Admin Role Assignment Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_user_session_start_via_anonymised_proxy.yml
Sigma Transformation Error for 'Okta User Session Start Via An Anonymising Proxy Service': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_policy_rule_modified_or_deleted.yml
Sigma Transformation Error for 'Okta Policy Rule Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/okta/okta_api_token_revoked.yml
Sigma Transformation Error for 'Okta API Token Revoked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_efs_fileshare_mount_modified_or_deleted.yml
Sigma Transformation Error for 'AWS EFS Fileshare Mount Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_sso_idp_change.yml
Sigma Transformation Error for 'AWS Identity Center Identity Provider Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_ec2_import_key_pair_activity.yml
Sigma Transformation Error for 'AWS Key Pair Import Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_iam_s3browser_loginprofile_creation.yml
Sigma Transformation Error for 'AWS IAM S3Browser LoginProfile Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_console_getsignintoken.yml
Sigma Transformation Error for 'AWS Console GetSigninToken Potential Abuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_rds_public_db_restore.yml
Sigma Transformation Error for 'Restore Public AWS RDS Instance': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_ssm_malicious_usage.yml
Sigma Transformation Error for 'Potential Malicious Usage of CloudTrail System Manager': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_update_login_profile.yml
Sigma Transformation Error for 'AWS User Login Profile Was Modified': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_disable_logging.yml
Sigma Transformation Error for 'AWS CloudTrail Important Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_imds_malicious_usage.yml
Sigma Transformation Error for 'Malicious Usage Of IMDS Credentials Outside Of AWS Infrastructure': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_route_53_domain_transferred_to_another_account.yml
Sigma Transformation Error for 'AWS Route 53 Domain Transferred to Another Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_delete_identity.yml
Sigma Transformation Error for 'SES Identity Has Been Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_new_route_added.yml
Sigma Transformation Error for 'New Network Route Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_snapshot_backup_exfiltration.yml
Sigma Transformation Error for 'AWS Snapshot Backup Exfiltration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_delete_saml_provider.yml
Sigma Transformation Error for 'AWS SAML Provider Deletion Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_ec2_vm_export_failure.yml
Sigma Transformation Error for 'AWS EC2 VM Export Failure': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_security_group_change_ingress_egress.yml
Sigma Transformation Error for 'Ingress/Egress Security Group Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_lambda_function_url.yml
Sigma Transformation Error for 'New AWS Lambda Function URL Configuration Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_guardduty_disruption.yml
Sigma Transformation Error for 'AWS GuardDuty Important Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_passed_role_to_glue_development_endpoint.yml
Sigma Transformation Error for 'AWS Glue Development Endpoint Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_new_acl_entries.yml
Sigma Transformation Error for 'New Network ACL Entry Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_iam_s3browser_templated_s3_bucket_policy_creation.yml
Sigma Transformation Error for 'AWS IAM S3Browser Templated S3 Bucket Policy Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_new_lambda_layer_attached.yml
Sigma Transformation Error for 'AWS New Lambda Layer Attached': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_ec2_disable_encryption.yml
Sigma Transformation Error for 'AWS EC2 Disable EBS Encryption': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_security_group_change_loadbalancer.yml
Sigma Transformation Error for 'LoadBalancer Security Group Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_cloudtrail_security_group_change_rds.yml
Sigma Transformation Error for 'RDS Database Security Group Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_enum_buckets.yml
Sigma Transformation Error for 'Potential Bucket Enumeration on AWS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_sts_assumerole_misuse.yml
Sigma Transformation Error for 'AWS STS AssumeRole Misuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_ec2_startup_script_change.yml
Sigma Transformation Error for 'AWS EC2 Startup Shell Script Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_rds_dbcluster_actions.yml
Sigma Transformation Error for 'Modification or Deletion of an AWS RDS Cluster': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_eks_cluster_created_or_deleted.yml
Sigma Transformation Error for 'AWS EKS Cluster Created or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_disable_bucket_versioning.yml
Sigma Transformation Error for 'AWS S3 Bucket Versioning Disable': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_sts_getsessiontoken_misuse.yml
Sigma Transformation Error for 'AWS STS GetSessionToken Misuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_ecs_task_definition_cred_endpoint_query.yml
Sigma Transformation Error for 'AWS ECS Task Definition That Queries The Credential Endpoint': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_efs_fileshare_modified_or_deleted.yml
Sigma Transformation Error for 'AWS EFS Fileshare Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_s3_data_management_tampering.yml
Sigma Transformation Error for 'AWS S3 Data Management Tampering': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_root_account_usage.yml
Sigma Transformation Error for 'AWS Root Credentials': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_iam_backdoor_users_keys.yml
Sigma Transformation Error for 'AWS IAM Backdoor Users Keys': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_rds_change_master_password.yml
Sigma Transformation Error for 'AWS RDS Master Password Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_securityhub_finding_evasion.yml
Sigma Transformation Error for 'AWS SecurityHub Findings Evasion': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_config_disable_recording.yml
Sigma Transformation Error for 'AWS Config Disabling Channel/Recorder': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_susp_saml_activity.yml
Sigma Transformation Error for 'AWS Suspicious SAML Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_route_53_domain_transferred_lock_disabled.yml
Sigma Transformation Error for 'AWS Route 53 Domain Transfer Lock Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_elasticache_security_group_modified_or_deleted.yml
Sigma Transformation Error for 'AWS ElastiCache Security Group Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_elasticache_security_group_created.yml
Sigma Transformation Error for 'AWS ElastiCache Security Group Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/aws/cloudtrail/aws_iam_s3browser_user_or_accesskey_creation.yml
Sigma Transformation Error for 'AWS IAM S3Browser User or AccessKey Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_project_secret_scanning_allowlist_added.yml
Sigma Transformation Error for 'Bitbucket Project Secret Scanning Allowlist Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_unauthorized_full_data_export_triggered.yml
Sigma Transformation Error for 'Bitbucket Unauthorized Full Data Export Triggered': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_full_data_export_triggered.yml
Sigma Transformation Error for 'Bitbucket Full Data Export Triggered': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_user_permissions_export_attempt_detected.yml
Sigma Transformation Error for 'Bitbucket User Permissions Export Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_unauthorized_access_detected.yml
Sigma Transformation Error for 'Bitbucket Unauthorized Access To A Resource': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_global_ssh_settings_change_detected.yml
Sigma Transformation Error for 'Bitbucket Global SSH Settings Changed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_user_details_export_attempt_detected.yml
Sigma Transformation Error for 'Bitbucket User Details Export Attempt Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_secret_scanning_rule_deleted.yml
Sigma Transformation Error for 'Bitbucket Secret Scanning Rule Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_global_secret_scanning_rule_deleted.yml
Sigma Transformation Error for 'Bitbucket Global Secret Scanning Rule Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_log_configuration_update_detected.yml
Sigma Transformation Error for 'Bitbucket Audit Log Configuration Updated': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_user_login_failure_detected.yml
Sigma Transformation Error for 'Bitbucket User Login Failure': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_global_permissions_change_detected.yml
Sigma Transformation Error for 'Bitbucket Global Permission Changed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_secret_scanning_exempt_repository_detected.yml
Sigma Transformation Error for 'Bitbucket Secret Scanning Exempt Repository Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/cloud/bitbucket/audit/bitbucket_audit_user_login_failure_via_ssh_detected.yml
Sigma Transformation Error for 'Bitbucket User Login Failure Via SSH': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_sharphound_recon_account.yml
Sigma Transformation Error for 'SharpHound Recon Account Discovery': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_eventlog_recon.yml
Sigma Transformation Error for 'Remote Event Log Recon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_printing_lateral_movement.yml
Sigma Transformation Error for 'Remote Printing Abuse for Lateral Movement': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_efs_abuse.yml
Sigma Transformation Error for 'Remote Encrypting File System Abuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_itaskschedulerservice_recon.yml
Sigma Transformation Error for 'Remote Schedule Task Recon via ITaskSchedulerService': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_atsvc_recon.yml
Sigma Transformation Error for 'Remote Schedule Task Recon via AtScv': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_remote_registry_recon.yml
Sigma Transformation Error for 'Remote Registry Recon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_remote_service_lateral_movement.yml
Sigma Transformation Error for 'Remote Server Service Abuse for Lateral Movement': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_remote_registry_lateral_movement.yml
Sigma Transformation Error for 'Remote Registry Lateral Movement': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_atsvc_lateral_movement.yml
Sigma Transformation Error for 'Remote Schedule Task Lateral Movement via ATSvc': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_itaskschedulerservice_lateral_movement.yml
Sigma Transformation Error for 'Remote Schedule Task Lateral Movement via ITaskSchedulerService': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_dcsync_attack.yml
Sigma Transformation Error for 'Possible DCSync Attack': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_remote_server_service_abuse.yml
Sigma Transformation Error for 'Remote Server Service Abuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_sharphound_recon_sessions.yml
Sigma Transformation Error for 'SharpHound Recon Sessions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_sasec_recon.yml
Sigma Transformation Error for 'Recon Activity via SASec': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_sasec_lateral_movement.yml
Sigma Transformation Error for 'Remote Schedule Task Lateral Movement via SASec': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/rpc_firewall/rpc_firewall_remote_dcom_or_wmi.yml
Sigma Transformation Error for 'Remote DCOM/WMI Lateral Movement': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/nodejs/nodejs_rce_exploitation_attempt.yml
Sigma Transformation Error for 'Potential RCE Exploitation Attempt In NodeJS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/python/app_python_sql_exceptions.yml
Sigma Transformation Error for 'Python SQL Exceptions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/jvm/java_xxe_exploitation_attempt.yml
Sigma Transformation Error for 'Potential XXE Exploitation Attempt In JVM Based Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/jvm/java_rce_exploitation_attempt.yml
Sigma Transformation Error for 'Process Execution Error In JVM Based Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/jvm/java_local_file_read.yml
Sigma Transformation Error for 'Potential Local File Read Vulnerability In JVM Based Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/jvm/java_jndi_injection_exploitation_attempt.yml
Sigma Transformation Error for 'Potential JNDI Injection Exploitation In JVM Based Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/jvm/java_ognl_injection_exploitation_attempt.yml
Sigma Transformation Error for 'Potential OGNL Injection Exploitation In JVM Based Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/velocity/velocity_ssti_injection.yml
Sigma Transformation Error for 'Potential Server Side Template Injection In Velocity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_cronjob_modification.yml
Sigma Transformation Error for 'Kubernetes CronJob/Job Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_sidecar_injection.yml
Sigma Transformation Error for 'Potential Sidecar Injection Into Running Deployment': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_secrets_enumeration.yml
Sigma Transformation Error for 'Kubernetes Secrets Enumeration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_hostpath_mount.yml
Sigma Transformation Error for 'Container With A hostPath Mount Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_privileged_pod_creation.yml
Sigma Transformation Error for 'Privileged Container Deployed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_exec_into_container.yml
Sigma Transformation Error for 'Potential Remote Command Execution In Pod Container': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_events_deleted.yml
Sigma Transformation Error for 'Kubernetes Events Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_pod_in_system_namespace.yml
Sigma Transformation Error for 'Creation Of Pod In System Namespace': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_rolebinding_modification.yml
Sigma Transformation Error for 'Kubernetes Rolebinding Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_rbac_permisions_listing.yml
Sigma Transformation Error for 'RBAC Permission Enumeration Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_secrets_modified_or_deleted.yml
Sigma Transformation Error for 'Kubernetes Secrets Modified or Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_change_admission_controller.yml
Sigma Transformation Error for 'Kubernetes Admission Controller Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_unauthorized_unauthenticated_actions.yml
Sigma Transformation Error for 'Kubernetes Unauthorized or Unauthenticated Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_serviceaccount_creation.yml
Sigma Transformation Error for 'New Kubernetes Service Account Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/kubernetes/audit/kubernetes_audit_deployment_deleted.yml
Sigma Transformation Error for 'Deployment Deleted From Kubernetes Cluster': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/django/appframework_django_exceptions.yml
Sigma Transformation Error for 'Django Framework Exceptions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/ruby/appframework_ruby_on_rails_exceptions.yml
Sigma Transformation Error for 'Ruby on Rails Framework Exceptions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/spring/spring_spel_injection.yml
Sigma Transformation Error for 'Potential SpEL Injection In Spring Framework': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/spring/spring_application_exceptions.yml
Sigma Transformation Error for 'Spring Framework Exceptions': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_smb_file_open.yml
Sigma Transformation Error for 'OpenCanary - SMB File Open Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_redis_command.yml
Sigma Transformation Error for 'OpenCanary - REDIS Action Command Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_git_clone_request.yml
Sigma Transformation Error for 'OpenCanary - GIT Clone Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_ssh_login_attempt.yml
Sigma Transformation Error for 'OpenCanary - SSH Login Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_http_get.yml
Sigma Transformation Error for 'OpenCanary - HTTP GET Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_sip_request.yml
Sigma Transformation Error for 'OpenCanary - SIP Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_ntp_monlist.yml
Sigma Transformation Error for 'OpenCanary - NTP Monlist Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_snmp_cmd.yml
Sigma Transformation Error for 'OpenCanary - SNMP OID Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_httpproxy_login_attempt.yml
Sigma Transformation Error for 'OpenCanary - HTTPPROXY Login Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_mssql_login_winauth.yml
Sigma Transformation Error for 'OpenCanary - MSSQL Login Attempt Via Windows Authentication': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_vnc_connection_attempt.yml
Sigma Transformation Error for 'OpenCanary - VNC Connection Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_http_post_login_attempt.yml
Sigma Transformation Error for 'OpenCanary - HTTP POST Login Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_telnet_login_attempt.yml
Sigma Transformation Error for 'OpenCanary - Telnet Login Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_ftp_login_attempt.yml
Sigma Transformation Error for 'OpenCanary - FTP Login Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_mysql_login_attempt.yml
Sigma Transformation Error for 'OpenCanary - MySQL Login Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_ssh_new_connection.yml
Sigma Transformation Error for 'OpenCanary - SSH New Connection Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_tftp_request.yml
Sigma Transformation Error for 'OpenCanary - TFTP Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/opencanary/opencanary_mssql_login_sqlauth.yml
Sigma Transformation Error for 'OpenCanary - MSSQL Login Attempt Via SQLAuth': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/application/sql/app_sqlinjection_errors.yml
Sigma Transformation Error for 'Suspicious SQL Error Messages': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_efspotato.yml
Sigma Transformation Error for 'HackTool - EfsPotato Named Pipe Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_koh_default_pipe.yml
Sigma Transformation Error for 'HackTool - Koh Default Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_sysinternals_psexec_default_pipe_susp_location.yml
Sigma Transformation Error for 'PsExec Tool Execution From Suspicious Locations - PipeName': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_pua_paexec_default_pipe.yml
Sigma Transformation Error for 'PUA - PAExec Default Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_generic_cred_dump_tools_pipes.yml
Sigma Transformation Error for 'HackTool - Credential Dumping Tools Named Pipe Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_powershell_alternate_host_pipe.yml
Sigma Transformation Error for 'Alternate PowerShell Hosts Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_diagtrack_eop.yml
Sigma Transformation Error for 'HackTool - DiagTrackEoP Default Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_pua_remcom_default_pipe.yml
Sigma Transformation Error for 'PUA - RemCom Default Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_cobaltstrike_re.yml
Sigma Transformation Error for 'CobaltStrike Named Pipe Pattern Regex': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_powershell_execution_pipe.yml
Sigma Transformation Error for 'New PowerShell Instance Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_cobaltstrike_susp_pipe_patterns.yml
Sigma Transformation Error for 'CobaltStrike Named Pipe Patterns': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_cobaltstrike.yml
Sigma Transformation Error for 'CobaltStrike Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_pua_csexec_default_pipe.yml
Sigma Transformation Error for 'PUA - CSExec Default Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_scrcons_wmi_consumer_namedpipe.yml
Sigma Transformation Error for 'WMI Event Consumer Created Named Pipe': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_hktl_coercedpotato.yml
Sigma Transformation Error for 'HackTool - CoercedPotato Named Pipe Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_susp_malicious_namedpipes.yml
Sigma Transformation Error for 'Malicious Named Pipe Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/pipe_created/pipe_created_adfs_namedpipe_connection_uncommon_tool.yml
Sigma Transformation Error for 'ADFS Database Named Pipe Connection By Uncommon Tool': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_tampering/proc_tampering_susp_process_hollowing.yml
Sigma Transformation Error for 'Potential Process Hollowing Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/file/file_rename/file_rename_win_ransomware.yml
Sigma Transformation Error for 'Suspicious Appended Extension': Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/file/file_executable_detected/file_executable_detected_win_susp_embeded_sed_file.yml
Sigma Transformation Error for 'Potentially Suspicious Self Extraction Directive File Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_onenote_susp_dropped_files.yml
Suspicious File Created Via OneNote Application ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenotem.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe") and FolderPath contains "\\AppData\\Local\\Temp\\OneNote\\" and (FolderPath endswith ".bat" or FolderPath endswith ".chm" or FolderPath endswith ".cmd" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".htm" or FolderPath endswith ".html" or FolderPath endswith ".js" or FolderPath endswith ".lnk" or FolderPath endswith ".ps1" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs" or FolderPath endswith ".wsf")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_creation_by_mobsync.yml
Created Files by Microsoft Sync Center ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\mobsync.exe" and (FolderPath endswith ".dll" or FolderPath endswith ".exe")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_vscode_tunnel_remote_creation_artefacts.yml
Visual Studio Code Tunnel Remote File Creation ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath contains "\\servers\\Stable-" and InitiatingProcessFolderPath endswith "\\server\\node.exe" and FolderPath contains "\\.vscode-server\\data\\User\\History\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_writing_local_admin_share.yml
Writing Local Admin Share ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\\\127.0.0" and FolderPath contains "\\ADMIN$\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_exchange_aspx_write.yml
Suspicious MSExchangeMailboxReplication ASPX Write ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\MSExchangeMailboxReplication.exe" and (FolderPath endswith ".aspx" or FolderPath endswith ".asp")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_recycle_bin_fake_exec.yml
Suspicious File Creation Activity From Fake Recycle.Bin Folder ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath contains "RECYCLERS.BIN\\" or InitiatingProcessFolderPath contains "RECYCLER.BIN\\") or (FolderPath contains "RECYCLERS.BIN\\" or FolderPath contains "RECYCLER.BIN\\")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_wmp.yml
UAC Bypass Using Windows Media Player - File ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\AppData\\Local\\Temp\\OskSupport.dll" and FolderPath startswith "C:\\Users\\") or (InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\DllHost.exe" and FolderPath =~ "C:\\Program Files\\Windows Media Player\\osk.exe")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_errorhandler_persistence.yml
Potential Persistence Attempt Via ErrorHandler.Cmd ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\WINDOWS\\Setup\\Scripts\\ErrorHandler.cmd"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_desktopimgdownldr_file.yml
Suspicious Desktopimgdownldr Target File ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\svchost.exe" and FolderPath contains "\\Personalization\\LockScreenImage\\") and (not(FolderPath contains "C:\\Windows\\")) and (not((FolderPath contains ".jpg" or FolderPath contains ".jpeg" or FolderPath contains ".png")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_task_write.yml
Suspicious Scheduled Task Write to System32 Tasks ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath contains "\\AppData\\" or InitiatingProcessFolderPath contains "C:\\PerfLogs" or InitiatingProcessFolderPath contains "\\Windows\\System32\\config\\systemprofile") and FolderPath contains "\\Windows\\System32\\Tasks"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_procmon_driver_susp_creation.yml
Process Monitor Driver Creation By Non-Sysinternals Binary ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\procmon" and FolderPath endswith ".sys") and (not((InitiatingProcessFolderPath endswith "\\procmon.exe" or InitiatingProcessFolderPath endswith "\\procmon64.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_ripzip_attack.yml
Potential RipZip Attack on Startup Folder ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\explorer.exe" and (FolderPath contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup" and FolderPath contains ".lnk.{0AFACED1-E828-11D1-9187-B532F1E9575D}")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_ieinstal.yml
UAC Bypass Using IEInstal - File ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath =~ "C:\\Program Files\\Internet Explorer\\IEInstal.exe" and FolderPath contains "\\AppData\\Local\\Temp\\" and FolderPath endswith "consent.exe" and FolderPath startswith "C:\\Users\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_psexec_service_key.yml
PSEXEC Remote Execution File Artefact ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".key" and FolderPath startswith "C:\\Windows\\PSEXEC-"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_livekd_default_dump_name.yml
LiveKD Kernel Memory Dump File Created ---> KQL Query:
DeviceFileEvents
| where FolderPath =~ "C:\\Windows\\livekd.dmp"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_creation_system_dll_files.yml
Files With System DLL Name In Unsuspected Locations ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\secur32.dll" or FolderPath endswith "\\tdh.dll") and (not((FolderPath contains "C:\\$WINDOWS.~BT\\" or FolderPath contains "C:\\$WinREAgent\\" or FolderPath contains "C:\\Windows\\SoftwareDistribution\\" or FolderPath contains "C:\\Windows\\System32\\" or FolderPath contains "C:\\Windows\\SysWOW64\\" or FolderPath contains "C:\\Windows\\WinSxS\\" or FolderPath contains "C:\\Windows\\uus\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_eventvwr.yml
UAC Bypass Using EventVwr ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\Microsoft\\Event Viewer\\RecentViews" or FolderPath endswith "\\Microsoft\\EventV~1\\RecentViews") and (not((InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_pfx_file_creation.yml
Suspicious PFX File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".pfx" and (not((FolderPath contains "\\Templates\\Windows\\Windows_TemporaryKey.pfx" and FolderPath contains "\\CMake\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_create_evtx_non_common_locations.yml
EVTX Created In Uncommon Location ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".evtx" and (not(((FolderPath endswith "\\Windows\\System32\\winevt\\Logs\\" and FolderPath startswith "C:\\ProgramData\\Microsoft\\Windows\\Containers\\BaseImages\\") or FolderPath startswith "C:\\Windows\\System32\\winevt\\Logs\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_lsass_shtinkering.yml
LSASS Process Dump Artefact In CrashDumps Folder ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "lsass.exe." and FolderPath endswith ".dmp" and FolderPath startswith "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\CrashDumps\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_windows_terminal_profile.yml
Windows Terminal Profile Settings Modification By Uncommon Process ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") and FolderPath endswith "\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_8wekyb3d8bbwe\\LocalState\\settings.json"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_homoglyph_filename.yml
Potential Homoglyph Attack Using Lookalike Characters in Filename ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "") or (FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "" or FolderPath contains "")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_webshell_creation_detect.yml
Potential Webshell Creation On Static Website ---> KQL Query:
DeviceFileEvents
| where (((FolderPath contains ".ashx" or FolderPath contains ".asp" or FolderPath contains ".ph" or FolderPath contains ".soap") and FolderPath contains "\\inetpub\\wwwroot\\") or (FolderPath contains ".ph" and (FolderPath contains "\\www\\" or FolderPath contains "\\htdocs\\" or FolderPath contains "\\html\\"))) and (not((FolderPath contains "\\xampp" or InitiatingProcessFolderPath =~ "System" or (FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "\\Windows\\Temp\\"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_notepad_plus_plus_persistence.yml
Potential Persistence Via Notepad++ Plugins ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\Notepad++\\plugins\\" and FolderPath endswith ".dll") and (not((InitiatingProcessFolderPath endswith "\\Notepad++\\updater\\gup.exe" or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\" and (InitiatingProcessFolderPath endswith "\\target.exe" or InitiatingProcessFolderPath endswith "Installer.x64.exe") and InitiatingProcessFolderPath startswith "C:\\Users\\"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_exe.yml
Legitimate Application Dropped Executable ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\eqnedt32.exe" or InitiatingProcessFolderPath endswith "\\wordpad.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe" or InitiatingProcessFolderPath endswith "\\certutil.exe" or InitiatingProcessFolderPath endswith "\\certoc.exe" or InitiatingProcessFolderPath endswith "\\CertReq.exe" or InitiatingProcessFolderPath endswith "\\Desktopimgdownldr.exe" or InitiatingProcessFolderPath endswith "\\esentutl.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\AcroRd32.exe" or InitiatingProcessFolderPath endswith "\\RdrCEF.exe" or InitiatingProcessFolderPath endswith "\\hh.exe" or InitiatingProcessFolderPath endswith "\\finger.exe") and (FolderPath endswith ".exe" or FolderPath endswith ".dll" or FolderPath endswith ".ocx")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_public_folder_extension.yml
Suspicious Binaries and Scripts in Public Folder ---> KQL Query:
DeviceFileEvents
| where FolderPath contains ":\\Users\\Public\\" and (FolderPath endswith ".bat" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".js" or FolderPath endswith ".ps1" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml
Suspicious PROCEXP152.sys File Created In TMP ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\AppData\\Local\\Temp\\" and FolderPath endswith "PROCEXP152.sys") and (not((InitiatingProcessFolderPath contains "\\procexp64.exe" or InitiatingProcessFolderPath contains "\\procexp.exe" or InitiatingProcessFolderPath contains "\\procmon64.exe" or InitiatingProcessFolderPath contains "\\procmon.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_rclone_config_files.yml
Rclone Config File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath contains ":\\Users\\" and FolderPath contains "\\.config\\rclone\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_startup_folder_persistence.yml
Suspicious Startup Folder Persistence ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\Windows\\Start Menu\\Programs\\Startup\\" and (FolderPath endswith ".vbs" or FolderPath endswith ".vbe" or FolderPath endswith ".bat" or FolderPath endswith ".ps1" or FolderPath endswith ".hta" or FolderPath endswith ".dll" or FolderPath endswith ".jar" or FolderPath endswith ".msi" or FolderPath endswith ".scr" or FolderPath endswith ".cmd")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_uncommon_file_startup.yml
Uncommon File Created In Office Startup Folder ---> KQL Query:
DeviceFileEvents
| where (((FolderPath contains "\\Microsoft\\Word\\STARTUP" or (FolderPath contains "\\Office" and FolderPath contains "\\Program Files" and FolderPath contains "\\STARTUP")) and (not((FolderPath endswith ".docb" or FolderPath endswith ".docm" or FolderPath endswith ".docx" or FolderPath endswith ".dotm" or FolderPath endswith ".mdb" or FolderPath endswith ".mdw" or FolderPath endswith ".pdf" or FolderPath endswith ".wll" or FolderPath endswith ".wwl")))) or ((FolderPath contains "\\Microsoft\\Excel\\XLSTART" or (FolderPath contains "\\Office" and FolderPath contains "\\Program Files" and FolderPath contains "\\XLSTART")) and (not((FolderPath endswith ".xll" or FolderPath endswith ".xls" or FolderPath endswith ".xlsm" or FolderPath endswith ".xlsx" or FolderPath endswith ".xlt" or FolderPath endswith ".xltm" or FolderPath endswith ".xlw"))))) and (not((((InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft Office\\" or InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft Office\\") and (InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\excel.exe")) or (InitiatingProcessFolderPath contains ":\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" and InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_powerup_dllhijacking.yml
HackTool - Powerup Write Hijack DLL ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") and FolderPath endswith ".bat"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_susp_file_extension.yml
File With Uncommon Extension Created By An Office Application ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\msaccess.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\visio.exe" or InitiatingProcessFolderPath endswith "\\winword.exe") and (FolderPath endswith ".bat" or FolderPath endswith ".cmd" or FolderPath endswith ".com" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".ocx" or FolderPath endswith ".proj" or FolderPath endswith ".ps1" or FolderPath endswith ".scf" or FolderPath endswith ".scr" or FolderPath endswith ".sys" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs" or FolderPath endswith ".wsf" or FolderPath endswith ".wsh")) and (not((FolderPath contains "\\AppData\\Local\\assembly\\tmp\\" and FolderPath endswith ".dll"))) and (not(((InitiatingProcessFolderPath endswith "\\winword.exe" and FolderPath contains "\\AppData\\Local\\Temp\\webexdelta\\" and (FolderPath endswith ".dll" or FolderPath endswith ".exe")) or ((FolderPath contains "C:\\Users\\" and FolderPath contains "\\AppData\\Local\\Microsoft\\Office\\" and FolderPath contains "\\WebServiceCache\\AllUsers") and FolderPath endswith ".com"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_taskmgr_lsass_dump.yml
LSASS Process Memory Dump Creation Via Taskmgr.EXE ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith ":\\Windows\\system32\\taskmgr.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\taskmgr.exe") and (FolderPath contains "\\AppData\\Local\\Temp\\" and FolderPath contains "\\lsass" and FolderPath contains ".DMP")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_dcom_iertutil_dll_hijack.yml
Potential DCOM InternetExplorer.Application DLL Hijack ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath =~ "System" and FolderPath endswith "\\Internet Explorer\\iertutil.dll"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_drop_binary_or_script.yml
Potential Binary Or Script Dropper Via PowerShell ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") and (FolderPath endswith ".bat" or FolderPath endswith ".chm" or FolderPath endswith ".cmd" or FolderPath endswith ".com" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".jar" or FolderPath endswith ".js" or FolderPath endswith ".ocx" or FolderPath endswith ".scr" or FolderPath endswith ".sys" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs" or FolderPath endswith ".wsf")) and (not((((FolderPath endswith ".dll" or FolderPath endswith ".exe") and (FolderPath startswith "C:\\Windows\\Temp\\" or FolderPath startswith "C:\\Windows\\SystemTemp\\")) or (FolderPath contains "\\AppData\\Local\\Temp\\" and (FolderPath endswith ".dll" or FolderPath endswith ".exe") and FolderPath startswith "C:\\Users\\"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_winsxs_binary_creation.yml
WinSxS Executable File Creation By Non-System Process ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith ".exe" and FolderPath startswith "C:\\Windows\\WinSxS\\") and (not((InitiatingProcessFolderPath startswith "C:\\Windows\\Systems32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_cred_dump_tools_dropped_files.yml
Cred Dump Tools Dropped Files ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\fgdump-log" or FolderPath contains "\\kirbi" or FolderPath contains "\\pwdump" or FolderPath contains "\\pwhashes" or FolderPath contains "\\wce_ccache" or FolderPath contains "\\wce_krbtkts") or (FolderPath endswith "\\cachedump.exe" or FolderPath endswith "\\cachedump64.exe" or FolderPath endswith "\\DumpExt.dll" or FolderPath endswith "\\DumpSvc.exe" or FolderPath endswith "\\Dumpy.exe" or FolderPath endswith "\\fgexec.exe" or FolderPath endswith "\\lsremora.dll" or FolderPath endswith "\\lsremora64.dll" or FolderPath endswith "\\NTDS.out" or FolderPath endswith "\\procdump64.exe" or FolderPath endswith "\\pstgdump.exe" or FolderPath endswith "\\pwdump.exe" or FolderPath endswith "\\SAM.out" or FolderPath endswith "\\SECURITY.out" or FolderPath endswith "\\servpw.exe" or FolderPath endswith "\\servpw64.exe" or FolderPath endswith "\\SYSTEM.out" or FolderPath endswith "\\test.pwd" or FolderPath endswith "\\wceaux.dll")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_archive.yml
Legitimate Application Dropped Archive ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\msaccess.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\eqnedt32.exe" or InitiatingProcessFolderPath endswith "\\visio.exe" or InitiatingProcessFolderPath endswith "\\wordpad.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe" or InitiatingProcessFolderPath endswith "\\certutil.exe" or InitiatingProcessFolderPath endswith "\\certoc.exe" or InitiatingProcessFolderPath endswith "\\CertReq.exe" or InitiatingProcessFolderPath endswith "\\Desktopimgdownldr.exe" or InitiatingProcessFolderPath endswith "\\esentutl.exe" or InitiatingProcessFolderPath endswith "\\finger.exe" or InitiatingProcessFolderPath endswith "\\notepad.exe" or InitiatingProcessFolderPath endswith "\\AcroRd32.exe" or InitiatingProcessFolderPath endswith "\\RdrCEF.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\hh.exe") and (FolderPath endswith ".zip" or FolderPath endswith ".rar" or FolderPath endswith ".7z" or FolderPath endswith ".diagcab" or FolderPath endswith ".appx")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_anydesk_writing_susp_binaries.yml
Suspicious Binary Writes Via AnyDesk ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\AnyDesk.exe" or InitiatingProcessFolderPath endswith "\\AnyDeskMSI.exe") and (FolderPath endswith ".dll" or FolderPath endswith ".exe")) and (not(FolderPath endswith "\\gcapi.dll"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_executable_creation.yml
Suspicious Executable File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ":\\$Recycle.Bin.exe" or FolderPath endswith ":\\Documents and Settings.exe" or FolderPath endswith ":\\MSOCache.exe" or FolderPath endswith ":\\PerfLogs.exe" or FolderPath endswith ":\\Recovery.exe" or FolderPath endswith ".bat.exe" or FolderPath endswith ".sys.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_diagcab.yml
Creation of a Diagcab ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".diagcab"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_dotnet_profiler.yml
UAC Bypass Using .NET Code Profiler on MMC ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\AppData\\Local\\Temp\\pe386.dll" and FolderPath startswith "C:\\Users\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_new_files_in_uncommon_appdata_folder.yml
Suspicious File Creation In Uncommon AppData Folder ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\AppData\\" and (FolderPath endswith ".bat" or FolderPath endswith ".cmd" or FolderPath endswith ".cpl" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".iso" or FolderPath endswith ".lnk" or FolderPath endswith ".msi" or FolderPath endswith ".ps1" or FolderPath endswith ".psm1" or FolderPath endswith ".scr" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs") and FolderPath startswith "C:\\Users\\") and (not(((FolderPath contains "\\AppData\\Local\\" or FolderPath contains "\\AppData\\LocalLow\\" or FolderPath contains "\\AppData\\Roaming\\") and FolderPath startswith "C:\\Users\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_ntds_exfil_tools.yml
NTDS Exfiltration Filename Patterns ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\All.cab" or FolderPath endswith ".ntds.cleartext"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_csharp_compile_artefact.yml
Dynamic CSharp Compile Artefact ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".cmdline"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_wmi_persistence_script_event_consumer_write.yml
WMI Persistence - Script Event Consumer File Write ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath =~ "C:\\WINDOWS\\system32\\wbem\\scrcons.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_dump_file_susp_creation.yml
Potentially Suspicious DMP/HDMP File Creation ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") and (FolderPath endswith ".dmp" or FolderPath endswith ".dump" or FolderPath endswith ".hdmp")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_nppspy.yml
HackTool - NPPSpy Hacktool Usage ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\NPPSpy.txt" or FolderPath endswith "\\NPPSpy.dll"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_adsi_cache_creation_by_uncommon_tool.yml
ADSI-Cache File Creation By Uncommon Tool ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\Local\\Microsoft\\Windows\\SchCache\\" and FolderPath endswith ".sch") and (not((((InitiatingProcessFolderPath endswith ":\\Program Files\\Cylance\\Desktop\\CylanceSvc.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\CCM\\CcmExec.exe" or InitiatingProcessFolderPath endswith ":\\windows\\system32\\dllhost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\system32\\dsac.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\system32\\efsui.exe" or InitiatingProcessFolderPath endswith ":\\windows\\system32\\mmc.exe" or InitiatingProcessFolderPath endswith ":\\windows\\system32\\svchost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\wbem\\WmiPrvSE.exe" or InitiatingProcessFolderPath endswith ":\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe") or (InitiatingProcessFolderPath contains ":\\Windows\\ccmsetup\\autoupgrade\\ccmsetup" or InitiatingProcessFolderPath contains ":\\Program Files\\SentinelOne\\Sentinel Agent")) or ((InitiatingProcessFolderPath contains ":\\Program Files\\" and InitiatingProcessFolderPath contains "\\Microsoft Office") and InitiatingProcessFolderPath endswith "\\OUTLOOK.EXE")))) and (not((InitiatingProcessFolderPath endswith ":\\Program Files\\Citrix\\Receiver StoreFront\\Services\\DefaultDomainServices\\Citrix.DeliveryServices.DomainServices.ServiceHost.exe" or InitiatingProcessFolderPath endswith "\\LANDesk\\LDCLient\\ldapwhoami.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_exploit_scripts.yml
Malicious PowerShell Scripts - FileCreation ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\Add-ConstrainedDelegationBackdoor.ps1" or FolderPath endswith "\\Add-Exfiltration.ps1" or FolderPath endswith "\\Add-Persistence.ps1" or FolderPath endswith "\\Add-RegBackdoor.ps1" or FolderPath endswith "\\Add-RemoteRegBackdoor.ps1" or FolderPath endswith "\\Add-ScrnSaveBackdoor.ps1" or FolderPath endswith "\\ADRecon.ps1" or FolderPath endswith "\\AzureADRecon.ps1" or FolderPath endswith "\\Check-VM.ps1" or FolderPath endswith "\\ConvertTo-ROT13.ps1" or FolderPath endswith "\\Copy-VSS.ps1" or FolderPath endswith "\\Create-MultipleSessions.ps1" or FolderPath endswith "\\DNS_TXT_Pwnage.ps1" or FolderPath endswith "\\dnscat2.ps1" or FolderPath endswith "\\Do-Exfiltration.ps1" or FolderPath endswith "\\DomainPasswordSpray.ps1" or FolderPath endswith "\\Download_Execute.ps1" or FolderPath endswith "\\Download-Execute-PS.ps1" or FolderPath endswith "\\Enable-DuplicateToken.ps1" or FolderPath endswith "\\Enabled-DuplicateToken.ps1" or FolderPath endswith "\\Execute-Command-MSSQL.ps1" or FolderPath endswith "\\Execute-DNSTXT-Code.ps1" or FolderPath endswith "\\Execute-OnTime.ps1" or FolderPath endswith "\\ExetoText.ps1" or FolderPath endswith "\\Exploit-Jboss.ps1" or FolderPath endswith "\\Find-AVSignature.ps1" or FolderPath endswith "\\Find-Fruit.ps1" or FolderPath endswith "\\Find-GPOLocation.ps1" or FolderPath endswith "\\Find-TrustedDocuments.ps1" or FolderPath endswith "\\FireBuster.ps1" or FolderPath endswith "\\FireListener.ps1" or FolderPath endswith "\\Get-ApplicationHost.ps1" or FolderPath endswith "\\Get-ChromeDump.ps1" or FolderPath endswith "\\Get-ClipboardContents.ps1" or FolderPath endswith "\\Get-ComputerDetail.ps1" or FolderPath endswith "\\Get-FoxDump.ps1" or FolderPath endswith "\\Get-GPPAutologon.ps1" or FolderPath endswith "\\Get-GPPPassword.ps1" or FolderPath endswith "\\Get-IndexedItem.ps1" or FolderPath endswith "\\Get-Keystrokes.ps1" or FolderPath endswith "\\Get-LSASecret.ps1" or FolderPath endswith "\\Get-MicrophoneAudio.ps1" or FolderPath endswith "\\Get-PassHashes.ps1" or FolderPath endswith "\\Get-PassHints.ps1" or FolderPath endswith "\\Get-RegAlwaysInstallElevated.ps1" or FolderPath endswith "\\Get-RegAutoLogon.ps1" or FolderPath endswith "\\Get-RickAstley.ps1" or FolderPath endswith "\\Get-Screenshot.ps1" or FolderPath endswith "\\Get-SecurityPackages.ps1" or FolderPath endswith "\\Get-ServiceFilePermission.ps1" or FolderPath endswith "\\Get-ServicePermission.ps1" or FolderPath endswith "\\Get-ServiceUnquoted.ps1" or FolderPath endswith "\\Get-SiteListPassword.ps1" or FolderPath endswith "\\Get-System.ps1" or FolderPath endswith "\\Get-TimedScreenshot.ps1" or FolderPath endswith "\\Get-UnattendedInstallFile.ps1" or FolderPath endswith "\\Get-Unconstrained.ps1" or FolderPath endswith "\\Get-USBKeystrokes.ps1" or FolderPath endswith "\\Get-VaultCredential.ps1" or FolderPath endswith "\\Get-VulnAutoRun.ps1" or FolderPath endswith "\\Get-VulnSchTask.ps1" or FolderPath endswith "\\Get-WebConfig.ps1" or FolderPath endswith "\\Get-WebCredentials.ps1" or FolderPath endswith "\\Get-WLAN-Keys.ps1" or FolderPath endswith "\\Gupt-Backdoor.ps1" or FolderPath endswith "\\HTTP-Backdoor.ps1" or FolderPath endswith "\\HTTP-Login.ps1" or FolderPath endswith "\\Install-ServiceBinary.ps1" or FolderPath endswith "\\Install-SSP.ps1" or FolderPath endswith "\\Invoke-ACLScanner.ps1" or FolderPath endswith "\\Invoke-ADSBackdoor.ps1" or FolderPath endswith "\\Invoke-AmsiBypass.ps1" or FolderPath endswith "\\Invoke-ARPScan.ps1" or FolderPath endswith "\\Invoke-BackdoorLNK.ps1" or FolderPath endswith "\\Invoke-BadPotato.ps1" or FolderPath endswith "\\Invoke-BetterSafetyKatz.ps1" or FolderPath endswith "\\Invoke-BruteForce.ps1" or FolderPath endswith "\\Invoke-BypassUAC.ps1" or FolderPath endswith "\\Invoke-Carbuncle.ps1" or FolderPath endswith "\\Invoke-Certify.ps1" or FolderPath endswith "\\Invoke-ConPtyShell.ps1" or FolderPath endswith "\\Invoke-CredentialInjection.ps1" or FolderPath endswith "\\Invoke-CredentialsPhish.ps1" or FolderPath endswith "\\Invoke-DAFT.ps1" or FolderPath endswith "\\Invoke-DCSync.ps1" or FolderPath endswith "\\Invoke-Decode.ps1" or FolderPath endswith "\\Invoke-DinvokeKatz.ps1" or FolderPath endswith "\\Invoke-DllInjection.ps1" or FolderPath endswith "\\Invoke-DNSUpdate.ps1" or FolderPath endswith "\\Invoke-DowngradeAccount.ps1" or FolderPath endswith "\\Invoke-EgressCheck.ps1" or FolderPath endswith "\\Invoke-Encode.ps1" or FolderPath endswith "\\Invoke-EventViewer.ps1" or FolderPath endswith "\\Invoke-Eyewitness.ps1" or FolderPath endswith "\\Invoke-FakeLogonScreen.ps1" or FolderPath endswith "\\Invoke-Farmer.ps1" or FolderPath endswith "\\Invoke-Get-RBCD-Threaded.ps1" or FolderPath endswith "\\Invoke-Gopher.ps1" or FolderPath endswith "\\Invoke-Grouper2.ps1" or FolderPath endswith "\\Invoke-Grouper3.ps1" or FolderPath endswith "\\Invoke-HandleKatz.ps1" or FolderPath endswith "\\Invoke-Interceptor.ps1" or FolderPath endswith "\\Invoke-Internalmonologue.ps1" or FolderPath endswith "\\Invoke-Inveigh.ps1" or FolderPath endswith "\\Invoke-InveighRelay.ps1" or FolderPath endswith "\\Invoke-JSRatRegsvr.ps1" or FolderPath endswith "\\Invoke-JSRatRundll.ps1" or FolderPath endswith "\\Invoke-KrbRelay.ps1" or FolderPath endswith "\\Invoke-KrbRelayUp.ps1" or FolderPath endswith "\\Invoke-LdapSignCheck.ps1" or FolderPath endswith "\\Invoke-Lockless.ps1" or FolderPath endswith "\\Invoke-MalSCCM.ps1" or FolderPath endswith "\\Invoke-Mimikatz.ps1" or FolderPath endswith "\\Invoke-MimikatzWDigestDowngrade.ps1" or FolderPath endswith "\\Invoke-Mimikittenz.ps1" or FolderPath endswith "\\Invoke-MITM6.ps1" or FolderPath endswith "\\Invoke-NanoDump.ps1" or FolderPath endswith "\\Invoke-NetRipper.ps1" or FolderPath endswith "\\Invoke-NetworkRelay.ps1" or FolderPath endswith "\\Invoke-NinjaCopy.ps1" or FolderPath endswith "\\Invoke-OxidResolver.ps1" or FolderPath endswith "\\Invoke-P0wnedshell.ps1" or FolderPath endswith "\\Invoke-P0wnedshellx86.ps1" or FolderPath endswith "\\Invoke-Paranoia.ps1" or FolderPath endswith "\\Invoke-PortScan.ps1" or FolderPath endswith "\\Invoke-PoshRatHttp.ps1" or FolderPath endswith "\\Invoke-PoshRatHttps.ps1" or FolderPath endswith "\\Invoke-PostExfil.ps1" or FolderPath endswith "\\Invoke-PowerDump.ps1" or FolderPath endswith "\\Invoke-PowerShellIcmp.ps1" or FolderPath endswith "\\Invoke-PowerShellTCP.ps1" or FolderPath endswith "\\Invoke-PowerShellTcpOneLine.ps1" or FolderPath endswith "\\Invoke-PowerShellTcpOneLineBind.ps1" or FolderPath endswith "\\Invoke-PowerShellUdp.ps1" or FolderPath endswith "\\Invoke-PowerShellUdpOneLine.ps1" or FolderPath endswith "\\Invoke-PowerShellWMI.ps1" or FolderPath endswith "\\Invoke-PowerThIEf.ps1" or FolderPath endswith "\\Invoke-PPLDump.ps1" or FolderPath endswith "\\Invoke-Prasadhak.ps1" or FolderPath endswith "\\Invoke-PsExec.ps1" or FolderPath endswith "\\Invoke-PsGcat.ps1" or FolderPath endswith "\\Invoke-PsGcatAgent.ps1" or FolderPath endswith "\\Invoke-PSInject.ps1" or FolderPath endswith "\\Invoke-PsUaCme.ps1" or FolderPath endswith "\\Invoke-ReflectivePEInjection.ps1" or FolderPath endswith "\\Invoke-ReverseDNSLookup.ps1" or FolderPath endswith "\\Invoke-Rubeus.ps1" or FolderPath endswith "\\Invoke-RunAs.ps1" or FolderPath endswith "\\Invoke-SafetyKatz.ps1" or FolderPath endswith "\\Invoke-SauronEye.ps1" or FolderPath endswith "\\Invoke-SCShell.ps1" or FolderPath endswith "\\Invoke-Seatbelt.ps1" or FolderPath endswith "\\Invoke-ServiceAbuse.ps1" or FolderPath endswith "\\Invoke-SessionGopher.ps1" or FolderPath endswith "\\Invoke-ShellCode.ps1" or FolderPath endswith "\\Invoke-SMBScanner.ps1" or FolderPath endswith "\\Invoke-Snaffler.ps1" or FolderPath endswith "\\Invoke-Spoolsample.ps1" or FolderPath endswith "\\Invoke-SSHCommand.ps1" or FolderPath endswith "\\Invoke-SSIDExfil.ps1" or FolderPath endswith "\\Invoke-StandIn.ps1" or FolderPath endswith "\\Invoke-StickyNotesExtract.ps1" or FolderPath endswith "\\Invoke-Tater.ps1" or FolderPath endswith "\\Invoke-Thunderfox.ps1" or FolderPath endswith "\\Invoke-ThunderStruck.ps1" or FolderPath endswith "\\Invoke-TokenManipulation.ps1" or FolderPath endswith "\\Invoke-Tokenvator.ps1" or FolderPath endswith "\\Invoke-TotalExec.ps1" or FolderPath endswith "\\Invoke-UrbanBishop.ps1" or FolderPath endswith "\\Invoke-UserHunter.ps1" or FolderPath endswith "\\Invoke-VoiceTroll.ps1" or FolderPath endswith "\\Invoke-Whisker.ps1" or FolderPath endswith "\\Invoke-WinEnum.ps1" or FolderPath endswith "\\Invoke-winPEAS.ps1" or FolderPath endswith "\\Invoke-WireTap.ps1" or FolderPath endswith "\\Invoke-WmiCommand.ps1" or FolderPath endswith "\\Invoke-WScriptBypassUAC.ps1" or FolderPath endswith "\\Invoke-Zerologon.ps1" or FolderPath endswith "\\Keylogger.ps1" or FolderPath endswith "\\MailRaider.ps1" or FolderPath endswith "\\New-HoneyHash.ps1" or FolderPath endswith "\\OfficeMemScraper.ps1" or FolderPath endswith "\\Offline_Winpwn.ps1" or FolderPath endswith "\\Out-CHM.ps1" or FolderPath endswith "\\Out-DnsTxt.ps1" or FolderPath endswith "\\Out-Excel.ps1" or FolderPath endswith "\\Out-HTA.ps1" or FolderPath endswith "\\Out-Java.ps1" or FolderPath endswith "\\Out-JS.ps1" or FolderPath endswith "\\Out-Minidump.ps1" or FolderPath endswith "\\Out-RundllCommand.ps1" or FolderPath endswith "\\Out-SCF.ps1" or FolderPath endswith "\\Out-SCT.ps1" or FolderPath endswith "\\Out-Shortcut.ps1" or FolderPath endswith "\\Out-WebQuery.ps1" or FolderPath endswith "\\Out-Word.ps1" or FolderPath endswith "\\Parse_Keys.ps1" or FolderPath endswith "\\Port-Scan.ps1" or FolderPath endswith "\\PowerBreach.ps1" or FolderPath endswith "\\powercat.ps1" or FolderPath endswith "\\Powermad.ps1" or FolderPath endswith "\\PowerRunAsSystem.psm1" or FolderPath endswith "\\PowerSharpPack.ps1" or FolderPath endswith "\\PowerUp.ps1" or FolderPath endswith "\\PowerUpSQL.ps1" or FolderPath endswith "\\PowerView.ps1" or FolderPath endswith "\\PSAsyncShell.ps1" or FolderPath endswith "\\RemoteHashRetrieval.ps1" or FolderPath endswith "\\Remove-Persistence.ps1" or FolderPath endswith "\\Remove-PoshRat.ps1" or FolderPath endswith "\\Remove-Update.ps1" or FolderPath endswith "\\Run-EXEonRemote.ps1" or FolderPath endswith "\\Schtasks-Backdoor.ps1" or FolderPath endswith "\\Set-DCShadowPermissions.ps1" or FolderPath endswith "\\Set-MacAttribute.ps1" or FolderPath endswith "\\Set-RemotePSRemoting.ps1" or FolderPath endswith "\\Set-RemoteWMI.ps1" or FolderPath endswith "\\Set-Wallpaper.ps1" or FolderPath endswith "\\Show-TargetScreen.ps1" or FolderPath endswith "\\Speak.ps1" or FolderPath endswith "\\Start-CaptureServer.ps1" or FolderPath endswith "\\Start-WebcamRecorder.ps1" or FolderPath endswith "\\StringToBase64.ps1" or FolderPath endswith "\\TexttoExe.ps1" or FolderPath endswith "\\Veeam-Get-Creds.ps1" or FolderPath endswith "\\VolumeShadowCopyTools.ps1" or FolderPath endswith "\\WinPwn.ps1" or FolderPath endswith "\\WSUSpendu.ps1") or (FolderPath contains "Invoke-Sharp" and FolderPath endswith ".ps1")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_macro_files_downloaded.yml
Office Macro File Download ---> KQL Query:
DeviceFileEvents
| where ((FolderPath endswith ".docm" or FolderPath endswith ".dotm" or FolderPath endswith ".xlsm" or FolderPath endswith ".xltm" or FolderPath endswith ".potm" or FolderPath endswith ".pptm") or (FolderPath contains ".docm:Zone" or FolderPath contains ".dotm:Zone" or FolderPath contains ".xlsm:Zone" or FolderPath contains ".xltm:Zone" or FolderPath contains ".potm:Zone" or FolderPath contains ".pptm:Zone")) and (InitiatingProcessFolderPath endswith "\\RuntimeBroker.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\thunderbird.exe" or InitiatingProcessFolderPath endswith "\\brave.exe" or InitiatingProcessFolderPath endswith "\\chrome.exe" or InitiatingProcessFolderPath endswith "\\firefox.exe" or InitiatingProcessFolderPath endswith "\\iexplore.exe" or InitiatingProcessFolderPath endswith "\\maxthon.exe" or InitiatingProcessFolderPath endswith "\\MicrosoftEdge.exe" or InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\seamonkey.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_iso_file_mount.yml
ISO File Created Within Temp Folders ---> KQL Query:
DeviceFileEvents
| where ((FolderPath contains "\\AppData\\Local\\Temp\\" and FolderPath contains ".zip\\") and FolderPath endswith ".iso") or (FolderPath contains "\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook\\" and FolderPath endswith ".iso")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_artefact.yml
ScreenConnect Temporary Installation Artefact ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\Bin\\ScreenConnect."

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_script.yml
Legitimate Application Dropped Script ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\eqnedt32.exe" or InitiatingProcessFolderPath endswith "\\wordpad.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe" or InitiatingProcessFolderPath endswith "\\certutil.exe" or InitiatingProcessFolderPath endswith "\\certoc.exe" or InitiatingProcessFolderPath endswith "\\CertReq.exe" or InitiatingProcessFolderPath endswith "\\Desktopimgdownldr.exe" or InitiatingProcessFolderPath endswith "\\esentutl.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\AcroRd32.exe" or InitiatingProcessFolderPath endswith "\\RdrCEF.exe" or InitiatingProcessFolderPath endswith "\\hh.exe" or InitiatingProcessFolderPath endswith "\\finger.exe") and (FolderPath endswith ".ps1" or FolderPath endswith ".bat" or FolderPath endswith ".vbs" or FolderPath endswith ".scf" or FolderPath endswith ".wsf" or FolderPath endswith ".wsh")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_addin_persistence.yml
Potential Persistence Via Microsoft Office Add-In ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\Microsoft\\Addins\\" and (FolderPath endswith ".xlam" or FolderPath endswith ".xla" or FolderPath endswith ".ppam")) or (FolderPath contains "\\Microsoft\\Word\\Startup\\" and FolderPath endswith ".wll") or (FolderPath contains "Microsoft\\Excel\\XLSTART\\" and FolderPath endswith ".xlam") or (FolderPath contains "\\Microsoft\\Excel\\Startup\\" and FolderPath endswith ".xll")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_iphlpapi_dll_sideloading.yml
Malicious DLL File Dropped in the Teams or OneDrive Folder ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "iphlpapi.dll" and FolderPath contains "\\AppData\\Local\\Microsoft"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_creation_new_shim_database.yml
New Custom Shim Database Created ---> KQL Query:
DeviceFileEvents
| where FolderPath contains ":\\Windows\\apppatch\\Custom\\" or FolderPath contains ":\\Windows\\apppatch\\CustomSDB\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_regedit_print_as_pdf.yml
PDF File Created By RegEdit.EXE ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\regedit.exe" and FolderPath endswith ".pdf"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_creation_unquoted_service_path.yml
Creation Exe for Service with Unquoted Path ---> KQL Query:
DeviceFileEvents
| where FolderPath =~ "C:\\program.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_quarkspw_filedump.yml
HackTool - QuarksPwDump Dump File ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\AppData\\Local\\Temp\\SAM-" and FolderPath contains ".dmp"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_system32_local_folder_privilege_escalation.yml
Potential Privilege Escalation Attempt Via .Exe.Local Technique ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\comctl32.dll" and (FolderPath startswith "C:\\Windows\\System32\\logonUI.exe.local" or FolderPath startswith "C:\\Windows\\System32\\werFault.exe.local" or FolderPath startswith "C:\\Windows\\System32\\consent.exe.local" or FolderPath startswith "C:\\Windows\\System32\\narrator.exe.local" or FolderPath startswith "C:\\Windows\\System32\\wermgr.exe.local")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_module_uncommon_creation.yml
PowerShell Module File Created By Non-PowerShell Process ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\WindowsPowerShell\\Modules\\" or FolderPath contains "\\PowerShell\\7\\Modules\\") and (not((InitiatingProcessFolderPath endswith ":\\Program Files\\PowerShell\\7-preview\\pwsh.exe" or InitiatingProcessFolderPath endswith ":\\Program Files\\PowerShell\\7\\pwsh.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\poqexec.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\poqexec.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_iso_file_recent.yml
ISO or Image Mount Indicator in Recent Files ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\Microsoft\\Windows\\Recent\\" and (FolderPath endswith ".iso.lnk" or FolderPath endswith ".img.lnk" or FolderPath endswith ".vhd.lnk" or FolderPath endswith ".vhdx.lnk")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_double_extension.yml
Suspicious Double Extension Files ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith ".rar.exe" or FolderPath endswith ".zip.exe") or ((FolderPath contains ".doc." or FolderPath contains ".docx." or FolderPath contains ".jpg." or FolderPath contains ".pdf." or FolderPath contains ".ppt." or FolderPath contains ".pptx." or FolderPath contains ".xls." or FolderPath contains ".xlsx.") and (FolderPath endswith ".exe" or FolderPath endswith ".iso" or FolderPath endswith ".rar" or FolderPath endswith ".zip"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_drop_powershell.yml
PowerShell Script Dropped Via PowerShell.EXE ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") and FolderPath endswith ".ps1") and (not(((FolderPath contains "\\AppData\\Local\\Temp\\" and FolderPath startswith "C:\\Users\\") or FolderPath contains "__PSScriptPolicyTest_" or FolderPath startswith "C:\\Windows\\Temp\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_startup_persistence.yml
Potential Persistence Via Microsoft Office Startup Folder ---> KQL Query:
DeviceFileEvents
| where (((FolderPath endswith ".doc" or FolderPath endswith ".docm" or FolderPath endswith ".docx" or FolderPath endswith ".dot" or FolderPath endswith ".dotm" or FolderPath endswith ".rtf") and (FolderPath contains "\\Microsoft\\Word\\STARTUP" or (FolderPath contains "\\Office" and FolderPath contains "\\Program Files" and FolderPath contains "\\STARTUP"))) or ((FolderPath endswith ".xls" or FolderPath endswith ".xlsm" or FolderPath endswith ".xlsx" or FolderPath endswith ".xlt" or FolderPath endswith ".xltm") and (FolderPath contains "\\Microsoft\\Excel\\XLSTART" or (FolderPath contains "\\Office" and FolderPath contains "\\Program Files" and FolderPath contains "\\XLSTART")))) and (not((InitiatingProcessFolderPath endswith "\\WINWORD.exe" or InitiatingProcessFolderPath endswith "\\EXCEL.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_lnk_double_extension.yml
Suspicious LNK Double Extension File Created ---> KQL Query:
DeviceFileEvents
| where ((FolderPath contains ".doc." or FolderPath contains ".docx." or FolderPath contains ".jpg." or FolderPath contains ".pdf." or FolderPath contains ".ppt." or FolderPath contains ".pptx." or FolderPath contains ".xls." or FolderPath contains ".xlsx.") and FolderPath endswith ".lnk") and (not(FolderPath contains "\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\")) and (not(((InitiatingProcessFolderPath endswith "\\excel.exe" and FolderPath contains "\\AppData\\Roaming\\Microsoft\\Excel") or (InitiatingProcessFolderPath endswith "\\powerpnt.exe" and FolderPath contains "\\AppData\\Roaming\\Microsoft\\PowerPoint") or ((InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe") and FolderPath contains "\\AppData\\Roaming\\Microsoft\\Office\\Recent\\") or (InitiatingProcessFolderPath endswith "\\winword.exe" and FolderPath contains "\\AppData\\Roaming\\Microsoft\\Word"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_teamviewer_remote_session.yml
TeamViewer Remote Session ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\TeamViewer\\RemotePrinting\\tvprint.db" or FolderPath endswith "\\TeamViewer\\TVNetwork.log") or (FolderPath contains "\\TeamViewer" and FolderPath contains "_Logfile.log")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_consent_comctl32.yml
UAC Bypass Using Consent and Comctl32 - File ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\comctl32.dll" and FolderPath startswith "C:\\Windows\\System32\\consent.exe.@"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_exchange_webshell_drop.yml
Suspicious ASPX File Drop by Exchange ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessCommandLine contains "MSExchange" and InitiatingProcessFolderPath endswith "\\w3wp.exe" and (FolderPath contains "FrontEnd\\HttpProxy\\" or FolderPath contains "\\inetpub\\wwwroot\\aspnet_client\\")) and (FolderPath endswith ".aspx" or FolderPath endswith ".asp" or FolderPath endswith ".ashx")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml
UAC Bypass Using NTFS Reparse Point - File ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\AppData\\Local\\Temp\\api-ms-win-core-kernel32-legacy-l1.DLL" and FolderPath startswith "C:\\Users\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_hivenightmare_file_exports.yml
HackTool - Typical HiveNightmare SAM File Export ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\hive_sam_" or FolderPath contains "\\SAM-2021-" or FolderPath contains "\\SAM-2022-" or FolderPath contains "\\SAM-2023-" or FolderPath contains "\\SAM-haxx" or FolderPath contains "\\Sam.save") or FolderPath =~ "C:\\windows\\temp\\sam"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_hidden_dir_index_allocation.yml
Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "::$index_allocation"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_default_gpo_dir_write.yml
Suspicious Files in Default GPO Folder ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\" and (FolderPath endswith ".dll" or FolderPath endswith ".exe")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sed_file_creation.yml
Self Extraction Directive File Created In Potentially Suspicious Location ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains ":\\ProgramData\\" or FolderPath contains ":\\Temp\\" or FolderPath contains ":\\Windows\\System32\\Tasks\\" or FolderPath contains ":\\Windows\\Tasks\\" or FolderPath contains ":\\Windows\\Temp\\" or FolderPath contains "\\AppData\\Local\\Temp\\") and FolderPath endswith ".sed"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_process.yml
NTDS.DIT Creation By Uncommon Process ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\ntds.dit" and ((InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\wsl.exe" or InitiatingProcessFolderPath endswith "\\wt.exe") or (InitiatingProcessFolderPath contains "\\AppData\\" or InitiatingProcessFolderPath contains "\\Temp\\" or InitiatingProcessFolderPath contains "\\Public\\" or InitiatingProcessFolderPath contains "\\PerfLogs\\"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sam_dump.yml
Potential SAM Database Dump ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\Temp\\sam" or FolderPath endswith "\\sam.sav" or FolderPath endswith "\\Intel\\sam" or FolderPath endswith "\\sam.hive" or FolderPath endswith "\\Perflogs\\sam" or FolderPath endswith "\\ProgramData\\sam" or FolderPath endswith "\\Users\\Public\\sam" or FolderPath endswith "\\AppData\\Local\\sam" or FolderPath endswith "\\AppData\\Roaming\\sam" or FolderPath endswith "_ShadowSteal.zip" or FolderPath endswith "\\Documents\\SAM.export" or FolderPath endswith ":\\sam") or (FolderPath contains "\\hive_sam_" or FolderPath contains "\\sam.save" or FolderPath contains "\\sam.export" or FolderPath contains "\\~reg_sam.save" or FolderPath contains "\\sam_backup" or FolderPath contains "\\sam.bck" or FolderPath contains "\\sam.backup")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_vscode_powershell_profile.yml
VsCode Powershell Profile Modification ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\Microsoft.VSCode_profile.ps1"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_macro_files_from_susp_process.yml
Office Macro File Creation From Suspicious Process ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") or (InitiatingProcessParentFileName in~ ("cscript.exe", "mshta.exe", "regsvr32.exe", "rundll32.exe", "wscript.exe"))) and (FolderPath endswith ".docm" or FolderPath endswith ".dotm" or FolderPath endswith ".xlsm" or FolderPath endswith ".xltm" or FolderPath endswith ".potm" or FolderPath endswith ".pptm")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_startup_folder_file_write.yml
Startup Folder File Write ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp" and (not((InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\wuauclt.exe" or FolderPath startswith "C:\\$WINDOWS.~BT\\NewOS\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_lsass_default_dump_file_names.yml
LSASS Process Memory Dump Files ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\Andrew.dmp" or FolderPath endswith "\\Coredump.dmp" or FolderPath endswith "\\lsass.dmp" or FolderPath endswith "\\lsass.rar" or FolderPath endswith "\\lsass.zip" or FolderPath endswith "\\NotLSASS.zip" or FolderPath endswith "\\PPLBlade.dmp" or FolderPath endswith "\\rustive.dmp") or (FolderPath contains "\\lsass_2" or FolderPath contains "\\lsassdmp" or FolderPath contains "\\lsassdump") or (FolderPath contains "\\lsass" and FolderPath contains ".dmp") or (FolderPath contains "SQLDmpr" and FolderPath endswith ".mdmp") or ((FolderPath contains "\\nanodump" or FolderPath contains "\\proc_") and FolderPath endswith ".dmp")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_redmimicry_winnti_filedrop.yml
Potential Winnti Dropper Activity ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\gthread-3.6.dll" or FolderPath endswith "\\sigcmm-2.4.dll" or FolderPath endswith "\\Windows\\Temp\\tmp.bat"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_winsat.yml
UAC Bypass Abusing Winsat Path Parsing - File ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\AppData\\Local\\Temp\\system32\\winsat.exe" or FolderPath endswith "\\AppData\\Local\\Temp\\system32\\winmm.dll") and FolderPath startswith "C:\\Users\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_inveigh_artefacts.yml
HackTool - Inveigh Execution Artefacts ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\Inveigh-Log.txt" or FolderPath endswith "\\Inveigh-Cleartext.txt" or FolderPath endswith "\\Inveigh-NTLMv1Users.txt" or FolderPath endswith "\\Inveigh-NTLMv2Users.txt" or FolderPath endswith "\\Inveigh-NTLMv1.txt" or FolderPath endswith "\\Inveigh-NTLMv2.txt" or FolderPath endswith "\\Inveigh-FormInput.txt" or FolderPath endswith "\\Inveigh.dll" or FolderPath endswith "\\Inveigh.exe" or FolderPath endswith "\\Inveigh.ps1" or FolderPath endswith "\\Inveigh-Relay.ps1"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_aspnet_temp_files.yml
Assembly DLL Creation Via AspNetCompiler ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\aspnet_compiler.exe" and (FolderPath contains "\\Temporary ASP.NET Files\\" and FolderPath contains "\\assembly\\tmp\\" and FolderPath contains ".dll")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_krbrelay_remote_ioc.yml
HackTool - RemoteKrbRelay SMB Relay Secrets Dump Module Indicators ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ":\\windows\\temp\\sam.tmp" or FolderPath endswith ":\\windows\\temp\\sec.tmp" or FolderPath endswith ":\\windows\\temp\\sys.tmp"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_creation_system_file.yml
Files With System Process Name In Unsuspected Locations ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\AtBroker.exe" or FolderPath endswith "\\audiodg.exe" or FolderPath endswith "\\backgroundTaskHost.exe" or FolderPath endswith "\\bcdedit.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\cmdl32.exe" or FolderPath endswith "\\cmstp.exe" or FolderPath endswith "\\conhost.exe" or FolderPath endswith "\\csrss.exe" or FolderPath endswith "\\dasHost.exe" or FolderPath endswith "\\dfrgui.exe" or FolderPath endswith "\\dllhost.exe" or FolderPath endswith "\\dwm.exe" or FolderPath endswith "\\eventcreate.exe" or FolderPath endswith "\\eventvwr.exe" or FolderPath endswith "\\explorer.exe" or FolderPath endswith "\\extrac32.exe" or FolderPath endswith "\\fontdrvhost.exe" or FolderPath endswith "\\ipconfig.exe" or FolderPath endswith "\\iscsicli.exe" or FolderPath endswith "\\iscsicpl.exe" or FolderPath endswith "\\logman.exe" or FolderPath endswith "\\LogonUI.exe" or FolderPath endswith "\\LsaIso.exe" or FolderPath endswith "\\lsass.exe" or FolderPath endswith "\\lsm.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\msinfo32.exe" or FolderPath endswith "\\mstsc.exe" or FolderPath endswith "\\nbtstat.exe" or FolderPath endswith "\\odbcconf.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regini.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\RuntimeBroker.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\SearchFilterHost.exe" or FolderPath endswith "\\SearchIndexer.exe" or FolderPath endswith "\\SearchProtocolHost.exe" or FolderPath endswith "\\SecurityHealthService.exe" or FolderPath endswith "\\SecurityHealthSystray.exe" or FolderPath endswith "\\services.exe" or FolderPath endswith "\\ShellAppRuntime.exe" or FolderPath endswith "\\sihost.exe" or FolderPath endswith "\\smartscreen.exe" or FolderPath endswith "\\smss.exe" or FolderPath endswith "\\spoolsv.exe" or FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\SystemSettingsBroker.exe" or FolderPath endswith "\\taskhost.exe" or FolderPath endswith "\\taskhostw.exe" or FolderPath endswith "\\Taskmgr.exe" or FolderPath endswith "\\TiWorker.exe" or FolderPath endswith "\\vssadmin.exe" or FolderPath endswith "\\w32tm.exe" or FolderPath endswith "\\WerFault.exe" or FolderPath endswith "\\WerFaultSecure.exe" or FolderPath endswith "\\wermgr.exe" or FolderPath endswith "\\wevtutil.exe" or FolderPath endswith "\\wininit.exe" or FolderPath endswith "\\winlogon.exe" or FolderPath endswith "\\winrshost.exe" or FolderPath endswith "\\WinRTNetMUAHostServer.exe" or FolderPath endswith "\\wlanext.exe" or FolderPath endswith "\\wlrmdr.exe" or FolderPath endswith "\\WmiPrvSE.exe" or FolderPath endswith "\\wslhost.exe" or FolderPath endswith "\\WSReset.exe" or FolderPath endswith "\\WUDFHost.exe" or FolderPath endswith "\\WWAHost.exe") and (not((FolderPath endswith "C:\\Windows\\explorer.exe" or (FolderPath contains "C:\\$WINDOWS.~BT\\" or FolderPath contains "C:\\$WinREAgent\\" or FolderPath contains "C:\\Windows\\SoftwareDistribution\\" or FolderPath contains "C:\\Windows\\System32\\" or FolderPath contains "C:\\Windows\\SysWOW64\\" or FolderPath contains "C:\\Windows\\WinSxS\\" or FolderPath contains "C:\\Windows\\uus\\") or (InitiatingProcessFolderPath endswith "\\SecurityHealthSetup.exe" and FolderPath contains "C:\\Windows\\System32\\SecurityHealth\\" and FolderPath endswith "\\SecurityHealthSystray.exe") or (InitiatingProcessFolderPath endswith "C:\\WINDOWS\\system32\\msiexec.exe" and (FolderPath endswith "C:\\Program Files\\PowerShell\\7\\pwsh.exe" or FolderPath endswith "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe")) or (InitiatingProcessFolderPath endswith "C:\\Windows\\system32\\svchost.exe" and FolderPath contains "C:\\Program Files\\WindowsApps\\") or InitiatingProcessFolderPath endswith "C:\\Windows\\System32\\wuauclt.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_advanced_ip_scanner.yml
Advanced IP Scanner - File Event ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\AppData\\Local\\Temp\\Advanced IP Scanner 2"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_mal_octopus_scanner.yml
Octopus Scanner Malware ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\AppData\\Local\\Microsoft\\Cache134.dat" or FolderPath endswith "\\AppData\\Local\\Microsoft\\ExplorerSync.db"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_livekd_driver_susp_creation.yml
LiveKD Driver Creation By Uncommon Process ---> KQL Query:
DeviceFileEvents
| where FolderPath =~ "C:\\Windows\\System32\\drivers\\LiveKdD.SYS" and (not((InitiatingProcessFolderPath endswith "\\livekd.exe" or InitiatingProcessFolderPath endswith "\\livek64.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_create_non_existent_dlls.yml
Creation Of Non-Existent System DLL ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ":\\Windows\\System32\\TSMSISrv.dll" or FolderPath endswith ":\\Windows\\System32\\TSVIPSrv.dll" or FolderPath endswith ":\\Windows\\System32\\wbem\\wbemcomn.dll" or FolderPath endswith ":\\Windows\\System32\\WLBSCTRL.dll" or FolderPath endswith ":\\Windows\\System32\\wow64log.dll" or FolderPath endswith ":\\Windows\\System32\\WptsExtensions.dll" or FolderPath endswith "\\SprintCSP.dll"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_wpbbin_persistence.yml
UEFI Persistence Via Wpbbin - FileCreation ---> KQL Query:
DeviceFileEvents
| where FolderPath =~ "C:\\Windows\\System32\\wpbbin.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_onenote_files_in_susp_locations.yml
OneNote Attachment File Dropped In Suspicious Location ---> KQL Query:
DeviceFileEvents
| where ((FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\Windows\\Temp\\" or FolderPath contains ":\\Temp\\") and (FolderPath endswith ".one" or FolderPath endswith ".onepkg")) and (not((InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft Office\\" and InitiatingProcessFolderPath endswith "\\ONENOTE.EXE")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_module_susp_creation.yml
Potential Suspicious PowerShell Module File Created ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\WindowsPowerShell\\Modules\\" and FolderPath contains "\\.ps") or (FolderPath contains "\\WindowsPowerShell\\Modules\\" and FolderPath contains "\\.dll")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_ntds_dit_creation.yml
NTDS.DIT Created ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "ntds.dit"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_remote_file.yml
Remote Access Tool - ScreenConnect Temporary File ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\ScreenConnect.WindowsClient.exe" and FolderPath contains "\\Documents\\ConnectWiseControl\\Temp\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_colorcpl.yml
Suspicious Creation with Colorcpl ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\colorcpl.exe" and (not((FolderPath endswith ".icm" or FolderPath endswith ".gmmp" or FolderPath endswith ".cdmp" or FolderPath endswith ".camp")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_csexec_service.yml
CSExec Service File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\csexecsvc.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_system_interactive_powershell.yml
Suspicious Interactive PowerShell as SYSTEM ---> KQL Query:
DeviceFileEvents
| where FolderPath in~ ("C:\\Windows\\System32\\config\\systemprofile\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt", "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\PowerShell\\StartupProfileData-Interactive")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_gotoopener_artefact.yml
GoToAssist Temporary Installation Artefact ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\AppData\\Local\\Temp\\LogMeInInc\\GoToAssist Remote Support Expert\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_idiagnostic_profile.yml
UAC Bypass Using IDiagnostic Profile - File ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\DllHost.exe" and FolderPath endswith ".dll" and FolderPath startswith "C:\\Windows\\System32\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_tsclient_filewrite_startup.yml
Hijack Legit RDP Session to Move Laterally ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\mstsc.exe" and FolderPath contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_pcre_net_temp_file.yml
PCRE.NET Package Temp Files ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_winrm_awl_bypass.yml
AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl - File ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "WsmPty.xsl" or FolderPath endswith "WsmTxt.xsl") and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_werfault_dll_hijacking.yml
Creation of WerFault.exe/Wer.dll in Unusual Folder ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\WerFault.exe" or FolderPath endswith "\\wer.dll") and (not((FolderPath startswith "C:\\Windows\\SoftwareDistribution\\" or FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_cscript_wscript_dropper.yml
WScript or CScript Dropper - File ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe") and (FolderPath endswith ".jse" or FolderPath endswith ".vbe" or FolderPath endswith ".js" or FolderPath endswith ".vba" or FolderPath endswith ".vbs") and (FolderPath startswith "C:\\Users\\" or FolderPath startswith "C:\\ProgramData")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_dpapi_backup_and_cert_export_ioc.yml
DPAPI Backup Keys And Certificate Export Activity IOC ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "ntds_capi_" or FolderPath contains "ntds_legacy_" or FolderPath contains "ntds_unknown_") and (FolderPath endswith ".cer" or FolderPath endswith ".key" or FolderPath endswith ".pfx" or FolderPath endswith ".pvk")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_uac_bypass_msconfig_gui.yml
UAC Bypass Using MSConfig Token Modification - File ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\AppData\\Local\\Temp\\pkgmgr.exe" and FolderPath startswith "C:\\Users\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_get_variable.yml
Suspicious Get-Variable.exe Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "Local\\Microsoft\\WindowsApps\\Get-Variable.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_wmiexec_default_filename.yml
Wmiexec Default Output File ---> KQL Query:
DeviceFileEvents
| where FolderPath matches regex "\\\\Windows\\\\__1\\d{9}\\.\\d{1,7}$" or FolderPath matches regex "C:\\\\__1\\d{9}\\.\\d{1,7}$" or FolderPath matches regex "D:\\\\__1\\d{9}\\.\\d{1,7}$"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_anydesk_artefact.yml
Anydesk Temporary Artefact ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\AppData\\Roaming\\AnyDesk\\user.conf" or FolderPath contains "\\AppData\\Roaming\\AnyDesk\\system.conf"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_initial_access_dll_search_order_hijacking.yml
Potential Initial Access via DLL Search Order Hijacking ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\MSACCESS.EXE" or InitiatingProcessFolderPath endswith "\\MSPUB.EXE" or InitiatingProcessFolderPath endswith "\\fltldr.exe" or InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\certutil.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\curl.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") and (FolderPath contains "\\Microsoft\\OneDrive\\" or FolderPath contains "\\Microsoft OneDrive\\" or FolderPath contains "\\Microsoft\\Teams\\" or FolderPath contains "\\Local\\slack\\app-" or FolderPath contains "\\Local\\Programs\\Microsoft VS Code\\") and (FolderPath contains "\\Users\\" and FolderPath contains "\\AppData\\") and FolderPath endswith ".dll") and (not((InitiatingProcessFolderPath endswith "\\cmd.exe" and (FolderPath contains "\\Users\\" and FolderPath contains "\\AppData\\" and FolderPath contains "\\Microsoft\\OneDrive\\" and FolderPath contains "\\api-ms-win-core-"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml
Wmiprvse Wbemcomn DLL Hijack - File ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath =~ "System" and FolderPath endswith "\\wbem\\wbemcomn.dll"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_spool_drivers_color_drop.yml
Drop Binaries Into Spool Drivers Color Folder ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".sys") and FolderPath startswith "C:\\Windows\\System32\\spool\\drivers\\color\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_right_to_left_override_extension_spoofing.yml
Potential File Extension Spoofing Using Right-to-Left Override ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "fpd.." or FolderPath contains "nls.." or FolderPath contains "vsc.." or FolderPath contains "xcod." or FolderPath contains "xslx.") and FolderPath contains "\\u202e"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_lolbin_gather_network_info_script_output.yml
GatherNetworkInfo.VBS Reconnaissance Script Output ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "\\Hotfixinfo.txt" or FolderPath endswith "\\netiostate.txt" or FolderPath endswith "\\sysportslog.txt" or FolderPath endswith "\\VmSwitchLog.evtx") and FolderPath startswith "C:\\Windows\\System32\\config"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_remcom_service.yml
RemCom Service File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\RemComSvc.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_crackmapexec_indicators.yml
HackTool - CrackMapExec File Indicators ---> KQL Query:
DeviceFileEvents
| where FolderPath startswith "C:\\Windows\\Temp\\" and ((FolderPath matches regex "\\\\[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\.txt$" or FolderPath matches regex "\\\\[a-zA-Z]{8}\\.tmp$") or (FolderPath endswith "\\temp.ps1" or FolderPath endswith "\\msol.ps1"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_remote_cred_dump.yml
HackTool - Potential Remote Credential Dumping Activity Via CrackMapExec Or Impacket-Secretsdump ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\svchost.exe" and FolderPath matches regex "\\\\Windows\\\\System32\\\\[a-zA-Z0-9]{8}\\.tmp$"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_shell_write_susp_directory.yml
Windows Shell/Scripting Application File Write to Suspicious Folder ---> KQL Query:
DeviceFileEvents
| where ((InitiatingProcessFolderPath endswith "\\bash.exe" or InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\msbuild.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\sh.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") and (FolderPath startswith "C:\\PerfLogs\\" or FolderPath startswith "C:\\Users\\Public\\")) or ((InitiatingProcessFolderPath endswith "\\certutil.exe" or InitiatingProcessFolderPath endswith "\\forfiles.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\schtasks.exe" or InitiatingProcessFolderPath endswith "\\scriptrunner.exe" or InitiatingProcessFolderPath endswith "\\wmic.exe") and (FolderPath contains "C:\\PerfLogs\\" or FolderPath contains "C:\\Users\\Public\\" or FolderPath contains "C:\\Windows\\Temp\\"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_rdp_file_susp_creation.yml
.RDP File Created By Uncommon Application ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\brave.exe" or InitiatingProcessFolderPath endswith "\\CCleaner Browser\\Application\\CCleanerBrowser.exe" or InitiatingProcessFolderPath endswith "\\chromium.exe" or InitiatingProcessFolderPath endswith "\\firefox.exe" or InitiatingProcessFolderPath endswith "\\Google\\Chrome\\Application\\chrome.exe" or InitiatingProcessFolderPath endswith "\\iexplore.exe" or InitiatingProcessFolderPath endswith "\\microsoftedge.exe" or InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\Opera.exe" or InitiatingProcessFolderPath endswith "\\Vivaldi.exe" or InitiatingProcessFolderPath endswith "\\Whale.exe" or InitiatingProcessFolderPath endswith "\\olk.exe" or InitiatingProcessFolderPath endswith "\\Outlook.exe" or InitiatingProcessFolderPath endswith "\\RuntimeBroker.exe" or InitiatingProcessFolderPath endswith "\\Thunderbird.exe" or InitiatingProcessFolderPath endswith "\\Discord.exe" or InitiatingProcessFolderPath endswith "\\Keybase.exe" or InitiatingProcessFolderPath endswith "\\msteams.exe" or InitiatingProcessFolderPath endswith "\\Slack.exe" or InitiatingProcessFolderPath endswith "\\teams.exe") and FolderPath endswith ".rdp"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_powershell_profile.yml
PowerShell Profile Modification ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\Microsoft.PowerShell_profile.ps1" or FolderPath endswith "\\PowerShell\\profile.ps1" or FolderPath endswith "\\Program Files\\PowerShell\\7-preview\\profile.ps1" or FolderPath endswith "\\Program Files\\PowerShell\\7\\profile.ps1" or FolderPath endswith "\\Windows\\System32\\WindowsPowerShell\\v1.0\\profile.ps1" or FolderPath endswith "\\WindowsPowerShell\\profile.ps1"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_desktop_txt.yml
Suspicious Creation TXT File in User Desktop ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\cmd.exe" and (FolderPath contains "\\Users\\" and FolderPath contains "\\Desktop\\") and FolderPath endswith ".txt"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_outlook_macro_creation.yml
New Outlook Macro Created ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\outlook.exe" and FolderPath endswith "\\Microsoft\\Outlook\\VbaProject.OTM"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_perflogs_susp_files.yml
Suspicious File Created In PerfLogs ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith ".7z" or FolderPath endswith ".bat" or FolderPath endswith ".bin" or FolderPath endswith ".chm" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".lnk" or FolderPath endswith ".ps1" or FolderPath endswith ".psm1" or FolderPath endswith ".py" or FolderPath endswith ".scr" or FolderPath endswith ".sys" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs" or FolderPath endswith ".zip") and FolderPath startswith "C:\\PerfLogs\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_bloodhound_collection.yml
BloodHound Collection Files ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith "BloodHound.zip" or FolderPath endswith "_computers.json" or FolderPath endswith "_containers.json" or FolderPath endswith "_domains.json" or FolderPath endswith "_gpos.json" or FolderPath endswith "_groups.json" or FolderPath endswith "_ous.json" or FolderPath endswith "_users.json") and (not((InitiatingProcessFolderPath endswith "\\svchost.exe" and FolderPath endswith "\\pocket_containers.json" and FolderPath startswith "C:\\Program Files\\WindowsApps\\Microsoft.")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_module_creation.yml
PowerShell Module File Created ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") and (FolderPath contains "\\WindowsPowerShell\\Modules\\" or FolderPath contains "\\PowerShell\\7\\Modules\\")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_install_teamviewer_desktop.yml
Installation of TeamViewer Desktop ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\TeamViewer_Desktop.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_desktop_ini.yml
Suspicious desktop.ini Action ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\desktop.ini" and (not(((InitiatingProcessFolderPath startswith "C:\\Windows\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\") or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\JetBrains\\Toolbox\\bin\\7z.exe" and FolderPath contains "\\JetBrains\\apps\\") or FolderPath startswith "C:\\$WINDOWS.~BT\\NewOS\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_publisher_files_in_susp_locations.yml
Publisher Attachment File Dropped In Suspicious Location ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\Windows\\Temp\\" or FolderPath contains "C:\\Temp\\") and FolderPath endswith ".pub"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_ps_script_policy_test_creation_by_uncommon_process.yml
PSScriptPolicyTest Creation By Uncommon Process ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "__PSScriptPolicyTest_" and (not((InitiatingProcessFolderPath endswith ":\\Program Files\\PowerShell\\7-preview\\pwsh.exe" or InitiatingProcessFolderPath endswith ":\\Program Files\\PowerShell\\7\\pwsh.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\dsac.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\sdiagnhost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\ServerManager.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\wsmprovhost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\sdiagnhost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_livekd_driver.yml
LiveKD Driver Creation ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\livekd.exe" or InitiatingProcessFolderPath endswith "\\livek64.exe") and FolderPath =~ "C:\\Windows\\System32\\drivers\\LiveKdD.SYS"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_msdt_susp_directories.yml
File Creation In Suspicious Directory By Msdt.EXE ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\msdt.exe" and (FolderPath contains "\\Desktop\\" or FolderPath contains "\\Start Menu\\Programs\\Startup\\" or FolderPath contains "C:\\PerfLogs\\" or FolderPath contains "C:\\ProgramData\\" or FolderPath contains "C:\\Users\\Public\\")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_lsass_werfault_dump.yml
WerFault LSASS Process Memory Dump ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath =~ "C:\\WINDOWS\\system32\\WerFault.exe" and (FolderPath contains "\\lsass" or FolderPath contains "lsass.exe")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_dll_sideloading_space_path.yml
DLL Search Order Hijackig Via Additional Space in Path ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".dll" and (FolderPath startswith "C:\\Windows \\" or FolderPath startswith "C:\\Program Files \\" or FolderPath startswith "C:\\Program Files (x86) \\")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_exchange_webshell_drop_suspicious.yml
Suspicious File Drop by Exchange ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessCommandLine contains "MSExchange" and InitiatingProcessFolderPath endswith "\\w3wp.exe") and (FolderPath endswith ".aspx" or FolderPath endswith ".asp" or FolderPath endswith ".ashx" or FolderPath endswith ".ps1" or FolderPath endswith ".bat" or FolderPath endswith ".exe" or FolderPath endswith ".dll" or FolderPath endswith ".vbs")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_macro_files_created.yml
Office Macro File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".docm" or FolderPath endswith ".dotm" or FolderPath endswith ".xlsm" or FolderPath endswith ".xltm" or FolderPath endswith ".potm" or FolderPath endswith ".pptm"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_safetykatz.yml
HackTool - SafetyKatz Dump Indicator ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\Temp\\debug.bin"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_outlook_newform.yml
Potential Persistence Via Outlook Form ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\outlook.exe" and (FolderPath contains "\\AppData\\Local\\Microsoft\\FORMS\\IPM" or FolderPath contains "\\Local Settings\\Application Data\\Microsoft\\Forms")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_powershell_startup_shortcuts.yml
Potential Startup Shortcut Persistence Via PowerShell.EXE ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") and FolderPath contains "\\start menu\\programs\\startup\\" and FolderPath endswith ".lnk"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_outlook_rdp_file_creation.yml
.RDP File Created by Outlook Process ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".rdp" and ((FolderPath contains "\\AppData\\Local\\Packages\\Microsoft.Outlook_" or FolderPath contains "\\AppData\\Local\\Microsoft\\Olk\\Attachments\\") or (FolderPath contains "\\AppData\\Local\\Microsoft\\Windows\\" and FolderPath contains "\\Content.Outlook\\"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_dumpert.yml
HackTool - Dumpert Process Dumper Default File ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "dumpert.dmp"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_procexp_driver_susp_creation.yml
Process Explorer Driver Creation By Non-Sysinternals Binary ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\PROCEXP" and FolderPath endswith ".sys") and (not((InitiatingProcessFolderPath endswith "\\procexp.exe" or InitiatingProcessFolderPath endswith "\\procexp64.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_creation_scr_binary_file.yml
Suspicious Screensaver Binary File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".scr" and (not(((InitiatingProcessFolderPath endswith "\\Kindle.exe" or InitiatingProcessFolderPath endswith "\\Bin\\ccSvcHst.exe") or (InitiatingProcessFolderPath endswith "\\TiWorker.exe" and FolderPath endswith "\\uwfservicingscr.scr"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_net_cli_artefact.yml
Sigma Transformation Error for 'Suspicious DotNET CLR Usage Log Artifact': Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_mal_adwind.yml
Adwind RAT / JRAT File Artifact ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\AppData\\Roaming\\Oracle\\bin\\java" and FolderPath contains ".exe") or (FolderPath contains "\\Retrive" and FolderPath contains ".vbs")

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_new_scr_file.yml
SCR File Write Event ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".scr" and (not((FolderPath contains ":\\$WINDOWS.~BT\\NewOS\\" or FolderPath contains ":\\Windows\\System32\\" or FolderPath contains ":\\Windows\\SysWOW64\\" or FolderPath contains ":\\Windows\\WinSxS\\" or FolderPath contains ":\\WUDownloadCache\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_shell_write_susp_files_extensions.yml
Windows Binaries Write Suspicious Extensions ---> KQL Query:
DeviceFileEvents
| where (((InitiatingProcessFolderPath endswith "\\csrss.exe" or InitiatingProcessFolderPath endswith "\\lsass.exe" or InitiatingProcessFolderPath endswith "\\RuntimeBroker.exe" or InitiatingProcessFolderPath endswith "\\sihost.exe" or InitiatingProcessFolderPath endswith "\\smss.exe" or InitiatingProcessFolderPath endswith "\\wininit.exe" or InitiatingProcessFolderPath endswith "\\winlogon.exe") and (FolderPath endswith ".bat" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".hta" or FolderPath endswith ".iso" or FolderPath endswith ".ps1" or FolderPath endswith ".txt" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs")) or ((InitiatingProcessFolderPath endswith "\\dllhost.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\svchost.exe") and (FolderPath endswith ".bat" or FolderPath endswith ".hta" or FolderPath endswith ".iso" or FolderPath endswith ".ps1" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs"))) and (not(((InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\dllhost.exe" and (FolderPath contains ":\\Users\\" and FolderPath contains "\\AppData\\Local\\Temp\\__PSScriptPolicyTest_") and FolderPath endswith ".ps1") or (InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\svchost.exe" and (FolderPath contains "C:\\Windows\\System32\\GroupPolicy\\DataStore\\" and FolderPath contains "\\sysvol\\" and FolderPath contains "\\Policies\\" and FolderPath contains "\\Machine\\Scripts\\Startup\\") and (FolderPath endswith ".ps1" or FolderPath endswith ".bat")))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_vhd_download_via_browsers.yml
VHD Image Download Via Browser ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\brave.exe" or InitiatingProcessFolderPath endswith "\\chrome.exe" or InitiatingProcessFolderPath endswith "\\firefox.exe" or InitiatingProcessFolderPath endswith "\\iexplore.exe" or InitiatingProcessFolderPath endswith "\\maxthon.exe" or InitiatingProcessFolderPath endswith "\\MicrosoftEdge.exe" or InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\seamonkey.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe") and FolderPath contains ".vhd"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_vscode_tunnel_renamed_execution.yml
Renamed VsCode Code Tunnel Execution - File Indicator ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\code_tunnel.json" and (not((InitiatingProcessFolderPath endswith "\\code-tunnel.exe" or InitiatingProcessFolderPath endswith "\\code.exe")))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_office_outlook_susp_macro_creation.yml
Suspicious Outlook Macro Created ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\Microsoft\\Outlook\\VbaProject.OTM" and (not(InitiatingProcessFolderPath endswith "\\outlook.exe"))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_sysinternals_psexec_service.yml
PsExec Service File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\PSEXESVC.exe"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_hktl_mimikatz_files.yml
HackTool - Mimikatz Kirbi File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".kirbi" or FolderPath endswith "mimilsa.log"

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_susp_wdac_policy_creation.yml
Potentially Suspicious WDAC Policy File Creation ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\Windows\\System32\\CodeIntegrity\\" and (not((((InitiatingProcessCommandLine contains "ConvertFrom-CIPolicy -XmlFilePath" and InitiatingProcessCommandLine contains "-BinaryFilePath ") or InitiatingProcessCommandLine contains "CiTool --update-policy" or (InitiatingProcessCommandLine contains "Copy-Item -Path" and InitiatingProcessCommandLine contains "-Destination")) or (InitiatingProcessFolderPath endswith "\\Microsoft.ConfigurationManagement.exe" or InitiatingProcessFolderPath endswith "\\WDAC Wizard.exe" or InitiatingProcessFolderPath endswith "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe" or InitiatingProcessFolderPath endswith "C:\\Program Files\\PowerShell\\7\\pwsh.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\System32\\dllhost.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\SysWOW64\\dllhost.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_parent_process.yml
NTDS.DIT Creation By Uncommon Parent Process ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\ntds.dit" and ((InitiatingProcessParentFileName in~ ("cscript.exe", "httpd.exe", "nginx.exe", "php-cgi.exe", "powershell.exe", "pwsh.exe", "w3wp.exe", "wscript.exe")) or (InitiatingProcessParentFileName startswith "apache" or InitiatingProcessParentFileName startswith "tomcat" or InitiatingProcessParentFileName startswith "" or InitiatingProcessParentFileName startswith "" or InitiatingProcessParentFileName startswith "" or InitiatingProcessParentFileName startswith ""))

----------------------------------------
Processing: sigma/rules/windows/file/file_event/file_event_win_mysqld_uncommon_file_creation.yml
Uncommon File Creation By Mysql Daemon Process ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\mysqld.exe" or InitiatingProcessFolderPath endswith "\\mysqld-nt.exe") and (FolderPath endswith ".bat" or FolderPath endswith ".dat" or FolderPath endswith ".dll" or FolderPath endswith ".exe" or FolderPath endswith ".ps1" or FolderPath endswith ".psm1" or FolderPath endswith ".vbe" or FolderPath endswith ".vbs")

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_iis_access_logs.yml
IIS WebServer Access Logs Deleted ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "\\inetpub\\logs\\LogFiles\\" and FolderPath endswith ".log"

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_zone_identifier_ads_uncommon.yml
ADS Zone.Identifier Deleted By Uncommon Application ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ":Zone.Identifier" and (not((InitiatingProcessFolderPath in~ ("C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe", "C:\\Program Files\\PowerShell\\7\\pwsh.exe", "C:\\Windows\\explorer.exe", "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "C:\\Windows\\SysWOW64\\explorer.exe", "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe")))) and (not(((InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe", "C:\\Program Files\\Mozilla Firefox\\firefox.exe")))))

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_tomcat_logs.yml
Tomcat WebServer Logs Deleted ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "catalina." or FolderPath contains "_access_log." or FolderPath contains "localhost.") and (FolderPath contains "\\Tomcat" and FolderPath contains "\\logs\\")

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_unusual_deletion_by_dns_exe.yml
Unusual File Deletion by Dns.exe ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\dns.exe" and (not(FolderPath endswith "\\dns.log"))

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_own_image.yml
Unexpected Error processing 'Process Deletion of Its Own Executable' (sigma/rules/windows/file/file_delete/file_delete_win_delete_own_image.yml): 'NoneType' object has no attribute 'format' (while converting rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_backup_file.yml
Backup Files Deleted ---> KQL Query:
DeviceFileEvents
| where (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\wt.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe") and (FolderPath endswith ".VHD" or FolderPath endswith ".bac" or FolderPath endswith ".bak" or FolderPath endswith ".wbcat" or FolderPath endswith ".bkf" or FolderPath endswith ".set" or FolderPath endswith ".win" or FolderPath endswith ".dsk")

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_sysinternals_sdelete_file_deletion.yml
File Deleted Via Sysinternals SDelete ---> KQL Query:
DeviceFileEvents
| where (FolderPath endswith ".AAA" or FolderPath endswith ".ZZZ") and (not(FolderPath endswith "\\Wireshark\\radius\\dictionary.alcatel-lucent.aaa"))

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_teamviewer_logs.yml
TeamViewer Log File Deleted ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains "\\TeamViewer_" and FolderPath endswith ".log") and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\svchost.exe"))

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_exchange_powershell_logs.yml
Exchange PowerShell Cmdlet History Deleted ---> KQL Query:
DeviceFileEvents
| where FolderPath contains "_Cmdlet_" and FolderPath startswith "\\Logging\\CmdletInfra\\LocalPowerShell\\Cmdlet\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_prefetch.yml
Prefetch File Deleted ---> KQL Query:
DeviceFileEvents
| where (FolderPath contains ":\\Windows\\Prefetch\\" and FolderPath endswith ".pf") and (not((InitiatingProcessFolderPath endswith ":\\windows\\system32\\svchost.exe" and (RequestAccountName contains "AUTHORI" or RequestAccountName contains "AUTORI"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_cve_2021_1675_print_nightmare.yml
Potential PrintNightmare Exploitation Attempt ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\spoolsv.exe" and FolderPath contains "C:\\Windows\\System32\\spool\\drivers\\x64\\3\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_event_log_files.yml
EventLog EVTX File Deleted ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith ".evtx" and FolderPath startswith "C:\\Windows\\System32\\winevt\\Logs\\"

----------------------------------------
Processing: sigma/rules/windows/file/file_delete/file_delete_win_delete_powershell_command_history.yml
PowerShell Console History Logs Deleted ---> KQL Query:
DeviceFileEvents
| where FolderPath endswith "\\PSReadLine\\ConsoleHost_history.txt"

----------------------------------------
Processing: sigma/rules/windows/file/file_access/file_access_win_susp_crypto_currency_wallets.yml
Access To Crypto Currency Wallets By Uncommon Applications ---> KQL Query:
DeviceFileEvents
| where ((FileName contains "\\AppData\\Roaming\\Ethereum\\keystore\\" or FileName contains "\\AppData\\Roaming\\EthereumClassic\\keystore\\" or FileName contains "\\AppData\\Roaming\\monero\\wallets\\") or (FileName endswith "\\AppData\\Roaming\\Bitcoin\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\BitcoinABC\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\BitcoinSV\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\DashCore\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\DogeCoin\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\Litecoin\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\Ripple\\wallet.dat" or FileName endswith "\\AppData\\Roaming\\Zcash\\wallet.dat")) and (not(((InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\system32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\") or InitiatingProcessFolderPath =~ "System"))) and (not(((InitiatingProcessFolderPath endswith "\\MpCopyAccelerator.exe" or InitiatingProcessFolderPath endswith "\\MsMpEng.exe") and InitiatingProcessFolderPath startswith "C:\\ProgramData\\Microsoft\\Windows Defender\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_access/file_access_win_susp_credential_manager_access.yml
Credential Manager Access By Uncommon Applications ---> KQL Query:
DeviceFileEvents
| where (FileName contains "\\AppData\\Local\\Microsoft\\Credentials\\" or FileName contains "\\AppData\\Roaming\\Microsoft\\Credentials\\" or FileName contains "\\AppData\\Local\\Microsoft\\Vault\\" or FileName contains "\\ProgramData\\Microsoft\\Vault\\") and (not((InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\system32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_access/file_access_win_susp_gpo_files.yml
Access To Potentially Sensitive Sysvol Files By Uncommon Applications ---> KQL Query:
DeviceFileEvents
| where ((FileName contains "\\sysvol\\" and FileName contains "\\Policies\\") and (FileName endswith "audit.csv" or FileName endswith "Files.xml" or FileName endswith "GptTmpl.inf" or FileName endswith "groups.xml" or FileName endswith "Registry.pol" or FileName endswith "Registry.xml" or FileName endswith "scheduledtasks.xml" or FileName endswith "scripts.ini" or FileName endswith "services.xml") and FileName startswith "\\") and (not((InitiatingProcessFolderPath =~ "C:\\Windows\\explorer.exe" or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\system32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_access/file_access_win_susp_dpapi_master_key_access.yml
Access To Windows DPAPI Master Keys By Uncommon Applications ---> KQL Query:
DeviceFileEvents
| where (FileName contains "\\Microsoft\\Protect\\S-1-5-18\\" or FileName contains "\\Microsoft\\Protect\\S-1-5-21-") and (not((InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\system32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/file/file_access/file_access_win_susp_credhist.yml
Access To Windows Credential History File By Uncommon Applications ---> KQL Query:
DeviceFileEvents
| where FileName endswith "\\Microsoft\\Protect\\CREDHIST" and (not((InitiatingProcessFolderPath =~ "C:\\Windows\\explorer.exe" or (InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\system32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\"))))

----------------------------------------
Processing: sigma/rules/windows/file/file_access/file_access_win_teams_sensitive_files.yml
Microsoft Teams Sensitive File Access By Uncommon Applications ---> KQL Query:
DeviceFileEvents
| where (FileName contains "\\Microsoft\\Teams\\Cookies" or FileName contains "\\Microsoft\\Teams\\Local Storage\\leveldb") and (not(InitiatingProcessFolderPath endswith "\\Microsoft\\Teams\\current\\Teams.exe"))

----------------------------------------
Processing: sigma/rules/windows/file/file_change/file_change_win_2022_timestomping.yml
Sigma Transformation Error for 'File Creation Date Changed to Another Year': Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/file/file_change/file_change_win_unusual_modification_by_dns_exe.yml
Unusual File Modification by dns.exe ---> KQL Query:
DeviceFileEvents
| where InitiatingProcessFolderPath endswith "\\dns.exe" and (not(FolderPath endswith "\\dns.log"))

----------------------------------------
Processing: sigma/rules/windows/wmi_event/sysmon_wmi_susp_scripting.yml
Sigma Transformation Error for 'Suspicious Scripting in a WMI Consumer': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/wmi_event/sysmon_wmi_susp_encoded_scripts.yml
Sigma Transformation Error for 'Suspicious Encoded Scripts in a WMI Consumer': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/wmi_event/sysmon_wmi_event_subscription.yml
Sigma Transformation Error for 'WMI Event Subscription': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_tamper_windows_defender_set_mp.yml
Sigma Transformation Error for 'Tamper Windows Defender - PSClassic': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_abuse_nslookup_with_dns_records.yml
Sigma Transformation Error for 'Nslookup PowerShell Download Cradle': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_remotefxvgpudisablement_abuse.yml
Sigma Transformation Error for 'Potential RemoteFXvGPUDisablement.EXE Abuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_delete_volume_shadow_copies.yml
Sigma Transformation Error for 'Delete Volume Shadow Copies Via WMI With PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_downgrade_attack.yml
Sigma Transformation Error for 'PowerShell Downgrade Attack - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_susp_get_nettcpconnection.yml
Sigma Transformation Error for 'Use Get-NetTCPConnection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_exe_calling_ps.yml
Sigma Transformation Error for 'PowerShell Called from an Executable Version Mismatch': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_wsman_com_provider_no_powershell.yml
Sigma Transformation Error for 'Suspicious Non PowerShell WSMAN COM Provider': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_susp_download.yml
Sigma Transformation Error for 'Suspicious PowerShell Download': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_remote_powershell_session.yml
Sigma Transformation Error for 'Remote PowerShell Session (PS Classic)': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_renamed_powershell.yml
Sigma Transformation Error for 'Renamed Powershell Under Powershell Channel': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_powercat.yml
Sigma Transformation Error for 'Netcat The Powershell Version': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_classic/posh_pc_susp_zip_compress.yml
Sigma Transformation Error for 'Zip A Folder With PowerShell For Staging In Temp - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_current_user.yml
Sigma Transformation Error for 'Suspicious PowerShell Get Current User': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_xml_iex.yml
Sigma Transformation Error for 'Powershell XML Execute Command': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_hktl_winpwn.yml
Sigma Transformation Error for 'HackTool - WinPwn Execution - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_test_netconnection.yml
Sigma Transformation Error for 'Testing Usage of Uncommonly Used Port': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_capture_screenshots.yml
Sigma Transformation Error for 'Windows Screen Capture with CopyFromScreen': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_disable_psreadline_command_history.yml
Sigma Transformation Error for 'Disable Powershell Command History': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_mailboxexport_share.yml
Sigma Transformation Error for 'Suspicious PowerShell Mailbox Export to Share - PS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_root_certificate_installed.yml
Sigma Transformation Error for 'Root Certificate Installed - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_service_dacl_modification_set_service.yml
Sigma Transformation Error for 'Suspicious Service DACL Modification Via Set-Service Cmdlet - PS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_prompt_credentials.yml
Sigma Transformation Error for 'PowerShell Credential Prompt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_get_adgroup.yml
Sigma Transformation Error for 'Active Directory Group Enumeration With Get-AdGroup': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_download.yml
Sigma Transformation Error for 'Suspicious PowerShell Download - Powershell Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_dsinternals_cmdlets.yml
Sigma Transformation Error for 'DSInternals Suspicious PowerShell Cmdlets - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_tamper_windows_defender_set_mp.yml
Sigma Transformation Error for 'Tamper Windows Defender - ScriptBlockLogging': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_invocation_generic.yml
Sigma Transformation Error for 'Suspicious PowerShell Invocations - Generic': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_audio_exfiltration.yml
Sigma Transformation Error for 'Potential Data Exfiltration Via Audio File': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_obfuscated_iex.yml
Sigma Transformation Error for 'Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_set_acl_susp_location.yml
Sigma Transformation Error for 'PowerShell Set-Acl On Windows Folder - PsScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_automated_collection.yml
Sigma Transformation Error for 'Automated Collection Command PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_modify_group_policy_settings.yml
Sigma Transformation Error for 'Modify Group Policy Settings - ScriptBlockLogging': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_win32_nteventlogfile_usage.yml
Sigma Transformation Error for 'Potentially Suspicious Call To Win32_NTEventlogFile Class - PSScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_winlogon_helper_dll.yml
Sigma Transformation Error for 'Winlogon Helper DLL': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_access_to_browser_login_data.yml
Sigma Transformation Error for 'Access to Browser Login Data': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_powershell_web_access_installation.yml
Sigma Transformation Error for 'PowerShell Web Access Installation - PsScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_recon_export.yml
Sigma Transformation Error for 'Recon Information for Export with PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_ssl_keyword.yml
Sigma Transformation Error for 'Suspicious SSL Connection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_clip.yml
Sigma Transformation Error for 'Invoke-Obfuscation CLIP+ Launcher - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_using_set_service_to_hide_services.yml
Sigma Transformation Error for 'Abuse of Service Permissions to Hide Services Via Set-Service - PS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_keywords.yml
Sigma Transformation Error for 'Potential Suspicious PowerShell Keywords': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_keylogger_activity.yml
Sigma Transformation Error for 'Potential Keylogger Activity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_wmimplant.yml
Sigma Transformation Error for 'WMImplant Hack Tool': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_mhsta.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use MSHTA - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_install_unsigned_appx_packages.yml
Sigma Transformation Error for 'Unsigned AppX Installation Attempt Using Add-AppxPackage - PsScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_as_rep_roasting.yml
Sigma Transformation Error for 'Get-ADUser Enumeration Using UserAccountControl Flags': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_add_windows_capability.yml
Sigma Transformation Error for 'Add Windows Capability Via PowerShell Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_stdin.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Stdin - Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_create_volume_shadow_copy.yml
Sigma Transformation Error for 'Create Volume Shadow Copy with Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_hktl_rubeus.yml
Sigma Transformation Error for 'HackTool - Rubeus Execution - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_amsi_null_bits_bypass.yml
Sigma Transformation Error for 'Potential AMSI Bypass Script Using NULL Bits': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_iofilestream.yml
Sigma Transformation Error for 'Suspicious IO.FileStream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_nishang_malicious_commandlets.yml
Sigma Transformation Error for 'Malicious Nishang PowerShell Commandlets': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml
Sigma Transformation Error for 'Powershell Create Scheduled Task': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_syncappvpublishingserver_exe.yml
Sigma Transformation Error for 'SyncAppvPublishingServer Execution to Bypass Powershell Restriction': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_enumerate_password_windows_credential_manager.yml
Sigma Transformation Error for 'Enumerate Credentials from Windows Credential Manager With PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_dnsexfiltration.yml
Sigma Transformation Error for 'Powershell DNSExfiltration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_user_discovery_get_aduser.yml
Sigma Transformation Error for 'User Discovery And Export Via Get-ADUser Cmdlet - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_clip.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Clip - Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_directory_enum.yml
Sigma Transformation Error for 'Powershell Directory Enumeration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_invoke_webrequest_useragent.yml
Sigma Transformation Error for 'Change User Agents with WebRequest': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_enable_psremoting.yml
Sigma Transformation Error for 'Enable Windows Remote Management': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_gettypefromclsid.yml
Sigma Transformation Error for 'Suspicious GetTypeFromCLSID ShellExecute': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_disable_windows_optional_feature.yml
Sigma Transformation Error for 'Disable-WindowsOptionalFeature Command PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_potential_unconstrained_delegation_discovery.yml
Sigma Transformation Error for 'Potential Unconstrained Delegation Discovery Via Get-ADComputer - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_zip_compress.yml
Sigma Transformation Error for 'Zip A Folder With PowerShell For Staging In Temp - PowerShell Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_wallpaper.yml
Sigma Transformation Error for 'Replace Desktop Wallpaper by Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_win32_product_install_msi.yml
Sigma Transformation Error for 'PowerShell WMI Win32_Product Install MSI': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_keylogging.yml
Sigma Transformation Error for 'Powershell Keylogging': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_mail_acces.yml
Sigma Transformation Error for 'Powershell Local Email Collection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_x509enrollment.yml
Sigma Transformation Error for 'Suspicious X509Enrollment - Ps Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_import_module_susp_dirs.yml
Sigma Transformation Error for 'Import PowerShell Modules From Suspicious Directories': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_stdin.yml
Sigma Transformation Error for 'Invoke-Obfuscation STDIN+ Launcher - Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_var.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_extracting.yml
Sigma Transformation Error for 'Extracting Information with PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_software_discovery.yml
Sigma Transformation Error for 'Detected Windows Software Discovery - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_start_process.yml
Sigma Transformation Error for 'Suspicious Start-Process PassThru': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_script_with_upload_capabilities.yml
Sigma Transformation Error for 'PowerShell Script With File Upload Capabilities': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_potential_invoke_mimikatz.yml
Sigma Transformation Error for 'Potential Invoke-Mimikatz PowerShell Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_process.yml
Sigma Transformation Error for 'Suspicious Process Discovery With Get-Process': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_malicious_commandlets.yml
Sigma Transformation Error for 'Malicious PowerShell Commandlets - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_download_com_cradles.yml
Sigma Transformation Error for 'Potential COM Objects Download Cradles Usage - PS Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_run_from_mount_diskimage.yml
Sigma Transformation Error for 'Suspicious Invoke-Item From Mount-DiskImage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_request_kerberos_ticket.yml
Sigma Transformation Error for 'Request A Single Ticket via PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_veeam_credential_dumping_script.yml
Sigma Transformation Error for 'Veeam Backup Servers Credential Dumping Script Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_enable_susp_windows_optional_feature.yml
Sigma Transformation Error for 'Potential Suspicious Windows Feature Enabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml
Sigma Transformation Error for 'PowerView PowerShell Cmdlets - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_shellintel_malicious_commandlets.yml
Sigma Transformation Error for 'Malicious ShellIntel PowerShell Commandlets': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_computer_discovery_get_adcomputer.yml
Sigma Transformation Error for 'Computer Discovery And Export Via Get-ADComputer Cmdlet - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_remotefxvgpudisablement_abuse.yml
Sigma Transformation Error for 'Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_remote_session_creation.yml
Sigma Transformation Error for 'PowerShell Remote Session Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_smb_share_reco.yml
Sigma Transformation Error for 'Suspicious Get Information for SMB Share': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_directorysearcher.yml
Sigma Transformation Error for 'DirectorySearcher Powershell Exploitation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_adrecon_execution.yml
Sigma Transformation Error for 'PowerShell ADRecon Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_local_group_reco.yml
Sigma Transformation Error for 'Suspicious Get Local Groups Information - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_addefaultdomainpasswordpolicy.yml
Sigma Transformation Error for 'Password Policy Discovery With Get-AdDefaultDomainPasswordPolicy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_clear_eventlog.yml
Sigma Transformation Error for 'Suspicious Eventlog Clear': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_psasyncshell.yml
Sigma Transformation Error for 'PSAsyncShell - Asynchronous TCP Reverse Shell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_apt_silence_eda.yml
Sigma Transformation Error for 'Silence.EDA Detection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_token_obfuscation.yml
Sigma Transformation Error for 'Powershell Token Obfuscation - Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_office_comobject_registerxll.yml
Sigma Transformation Error for 'Code Executed Via Office Add-in XLL File': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_win_api_susp_access.yml
Sigma Transformation Error for 'Potential WinAPI Calls Via PowerShell Scripts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_tamper_windows_defender_rem_mp.yml
Sigma Transformation Error for 'Tamper Windows Defender Remove-MpPreference - ScriptBlockLogging': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_add_dnsclient_rule.yml
Sigma Transformation Error for 'Powershell Add Name Resolution Policy Table Rule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_win32_shadowcopy_deletion.yml
Sigma Transformation Error for 'Deletion of Volume Shadow Copies via WMI with PowerShell - PS Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_win32_shadowcopy.yml
Sigma Transformation Error for 'Delete Volume Shadow Copies via WMI with PowerShell - PS Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_etw_trace_evasion.yml
Sigma Transformation Error for 'Disable of ETW Trace - Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_exchange_mailbox_smpt_forwarding_rule.yml
Sigma Transformation Error for 'Suspicious PowerShell Mailbox SMTP Forward Rule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_get_childitem_bookmarks.yml
Sigma Transformation Error for 'Automated Collection Bookmarks Using Get-ChildItem PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_new_psdrive.yml
Sigma Transformation Error for 'Suspicious New-PSDrive to Admin Share': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_aadinternals_cmdlets_execution.yml
Sigma Transformation Error for 'AADInternals PowerShell Cmdlets Execution - PsScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_windowstyle.yml
Sigma Transformation Error for 'Suspicious PowerShell WindowStyle Option': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_clear_powershell_history.yml
Sigma Transformation Error for 'Clear PowerShell History - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_hotfix_enum.yml
Sigma Transformation Error for 'PowerShell Hotfix Enumeration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_hyper_v_condlet.yml
Sigma Transformation Error for 'Suspicious Hyper-V Cmdlets': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_remove_adgroupmember.yml
Sigma Transformation Error for 'Remove Account From Domain Admin Group': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_timestomp.yml
Sigma Transformation Error for 'Powershell Timestomp': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_gpo.yml
Sigma Transformation Error for 'Suspicious GPO Discovery With Get-GPO': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_alias_obfscuation.yml
Sigma Transformation Error for 'Potential PowerShell Obfuscation Using Character Join': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_compress.yml
Sigma Transformation Error for 'Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_getprocess_lsass.yml
Sigma Transformation Error for 'PowerShell Get-Process LSASS in ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_get_process_security_software_discovery.yml
Sigma Transformation Error for 'Security Software Discovery Via Powershell Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_packet_capture.yml
Sigma Transformation Error for 'Potential Packet Capture Activity Via Start-NetEventSession - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_memorydump_getstoragediagnosticinfo.yml
Sigma Transformation Error for 'Live Memory Dump Using Powershell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_localuser.yml
Sigma Transformation Error for 'Powershell LocalAccount Manipulation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_user_profile_tampering.yml
Sigma Transformation Error for 'Potential Persistence Via PowerShell User Profile Using Add-Content': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_set_alias.yml
Sigma Transformation Error for 'Potential PowerShell Obfuscation Using Alias Cmdlets': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_directoryservices_accountmanagement.yml
Sigma Transformation Error for 'Manipulation of User Computer or Group Security Principals Across AD': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_mounted_share_deletion.yml
Sigma Transformation Error for 'PowerShell Deleted Mounted Share': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_proxy_scripts.yml
Sigma Transformation Error for 'Suspicious TCP Tunnel Via PowerShell Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_use_rundll32.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Rundll32 - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_mount_diskimage.yml
Sigma Transformation Error for 'Suspicious Mount-DiskImage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_windows_firewall_profile_disabled.yml
Sigma Transformation Error for 'Windows Firewall Profile Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_resolve_list_of_ip_from_file.yml
Sigma Transformation Error for 'PowerShell Script With File Hostname Resolving Capabilities': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_cor_profiler.yml
Sigma Transformation Error for 'Registry-Free Process Scope COR_PROFILER': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_win_defender_exclusions_added.yml
Sigma Transformation Error for 'Windows Defender Exclusions Added - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_wmi_persistence.yml
Sigma Transformation Error for 'Powershell WMI Persistence': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_shellcode_b64.yml
Sigma Transformation Error for 'PowerShell ShellCode': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_set_acl.yml
Sigma Transformation Error for 'PowerShell Script Change Permission Via Set-Acl - PsScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_write_eventlog.yml
Sigma Transformation Error for 'PowerShell Write-EventLog Usage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_set_policies_to_unsecure_level.yml
Sigma Transformation Error for 'Change PowerShell Policies to an Insecure Level - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_msxml_com.yml
Sigma Transformation Error for 'Powershell MsXml COM Object': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_invocation_specific.yml
Sigma Transformation Error for 'Suspicious PowerShell Invocations - Specific': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_copy_item_system_directory.yml
Sigma Transformation Error for 'Powershell Install a DLL in System Directory': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_store_file_in_alternate_data_stream.yml
Sigma Transformation Error for 'Powershell Store File In Alternate Data Stream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_icmp_exfiltration.yml
Sigma Transformation Error for 'PowerShell ICMP Exfiltration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_psattack.yml
Sigma Transformation Error for 'PowerShell PSAttack': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_follina_execution.yml
Sigma Transformation Error for 'Troubleshooting Pack Cmdlet Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_ntfs_ads_access.yml
Sigma Transformation Error for 'NTFS Alternate Data Stream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_active_directory_module_dll_import.yml
Sigma Transformation Error for 'Potential Active Directory Enumeration Using AD Module - PsScript': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_export_certificate.yml
Sigma Transformation Error for 'Certificate Exported Via PowerShell - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_sensitive_file_discovery.yml
Sigma Transformation Error for 'Powershell Sensitive File Discovery': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_detect_vm_env.yml
Sigma Transformation Error for 'Powershell Detect Virtualization Environment': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_ad_group_reco.yml
Sigma Transformation Error for 'AD Groups Or Users Enumeration Using PowerShell - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_networkcredential.yml
Sigma Transformation Error for 'Suspicious Connection to Remote Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_via_rundll.yml
Sigma Transformation Error for 'Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_unblock_file.yml
Sigma Transformation Error for 'Suspicious Unblock-File': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_create_local_user.yml
Sigma Transformation Error for 'PowerShell Create Local User': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_execute_batch_script.yml
Sigma Transformation Error for 'Powershell Execute Batch Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_dotnet_assembly_from_file.yml
Sigma Transformation Error for 'Potential In-Memory Execution Using Reflection.Assembly': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_command_remote.yml
Sigma Transformation Error for 'Execute Invoke-command on Remote Host': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_invoke_obfuscation_var.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR+ Launcher - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_frombase64string_archive.yml
Sigma Transformation Error for 'Suspicious FromBase64String Usage On Gzip Archive - Ps Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_get_adreplaccount.yml
Sigma Transformation Error for 'Suspicious Get-ADReplAccount': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_win32_pnpentity.yml
Sigma Transformation Error for 'Powershell Suspicious Win32_PnPEntity': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_amsi_bypass_pattern_nov22.yml
Sigma Transformation Error for 'AMSI Bypass Pattern Assembly GetType': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_wmi_unquoted_service_search.yml
Sigma Transformation Error for 'WMIC Unquoted Services Path Lookup - PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_get_adcomputer.yml
Sigma Transformation Error for 'Active Directory Computers Enumeration With Get-AdComputer': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_malicious_keywords.yml
Sigma Transformation Error for 'Malicious PowerShell Keywords': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_web_request_cmd_and_cmdlets.yml
Sigma Transformation Error for 'Usage Of Web Request Commands And Cmdlets - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_dump_password_windows_credential_manager.yml
Sigma Transformation Error for 'Dump Credentials from Windows Credential Manager With PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_get_acl_service.yml
Sigma Transformation Error for 'Service Registry Permissions Weakness Check': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_susp_ace_tampering.yml
Sigma Transformation Error for 'Potential Persistence Via Security Descriptors - ScriptBlock': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_script/posh_ps_clearing_windows_console_history.yml
Sigma Transformation Error for 'Clearing Windows Console History': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_var.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR+ Launcher - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_obfuscated_iex.yml
Sigma Transformation Error for 'Invoke-Obfuscation Obfuscated IEX Invocation - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_reset_computermachinepassword.yml
Sigma Transformation Error for 'Suspicious Computer Machine Password by PowerShell': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_download.yml
Sigma Transformation Error for 'Suspicious PowerShell Download - PoshModule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_malicious_commandlets.yml
Sigma Transformation Error for 'Malicious PowerShell Commandlets - PoshModule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_invocation_specific.yml
Sigma Transformation Error for 'Suspicious PowerShell Invocations - Specific - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_get_nettcpconnection.yml
Sigma Transformation Error for 'Use Get-NetTCPConnection - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_decompress_commands.yml
Sigma Transformation Error for 'PowerShell Decompress Commands': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_remotefxvgpudisablement_abuse.yml
Sigma Transformation Error for 'Potential RemoteFXvGPUDisablement.EXE Abuse - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_bad_opsec_artifacts.yml
Sigma Transformation Error for 'Bad Opsec Powershell Code Artifacts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_ad_group_reco.yml
Sigma Transformation Error for 'AD Groups Or Users Enumeration Using PowerShell - PoshModule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_clip.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Clip - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_clear_powershell_history.yml
Sigma Transformation Error for 'Clear PowerShell History - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_rundll32.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Rundll32 - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_hktl_evil_winrm_execution.yml
Sigma Transformation Error for 'HackTool - Evil-WinRm Execution - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_zip_compress.yml
Sigma Transformation Error for 'Zip A Folder With PowerShell For Staging In Temp  - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_rundll.yml
Sigma Transformation Error for 'Invoke-Obfuscation RUNDLL LAUNCHER - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_get_clipboard.yml
Sigma Transformation Error for 'PowerShell Get Clipboard': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_compress.yml
Sigma Transformation Error for 'Invoke-Obfuscation COMPRESS OBFUSCATION - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_active_directory_module_dll_import.yml
Sigma Transformation Error for 'Potential Active Directory Enumeration Using AD Module - PsModule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_smb_share_reco.yml
Sigma Transformation Error for 'Suspicious Get Information for SMB Share - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_remote_powershell_session.yml
Sigma Transformation Error for 'Remote PowerShell Session (PS Module)': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_use_mhsta.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use MSHTA - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_get_addbaccount.yml
Sigma Transformation Error for 'Suspicious Get-ADDBAccount Usage': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_alternate_powershell_hosts.yml
Sigma Transformation Error for 'Alternate PowerShell Hosts - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_stdin.yml
Sigma Transformation Error for 'Invoke-Obfuscation STDIN+ Launcher - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_stdin.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Stdin - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_syncappvpublishingserver_exe.yml
Sigma Transformation Error for 'SyncAppvPublishingServer Bypass Powershell Restriction - PS Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_invocation_generic.yml
Sigma Transformation Error for 'Suspicious PowerShell Invocations - Generic - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_clip.yml
Sigma Transformation Error for 'Invoke-Obfuscation CLIP+ Launcher - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_susp_local_group_reco.yml
Sigma Transformation Error for 'Suspicious Get Local Groups Information': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_exploit_scripts.yml
Sigma Transformation Error for 'Malicious PowerShell Scripts - PoshModule': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/powershell/powershell_module/posh_pm_invoke_obfuscation_via_var.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - PowerShell Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_python_based_tool.yml
Sigma Transformation Error for 'Credential Dumping Activity By Python Based Tool': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_dump_comsvcs_dll.yml
Sigma Transformation Error for 'Lsass Memory Dump via Comsvcs DLL': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_svchost_credential_dumping.yml
Sigma Transformation Error for 'Credential Dumping Attempt Via Svchost': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_uac_bypass_editionupgrademanagerobj.yml
Sigma Transformation Error for 'Function Call From Undocumented COM Interface EditionUpgradeManager': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_hktl_cobaltstrike_bof_injection_pattern.yml
Sigma Transformation Error for 'HackTool - CobaltStrike BOF Injection Pattern': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_hktl_littlecorporal_generated_maldoc.yml
Sigma Transformation Error for 'HackTool - LittleCorporal Generated Maldoc Injection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_werfault.yml
Sigma Transformation Error for 'Credential Dumping Attempt Via WerFault': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_hktl_sysmonente.yml
Sigma Transformation Error for 'HackTool - SysmonEnte Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_cmstp_execution_by_access.yml
Sigma Transformation Error for 'CMSTP Execution Process Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_hktl_handlekatz_lsass_access.yml
Sigma Transformation Error for 'HackTool - HandleKatz Duplicating LSASS Handle': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_seclogon_access.yml
Sigma Transformation Error for 'Suspicious LSASS Access Via MalSecLogon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_hktl_generic_access.yml
Sigma Transformation Error for 'HackTool - Generic Process Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_uac_bypass_wow64_logger.yml
Sigma Transformation Error for 'UAC Bypass Using WOW64 Logger DLL Hijack': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_dump_keyword_image.yml
Sigma Transformation Error for 'LSASS Memory Access by Tool With Dump Keyword In Name': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_memdump.yml
Sigma Transformation Error for 'Potential Credential Dumping Activity Via LSASS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_susp_access_flag.yml
Sigma Transformation Error for 'Potentially Suspicious GrantedAccess Flags On LSASS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_susp_all_access_uncommon_target.yml
Sigma Transformation Error for 'Uncommon Process Access Rights For Target Image': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_susp_direct_ntopenprocess_call.yml
Sigma Transformation Error for 'Potential Direct Syscall of NtOpenProcess': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_remote_access_trough_winrm.yml
Sigma Transformation Error for 'Remote LSASS Process Access Through Windows Remote Management': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_svchost_susp_access_request.yml
Sigma Transformation Error for 'Suspicious Svchost Process Access': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_access/proc_access_win_lsass_whitelisted_process_names.yml
Sigma Transformation Error for 'LSASS Access From Potentially White-Listed Processes': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_smadhook.yml
Potential SmadHook.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\SmadHook32c.dll" or FolderPath endswith "\\SmadHook64c.dll") and (not(((InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\SMADAV\\SmadavProtect32.exe", "C:\\Program Files (x86)\\SMADAV\\SmadavProtect64.exe", "C:\\Program Files\\SMADAV\\SmadavProtect32.exe", "C:\\Program Files\\SMADAV\\SmadavProtect64.exe")) and (FolderPath startswith "C:\\Program Files (x86)\\SMADAV\\" or FolderPath startswith "C:\\Program Files\\SMADAV\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_scrcons_wmi_scripteventconsumer.yml
WMI ActiveScriptEventConsumers Activity Via Scrcons.EXE DLL Load ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\vbscript.dll" or FolderPath endswith "\\wbemdisp.dll" or FolderPath endswith "\\wshom.ocx" or FolderPath endswith "\\scrrun.dll") and InitiatingProcessFolderPath endswith "\\scrcons.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_rjvplatform_default_location.yml
Potential RjvPlatform.DLL Sideloading From Default Location ---> KQL Query:
DeviceImageLoadEvents
| where InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\SystemResetPlatform\\SystemResetPlatform.exe" and FolderPath =~ "C:\\$SysReset\\Framework\\Stack\\RjvPlatform.dll"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_kerberos_dll_load.yml
Active Directory Kerberos DLL Loaded Via Office Application ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\kerberos.dll" and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_vsstrace_susp_load.yml
Potentially Suspicious Volume Shadow Copy Vsstrace.dll Load ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\vsstrace.dll" and (not((((InitiatingProcessFolderPath in~ ("C:\\Windows\\explorer.exe", "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe")) or (InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\Temp\\{" or InitiatingProcessFolderPath startswith "C:\\Windows\\WinSxS\\" or InitiatingProcessFolderPath startswith "C:\\ProgramData\\Package Cache\\{")) or (InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_system_management_automation_susp_load.yml
PowerShell Core DLL Loaded By Non PowerShell Process ---> KQL Query:
DeviceImageLoadEvents
| where (InitiatingProcessVersionInfoFileDescription =~ "System.Management.Automation" or InitiatingProcessVersionInfoOriginalFileName =~ "System.Management.Automation.dll" or (FolderPath endswith "\\System.Management.Automation.dll" or FolderPath endswith "\\System.Management.Automation.ni.dll")) and (not((((InitiatingProcessFolderPath contains ":\\Windows\\Microsoft.NET\\Framework\\" or InitiatingProcessFolderPath contains ":\\Windows\\Microsoft.NET\\Framework64\\") and InitiatingProcessFolderPath endswith "\\mscorsvw.exe") or (InitiatingProcessFolderPath endswith ":\\Program Files\\PowerShell\\7\\pwsh.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\dsac.exe" or InitiatingProcessFolderPath endswith ":\\WINDOWS\\System32\\RemoteFXvGPUDisablement.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\runscripthelper.exe" or InitiatingProcessFolderPath endswith ":\\WINDOWS\\System32\\sdiagnhost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\ServerManager.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\SyncAppvPublishingServer.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\winrshost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\wsmprovhost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\winrshost.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\wsmprovhost.exe")))) and (not((isnull(InitiatingProcessFolderPath) or InitiatingProcessFolderPath contains ":\\ProgramData\\chocolatey\\choco.exe" or InitiatingProcessFolderPath endswith "\\Citrix\\ConfigSync\\ConfigSyncRun.exe" or (InitiatingProcessFolderPath contains ":\\Windows\\Temp\\asgard2-agent\\" and (InitiatingProcessFolderPath endswith "\\thor64.exe" or InitiatingProcessFolderPath endswith "\\thor.exe")) or ((InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft SQL Server Management Studio" or InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft SQL Server Management Studio") and InitiatingProcessFolderPath endswith "\\IDE\\Ssms.exe") or ((InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft SQL Server\\" or InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft SQL Server\\") and InitiatingProcessFolderPath endswith "\\Tools\\Binn\\SQLPS.exe") or (InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft Visual Studio\\" or InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft Visual Studio\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_pcre_dotnet_dll_load.yml
PCRE.NET Package Image Load ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath contains "\\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_amsi_suspicious_process.yml
Amsi.DLL Loaded Via LOLBIN Process ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\amsi.dll" and (InitiatingProcessFolderPath endswith "\\ExtExport.exe" or InitiatingProcessFolderPath endswith "\\odbcconf.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_vbadll_load.yml
VBA DLL Loaded Via Office Application ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\VBE7.DLL" or FolderPath endswith "\\VBEUI.DLL" or FolderPath endswith "\\VBE7INTL.DLL") and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_hktl_sharpevtmute.yml
Unexpected Error processing 'HackTool - SharpEvtMute DLL Load' (sigma/rules/windows/image_load/image_load_hktl_sharpevtmute.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_mfdetours_unsigned.yml
Sigma Transformation Error for 'Unsigned Mfdetours.DLL Sideloading': Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_outlook_outlvba_load.yml
Microsoft VBA For Outlook Addin Loaded Via Outlook ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\outlvba.dll" and InitiatingProcessFolderPath endswith "\\outlook.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_mfdetours.yml
Potential Mfdetours.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\mfdetours.dll" and (not(FolderPath contains ":\\Program Files (x86)\\Windows Kits\\10\\bin\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_thor_unsigned_execution.yml
Sigma Transformation Error for 'Suspicious Unsigned Thor Scanner Execution': Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_wazuh.yml
Potential Wazuh Security Platform DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\libwazuhshared.dll" or FolderPath endswith "\\libwinpthread-1.dll") and (not((FolderPath startswith "C:\\Program Files\\" or FolderPath startswith "C:\\Program Files (x86)\\"))) and (not(((FolderPath contains "\\AppData\\Local\\" or FolderPath contains "\\ProgramData\\") and FolderPath endswith "\\mingw64\\bin\\libwinpthread-1.dll")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_shelldispatch.yml
Potential ShellDispatch.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\ShellDispatch.dll" and (not(((FolderPath contains ":\\Users\\" and FolderPath contains "\\AppData\\Local\\Temp\\") or FolderPath contains ":\\Windows\\Temp\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_comctl32.yml
Potential DLL Sideloading Via comctl32.dll ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\comctl32.dll" and (FolderPath startswith "C:\\Windows\\System32\\logonUI.exe.local\\" or FolderPath startswith "C:\\Windows\\System32\\werFault.exe.local\\" or FolderPath startswith "C:\\Windows\\System32\\consent.exe.local\\" or FolderPath startswith "C:\\Windows\\System32\\narrator.exe.local\\" or FolderPath startswith "C:\\windows\\system32\\wermgr.exe.local\\")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_vmware_xfer.yml
Potential DLL Sideloading Via VMware Xfer ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\glib-2.0.dll" and InitiatingProcessFolderPath endswith "\\VMwareXferlogs.exe") and (not(FolderPath startswith "C:\\Program Files\\VMware\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_hktl_silenttrinity_stager.yml
HackTool - SILENTTRINITY Stager DLL Load ---> KQL Query:
DeviceImageLoadEvents
| where InitiatingProcessVersionInfoFileDescription contains "st2stager"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_dsparse_dll_load.yml
Active Directory Parsing DLL Loaded Via Office Application ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath contains "\\dsparse.dll" and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_wsman_provider_image_load.yml
Suspicious WSMAN Provider Image Loads ---> KQL Query:
DeviceImageLoadEvents
| where (((FolderPath endswith "\\WsmSvc.dll" or FolderPath endswith "\\WsmAuto.dll" or FolderPath endswith "\\Microsoft.WSMan.Management.ni.dll") or (InitiatingProcessVersionInfoOriginalFileName in~ ("WsmSvc.dll", "WSMANAUTOMATION.DLL", "Microsoft.WSMan.Management.dll"))) or (InitiatingProcessFolderPath endswith "\\svchost.exe" and InitiatingProcessVersionInfoOriginalFileName =~ "WsmWmiPl.dll")) and (not((InitiatingProcessFolderPath startswith "C:\\Program Files\\Citrix\\" or (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\System32\\sdiagnhost.exe" or InitiatingProcessFolderPath endswith "C:\\Windows\\System32\\services.exe") or (InitiatingProcessFolderPath endswith "\\mscorsvw.exe" and (InitiatingProcessFolderPath startswith "C:\\Windows\\Microsoft.NET\\Framework64\\v" or InitiatingProcessFolderPath startswith "C:\\Windows\\Microsoft.NET\\Framework\\v")) or InitiatingProcessFolderPath startswith "C:\\Windows\\Temp\\asgard2-agent\\" or InitiatingProcessFolderPath endswith "\\powershell_ise.exe" or (InitiatingProcessCommandLine contains "svchost.exe -k netsvcs -p -s BITS" or InitiatingProcessCommandLine contains "svchost.exe -k GraphicsPerfSvcGroup -s GraphicsPerfSvc" or InitiatingProcessCommandLine contains "svchost.exe -k NetworkService -p -s Wecsvc" or InitiatingProcessCommandLine contains "svchost.exe -k netsvcs") or (InitiatingProcessFolderPath in~ ("C:\\Windows\\System32\\Configure-SMRemoting.exe", "C:\\Windows\\System32\\ServerManager.exe")) or InitiatingProcessFolderPath startswith "C:\\$WINDOWS.~BT\\Sources\\"))) and (not((InitiatingProcessFolderPath endswith "\\svchost.exe" and isnull(InitiatingProcessCommandLine))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_rstrtmgr_suspicious_load.yml
Load Of RstrtMgr.DLL By A Suspicious Process ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\RstrtMgr.dll" or InitiatingProcessVersionInfoOriginalFileName =~ "RstrtMgr.dll") and ((InitiatingProcessFolderPath contains ":\\Perflogs\\" or InitiatingProcessFolderPath contains ":\\Users\\Public\\" or InitiatingProcessFolderPath contains "\\Temporary Internet") or ((InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Favorites\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Favourites\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Contacts\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_dbgmodel.yml
Potential DLL Sideloading Of DbgModel.DLL ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\dbgmodel.dll" and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\"))) and (not((FolderPath startswith "C:\\Program Files\\WindowsApps\\Microsoft.WinDbg_" or (FolderPath startswith "C:\\Program Files (x86)\\Windows Kits\\" or FolderPath startswith "C:\\Program Files\\Windows Kits\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_iexplore_dcom_iertutil_dll_hijack.yml
Potential DCOM InternetExplorer.Application DLL Hijack - Image Load ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\Internet Explorer\\iertutil.dll" and InitiatingProcessFolderPath endswith "\\Internet Explorer\\iexplore.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_non_existent_dlls.yml
Sigma Transformation Error for 'Potential DLL Sideloading Of Non-Existent DLLs From System Folders': Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_susp_unsigned_dll.yml
Sigma Transformation Error for 'Unsigned DLL Loaded by Windows Utility': Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_excel_xll_susp_load.yml
Microsoft Excel Add-In Loaded From Uncommon Location ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath contains "\\Desktop\\" or FolderPath contains "\\Downloads\\" or FolderPath contains "\\Perflogs\\" or FolderPath contains "\\Temp\\" or FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\Windows\\Tasks\\") and FolderPath endswith ".xll" and InitiatingProcessFolderPath endswith "\\excel.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_dotnet_gac_dll_load.yml
GAC DLL Loaded Via Office Applications ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath startswith "C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL" and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_7za.yml
Potential 7za.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\7za.dll" and (not(((FolderPath startswith "C:\\Program Files (x86)\\" or FolderPath startswith "C:\\Program Files\\") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_ualapi.yml
Fax Service DLL Search Order Hijack ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "ualapi.dll" and InitiatingProcessFolderPath endswith "\\fxssvc.exe") and (not(FolderPath startswith "C:\\Windows\\WinSxS\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_cpl_from_non_system_location.yml
System Control Panel Item Loaded From Uncommon Location ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\hdwwiz.cpl" or FolderPath endswith "\\appwiz.cpl") and (not((FolderPath contains ":\\Windows\\System32\\" or FolderPath contains ":\\Windows\\SysWOW64\\" or FolderPath contains ":\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_susp_clickonce_unsigned_module_loaded.yml
Sigma Transformation Error for 'Unsigned Module Loaded by ClickOnce Application': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_aruba_networks_virtual_intranet_access.yml
Aruba Network Service Potential DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where ((FolderPath endswith "\\wtsapi32.dll" or FolderPath endswith "\\msvcr100.dll" or FolderPath endswith "\\msvcp100.dll" or FolderPath endswith "\\dbghelp.dll" or FolderPath endswith "\\dbgcore.dll" or FolderPath endswith "\\wininet.dll" or FolderPath endswith "\\iphlpapi.dll" or FolderPath endswith "\\version.dll" or FolderPath endswith "\\cryptsp.dll" or FolderPath endswith "\\cryptbase.dll" or FolderPath endswith "\\wldp.dll" or FolderPath endswith "\\profapi.dll" or FolderPath endswith "\\sspicli.dll" or FolderPath endswith "\\winsta.dll" or FolderPath endswith "\\dpapi.dll") and InitiatingProcessFolderPath endswith "\\arubanetsvc.exe") and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_solidpdfcreator.yml
Potential SolidPDFCreator.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\SolidPDFCreator.dll" and (not(((FolderPath startswith "C:\\Program Files (x86)\\SolidDocuments\\SolidPDFCreator\\" or FolderPath startswith "C:\\Program Files\\SolidDocuments\\SolidPDFCreator\\") and InitiatingProcessFolderPath endswith "\\SolidPDFCreator.exe")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_dotnet_assembly_dll_load.yml
DotNET Assembly DLL Loaded Via Office Application ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath startswith "C:\\Windows\\assembly\\" and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_mscorsvc.yml
Potential DLL Sideloading Of MsCorSvc.DLL ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\mscorsvc.dll" and (not((FolderPath startswith "C:\\Windows\\Microsoft.NET\\Framework\\" or FolderPath startswith "C:\\Windows\\Microsoft.NET\\Framework64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_rjvplatform_non_default_location.yml
Potential RjvPlatform.DLL Sideloading From Non-Default Location ---> KQL Query:
DeviceImageLoadEvents
| where (InitiatingProcessFolderPath =~ "\\SystemResetPlatform.exe" and FolderPath endswith "\\RjvPlatform.dll") and (not(InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\SystemResetPlatform\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_coregen.yml
Potential DLL Sideloading Using Coregen.exe ---> KQL Query:
DeviceImageLoadEvents
| where InitiatingProcessFolderPath endswith "\\coregen.exe" and (not((FolderPath startswith "C:\\Program Files (x86)\\Microsoft Silverlight\\" or FolderPath startswith "C:\\Program Files\\Microsoft Silverlight\\" or FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_gup_libcurl.yml
Potential DLL Sideloading Of Libcurl.DLL Via GUP.EXE ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\libcurl.dll" and InitiatingProcessFolderPath endswith "\\gup.exe") and (not(InitiatingProcessFolderPath endswith "\\Notepad++\\updater\\GUP.exe"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_ccleaner_reactivator.yml
Potential CCleanerReactivator.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\CCleanerReactivator.dll" and (not((InitiatingProcessFolderPath endswith "\\CCleanerReactivator.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\CCleaner\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\CCleaner\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_wmiprvse_wbemcomn_dll_hijack.yml
Wmiprvse Wbemcomn DLL Hijack ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\wbem\\wbemcomn.dll" and InitiatingProcessFolderPath endswith "\\wmiprvse.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_dbghelp_dbgcore_unsigned_load.yml
Sigma Transformation Error for 'Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_dbghelp.yml
Potential DLL Sideloading Of DBGHELP.DLL ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\dbghelp.dll" and (not((FolderPath startswith "C:\\Program Files (x86)\\" or FolderPath startswith "C:\\Program Files\\" or FolderPath startswith "C:\\Windows\\SoftwareDistribution\\" or FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SystemTemp\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\"))) and (not(((FolderPath endswith "\\Anaconda3\\Lib\\site-packages\\vtrace\\platforms\\windll\\amd64\\dbghelp.dll" or FolderPath endswith "\\Anaconda3\\Lib\\site-packages\\vtrace\\platforms\\windll\\i386\\dbghelp.dll") or (FolderPath endswith "\\Epic Games\\Launcher\\Engine\\Binaries\\ThirdParty\\DbgHelp\\dbghelp.dll" or FolderPath endswith "\\Epic Games\\MagicLegends\\x86\\dbghelp.dll"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_susp_dll_load_system_process.yml
DLL Load By System Process From Suspicious Locations ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath startswith "C:\\Users\\Public\\" or FolderPath startswith "C:\\PerfLogs\\") and InitiatingProcessFolderPath startswith "C:\\Windows\\"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_libvlc.yml
Potential Libvlc.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\libvlc.dll" and (not((FolderPath startswith "C:\\Program Files (x86)\\VideoLAN\\VLC\\" or FolderPath startswith "C:\\Program Files\\VideoLAN\\VLC\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_robform.yml
Potential RoboForm.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\roboform.dll" or FolderPath endswith "\\roboform-x64.dll") and (not(((InitiatingProcessFolderPath endswith "\\robotaskbaricon.exe" or InitiatingProcessFolderPath endswith "\\robotaskbaricon-x64.exe") and (InitiatingProcessFolderPath startswith " C:\\Program Files (x86)\\Siber Systems\\AI RoboForm\\" or InitiatingProcessFolderPath startswith " C:\\Program Files\\Siber Systems\\AI RoboForm\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_credui_uncommon_process_load.yml
CredUI.DLL Loaded By Uncommon Process ---> KQL Query:
DeviceImageLoadEvents
| where ((FolderPath endswith "\\credui.dll" or FolderPath endswith "\\wincredui.dll") or (InitiatingProcessVersionInfoOriginalFileName in~ ("credui.dll", "wincredui.dll"))) and (not(((InitiatingProcessFolderPath in~ ("C:\\Windows\\explorer.exe", "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe", "C:\\Windows\\regedit.exe")) or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\")))) and (not(((InitiatingProcessFolderPath contains "\\AppData\\Local\\Microsoft\\OneDrive\\" and InitiatingProcessFolderPath startswith "C:\\Users\\") or InitiatingProcessFolderPath endswith "\\opera_autoupdate.exe" or (InitiatingProcessFolderPath endswith "\\procexp64.exe" or InitiatingProcessFolderPath endswith "\\procexp.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Microsoft\\Teams\\" and InitiatingProcessFolderPath endswith "\\Teams.exe" and InitiatingProcessFolderPath startswith "C:\\Users\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_windows_defender.yml
Potential Mpclient.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\mpclient.dll" and (InitiatingProcessFolderPath endswith "\\MpCmdRun.exe" or InitiatingProcessFolderPath endswith "\\NisSrv.exe")) and (not((InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Windows Defender\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft Security Client\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Windows Defender\\" or InitiatingProcessFolderPath startswith "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_comsvcs_load_renamed_version_by_rundll32.yml
Unexpected Error processing 'Suspicious Renamed Comsvcs DLL Loaded By Rundll32' (sigma/rules/windows/image_load/image_load_dll_comsvcs_load_renamed_version_by_rundll32.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_uac_bypass_via_dism.yml
UAC Bypass With Fake DLL ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\dismcore.dll" and InitiatingProcessFolderPath endswith "\\dism.exe") and (not(FolderPath =~ "C:\\Windows\\System32\\Dism\\dismcore.dll"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_vivaldi_elf.yml
Potential Vivaldi_elf.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\vivaldi_elf.dll" and (not((FolderPath contains "\\Vivaldi\\Application\\" and InitiatingProcessFolderPath endswith "\\Vivaldi\\Application\\vivaldi.exe")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_tttracer_module_load.yml
Time Travel Debugging Utility Usage - Image ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\ttdrecord.dll" or FolderPath endswith "\\ttdwriter.dll" or FolderPath endswith "\\ttdloader.dll"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_antivirus.yml
Potential Antivirus Software DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\log.dll" and (not(((FolderPath startswith "C:\\Program Files\\Bitdefender Antivirus Free\\" or FolderPath startswith "C:\\Program Files (x86)\\Bitdefender Antivirus Free\\") or FolderPath startswith "C:\\Program Files\\Canon\\MyPrinter\\" or (InitiatingProcessFolderPath =~ "C:\\Program Files\\Dell\\SARemediation\\audit\\TelemetryUtility.exe" and (FolderPath in~ ("C:\\Program Files\\Dell\\SARemediation\\plugin\\log.dll", "C:\\Program Files\\Dell\\SARemediation\\audit\\log.dll"))))))) or (FolderPath endswith "\\qrt.dll" and (not((FolderPath startswith "C:\\Program Files\\F-Secure\\Anti-Virus\\" or FolderPath startswith "C:\\Program Files (x86)\\F-Secure\\Anti-Virus\\")))) or ((FolderPath endswith "\\ashldres.dll" or FolderPath endswith "\\lockdown.dll" or FolderPath endswith "\\vsodscpl.dll") and (not((FolderPath startswith "C:\\Program Files\\McAfee\\" or FolderPath startswith "C:\\Program Files (x86)\\McAfee\\")))) or (FolderPath endswith "\\vftrace.dll" and (not((FolderPath startswith "C:\\Program Files\\CyberArk\\Endpoint Privilege Manager\\Agent\\x32\\" or FolderPath startswith "C:\\Program Files (x86)\\CyberArk\\Endpoint Privilege Manager\\Agent\\x32\\")))) or (FolderPath endswith "\\wsc.dll" and (not((FolderPath startswith "C:\\program Files\\AVAST Software\\Avast\\" or FolderPath startswith "C:\\program Files (x86)\\AVAST Software\\Avast\\")))) or (FolderPath endswith "\\tmdbglog.dll" and (not((FolderPath startswith "C:\\program Files\\Trend Micro\\Titanium\\" or FolderPath startswith "C:\\program Files (x86)\\Trend Micro\\Titanium\\")))) or (FolderPath endswith "\\DLPPREM32.dll" and (not((FolderPath startswith "C:\\program Files\\ESET" or FolderPath startswith "C:\\program Files (x86)\\ESET"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_rundll32_remote_share_load.yml
Remote DLL Load Via Rundll32.EXE ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath startswith "\\\\" and InitiatingProcessFolderPath endswith "\\rundll32.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_classicexplorer32.yml
Potential DLL Sideloading Via ClassicExplorer32.dll ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\ClassicExplorer32.dll" and (not(FolderPath startswith "C:\\Program Files\\Classic Shell\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_edputil.yml
Potential Edputil.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\edputil.dll" and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_vmmap_dbghelp_unsigned.yml
Sigma Transformation Error for 'VMMap Unsigned Dbghelp.DLL Potential Sideloading': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_from_non_system_location.yml
Potential System DLL Sideloading From Non System Locations ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\aclui.dll" or FolderPath endswith "\\activeds.dll" or FolderPath endswith "\\adsldpc.dll" or FolderPath endswith "\\aepic.dll" or FolderPath endswith "\\apphelp.dll" or FolderPath endswith "\\applicationframe.dll" or FolderPath endswith "\\appvpolicy.dll" or FolderPath endswith "\\appxalluserstore.dll" or FolderPath endswith "\\appxdeploymentclient.dll" or FolderPath endswith "\\archiveint.dll" or FolderPath endswith "\\atl.dll" or FolderPath endswith "\\audioses.dll" or FolderPath endswith "\\auditpolcore.dll" or FolderPath endswith "\\authfwcfg.dll" or FolderPath endswith "\\authz.dll" or FolderPath endswith "\\avrt.dll" or FolderPath endswith "\\batmeter.dll" or FolderPath endswith "\\bcd.dll" or FolderPath endswith "\\bcp47langs.dll" or FolderPath endswith "\\bcp47mrm.dll" or FolderPath endswith "\\bcrypt.dll" or FolderPath endswith "\\bderepair.dll" or FolderPath endswith "\\bootmenuux.dll" or FolderPath endswith "\\bootux.dll" or FolderPath endswith "\\cabinet.dll" or FolderPath endswith "\\cabview.dll" or FolderPath endswith "\\certcli.dll" or FolderPath endswith "\\certenroll.dll" or FolderPath endswith "\\cfgmgr32.dll" or FolderPath endswith "\\cldapi.dll" or FolderPath endswith "\\clipc.dll" or FolderPath endswith "\\clusapi.dll" or FolderPath endswith "\\cmpbk32.dll" or FolderPath endswith "\\cmutil.dll" or FolderPath endswith "\\coloradapterclient.dll" or FolderPath endswith "\\colorui.dll" or FolderPath endswith "\\comdlg32.dll" or FolderPath endswith "\\configmanager2.dll" or FolderPath endswith "\\connect.dll" or FolderPath endswith "\\coredplus.dll" or FolderPath endswith "\\coremessaging.dll" or FolderPath endswith "\\coreuicomponents.dll" or FolderPath endswith "\\credui.dll" or FolderPath endswith "\\cryptbase.dll" or FolderPath endswith "\\cryptdll.dll" or FolderPath endswith "\\cryptsp.dll" or FolderPath endswith "\\cryptui.dll" or FolderPath endswith "\\cryptxml.dll" or FolderPath endswith "\\cscapi.dll" or FolderPath endswith "\\cscobj.dll" or FolderPath endswith "\\cscui.dll" or FolderPath endswith "\\d2d1.dll" or FolderPath endswith "\\d3d10_1.dll" or FolderPath endswith "\\d3d10_1core.dll" or FolderPath endswith "\\d3d10.dll" or FolderPath endswith "\\d3d10core.dll" or FolderPath endswith "\\d3d10warp.dll" or FolderPath endswith "\\d3d11.dll" or FolderPath endswith "\\d3d12.dll" or FolderPath endswith "\\d3d9.dll" or FolderPath endswith "\\d3dx9_43.dll" or FolderPath endswith "\\dataexchange.dll" or FolderPath endswith "\\davclnt.dll" or FolderPath endswith "\\dcntel.dll" or FolderPath endswith "\\dcomp.dll" or FolderPath endswith "\\defragproxy.dll" or FolderPath endswith "\\desktopshellext.dll" or FolderPath endswith "\\deviceassociation.dll" or FolderPath endswith "\\devicecredential.dll" or FolderPath endswith "\\devicepairing.dll" or FolderPath endswith "\\devobj.dll" or FolderPath endswith "\\devrtl.dll" or FolderPath endswith "\\dhcpcmonitor.dll" or FolderPath endswith "\\dhcpcsvc.dll" or FolderPath endswith "\\dhcpcsvc6.dll" or FolderPath endswith "\\directmanipulation.dll" or FolderPath endswith "\\dismapi.dll" or FolderPath endswith "\\dismcore.dll" or FolderPath endswith "\\dmcfgutils.dll" or FolderPath endswith "\\dmcmnutils.dll" or FolderPath endswith "\\dmcommandlineutils.dll" or FolderPath endswith "\\dmenrollengine.dll" or FolderPath endswith "\\dmenterprisediagnostics.dll" or FolderPath endswith "\\dmiso8601utils.dll" or FolderPath endswith "\\dmoleaututils.dll" or FolderPath endswith "\\dmprocessxmlfiltered.dll" or FolderPath endswith "\\dmpushproxy.dll" or FolderPath endswith "\\dmxmlhelputils.dll" or FolderPath endswith "\\dnsapi.dll" or FolderPath endswith "\\dot3api.dll" or FolderPath endswith "\\dot3cfg.dll" or FolderPath endswith "\\dpx.dll" or FolderPath endswith "\\drprov.dll" or FolderPath endswith "\\drvstore.dll" or FolderPath endswith "\\dsclient.dll" or FolderPath endswith "\\dsparse.dll" or FolderPath endswith "\\dsprop.dll" or FolderPath endswith "\\dsreg.dll" or FolderPath endswith "\\dsrole.dll" or FolderPath endswith "\\dui70.dll" or FolderPath endswith "\\duser.dll" or FolderPath endswith "\\dusmapi.dll" or FolderPath endswith "\\dwmapi.dll" or FolderPath endswith "\\dwmcore.dll" or FolderPath endswith "\\dwrite.dll" or FolderPath endswith "\\dxcore.dll" or FolderPath endswith "\\dxgi.dll" or FolderPath endswith "\\dxva2.dll" or FolderPath endswith "\\dynamoapi.dll" or FolderPath endswith "\\eappcfg.dll" or FolderPath endswith "\\eappprxy.dll" or FolderPath endswith "\\edgeiso.dll" or FolderPath endswith "\\edputil.dll" or FolderPath endswith "\\efsadu.dll" or FolderPath endswith "\\efsutil.dll" or FolderPath endswith "\\esent.dll" or FolderPath endswith "\\execmodelproxy.dll" or FolderPath endswith "\\explorerframe.dll" or FolderPath endswith "\\fastprox.dll" or FolderPath endswith "\\faultrep.dll" or FolderPath endswith "\\fddevquery.dll" or FolderPath endswith "\\feclient.dll" or FolderPath endswith "\\fhcfg.dll" or FolderPath endswith "\\fhsvcctl.dll" or FolderPath endswith "\\firewallapi.dll" or FolderPath endswith "\\flightsettings.dll" or FolderPath endswith "\\fltlib.dll" or FolderPath endswith "\\framedynos.dll" or FolderPath endswith "\\fveapi.dll" or FolderPath endswith "\\fveskybackup.dll" or FolderPath endswith "\\fvewiz.dll" or FolderPath endswith "\\fwbase.dll" or FolderPath endswith "\\fwcfg.dll" or FolderPath endswith "\\fwpolicyiomgr.dll" or FolderPath endswith "\\fwpuclnt.dll" or FolderPath endswith "\\fxsapi.dll" or FolderPath endswith "\\fxsst.dll" or FolderPath endswith "\\fxstiff.dll" or FolderPath endswith "\\getuname.dll" or FolderPath endswith "\\gpapi.dll" or FolderPath endswith "\\hid.dll" or FolderPath endswith "\\hnetmon.dll" or FolderPath endswith "\\httpapi.dll" or FolderPath endswith "\\icmp.dll" or FolderPath endswith "\\idstore.dll" or FolderPath endswith "\\ieadvpack.dll" or FolderPath endswith "\\iedkcs32.dll" or FolderPath endswith "\\iernonce.dll" or FolderPath endswith "\\iertutil.dll" or FolderPath endswith "\\ifmon.dll" or FolderPath endswith "\\ifsutil.dll" or FolderPath endswith "\\inproclogger.dll" or FolderPath endswith "\\iphlpapi.dll" or FolderPath endswith "\\iri.dll" or FolderPath endswith "\\iscsidsc.dll" or FolderPath endswith "\\iscsium.dll" or FolderPath endswith "\\isv.exe_rsaenh.dll" or FolderPath endswith "\\iumbase.dll" or FolderPath endswith "\\iumsdk.dll" or FolderPath endswith "\\joinutil.dll" or FolderPath endswith "\\kdstub.dll" or FolderPath endswith "\\ksuser.dll" or FolderPath endswith "\\ktmw32.dll" or FolderPath endswith "\\licensemanagerapi.dll" or FolderPath endswith "\\licensingdiagspp.dll" or FolderPath endswith "\\linkinfo.dll" or FolderPath endswith "\\loadperf.dll" or FolderPath endswith "\\lockhostingframework.dll" or FolderPath endswith "\\logoncli.dll" or FolderPath endswith "\\logoncontroller.dll" or FolderPath endswith "\\lpksetupproxyserv.dll" or FolderPath endswith "\\lrwizdll.dll" or FolderPath endswith "\\magnification.dll" or FolderPath endswith "\\maintenanceui.dll" or FolderPath endswith "\\mapistub.dll" or FolderPath endswith "\\mbaexmlparser.dll" or FolderPath endswith "\\mdmdiagnostics.dll" or FolderPath endswith "\\mfc42u.dll" or FolderPath endswith "\\mfcore.dll" or FolderPath endswith "\\mfplat.dll" or FolderPath endswith "\\mi.dll" or FolderPath endswith "\\midimap.dll" or FolderPath endswith "\\mintdh.dll" or FolderPath endswith "\\miutils.dll" or FolderPath endswith "\\mlang.dll" or FolderPath endswith "\\mmdevapi.dll" or FolderPath endswith "\\mobilenetworking.dll" or FolderPath endswith "\\mpr.dll" or FolderPath endswith "\\mprapi.dll" or FolderPath endswith "\\mrmcorer.dll" or FolderPath endswith "\\msacm32.dll" or FolderPath endswith "\\mscms.dll" or FolderPath endswith "\\mscoree.dll" or FolderPath endswith "\\msctf.dll" or FolderPath endswith "\\msctfmonitor.dll" or FolderPath endswith "\\msdrm.dll" or FolderPath endswith "\\msdtctm.dll" or FolderPath endswith "\\msftedit.dll" or FolderPath endswith "\\msi.dll" or FolderPath endswith "\\msiso.dll" or FolderPath endswith "\\msutb.dll" or FolderPath endswith "\\msvcp110_win.dll" or FolderPath endswith "\\mswb7.dll" or FolderPath endswith "\\mswsock.dll" or FolderPath endswith "\\msxml3.dll" or FolderPath endswith "\\mtxclu.dll" or FolderPath endswith "\\napinsp.dll" or FolderPath endswith "\\ncrypt.dll" or FolderPath endswith "\\ndfapi.dll" or FolderPath endswith "\\netapi32.dll" or FolderPath endswith "\\netid.dll" or FolderPath endswith "\\netiohlp.dll" or FolderPath endswith "\\netjoin.dll" or FolderPath endswith "\\netplwiz.dll" or FolderPath endswith "\\netprofm.dll" or FolderPath endswith "\\netprovfw.dll" or FolderPath endswith "\\netsetupapi.dll" or FolderPath endswith "\\netshell.dll" or FolderPath endswith "\\nettrace.dll" or FolderPath endswith "\\netutils.dll" or FolderPath endswith "\\networkexplorer.dll" or FolderPath endswith "\\newdev.dll" or FolderPath endswith "\\ninput.dll" or FolderPath endswith "\\nlaapi.dll" or FolderPath endswith "\\nlansp_c.dll" or FolderPath endswith "\\npmproxy.dll" or FolderPath endswith "\\nshhttp.dll" or FolderPath endswith "\\nshipsec.dll" or FolderPath endswith "\\nshwfp.dll" or FolderPath endswith "\\ntdsapi.dll" or FolderPath endswith "\\ntlanman.dll" or FolderPath endswith "\\ntlmshared.dll" or FolderPath endswith "\\ntmarta.dll" or FolderPath endswith "\\ntshrui.dll" or FolderPath endswith "\\oleacc.dll" or FolderPath endswith "\\omadmapi.dll" or FolderPath endswith "\\onex.dll" or FolderPath endswith "\\opcservices.dll" or FolderPath endswith "\\osbaseln.dll" or FolderPath endswith "\\osksupport.dll" or FolderPath endswith "\\osuninst.dll" or FolderPath endswith "\\p2p.dll" or FolderPath endswith "\\p2pnetsh.dll" or FolderPath endswith "\\p9np.dll" or FolderPath endswith "\\pcaui.dll" or FolderPath endswith "\\pdh.dll" or FolderPath endswith "\\peerdistsh.dll" or FolderPath endswith "\\pkeyhelper.dll" or FolderPath endswith "\\pla.dll" or FolderPath endswith "\\playsndsrv.dll" or FolderPath endswith "\\pnrpnsp.dll" or FolderPath endswith "\\policymanager.dll" or FolderPath endswith "\\polstore.dll" or FolderPath endswith "\\powrprof.dll" or FolderPath endswith "\\printui.dll" or FolderPath endswith "\\prntvpt.dll" or FolderPath endswith "\\profapi.dll" or FolderPath endswith "\\propsys.dll" or FolderPath endswith "\\proximitycommon.dll" or FolderPath endswith "\\proximityservicepal.dll" or FolderPath endswith "\\prvdmofcomp.dll" or FolderPath endswith "\\puiapi.dll" or FolderPath endswith "\\radcui.dll" or FolderPath endswith "\\rasapi32.dll" or FolderPath endswith "\\rasdlg.dll" or FolderPath endswith "\\rasgcw.dll" or FolderPath endswith "\\rasman.dll" or FolderPath endswith "\\rasmontr.dll" or FolderPath endswith "\\reagent.dll" or FolderPath endswith "\\regapi.dll" or FolderPath endswith "\\reseteng.dll" or FolderPath endswith "\\resetengine.dll" or FolderPath endswith "\\resutils.dll" or FolderPath endswith "\\rmclient.dll" or FolderPath endswith "\\rpcnsh.dll" or FolderPath endswith "\\rsaenh.dll" or FolderPath endswith "\\rtutils.dll" or FolderPath endswith "\\rtworkq.dll" or FolderPath endswith "\\samcli.dll" or FolderPath endswith "\\samlib.dll" or FolderPath endswith "\\sapi_onecore.dll" or FolderPath endswith "\\sas.dll" or FolderPath endswith "\\scansetting.dll" or FolderPath endswith "\\scecli.dll" or FolderPath endswith "\\schedcli.dll" or FolderPath endswith "\\secur32.dll" or FolderPath endswith "\\security.dll" or FolderPath endswith "\\sensapi.dll" or FolderPath endswith "\\shell32.dll" or FolderPath endswith "\\shfolder.dll" or FolderPath endswith "\\slc.dll" or FolderPath endswith "\\snmpapi.dll" or FolderPath endswith "\\spectrumsyncclient.dll" or FolderPath endswith "\\spp.dll" or FolderPath endswith "\\sppc.dll" or FolderPath endswith "\\sppcext.dll" or FolderPath endswith "\\srclient.dll" or FolderPath endswith "\\srcore.dll" or FolderPath endswith "\\srmtrace.dll" or FolderPath endswith "\\srpapi.dll" or FolderPath endswith "\\srvcli.dll" or FolderPath endswith "\\ssp_isv.exe_rsaenh.dll" or FolderPath endswith "\\ssp.exe_rsaenh.dll" or FolderPath endswith "\\sspicli.dll" or FolderPath endswith "\\ssshim.dll" or FolderPath endswith "\\staterepository.core.dll" or FolderPath endswith "\\structuredquery.dll" or FolderPath endswith "\\sxshared.dll" or FolderPath endswith "\\systemsettingsthresholdadminflowui.dll" or FolderPath endswith "\\tapi32.dll" or FolderPath endswith "\\tbs.dll" or FolderPath endswith "\\tdh.dll" or FolderPath endswith "\\textshaping.dll" or FolderPath endswith "\\timesync.dll" or FolderPath endswith "\\tpmcoreprovisioning.dll" or FolderPath endswith "\\tquery.dll" or FolderPath endswith "\\tsworkspace.dll" or FolderPath endswith "\\ttdrecord.dll" or FolderPath endswith "\\twext.dll" or FolderPath endswith "\\twinapi.dll" or FolderPath endswith "\\twinui.appcore.dll" or FolderPath endswith "\\uianimation.dll" or FolderPath endswith "\\uiautomationcore.dll" or FolderPath endswith "\\uireng.dll" or FolderPath endswith "\\uiribbon.dll" or FolderPath endswith "\\umpdc.dll" or FolderPath endswith "\\unattend.dll" or FolderPath endswith "\\updatepolicy.dll" or FolderPath endswith "\\upshared.dll" or FolderPath endswith "\\urlmon.dll" or FolderPath endswith "\\userenv.dll" or FolderPath endswith "\\utildll.dll" or FolderPath endswith "\\uxinit.dll" or FolderPath endswith "\\uxtheme.dll" or FolderPath endswith "\\vaultcli.dll" or FolderPath endswith "\\vdsutil.dll" or FolderPath endswith "\\version.dll" or FolderPath endswith "\\virtdisk.dll" or FolderPath endswith "\\vssapi.dll" or FolderPath endswith "\\vsstrace.dll" or FolderPath endswith "\\wbemprox.dll" or FolderPath endswith "\\wbemsvc.dll" or FolderPath endswith "\\wcmapi.dll" or FolderPath endswith "\\wcnnetsh.dll" or FolderPath endswith "\\wdi.dll" or FolderPath endswith "\\wdscore.dll" or FolderPath endswith "\\webservices.dll" or FolderPath endswith "\\wecapi.dll" or FolderPath endswith "\\wer.dll" or FolderPath endswith "\\wevtapi.dll" or FolderPath endswith "\\whhelper.dll" or FolderPath endswith "\\wimgapi.dll" or FolderPath endswith "\\winbio.dll" or FolderPath endswith "\\winbrand.dll" or FolderPath endswith "\\windows.storage.dll" or FolderPath endswith "\\windows.storage.search.dll" or FolderPath endswith "\\windows.ui.immersive.dll" or FolderPath endswith "\\windowscodecs.dll" or FolderPath endswith "\\windowscodecsext.dll" or FolderPath endswith "\\windowsudk.shellcommon.dll" or FolderPath endswith "\\winhttp.dll" or FolderPath endswith "\\wininet.dll" or FolderPath endswith "\\winipsec.dll" or FolderPath endswith "\\winmde.dll" or FolderPath endswith "\\winmm.dll" or FolderPath endswith "\\winnsi.dll" or FolderPath endswith "\\winrnr.dll" or FolderPath endswith "\\winscard.dll" or FolderPath endswith "\\winsqlite3.dll" or FolderPath endswith "\\winsta.dll" or FolderPath endswith "\\winsync.dll" or FolderPath endswith "\\wkscli.dll" or FolderPath endswith "\\wlanapi.dll" or FolderPath endswith "\\wlancfg.dll" or FolderPath endswith "\\wldp.dll" or FolderPath endswith "\\wlidprov.dll" or FolderPath endswith "\\wmiclnt.dll" or FolderPath endswith "\\wmidcom.dll" or FolderPath endswith "\\wmiutils.dll" or FolderPath endswith "\\wmpdui.dll" or FolderPath endswith "\\wmsgapi.dll" or FolderPath endswith "\\wofutil.dll" or FolderPath endswith "\\wpdshext.dll" or FolderPath endswith "\\wscapi.dll" or FolderPath endswith "\\wsdapi.dll" or FolderPath endswith "\\wshbth.dll" or FolderPath endswith "\\wshelper.dll" or FolderPath endswith "\\wsmsvc.dll" or FolderPath endswith "\\wtsapi32.dll" or FolderPath endswith "\\wwancfg.dll" or FolderPath endswith "\\wwapi.dll" or FolderPath endswith "\\xmllite.dll" or FolderPath endswith "\\xolehlp.dll" or FolderPath endswith "\\xpsservices.dll" or FolderPath endswith "\\xwizards.dll" or FolderPath endswith "\\xwtpw32.dll" or FolderPath endswith "\\amsi.dll" or FolderPath endswith "\\appraiser.dll" or FolderPath endswith "\\COMRES.DLL" or FolderPath endswith "\\cryptnet.dll" or FolderPath endswith "\\DispBroker.dll" or FolderPath endswith "\\dsound.dll" or FolderPath endswith "\\dxilconv.dll" or FolderPath endswith "\\FxsCompose.dll" or FolderPath endswith "\\FXSRESM.DLL" or FolderPath endswith "\\msdtcVSp1res.dll" or FolderPath endswith "\\PrintIsolationProxy.dll" or FolderPath endswith "\\rdpendp.dll" or FolderPath endswith "\\rpchttp.dll" or FolderPath endswith "\\storageusage.dll" or FolderPath endswith "\\utcutil.dll" or FolderPath endswith "\\WfsR.dll" or FolderPath endswith "\\igd10iumd64.dll" or FolderPath endswith "\\igd12umd64.dll" or FolderPath endswith "\\igdumdim64.dll" or FolderPath endswith "\\igdusc64.dll" or FolderPath endswith "\\TSMSISrv.dll" or FolderPath endswith "\\TSVIPSrv.dll" or FolderPath endswith "\\wbemcomn.dll" or FolderPath endswith "\\WLBSCTRL.dll" or FolderPath endswith "\\wow64log.dll" or FolderPath endswith "\\WptsExtensions.dll") and (not(((FolderPath endswith "\\version.dll" and FolderPath startswith "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\") or (FolderPath endswith "\\d3dx9_43.dll" and FolderPath startswith "C:\\Program Files\\WindowsApps\\Microsoft.DirectXRuntime_") or (FolderPath endswith "\\cscui.dll" and FolderPath startswith "C:\\Windows\\Microsoft.NET\\") or (FolderPath contains "C:\\$WINDOWS.~BT\\" or FolderPath contains "C:\\$WinREAgent\\" or FolderPath contains "C:\\Windows\\SoftwareDistribution\\" or FolderPath contains "C:\\Windows\\System32\\" or FolderPath contains "C:\\Windows\\SystemTemp\\" or FolderPath contains "C:\\Windows\\SysWOW64\\" or FolderPath contains "C:\\Windows\\WinSxS\\")))) and (not((((FolderPath endswith "\\mi.dll" or FolderPath endswith "\\miutils.dl") and FolderPath startswith "C:\\Program Files\\Arsenal-Image-Mounter-") or FolderPath startswith "C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\" or (FolderPath endswith "\\PolicyManager.dll" and (FolderPath startswith "C:\\Program Files\\CheckPoint\\" or FolderPath startswith "C:\\Program Files (x86)\\CheckPoint\\") and InitiatingProcessFolderPath endswith "\\SmartConsole.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\CheckPoint\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\CheckPoint\\")) or (FolderPath startswith "C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs" and (InitiatingProcessFolderPath contains "C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs" or InitiatingProcessFolderPath contains "C:\\Windows\\System32\\backgroundTaskHost.exe")) or (InitiatingProcessFolderPath endswith "\\wldp.dll" and InitiatingProcessFolderPath startswith "C:\\Program Files\\WindowsApps\\DellInc.DellSupportAssistforPCs") or (FolderPath endswith "\\mswb7.dll" and FolderPath startswith "C:\\Program Files\\Microsoft\\Exchange Server\\") or (InitiatingProcessFolderPath =~ "C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\OfficeClickToRun.exe" and FolderPath =~ "C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\AppVPolicy.dll"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_azure_microsoft_account_token_provider_dll_load.yml
Potential Azure Browser SSO Abuse ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath =~ "C:\\Windows\\System32\\MicrosoftAccountTokenProvider.dll" and (not((InitiatingProcessFolderPath endswith "\\BackgroundTaskHost.exe" and (InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\")))) and (not(((InitiatingProcessFolderPath endswith "\\IDE\\devenv.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft Visual Studio\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft Visual Studio\\")) or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe", "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"))) or ((InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\EdgeCore\\")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "C:\\Program Files\\Internet Explorer\\iexplore.exe")) or isnull(InitiatingProcessFolderPath) or InitiatingProcessFolderPath endswith "\\AppData\\Local\\Microsoft\\OneDrive\\OneDrive.exe")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_vmguestlib.yml
Sigma Transformation Error for 'VMGuestLib DLL Sideload': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_vssapi_susp_load.yml
Suspicious Volume Shadow Copy Vssapi.dll Load ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\vssapi.dll" and (not(((InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\") or InitiatingProcessFolderPath startswith "C:\\ProgramData\\Package Cache\\" or ((InitiatingProcessFolderPath in~ ("C:\\Windows\\explorer.exe", "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe")) or (InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\Temp\\{" or InitiatingProcessFolderPath startswith "C:\\Windows\\WinSxS\\")))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_iviewers.yml
Potential Iviewers.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\iviewers.dll" and (not((FolderPath startswith "C:\\Program Files (x86)\\Windows Kits\\" or FolderPath startswith "C:\\Program Files\\Windows Kits\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_uac_bypass_iscsicpl.yml
UAC Bypass Using Iscsicpl - ImageLoad ---> KQL Query:
DeviceImageLoadEvents
| where (InitiatingProcessFolderPath =~ "C:\\Windows\\SysWOW64\\iscsicpl.exe" and FolderPath endswith "\\iscsiexe.dll") and (not((FolderPath contains "C:\\Windows\\" and FolderPath contains "iscsiexe.dll")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_rcdll.yml
Potential Rcdll.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\rcdll.dll" and (not((FolderPath startswith "C:\\Program Files (x86)\\Microsoft Visual Studio\\" or FolderPath startswith "C:\\Program Files (x86)\\Windows Kits\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_spoolsv_dll_load.yml
Windows Spooler Service Suspicious Binary Load ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath contains "\\Windows\\System32\\spool\\drivers\\x64\\3\\" or FolderPath contains "\\Windows\\System32\\spool\\drivers\\x64\\4\\") and FolderPath endswith ".dll" and InitiatingProcessFolderPath endswith "\\spoolsv.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_python.yml
Sigma Transformation Error for 'Potential Python DLL SideLoading': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_susp_script_dotnet_clr_dll_load.yml
DotNet CLR DLL Loaded By Scripting Applications ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\clr.dll" or FolderPath endswith "\\mscoree.dll" or FolderPath endswith "\\mscorlib.dll") and (InitiatingProcessFolderPath endswith "\\cmstp.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\msxsl.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\wmic.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_cmstp_load_dll_from_susp_location.yml
DLL Loaded From Suspicious Location Via Cmspt.EXE ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath contains "\\PerfLogs\\" or FolderPath contains "\\ProgramData\\" or FolderPath contains "\\Users\\" or FolderPath contains "\\Windows\\Temp\\" or FolderPath contains "C:\\Temp\\") and (FolderPath endswith ".dll" or FolderPath endswith ".ocx") and InitiatingProcessFolderPath endswith "\\cmstp.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_ccleaner_du.yml
Potential CCleanerDU.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\CCleanerDU.dll" and (not(((InitiatingProcessFolderPath endswith "\\CCleaner.exe" or InitiatingProcessFolderPath endswith "\\CCleaner64.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files\\CCleaner\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\CCleaner\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_wmi_persistence_commandline_event_consumer.yml
WMI Persistence - Command Line Event Consumer ---> KQL Query:
DeviceImageLoadEvents
| where InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe" and FolderPath endswith "\\wbemcons.dll"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_office_dlls.yml
Microsoft Office DLL Sideload ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\outllib.dll" and (not((FolderPath startswith "C:\\Program Files\\Microsoft Office\\OFFICE" or FolderPath startswith "C:\\Program Files (x86)\\Microsoft Office\\OFFICE" or FolderPath startswith "C:\\Program Files\\Microsoft Office\\Root\\OFFICE" or FolderPath startswith "C:\\Program Files (x86)\\Microsoft Office\\Root\\OFFICE")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_keyscrambler.yml
Sigma Transformation Error for 'Potential DLL Sideloading Of KeyScramblerIE.DLL Via KeyScrambler.EXE': Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_goopdate.yml
Potential Goopdate.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\goopdate.dll" and (not((FolderPath startswith "C:\\Program Files (x86)\\" or FolderPath startswith "C:\\Program Files\\"))) and (not(((FolderPath contains "\\AppData\\Local\\Temp\\GUM" and FolderPath contains ".tmp\\goopdate.dll") and (InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\GUM" and InitiatingProcessFolderPath contains ".tmp\\Dropbox"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_rstrtmgr_uncommon_load.yml
Load Of RstrtMgr.DLL By An Uncommon Process ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\RstrtMgr.dll" or InitiatingProcessVersionInfoOriginalFileName =~ "RstrtMgr.dll") and (not((InitiatingProcessFolderPath contains ":\\Windows\\Temp\\" or (InitiatingProcessFolderPath contains ":\\$WINDOWS.~BT\\" or InitiatingProcessFolderPath contains ":\\$WinREAgent\\" or InitiatingProcessFolderPath contains ":\\Program Files (x86)\\" or InitiatingProcessFolderPath contains ":\\Program Files\\" or InitiatingProcessFolderPath contains ":\\ProgramData\\" or InitiatingProcessFolderPath contains ":\\Windows\\explorer.exe" or InitiatingProcessFolderPath contains ":\\Windows\\SoftwareDistribution\\" or InitiatingProcessFolderPath contains ":\\Windows\\SysNative\\" or InitiatingProcessFolderPath contains ":\\Windows\\System32\\" or InitiatingProcessFolderPath contains ":\\Windows\\SysWOW64\\" or InitiatingProcessFolderPath contains ":\\Windows\\WinSxS\\" or InitiatingProcessFolderPath contains ":\\WUDownloadCache\\") or ((InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\is-" and InitiatingProcessFolderPath contains ".tmp\\") and InitiatingProcessFolderPath endswith ".tmp"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_wmic_remote_xsl_scripting_dlls.yml
WMIC Loading Scripting Libraries ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\jscript.dll" or FolderPath endswith "\\vbscript.dll") and InitiatingProcessFolderPath endswith "\\wmic.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_powershell_dll_load.yml
PowerShell Core DLL Loaded Via Office Application ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath contains "\\System.Management.Automation.Dll" or FolderPath contains "\\System.Management.Automation.ni.Dll") and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_eacore.yml
Potential EACore.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\EACore.dll" and (not((FolderPath startswith "C:\\Program Files\\Electronic Arts\\EA Desktop\\" and (InitiatingProcessFolderPath contains "C:\\Program Files\\Electronic Arts\\EA Desktop\\" and InitiatingProcessFolderPath contains "\\EACoreServer.exe"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_mpsvc.yml
Potential DLL Sideloading Of MpSvc.DLL ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\MpSvc.dll" and (not((FolderPath startswith "C:\\Program Files\\Windows Defender\\" or FolderPath startswith "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_wwlib.yml
Potential WWlib.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\wwlib.dll" and (not(((FolderPath startswith "C:\\Program Files (x86)\\Microsoft Office\\" or FolderPath startswith "C:\\Program Files\\Microsoft Office\\") and InitiatingProcessFolderPath endswith "\\winword.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft Office\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft Office\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_appverifui.yml
Potential appverifUI.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\appverifUI.dll" and (not(((InitiatingProcessFolderPath in~ ("C:\\Windows\\SysWOW64\\appverif.exe", "C:\\Windows\\System32\\appverif.exe")) and (FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_jsschhlp.yml
Potential DLL Sideloading Via JsSchHlp ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\JSESPR.dll" and (not(FolderPath startswith "C:\\Program Files\\Common Files\\Justsystem\\JsSchHlp\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_waveedit.yml
Potential Waveedit.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\waveedit.dll" and (not(((InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Nero\\Nero Apps\\Nero WaveEditor\\waveedit.exe", "C:\\Program Files\\Nero\\Nero Apps\\Nero WaveEditor\\waveedit.exe")) and (FolderPath startswith "C:\\Program Files (x86)\\Nero\\Nero Apps\\Nero WaveEditor\\" or FolderPath startswith "C:\\Program Files\\Nero\\Nero Apps\\Nero WaveEditor\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_lsass_unsigned_image_load.yml
Sigma Transformation Error for 'Unsigned Image Loaded Into LSASS Process': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_abused_dlls_susp_paths.yml
Abusable DLL Potential Sideloading From Suspicious Location ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\coreclr.dll" or FolderPath endswith "\\facesdk.dll" or FolderPath endswith "\\HPCustPartUI.dll" or FolderPath endswith "\\libcef.dll" or FolderPath endswith "\\ZIPDLL.dll") and ((FolderPath contains ":\\Perflogs\\" or FolderPath contains ":\\Users\\Public\\" or FolderPath contains "\\Temporary Internet" or FolderPath contains "\\Windows\\Temp\\") or ((FolderPath contains ":\\Users\\" and FolderPath contains "\\Favorites\\") or (FolderPath contains ":\\Users\\" and FolderPath contains "\\Favourites\\") or (FolderPath contains ":\\Users\\" and FolderPath contains "\\Contacts\\") or (FolderPath contains ":\\Users\\" and FolderPath contains "\\Pictures\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_sdiageng_load_by_msdt.yml
Diagnostic Library Sdiageng.DLL Loaded By Msdt.EXE ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\sdiageng.dll" and InitiatingProcessFolderPath endswith "\\msdt.exe"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_dll_vss_ps_susp_load.yml
Suspicious Volume Shadow Copy VSS_PS.dll Load ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\vss_ps.dll" and (not((isnull(InitiatingProcessFolderPath) or ((InitiatingProcessFolderPath endswith "\\clussvc.exe" or InitiatingProcessFolderPath endswith "\\dismhost.exe" or InitiatingProcessFolderPath endswith "\\dllhost.exe" or InitiatingProcessFolderPath endswith "\\inetsrv\\appcmd.exe" or InitiatingProcessFolderPath endswith "\\inetsrv\\iissetup.exe" or InitiatingProcessFolderPath endswith "\\msiexec.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\searchindexer.exe" or InitiatingProcessFolderPath endswith "\\srtasks.exe" or InitiatingProcessFolderPath endswith "\\svchost.exe" or InitiatingProcessFolderPath endswith "\\System32\\SystemPropertiesAdvanced.exe" or InitiatingProcessFolderPath endswith "\\taskhostw.exe" or InitiatingProcessFolderPath endswith "\\thor.exe" or InitiatingProcessFolderPath endswith "\\thor64.exe" or InitiatingProcessFolderPath endswith "\\tiworker.exe" or InitiatingProcessFolderPath endswith "\\vssvc.exe" or InitiatingProcessFolderPath endswith "\\WmiPrvSE.exe" or InitiatingProcessFolderPath endswith "\\wsmprovhost.exe") and InitiatingProcessFolderPath startswith "C:\\Windows\\") or (InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\") or (InitiatingProcessCommandLine contains "\\dismhost.exe {" and InitiatingProcessCommandLine startswith "C:\\$WinREAgent\\Scratch\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_office_dotnet_clr_dll_load.yml
CLR DLL Loaded Via Office Applications ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath contains "\\clr.dll" and (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mspub.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\onenoteim.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe")

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_susp_python_image_load.yml
Python Image Load By Non-Python Process ---> KQL Query:
DeviceImageLoadEvents
| where InitiatingProcessVersionInfoFileDescription =~ "Python Core" and (not((InitiatingProcessFolderPath contains "Python" or (InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\ProgramData\\Anaconda3\\")))) and (not(isnull(InitiatingProcessFolderPath)))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_clfs_load.yml
Clfs.SYS Loaded By Process Located In a Potential Suspicious Location ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\clfs.sys" and ((InitiatingProcessFolderPath contains ":\\Perflogs\\" or InitiatingProcessFolderPath contains ":\\Users\\Public\\" or InitiatingProcessFolderPath contains "\\Temporary Internet" or InitiatingProcessFolderPath contains "\\Windows\\Temp\\") or ((InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Favorites\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Favourites\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Contacts\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Pictures\\")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_avkkid.yml
Potential AVKkid.DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\AVKkid.dll" and (not(((FolderPath startswith "C:\\Program Files (x86)\\G DATA\\" or FolderPath startswith "C:\\Program Files\\G DATA\\") and (InitiatingProcessFolderPath contains "C:\\Program Files (x86)\\G DATA\\" or InitiatingProcessFolderPath contains "C:\\Program Files\\G DATA\\") and InitiatingProcessFolderPath endswith "\\AVKKid.exe")))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_third_party.yml
Third Party Software DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where (FolderPath endswith "\\commfunc.dll" and (not((FolderPath contains "\\AppData\\local\\Google\\Chrome\\Application\\" or (FolderPath startswith "C:\\Program Files\\Lenovo\\Communications Utility\\" or FolderPath startswith "C:\\Program Files (x86)\\Lenovo\\Communications Utility\\"))))) or (FolderPath endswith "\\tosbtkbd.dll" and (not((FolderPath startswith "C:\\Program Files\\Toshiba\\Bluetooth Toshiba Stack\\" or FolderPath startswith "C:\\Program Files (x86)\\Toshiba\\Bluetooth Toshiba Stack\\"))))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_shell_chrome_api.yml
DLL Sideloading Of ShellChromeAPI.DLL ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\ShellChromeAPI.dll"

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_dbgcore.yml
Potential DLL Sideloading Of DBGCORE.DLL ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\dbgcore.dll" and (not((FolderPath startswith "C:\\Program Files (x86)\\" or FolderPath startswith "C:\\Program Files\\" or FolderPath startswith "C:\\Windows\\SoftwareDistribution\\" or FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SystemTemp\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\"))) and (not(FolderPath endswith "\\Steam\\bin\\cef\\cef.win7x64\\dbgcore.dll"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_chrome_frame_helper.yml
Potential Chrome Frame Helper DLL Sideloading ---> KQL Query:
DeviceImageLoadEvents
| where FolderPath endswith "\\chrome_frame_helper.dll" and (not((FolderPath startswith "C:\\Program Files\\Google\\Chrome\\Application\\" or FolderPath startswith "C:\\Program Files (x86)\\Google\\Chrome\\Application\\"))) and (not(FolderPath contains "\\AppData\\local\\Google\\Chrome\\Application\\"))

----------------------------------------
Processing: sigma/rules/windows/image_load/image_load_side_load_vmmap_dbghelp_signed.yml
Sigma Transformation Error for 'VMMap Signed Dbghelp.DLL Potential Sideloading': Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: Signed. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: Signature. Invalid SigmaDetectionItem field name encountered: SignatureStatus. Please use valid fields for the DeviceImageLoadEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, Hashes, Image, ImageLoaded, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/raw_access_thread/raw_access_thread_susp_disk_access_using_uncommon_tools.yml
Sigma Transformation Error for 'Potential Defense Evasion Via Raw Disk Access By Uncommon Tools': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_ie_security_zone_protocol_defaults_downgrade.yml
IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData contains "DWORD (0x00000000)" and RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults" and (RegistryKey endswith "\\http" or RegistryKey endswith "\\https")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_comhijack_sdclt.yml
COM Hijack via Sdclt ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Classes\\Folder\\shell\\open\\command\\DelegateExecute"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_autologger_sessions.yml
Potential AutoLogger Sessions Tampering ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\System\\CurrentControlSet\\Control\\WMI\\Autologger*" and (RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey contains "\\EventLog-" or RegistryKey contains "\\Defender") and (RegistryKey endswith "\\Enable" or RegistryKey endswith "\\Start"))) and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\wevtutil.exe"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_bginfo_custom_db.yml
New BgInfo.EXE Custom DB Path Registry Configuration ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "RegistryValueSet" and RegistryKey endswith "\\Software\\Winternals\\BGInfo\\Database"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_comhijack_psfactorybuffer.yml
Potential PSFactoryBuffer COM Hijacking ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\CLSID\\{c90250f3-4d7d-4991-9b69-a5c5bc1c2ae6}\\InProcServer32\\(Default)" and (not((RegistryValueData in~ ("%windir%\\System32\\ActXPrxy.dll", "C:\\Windows\\System32\\ActXPrxy.dll"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_bginfo_custom_vbscript.yml
New BgInfo.EXE Custom VBScript Registry Configuration ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData startswith "4" and ActionType =~ "RegistryValueSet" and RegistryKey endswith "\\Software\\Winternals\\BGInfo\\UserFields*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_legalnotice_susp_message.yml
Potential Ransomware Activity Using LegalNotice Message ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "encrypted" or RegistryValueData contains "Unlock-Password" or RegistryValueData contains "paying") and (RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeCaption" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeText")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hide_scheduled_task_via_index_tamper.yml
Hide Schedule Task Via Index Value Tamper ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree*" and RegistryKey contains "Index")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_delegateexecute.yml
Bypass UAC Using DelegateExecute ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "(Empty)" and RegistryKey endswith "\\open\\command\\DelegateExecute"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_enabling_turnoffcheck.yml
Scripted Diagnostics Turn Off Check Enabled - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics\\TurnOffCheck"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_keyboard_layout_load.yml
Suspicious Keyboard Layout Load ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "00000429" or RegistryValueData contains "00050429" or RegistryValueData contains "0000042a") and (RegistryKey endswith "\\Keyboard Layout\\Preload*" or RegistryKey endswith "\\Keyboard Layout\\Substitutes*")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disallowrun_execution.yml
Add DisallowRun Execution to Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_appx_debugger.yml
Potential Persistence Using DebugPath ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "Classes\\ActivatableClasses\\Package\\Microsoft." and RegistryKey endswith "\\DebugPath") or (RegistryKey contains "\\Software\\Microsoft\\Windows\\CurrentVersion\\PackagedAppXDebug\\Microsoft." and RegistryKey endswith "\\(Default)")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_shim_database_uncommon_location.yml
Potential Persistence Via Shim Database In Uncommon Location ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB*" and RegistryKey contains "\\DatabasePath") and (not(RegistryValueData contains ":\\Windows\\AppPatch\\Custom"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hvci_disallowed_images.yml
Driver Added To Disallowed Images In HVCI - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Control\\CI*" and RegistryKey contains "\\HVCIDisallowedImages"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_fax_change_service_user.yml
Change User Account Associated with the FAX Service ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey =~ "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet001\\Services\\Fax\\ObjectName" and (not(RegistryValueData contains "NetworkService"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_outlook_enable_unsafe_client_mail_rules.yml
Outlook EnableUnsafeClientMailRules Setting Enabled - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Outlook\\Security\\EnableUnsafeClientMailRules"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_suspicious_env_variables.yml
Suspicious Environment Variable Has Been Registered ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData in~ ("powershell", "pwsh")) or (RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "C:\\Users\\Public\\" or RegistryValueData contains "TVqQAAMAAAAEAAAA" or RegistryValueData contains "TVpQAAIAAAAEAA8A" or RegistryValueData contains "TVqAAAEAAAAEABAA" or RegistryValueData contains "TVoAAAAAAAAAAAAA" or RegistryValueData contains "TVpTAQEAAAAEAAAA" or RegistryValueData contains "SW52b2tlL" or RegistryValueData contains "ludm9rZS" or RegistryValueData contains "JbnZva2Ut" or RegistryValueData contains "SQBuAHYAbwBrAGUALQ" or RegistryValueData contains "kAbgB2AG8AawBlAC0A" or RegistryValueData contains "JAG4AdgBvAGsAZQAtA") or (RegistryValueData startswith "SUVY" or RegistryValueData startswith "SQBFAF" or RegistryValueData startswith "SQBuAH" or RegistryValueData startswith "cwBhA" or RegistryValueData startswith "aWV4" or RegistryValueData startswith "aQBlA" or RegistryValueData startswith "R2V0" or RegistryValueData startswith "dmFy" or RegistryValueData startswith "dgBhA" or RegistryValueData startswith "dXNpbm" or RegistryValueData startswith "H4sIA" or RegistryValueData startswith "Y21k" or RegistryValueData startswith "cABhAH" or RegistryValueData startswith "Qzpc" or RegistryValueData startswith "Yzpc")) and RegistryKey endswith "\\Environment*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_session_manager.yml
Session Manager Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\System\\CurrentControlSet\\Control\\Session Manager" and (RegistryKey contains "\\SetupExecute" or RegistryKey contains "\\S0InitialCommand" or RegistryKey contains "\\KnownDlls" or RegistryKey contains "\\Execute" or RegistryKey contains "\\BootExecute" or RegistryKey contains "\\AppCertDlls") and (not(RegistryValueData =~ "(Empty)"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_disable_python_security_warnings.yml
Python Function Execution Security Warning Disabled In Excel - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Microsoft\\Office*" and RegistryKey endswith "\\Excel\\Security\\PythonFunctionWarnings"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_wdigest_enable_uselogoncredential.yml
Wdigest Enable UseLogonCredential ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "WDigest\\UseLogonCredential"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_windows_defender_service.yml
Windows Defender Service Disabled - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000004)" and RegistryKey endswith "\\Services\\WinDefend\\Start"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_rpcrt4_etw_tamper.yml
ETW Logging Disabled For rpcrt4.dll ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData in~ ("DWORD (0x00000000)", "DWORD (0x00000002)")) and RegistryKey endswith "\\Microsoft\\Windows NT\\Rpc\\ExtErrorInformation"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_eventviewer.yml
Bypass UAC Using Event Viewer ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "_Classes\\mscfile\\shell\\open\\command\\(Default)" and (not(RegistryValueData startswith "%SystemRoot%\\system32\\mmc.exe \"%1\" %"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_ime_suspicious_paths.yml
Suspicious Path In Keyboard Layout IME File Registry Value ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Control\\Keyboard Layouts*" and RegistryKey contains "Ime File") and ((RegistryValueData contains ":\\Perflogs\\" or RegistryValueData contains ":\\Users\\Public\\" or RegistryValueData contains ":\\Windows\\Temp\\" or RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "\\AppData\\Roaming\\" or RegistryValueData contains "\\Temporary Internet") or ((RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Favorites\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Favourites\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Contacts\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_suppress_defender_notifications.yml
Activate Suppression of Windows Security Center Notifications ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\\Notification_Suppress"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_winget_enable_local_manifest.yml
Enable Local Manifest Installation With Winget ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\AppInstaller\\EnableLocalManifestFiles"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_devdrv_disallow_antivirus_filter.yml
Antivirus Filter Driver Disallowed On Dev Drive - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "\\FilterManager\\FltmgrDevDriveAllowAntivirusFilter"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_policies_associations_tamper.yml
Potential Attachment Manager Settings Associations Tamper ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Associations*" and ((RegistryValueData =~ "DWORD (0x00006152)" and RegistryKey endswith "\\DefaultFileTypeRisk") or ((RegistryValueData contains ".zip;" or RegistryValueData contains ".rar;" or RegistryValueData contains ".exe;" or RegistryValueData contains ".bat;" or RegistryValueData contains ".com;" or RegistryValueData contains ".cmd;" or RegistryValueData contains ".reg;" or RegistryValueData contains ".msi;" or RegistryValueData contains ".htm;" or RegistryValueData contains ".html;") and RegistryKey endswith "\\LowRiskFileTypes"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hide_function_user.yml
Registry Hide Function from User ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowInfoTip" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowCompColor")) or (RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideClock" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAHealth" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCANetwork" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAPower" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAVolume"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_com_hijacking_builtin.yml
COM Object Hijacking Via Modification Of Default System CLSID Default Value ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryKey endswith "\\{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}*" or RegistryKey endswith "\\{2155fee3-2419-4373-b102-6843707eb41f}*" or RegistryKey endswith "\\{4590f811-1d3a-11d0-891f-00aa004b2e24}*" or RegistryKey endswith "\\{4de225bf-cf59-4cfc-85f7-68b90f185355}*" or RegistryKey endswith "\\{ddc05a5a-351a-4e06-8eaf-54ec1bc2dcea}*" or RegistryKey endswith "\\{F56F6FDD-AA9D-4618-A949-C1B91AF43B1A}*" or RegistryKey endswith "\\{F82B4EF1-93A9-4DDE-8015-F7950A1A6E31}*" or RegistryKey endswith "\\{7849596a-48ea-486e-8937-a2a3009f31a9}*" or RegistryKey endswith "\\{0b91a74b-ad7c-4a9d-b563-29eef9167172}*" or RegistryKey endswith "\\{603D3801-BD81-11d0-A3A5-00C04FD706EC}*") and (RegistryKey endswith "\\CLSID*" and (RegistryKey endswith "\\InprocServer32\\(Default)" or RegistryKey endswith "\\LocalServer32\\(Default)"))) and ((RegistryValueData contains ":\\Perflogs\\" or RegistryValueData contains "\\AppData\\Local\\" or RegistryValueData contains "\\Desktop\\" or RegistryValueData contains "\\Downloads\\" or RegistryValueData contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\" or RegistryValueData contains "\\System32\\spool\\drivers\\color\\" or RegistryValueData contains "\\Temporary Internet" or RegistryValueData contains "\\Users\\Public\\" or RegistryValueData contains "\\Windows\\Temp\\" or RegistryValueData contains "%appdata%" or RegistryValueData contains "%temp%" or RegistryValueData contains "%tmp%") or ((RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Favorites\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Favourites\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Contacts\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Pictures\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_app_cpmpat_layer_registerapprestart.yml
Potential Persistence Via AppCompat RegisterAppRestart Layer ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData contains "REGISTERAPPRESTART" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_administrative_share.yml
Disable Administrative Share Creation at Startup ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "\\Services\\LanmanServer\\Parameters*" and (RegistryKey endswith "\\AutoShareWks" or RegistryKey endswith "\\AutoShareServer")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_system_restore.yml
Registry Disable System Restore ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey contains "\\Policies\\Microsoft\\Windows NT\\SystemRestore" or RegistryKey contains "\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore") and (RegistryKey endswith "DisableConfig" or RegistryKey endswith "DisableSR")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_deviceguard_hypervisorenforcedcodeintegrity_disabled.yml
Hypervisor Enforced Code Integrity Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\Microsoft\\Windows\\DeviceGuard\\HypervisorEnforcedCodeIntegrity" or RegistryKey endswith "\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity" or RegistryKey endswith "\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\\Enabled")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_bginfo_custom_wmi_query.yml
New BgInfo.EXE Custom WMI Query Registry Configuration ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData startswith "6" and ActionType =~ "RegistryValueSet" and RegistryKey endswith "\\Software\\Winternals\\BGInfo\\UserFields*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_internet_explorer.yml
Internet Explorer Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Software\\Wow6432Node\\Microsoft\\Internet Explorer" or RegistryKey contains "\\Software\\Microsoft\\Internet Explorer") and (RegistryKey contains "\\Toolbar" or RegistryKey contains "\\Extensions" or RegistryKey contains "\\Explorer Bars") and (not((RegistryValueData =~ "(Empty)" or (RegistryKey contains "\\Extensions\\{2670000A-7350-4f3c-8081-5663EE0C6C49}" or RegistryKey contains "\\Extensions\\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}" or RegistryKey contains "\\Extensions\\{789FE86F-6FC4-46A1-9849-EDE0DB0C95CA}" or RegistryKey contains "\\Extensions\\{A95fe080-8f5d-11d2-a20b-00aa003c157a}") or (RegistryKey endswith "\\Toolbar\\ShellBrowser\\ITBar7Layout" or RegistryKey endswith "\\Toolbar\\ShowDiscussionButton" or RegistryKey endswith "\\Toolbar\\Locked"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_outlook_todaypage.yml
Potential Persistence Via Outlook Today Page ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "Software\\Microsoft\\Office*" and RegistryKey endswith "\\Outlook\\Today*") and ((RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Stamp") or (RegistryKey endswith "\\URL" or RegistryKey endswith "\\UserDefinedUrl")) and (not((InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentcontrolset.yml
CurrentControlSet Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\SYSTEM\\CurrentControlSet\\Control" and (RegistryKey contains "\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram" or RegistryKey contains "\\Terminal Server\\Wds\\rdpwd\\StartupPrograms" or RegistryKey contains "\\SecurityProviders\\SecurityProviders" or RegistryKey contains "\\SafeBoot\\AlternateShell" or RegistryKey contains "\\Print\\Providers" or RegistryKey contains "\\Print\\Monitors" or RegistryKey contains "\\NetworkProvider\\Order" or RegistryKey contains "\\Lsa\\Notification Packages" or RegistryKey contains "\\Lsa\\Authentication Packages" or RegistryKey contains "\\BootVerificationProgram\\ImagePath")) and (not((((RegistryValueData in~ ("cpwmon64_v40.dll", "CutePDF Writer")) and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\spoolsv.exe" and RegistryKey contains "\\Print\\Monitors\\CutePDF Writer Monitor") or RegistryValueData =~ "(Empty)" or (InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\spoolsv.exe" and RegistryKey contains "Print\\Monitors\\Appmon\\Ports\\Microsoft.Office.OneNote_" and (InitiatingProcessAccountName contains "AUTHORI" or InitiatingProcessAccountName contains "AUTORI")) or (InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\poqexec.exe" and RegistryKey endswith "\\NetworkProvider\\Order\\ProviderOrder") or (RegistryValueData =~ "VNCpm.dll" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\spoolsv.exe" and RegistryKey endswith "\\Print\\Monitors\\MONVNC\\Driver"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_netsh_helper_dll_potential_persistence.yml
Potential Persistence Via Netsh Helper DLL - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData contains ".dll" and RegistryKey contains "\\SOFTWARE\\Microsoft\\NetSh"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_optimize_file_sharing_network.yml
MaxMpxCt Registry Value Changed ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Services\\LanmanServer\\Parameters\\MaxMpxCt"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_dot_net_etw_tamper.yml
ETW Logging Disabled In .NET Processes - Sysmon Registry ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData in~ ("0", "DWORD (0x00000000)")) and (RegistryKey endswith "\\COMPlus_ETWEnabled" or RegistryKey endswith "\\COMPlus_ETWFlags")) or (RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_eventvwr.yml
UAC Bypass via Event Viewer ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\mscfile\\shell\\open\\command"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_trust_record_susp_location.yml
Macro Enabled In A Potentially Suspicious Document ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "/AppData/Local/Microsoft/Windows/INetCache/" or RegistryKey contains "/AppData/Local/Temp/" or RegistryKey contains "/PerfLogs/" or RegistryKey contains "C:/Users/Public/" or RegistryKey contains "file:///D:/" or RegistryKey contains "file:///E:/") and RegistryKey contains "\\Security\\Trusted Documents\\TrustRecords"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_provisioning_command_abuse.yml
Potential Provisioning Registry Key Abuse For Binary Proxy Execution - REG ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Provisioning\\Commands*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_treatas_persistence.yml
COM Hijacking via TreatAs ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "TreatAs\\(Default)" and (not(((InitiatingProcessFolderPath in~ ("C:\\Windows\\system32\\msiexec.exe", "C:\\Windows\\SysWOW64\\msiexec.exe")) or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\") or InitiatingProcessFolderPath =~ "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe" or InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\svchost.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_trusted_location_uncommon.yml
Uncommon Microsoft Office Trusted Location Added ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "Security\\Trusted Locations\\Location" and RegistryKey endswith "\\Path") and (not(((InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft Office\\" or InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft Office\\") or (InitiatingProcessFolderPath contains ":\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" and InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe")))) and (not((RegistryValueData contains "%APPDATA%\\Microsoft\\Templates" or RegistryValueData contains "%%APPDATA%%\\Microsoft\\Templates" or RegistryValueData contains "%APPDATA%\\Microsoft\\Word\\Startup" or RegistryValueData contains "%%APPDATA%%\\Microsoft\\Word\\Startup" or RegistryValueData contains ":\\Program Files (x86)\\Microsoft Office\\root\\Templates\\" or RegistryValueData contains ":\\Program Files\\Microsoft Office (x86)\\Templates" or RegistryValueData contains ":\\Program Files\\Microsoft Office\\root\\Templates\\" or RegistryValueData contains ":\\Program Files\\Microsoft Office\\Templates\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node.yml
Wow6432Node CurrentVersion Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion" and (RegistryKey contains "\\ShellServiceObjectDelayLoad" or RegistryKey endswith "\\Run*" or RegistryKey endswith "\\RunOnce*" or RegistryKey endswith "\\RunOnceEx*" or RegistryKey endswith "\\RunServices*" or RegistryKey endswith "\\RunServicesOnce*" or RegistryKey contains "\\Explorer\\ShellServiceObjects" or RegistryKey contains "\\Explorer\\ShellIconOverlayIdentifiers" or RegistryKey contains "\\Explorer\\ShellExecuteHooks" or RegistryKey contains "\\Explorer\\SharedTaskScheduler" or RegistryKey contains "\\Explorer\\Browser Helper Objects")) and (not(((RegistryValueData endswith ".exe\" /burn.runonce" and RegistryValueData startswith "\"C:\\ProgramData\\Package Cache\\" and InitiatingProcessFolderPath contains "\\windowsdesktop-runtime-" and (RegistryKey endswith "\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}" or RegistryKey endswith "\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{7037b699-7382-448c-89a7-4765961d2537}")) or (RegistryValueData endswith "-A251-47B7-93E1-CDD82E34AF8B}" or RegistryValueData =~ "grpconv -o" or (RegistryValueData contains "C:\\Program Files" and RegistryValueData contains "\\Dropbox\\Client\\Dropbox.exe" and RegistryValueData contains " /systemstartup")) or (InitiatingProcessFolderPath contains "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\Install\\{" and InitiatingProcessFolderPath contains "\\setup.exe") or RegistryValueData =~ "(Empty)" or RegistryKey endswith "\\Explorer\\Browser Helper Objects\\{92EF2EAD-A7CE-4424-B0DB-499CF856608E}\\NoExplorer" or RegistryValueData startswith "\"C:\\ProgramData\\Package Cache\\{d21a4f20-968a-4b0c-bf04-a38da5f06e41}\\windowsdesktop-runtime-" or (InitiatingProcessFolderPath =~ "C:\\WINDOWS\\system32\\msiexec.exe" and RegistryKey endswith "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run*") or (InitiatingProcessFolderPath =~ "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\OfficeClickToRun.exe" and RegistryKey endswith "\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Wow6432Node*") or ((InitiatingProcessFolderPath in~ ("C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe", "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe")) and RegistryKey endswith "\\Explorer\\Browser Helper Objects\\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}*") or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\")) or (InitiatingProcessFolderPath startswith "C:\\Windows\\Installer\\MSI" and RegistryKey contains "\\Explorer\\Browser Helper Objects") or (RegistryValueData endswith " /burn.runonce" and (InitiatingProcessFolderPath contains "\\winsdksetup.exe" or InitiatingProcessFolderPath contains "\\windowsdesktop-runtime-" or InitiatingProcessFolderPath contains "\\AspNetCoreSharedFrameworkBundle-") and (InitiatingProcessFolderPath startswith "C:\\ProgramData\\Package Cache" or InitiatingProcessFolderPath startswith "C:\\Windows\\Temp\\")) or (RegistryValueData endswith "}\\VC_redist.x64.exe\" /burn.runonce" and InitiatingProcessFolderPath endswith "\\VC_redist.x64.exe"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_renamed_sysinternals_eula_accepted.yml
Usage of Renamed Sysinternals Tools - RegistrySet ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryKey contains "\\PsExec" or RegistryKey contains "\\ProcDump" or RegistryKey contains "\\Handle" or RegistryKey contains "\\LiveKd" or RegistryKey contains "\\Process Explorer" or RegistryKey contains "\\PsLoglist" or RegistryKey contains "\\PsPasswd" or RegistryKey contains "\\Active Directory Explorer") and RegistryKey endswith "\\EulaAccepted") and (not((InitiatingProcessFolderPath endswith "\\PsExec.exe" or InitiatingProcessFolderPath endswith "\\PsExec64.exe" or InitiatingProcessFolderPath endswith "\\procdump.exe" or InitiatingProcessFolderPath endswith "\\procdump64.exe" or InitiatingProcessFolderPath endswith "\\handle.exe" or InitiatingProcessFolderPath endswith "\\handle64.exe" or InitiatingProcessFolderPath endswith "\\livekd.exe" or InitiatingProcessFolderPath endswith "\\livekd64.exe" or InitiatingProcessFolderPath endswith "\\procexp.exe" or InitiatingProcessFolderPath endswith "\\procexp64.exe" or InitiatingProcessFolderPath endswith "\\psloglist.exe" or InitiatingProcessFolderPath endswith "\\psloglist64.exe" or InitiatingProcessFolderPath endswith "\\pspasswd.exe" or InitiatingProcessFolderPath endswith "\\pspasswd64.exe" or InitiatingProcessFolderPath endswith "\\ADExplorer.exe" or InitiatingProcessFolderPath endswith "\\ADExplorer64.exe"))) and (not(isnull(InitiatingProcessFolderPath)))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_netsh_help_dll_persistence_susp_location.yml
New Netsh Helper DLL Registered From A Suspicious Location ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Microsoft\\NetSh" and ((RegistryValueData contains ":\\Perflogs\\" or RegistryValueData contains ":\\Users\\Public\\" or RegistryValueData contains ":\\Windows\\Temp\\" or RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "\\Temporary Internet") or ((RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Favorites\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Favourites\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Contacts\\") or (RegistryValueData contains ":\\Users\\" and RegistryValueData contains "\\Pictures\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_mycomputer.yml
Potential Persistence Via MyComputer Registry Keys ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer" and RegistryKey endswith "(Default)"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_disable.yml
UAC Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion_nt.yml
CurrentVersion NT Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" and (RegistryKey contains "\\Winlogon\\VmApplet" or RegistryKey contains "\\Winlogon\\Userinit" or RegistryKey contains "\\Winlogon\\Taskman" or RegistryKey contains "\\Winlogon\\Shell" or RegistryKey contains "\\Winlogon\\GpExtensions" or RegistryKey contains "\\Winlogon\\AppSetup" or RegistryKey contains "\\Winlogon\\AlternateShells\\AvailableShells" or RegistryKey contains "\\Windows\\IconServiceLib" or RegistryKey contains "\\Windows\\Appinit_Dlls" or RegistryKey contains "\\Image File Execution Options" or RegistryKey contains "\\Font Drivers" or RegistryKey contains "\\Drivers32" or RegistryKey contains "\\Windows\\Run" or RegistryKey contains "\\Windows\\Load") and (not(((InitiatingProcessFolderPath endswith "\\MicrosoftEdgeUpdate.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\Temp\\") or RegistryValueData =~ "(Empty)" or (RegistryKey endswith "\\Image File Execution Options*" and (RegistryKey endswith "\\DisableExceptionChainValidation" or RegistryKey endswith "\\MitigationOptions")) or ((RegistryKey endswith "\\ClickToRunStore\\HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion*" or RegistryKey endswith "\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion*") or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe", "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"))) or (InitiatingProcessFolderPath endswith "\\ngen.exe" and InitiatingProcessFolderPath startswith "C:\\Windows\\Microsoft.NET\\Framework") or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\")) or (RegistryValueData endswith "\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe\"" and RegistryValueData startswith "C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\" and InitiatingProcessFolderPath endswith "\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdater\\OneDriveSetup.exe" and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Delete Cached Update Binary") or ((RegistryValueData in~ ("DWORD (0x00000009)", "DWORD (0x000003c0)")) and InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\svchost.exe" and (RegistryKey contains "\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\PreviousPolicyAreas" or RegistryKey contains "\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\MaxNoGPOListChangesInterval")))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_winsock2.yml
WinSock2 Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters" and (RegistryKey contains "\\Protocol_Catalog9\\Catalog_Entries" or RegistryKey contains "\\NameSpace_Catalog5\\Catalog_Entries") and (not((RegistryValueData =~ "(Empty)" or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\MsiExec.exe" or InitiatingProcessFolderPath =~ "C:\\Windows\\syswow64\\MsiExec.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_enable_windows_recall.yml
Windows Recall Feature Enabled - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "\\Software\\Policies\\Microsoft\\Windows\\WindowsAI\\DisableAIDataAnalysis"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_powershell_execution_policy.yml
Potential PowerShell Execution Policy Tampering ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData contains "Bypass" or RegistryValueData contains "Unrestricted") and (RegistryKey endswith "\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy" or RegistryKey endswith "\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy")) and (not((InitiatingProcessFolderPath contains ":\\Windows\\System32\\" or InitiatingProcessFolderPath contains ":\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_xll.yml
Potential Persistence Via Excel Add-in - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData endswith ".xll" and RegistryValueData startswith "/R " and RegistryKey endswith "Software\\Microsoft\\Office*" and RegistryKey endswith "\\Excel\\Options"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_service_installed.yml
Suspicious Service Installed ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey in~ ("HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet001\\Services\\NalDrv\\ImagePath", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet001\\Services\\PROCEXP152\\ImagePath")) and (not((RegistryValueData contains "\\WINDOWS\\system32\\Drivers\\PROCEXP152.SYS" and (InitiatingProcessFolderPath endswith "\\procexp64.exe" or InitiatingProcessFolderPath endswith "\\procexp.exe" or InitiatingProcessFolderPath endswith "\\procmon64.exe" or InitiatingProcessFolderPath endswith "\\procmon.exe" or InitiatingProcessFolderPath endswith "\\handle.exe" or InitiatingProcessFolderPath endswith "\\handle64.exe"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disabled_microsoft_defender_eventlog.yml
Disabled Windows Defender Eventlog ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Windows Defender/Operational\\Enabled"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_wab_dllpath_reg_change.yml
Execution DLL of Choice Using WAB.EXE ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Software\\Microsoft\\WAB\\DLLPath" and (not(RegistryValueData =~ "%CommonProgramFiles%\\System\\wab32.dll"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_terminal_server_suspicious.yml
RDP Sensitive Settings Changed to Zero ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\fDenyTSConnections" or RegistryKey endswith "\\fSingleSessionPerUser" or RegistryKey endswith "\\UserAuthentication")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_sentinelone_shell_context_tampering.yml
Potential SentinelOne Shell Context Menu Scan Command Tampering ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\shell\\SentinelOneScan\\command*" and (not(((InitiatingProcessFolderPath endswith "C:\\Program Files\\SentinelOne\\" or InitiatingProcessFolderPath endswith "C:\\Program Files (x86)\\SentinelOne\\") or (RegistryValueData contains "\\SentinelScanFromContextMenu.exe" and (RegistryValueData startswith "C:\\Program Files\\SentinelOne\\Sentinel Agent" or RegistryValueData startswith "C:\\Program Files (x86)\\SentinelOne\\Sentinel Agent")))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_enable_periodic_backup.yml
Periodic Backup For System Registry Hives Enabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Control\\Session Manager\\Configuration Manager\\EnablePeriodicBackup"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_custom_protocol_handler.yml
Potential Persistence Via Custom Protocol Handler ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData startswith "URL:" and RegistryKey =~ "HKEY_LOCAL_MACHINE\\CLASSES*") and (not(((InitiatingProcessFolderPath startswith "C:\\Program Files (x86)" or InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\") or RegistryValueData startswith "URL:ms-")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_change_rdp_port.yml
Default RDP Port Changed to Non Standard Port ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\PortNumber" and (not(RegistryValueData =~ "DWORD (0x00000d3d)"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_lsa_disablerestrictedadmin.yml
RestrictedAdminMode Registry Value Tampering ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "System\\CurrentControlSet\\Control\\Lsa\\DisableRestrictedAdmin"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_shim_database.yml
Potential Persistence Via Shim Database Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Custom*") and (not(RegistryValueData =~ ""))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_windows_defender_tamper.yml
Disable Windows Defender Functionalities Via Registry Keys ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows Defender*" or RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center*" or RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\Windows Defender*") and ((RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\DisallowExploitProtectionOverride" or RegistryKey endswith "\\Features\\TamperProtection" or RegistryKey endswith "\\MpEngine\\MpEnablePus" or RegistryKey endswith "\\PUAProtection" or RegistryKey endswith "\\Signature Update\\ForceUpdateFromMU" or RegistryKey endswith "\\SpyNet\\SpynetReporting" or RegistryKey endswith "\\SpyNet\\SubmitSamplesConsent" or RegistryKey endswith "\\Windows Defender Exploit Guard\\Controlled Folder Access\\EnableControlledFolderAccess")) or (RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "\\DisableAntiSpyware" or RegistryKey endswith "\\DisableAntiVirus" or RegistryKey endswith "\\DisableBehaviorMonitoring" or RegistryKey endswith "\\DisableBlockAtFirstSeen" or RegistryKey endswith "\\DisableEnhancedNotifications" or RegistryKey endswith "\\DisableIntrusionPreventionSystem" or RegistryKey endswith "\\DisableIOAVProtection" or RegistryKey endswith "\\DisableOnAccessProtection" or RegistryKey endswith "\\DisableRealtimeMonitoring" or RegistryKey endswith "\\DisableScanOnRealtimeEnable" or RegistryKey endswith "\\DisableScriptScanning"))) and (not((InitiatingProcessFolderPath endswith "\\sepWscSvc64.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\Symantec\\Symantec Endpoint Protection\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_reflectdebugger.yml
Potential WerFault ReflectDebugger Registry Value Abuse ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "RegistryValueSet" and RegistryKey endswith "\\Microsoft\\Windows\\Windows Error Reporting\\Hangs\\ReflectDebugger"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_outlook_security_settings.yml
Outlook Security Settings Updated - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Office*" and RegistryKey endswith "\\Outlook\\Security*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_office_vsto.yml
Potential Persistence Via Visual Studio Tools for Office ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Software\\Microsoft\\Office\\Outlook\\Addins*" or RegistryKey endswith "\\Software\\Microsoft\\Office\\Word\\Addins*" or RegistryKey endswith "\\Software\\Microsoft\\Office\\Excel\\Addins*" or RegistryKey endswith "\\Software\\Microsoft\\Office\\Powerpoint\\Addins*" or RegistryKey endswith "\\Software\\Microsoft\\VSTO\\Security\\Inclusion*") and (not(((InitiatingProcessFolderPath =~ "C:\\Program Files\\AVG\\Antivirus\\RegSvr.exe" and RegistryKey endswith "\\Microsoft\\Office\\Outlook\\Addins\\Antivirus.AsOutExt*") or (InitiatingProcessFolderPath endswith "\\msiexec.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe") or (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\integrator.exe" or InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" or InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\visio.exe") or InitiatingProcessFolderPath endswith "\\Teams.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_desktop_background_change.yml
Potentially Suspicious Desktop Background Change Via Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "Control Panel\\Desktop" or RegistryKey contains "CurrentVersion\\Policies\\ActiveDesktop" or RegistryKey contains "CurrentVersion\\Policies\\System") and ((RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "NoChangingWallpaper") or RegistryKey endswith "\\Wallpaper" or (RegistryValueData =~ "2" and RegistryKey endswith "\\WallpaperStyle")) and (not(InitiatingProcessFolderPath endswith "\\svchost.exe"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_disable_notification.yml
UAC Notification Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey contains "\\Microsoft\\Security Center\\UACDisableNotify"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_winlogon_notify_key.yml
Winlogon Notify Key Logon Persistence ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData endswith ".dll" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\logon"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_change_sysmon_driver_altitude.yml
Sysmon Driver Altitude Change ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Services*" and RegistryKey endswith "\\Instances\\Sysmon Instance\\Altitude"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_change_winevt_channelaccess.yml
Change Winevt Channel Access Permission Via Registry ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData contains "(A;;0x1;;;LA)" or RegistryValueData contains "(A;;0x1;;;SY)" or RegistryValueData contains "(A;;0x5;;;BA)") and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels*" and RegistryKey endswith "\\ChannelAccess") and (not(((InitiatingProcessFolderPath endswith "\\TiWorker.exe" and InitiatingProcessFolderPath startswith "C:\\Windows\\WinSxS\\") or InitiatingProcessFolderPath =~ "C:\\Windows\\servicing\\TrustedInstaller.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_servicedll_hijack.yml
ServiceDll Hijack ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryKey endswith "\\System*" and RegistryKey contains "ControlSet" and RegistryKey endswith "\\Services*") and RegistryKey endswith "\\Parameters\\ServiceDll") and (not(((RegistryValueData =~ "%%systemroot%%\\system32\\ntdsa.dll" and InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\lsass.exe" and RegistryKey endswith "\\Services\\NTDS\\Parameters\\ServiceDll") or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\poqexec.exe" or RegistryValueData =~ "C:\\Windows\\system32\\spool\\drivers\\x64\\3\\PrintConfig.dll"))) and (not((RegistryValueData =~ "C:\\Windows\\System32\\STAgent.dll" and InitiatingProcessFolderPath endswith "\\regsvr32.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_classes.yml
Classes Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Software\\Classes" and (RegistryKey contains "\\Folder\\ShellEx\\ExtShellFolderViews" or RegistryKey contains "\\Folder\\ShellEx\\DragDropHandlers" or RegistryKey contains "\\Folder\\Shellex\\ColumnHandlers" or RegistryKey contains "\\Filter" or RegistryKey contains "\\Exefile\\Shell\\Open\\Command\\(Default)" or RegistryKey contains "\\Directory\\Shellex\\DragDropHandlers" or RegistryKey contains "\\Directory\\Shellex\\CopyHookHandlers" or RegistryKey contains "\\CLSID\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\Instance" or RegistryKey contains "\\CLSID\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\Instance" or RegistryKey contains "\\CLSID\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\Instance" or RegistryKey contains "\\CLSID\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\Instance" or RegistryKey contains "\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers" or RegistryKey contains "\\.exe" or RegistryKey contains "\\.cmd" or RegistryKey contains "\\ShellEx\\PropertySheetHandlers" or RegistryKey contains "\\ShellEx\\ContextMenuHandlers")) and (not((InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\drvinst.exe" or RegistryValueData =~ "(Empty)" or RegistryValueData =~ "{807583E5-5146-11D5-A672-00B0D022E945}" or (InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\svchost.exe" and RegistryKey endswith "\\lnkfile\\shellex\\ContextMenuHandlers*"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_currentversion.yml
Wow6432Node Windows NT CurrentVersion Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion" and (RegistryKey contains "\\Windows\\Appinit_Dlls" or RegistryKey contains "\\Image File Execution Options" or RegistryKey contains "\\Drivers32") and (not((RegistryValueData in~ ("(Empty)", "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_access_vbom_tamper.yml
Trust Access Disable For VBApplications ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Security\\AccessVBOM"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_powershell_enablescripts_enabled.yml
PowerShell Script Execution Policy Enabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Policies\\Microsoft\\Windows\\PowerShell\\EnableScripts"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_odbc_driver_registered_susp.yml
Potentially Suspicious ODBC Driver Registered ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains ":\\PerfLogs\\" or RegistryValueData contains ":\\ProgramData\\" or RegistryValueData contains ":\\Temp\\" or RegistryValueData contains ":\\Users\\Public\\" or RegistryValueData contains ":\\Windows\\Registration\\CRMLog" or RegistryValueData contains ":\\Windows\\System32\\com\\dmp\\" or RegistryValueData contains ":\\Windows\\System32\\FxsTmp\\" or RegistryValueData contains ":\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\" or RegistryValueData contains ":\\Windows\\System32\\spool\\drivers\\color\\" or RegistryValueData contains ":\\Windows\\System32\\spool\\PRINTERS\\" or RegistryValueData contains ":\\Windows\\System32\\spool\\SERVERS\\" or RegistryValueData contains ":\\Windows\\System32\\Tasks_Migrated\\" or RegistryValueData contains ":\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\" or RegistryValueData contains ":\\Windows\\SysWOW64\\com\\dmp\\" or RegistryValueData contains ":\\Windows\\SysWOW64\\FxsTmp\\" or RegistryValueData contains ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\" or RegistryValueData contains ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\" or RegistryValueData contains ":\\Windows\\Tasks\\" or RegistryValueData contains ":\\Windows\\Temp\\" or RegistryValueData contains ":\\Windows\\Tracing\\" or RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "\\AppData\\Roaming\\") and RegistryKey endswith "\\SOFTWARE\\ODBC\\ODBCINST.INI*" and (RegistryKey endswith "\\Driver" or RegistryKey endswith "\\Setup")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_vba_warnings_tamper.yml
Office Macros Warning Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\Security\\VBAWarnings"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_globalflags.yml
Potential Persistence Via GlobalFlags ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Microsoft\\Windows NT\\CurrentVersion*" and RegistryKey endswith "\\Image File Execution Options*" and RegistryKey contains "\\GlobalFlag") or ((RegistryKey contains "\\ReportingMode" or RegistryKey contains "\\MonitorProcess") and (RegistryKey endswith "\\Microsoft\\Windows NT\\CurrentVersion*" and RegistryKey endswith "\\SilentProcessExit*"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_winevt_logging.yml
Disable Windows Event Logging Via Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels*" and RegistryKey endswith "\\Enabled") and (not(((InitiatingProcessFolderPath endswith "\\TiWorker.exe" and InitiatingProcessFolderPath startswith "C:\\Windows\\winsxs\\") or (InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\svchost.exe" and (RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-FileInfoMinifilter" or RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-ASN1*" or RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Kernel-AppCompat*" or RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Runtime\\Error*" or RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-CAPI2/Operational*")) or (InitiatingProcessFolderPath =~ "C:\\Windows\\servicing\\TrustedInstaller.exe" and RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Compat-Appraiser") or InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\wevtutil.exe"))) and (not((InitiatingProcessFolderPath =~ "" or isnull(InitiatingProcessFolderPath))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_reg_persist_explorer_run.yml
Registry Persistence via Explorer Run Key ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains ":\\$Recycle.bin\\" or RegistryValueData contains ":\\ProgramData\\" or RegistryValueData contains ":\\Temp\\" or RegistryValueData contains ":\\Users\\Default\\" or RegistryValueData contains ":\\Users\\Public\\" or RegistryValueData contains ":\\Windows\\Temp\\" or RegistryValueData contains "\\AppData\\Local\\Temp\\") and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disk_cleanup_handler_autorun_persistence.yml
Persistence Via Disk Cleanup Handler - Autorun ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VolumeCaches*" and ((RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey contains "\\Autorun") or ((RegistryValueData contains "cmd" or RegistryValueData contains "powershell" or RegistryValueData contains "rundll32" or RegistryValueData contains "mshta" or RegistryValueData contains "cscript" or RegistryValueData contains "wscript" or RegistryValueData contains "wsl" or RegistryValueData contains "\\Users\\Public\\" or RegistryValueData contains "\\Windows\\TEMP\\" or RegistryValueData contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\") and (RegistryKey contains "\\CleanupString" or RegistryKey contains "\\PreCleanupString")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_exploit_guard_susp_allowed_apps.yml
Suspicious Application Allowed Through Exploit Guard ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "SOFTWARE\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\AllowedApplications" and (RegistryKey endswith "\\Users\\Public*" or RegistryKey endswith "\\AppData\\Local\\Temp*" or RegistryKey endswith "\\Desktop*" or RegistryKey endswith "\\PerfLogs*" or RegistryKey endswith "\\Windows\\Temp*")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_new_application_appcompat.yml
New Application in AppCompat ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\AppCompatFlags\\Compatibility Assistant\\Store*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_scr_file_executed_by_rundll32.yml
ScreenSaver Registry Key Set ---> KQL Query:
DeviceRegistryEvents
| where InitiatingProcessFolderPath endswith "\\rundll32.exe" and (RegistryValueData endswith ".scr" and RegistryKey contains "\\Control Panel\\Desktop\\SCRNSAVE.EXE") and (not((RegistryValueData contains "C:\\Windows\\System32\\" or RegistryValueData contains "C:\\Windows\\SysWOW64\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_enabling_cor_profiler_env_variables.yml
Enabling COR Profiler Environment Variables ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\COR_ENABLE_PROFILING" or RegistryKey endswith "\\COR_PROFILER" or RegistryKey endswith "\\CORECLR_ENABLE_PROFILING") or RegistryKey contains "\\CORECLR_PROFILER_PATH"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_timeproviders_dllname.yml
New TimeProviders Registered With Uncommon DLL Name ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Services\\W32Time\\TimeProviders" and RegistryKey endswith "\\DllName") and (not((RegistryValueData in~ ("%SystemRoot%\\System32\\vmictimeprovider.dll", "%systemroot%\\system32\\w32time.dll", "C:\\Windows\\SYSTEM32\\w32time.DLL"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_typed_paths.yml
Potential Persistence Via TypedPaths ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths*" and (not((InitiatingProcessFolderPath in~ ("C:\\Windows\\explorer.exe", "C:\\Windows\\SysWOW64\\explorer.exe"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_ie.yml
Modification of IE Registry Settings ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings" and (not((RegistryKey endswith "\\Accepted Documents*" or RegistryValueData =~ "Binary Data" or RegistryValueData startswith "DWORD" or (RegistryValueData in~ ("Cookie:", "Visited:", "(Empty)")) or (RegistryKey contains "\\Cache" or RegistryKey contains "\\ZoneMap" or RegistryKey contains "\\WpadDecision"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_windows_firewall.yml
Disable Windows Firewall by Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\\EnableFirewall" or RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\EnableFirewall")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_chrome_extension.yml
Running Chrome VPN Extensions via the Registry 2 VPN Extension ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "Software\\Wow6432Node\\Google\\Chrome\\Extensions" and RegistryKey endswith "update_url") and (RegistryKey contains "fdcgdnkidjaadafnichfpabhfomcebme" or RegistryKey contains "fcfhplploccackoneaefokcmbjfbkenj" or RegistryKey contains "bihmplhobchoageeokmgbdihknkjbknd" or RegistryKey contains "gkojfkhlekighikafcpjkiklfbnlmeio" or RegistryKey contains "jajilbjjinjmgcibalaakngmkilboobh" or RegistryKey contains "gjknjjomckknofjidppipffbpoekiipm" or RegistryKey contains "nabbmpekekjknlbkgpodfndbodhijjem" or RegistryKey contains "kpiecbcckbofpmkkkdibbllpinceiihk" or RegistryKey contains "nlbejmccbhkncgokjcmghpfloaajcffj" or RegistryKey contains "omghfjlpggmjjaagoclmmobgdodcjboh" or RegistryKey contains "bibjcjfmgapbfoljiojpipaooddpkpai" or RegistryKey contains "mpcaainmfjjigeicjnlkdfajbioopjko" or RegistryKey contains "jljopmgdobloagejpohpldgkiellmfnc" or RegistryKey contains "lochiccbgeohimldjooaakjllnafhaid" or RegistryKey contains "nhnfcgpcbfclhfafjlooihdfghaeinfc" or RegistryKey contains "ookhnhpkphagefgdiemllfajmkdkcaim" or RegistryKey contains "namfblliamklmeodpcelkokjbffgmeoo" or RegistryKey contains "nbcojefnccbanplpoffopkoepjmhgdgh" or RegistryKey contains "majdfhpaihoncoakbjgbdhglocklcgno" or RegistryKey contains "lnfdmdhmfbimhhpaeocncdlhiodoblbd" or RegistryKey contains "eppiocemhmnlbhjplcgkofciiegomcon" or RegistryKey contains "cocfojppfigjeefejbpfmedgjbpchcng" or RegistryKey contains "foiopecknacmiihiocgdjgbjokkpkohc" or RegistryKey contains "hhdobjgopfphlmjbmnpglhfcgppchgje" or RegistryKey contains "jgbaghohigdbgbolncodkdlpenhcmcge" or RegistryKey contains "inligpkjkhbpifecbdjhmdpcfhnlelja" or RegistryKey contains "higioemojdadgdbhbbbkfbebbdlfjbip" or RegistryKey contains "hipncndjamdcmphkgngojegjblibadbe" or RegistryKey contains "iolonopooapdagdemdoaihahlfkncfgg" or RegistryKey contains "nhfjkakglbnnpkpldhjmpmmfefifedcj" or RegistryKey contains "jpgljfpmoofbmlieejglhonfofmahini" or RegistryKey contains "fgddmllnllkalaagkghckoinaemmogpe" or RegistryKey contains "ejkaocphofnobjdedneohbbiilggdlbi" or RegistryKey contains "keodbianoliadkoelloecbhllnpiocoi" or RegistryKey contains "hoapmlpnmpaehilehggglehfdlnoegck" or RegistryKey contains "poeojclicodamonabcabmapamjkkmnnk" or RegistryKey contains "dfkdflfgjdajbhocmfjolpjbebdkcjog" or RegistryKey contains "kcdahmgmaagjhocpipbodaokikjkampi" or RegistryKey contains "klnkiajpmpkkkgpgbogmcgfjhdoljacg" or RegistryKey contains "lneaocagcijjdpkcabeanfpdbmapcjjg" or RegistryKey contains "pgfpignfckbloagkfnamnolkeaecfgfh" or RegistryKey contains "jplnlifepflhkbkgonidnobkakhmpnmh" or RegistryKey contains "jliodmnojccaloajphkingdnpljdhdok" or RegistryKey contains "hnmpcagpplmpfojmgmnngilcnanddlhb" or RegistryKey contains "ffbkglfijbcbgblgflchnbphjdllaogb" or RegistryKey contains "kcndmbbelllkmioekdagahekgimemejo" or RegistryKey contains "jdgilggpfmjpbodmhndmhojklgfdlhob" or RegistryKey contains "bihhflimonbpcfagfadcnbbdngpopnjb" or RegistryKey contains "ppajinakbfocjfnijggfndbdmjggcmde" or RegistryKey contains "oofgbpoabipfcfjapgnbbjjaenockbdp" or RegistryKey contains "bhnhkdgoefpmekcgnccpnhjfdgicfebm" or RegistryKey contains "knmmpciebaoojcpjjoeonlcjacjopcpf" or RegistryKey contains "dhadilbmmjiooceioladdphemaliiobo" or RegistryKey contains "jedieiamjmoflcknjdjhpieklepfglin" or RegistryKey contains "mhngpdlhojliikfknhfaglpnddniijfh" or RegistryKey contains "omdakjcmkglenbhjadbccaookpfjihpa" or RegistryKey contains "npgimkapccfidfkfoklhpkgmhgfejhbj" or RegistryKey contains "akeehkgglkmpapdnanoochpfmeghfdln" or RegistryKey contains "gbmdmipapolaohpinhblmcnpmmlgfgje" or RegistryKey contains "aigmfoeogfnljhnofglledbhhfegannp" or RegistryKey contains "cgojmfochfikphincbhokimmmjenhhgk" or RegistryKey contains "ficajfeojakddincjafebjmfiefcmanc" or RegistryKey contains "ifnaibldjfdmaipaddffmgcmekjhiloa" or RegistryKey contains "jbnmpdkcfkochpanomnkhnafobppmccn" or RegistryKey contains "apcfdffemoinopelidncddjbhkiblecc" or RegistryKey contains "mjolnodfokkkaichkcjipfgblbfgojpa" or RegistryKey contains "oifjbnnafapeiknapihcmpeodaeblbkn" or RegistryKey contains "plpmggfglncceinmilojdkiijhmajkjh" or RegistryKey contains "mjnbclmflcpookeapghfhapeffmpodij" or RegistryKey contains "bblcccknbdbplgmdjnnikffefhdlobhp" or RegistryKey contains "aojlhgbkmkahabcmcpifbolnoichfeep" or RegistryKey contains "lcmammnjlbmlbcaniggmlejfjpjagiia" or RegistryKey contains "knajdeaocbpmfghhmijicidfcmdgbdpm" or RegistryKey contains "bdlcnpceagnkjnjlbbbcepohejbheilk" or RegistryKey contains "edknjdjielmpdlnllkdmaghlbpnmjmgb" or RegistryKey contains "eidnihaadmmancegllknfbliaijfmkgo" or RegistryKey contains "ckiahbcmlmkpfiijecbpflfahoimklke" or RegistryKey contains "macdlemfnignjhclfcfichcdhiomgjjb" or RegistryKey contains "chioafkonnhbpajpengbalkececleldf" or RegistryKey contains "amnoibeflfphhplmckdbiajkjaoomgnj" or RegistryKey contains "llbhddikeonkpbhpncnhialfbpnilcnc" or RegistryKey contains "pcienlhnoficegnepejpfiklggkioccm" or RegistryKey contains "iocnglnmfkgfedpcemdflhkchokkfeii" or RegistryKey contains "igahhbkcppaollcjeaaoapkijbnphfhb" or RegistryKey contains "njpmifchgidinihmijhcfpbdmglecdlb" or RegistryKey contains "ggackgngljinccllcmbgnpgpllcjepgc" or RegistryKey contains "kchocjcihdgkoplngjemhpplmmloanja" or RegistryKey contains "bnijmipndnicefcdbhgcjoognndbgkep" or RegistryKey contains "lklekjodgannjcccdlbicoamibgbdnmi" or RegistryKey contains "dbdbnchagbkhknegmhgikkleoogjcfge" or RegistryKey contains "egblhcjfjmbjajhjhpmnlekffgaemgfh" or RegistryKey contains "ehbhfpfdkmhcpaehaooegfdflljcnfec" or RegistryKey contains "bkkgdjpomdnfemhhkalfkogckjdkcjkg" or RegistryKey contains "almalgbpmcfpdaopimbdchdliminoign" or RegistryKey contains "akkbkhnikoeojlhiiomohpdnkhbkhieh" or RegistryKey contains "gbfgfbopcfokdpkdigfmoeaajfmpkbnh" or RegistryKey contains "bniikohfmajhdcffljgfeiklcbgffppl" or RegistryKey contains "lejgfmmlngaigdmmikblappdafcmkndb" or RegistryKey contains "ffhhkmlgedgcliajaedapkdfigdobcif" or RegistryKey contains "gcknhkkoolaabfmlnjonogaaifnjlfnp" or RegistryKey contains "pooljnboifbodgifngpppfklhifechoe" or RegistryKey contains "fjoaledfpmneenckfbpdfhkmimnjocfa" or RegistryKey contains "aakchaleigkohafkfjfjbblobjifikek" or RegistryKey contains "dpplabbmogkhghncfbfdeeokoefdjegm" or RegistryKey contains "padekgcemlokbadohgkifijomclgjgif" or RegistryKey contains "bfidboloedlamgdmenmlbipfnccokknp")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_services_etw_tamper.yml
ETW Logging Disabled For SCM ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "Software\\Microsoft\\Windows NT\\CurrentVersion\\Tracing\\SCM\\Regular\\TracingDisabled"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_common.yml
Common Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows CE Services\\AutoStart" or RegistryKey contains "\\Software\\Wow6432Node\\Microsoft\\Command Processor\\Autorun" or RegistryKey contains "\\SOFTWARE\\Wow6432Node\\Microsoft\\Active Setup\\Installed Components" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnDisconnect" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnConnect" or RegistryKey contains "\\SYSTEM\\Setup\\CmdLine" or RegistryKey contains "\\Software\\Microsoft\\Ctf\\LangBarAddin" or RegistryKey contains "\\Software\\Microsoft\\Command Processor\\Autorun" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components" or RegistryKey contains "\\SOFTWARE\\Classes\\Protocols\\Handler" or RegistryKey contains "\\SOFTWARE\\Classes\\Protocols\\Filter" or RegistryKey contains "\\SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command\\(Default)" or RegistryKey contains "\\Environment\\UserInitMprLogonScript" or RegistryKey contains "\\SOFTWARE\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop\\Scrnsave.exe" or RegistryKey contains "\\Software\\Microsoft\\Internet Explorer\\UrlSearchHooks" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\Components" or RegistryKey contains "\\Software\\Classes\\Clsid\\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\\Inprocserver32" or RegistryKey contains "\\Control Panel\\Desktop\\Scrnsave.exe") and (not((RegistryKey contains "\\Software\\Microsoft\\Active Setup\\Installed Components\\{89820200-ECBD-11cf-8B85-00AA005B4383}" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{8A69D345-D564-463c-AFF1-A69D9E530F96}" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{9459C573-B17A-45AE-9F64-1857B5D58CEE}" or RegistryValueData =~ "(Empty)" or (InitiatingProcessFolderPath in~ ("C:\\Windows\\System32\\poqexec.exe", "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe")) or ((RegistryKey endswith "\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Classes\\PROTOCOLS\\Handler*" or RegistryKey endswith "\\ClickToRunStore\\HKMU\\SOFTWARE\\Classes\\PROTOCOLS\\Handler*") or (RegistryValueData in~ ("{314111c7-a502-11d2-bbca-00c04f8ec294}", "{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}", "{42089D2D-912D-4018-9087-2B87803E93FB}", "{5504BE45-A83B-4808-900A-3A5C36E7F77A}", "{807583E5-5146-11D5-A672-00B0D022E945}"))) or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\")))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_windows_event_log_access.yml
Windows Event Log Access Tampering Via Registry ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryKey endswith "\\SYSTEM\\CurrentControlSet\\Services\\EventLog*" and RegistryKey endswith "\\CustomSD") or ((RegistryKey endswith "\\Policies\\Microsoft\\Windows\\EventLog*" or RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels") and RegistryKey endswith "\\ChannelAccess")) and (RegistryValueData contains "D:(D;" or (RegistryValueData contains "D:(" and RegistryValueData contains ")(D;"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hidden_extention.yml
Registry Modification to Hidden File Extension ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "DWORD (0x00000002)" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden") or (RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\HideFileExt")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_system_lsa_nolmhash.yml
Enable LM Hash Storage ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "System\\CurrentControlSet\\Control\\Lsa\\NoLMHash"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hangs_debugger_persistence.yml
Add Debugger Entry To Hangs Key For Persistence ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\Hangs\\Debugger"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_evtx_file_key_tamper.yml
Potential EventLog File Location Tampering ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\SYSTEM\\CurrentControlSet\\Services\\EventLog*" and RegistryKey endswith "\\File") and (not(RegistryValueData contains "\\System32\\Winevt\\Logs\\"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_lolbin_onedrivestandaloneupdater.yml
Lolbas OneDriveStandaloneUpdater.exe Proxy Download ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Microsoft\\OneDrive\\UpdateOfficeConfig\\UpdateRingSettingURLFromOC"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_autodial_dll.yml
Potential Persistence Via AutodialDLL ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Services\\WinSock2\\Parameters\\AutodialDLL"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_security_center_notifications.yml
Disable Windows Security Center Notifications ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "Windows\\CurrentVersion\\ImmersiveShell\\UseActionCenterExperience"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_new_network_provider.yml
Potential Credential Dumping Attempt Using New NetworkProvider - REG ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\System\\CurrentControlSet\\Services*" and RegistryKey contains "\\NetworkProvider") and (not(((RegistryKey contains "\\System\\CurrentControlSet\\Services\\WebClient\\NetworkProvider" or RegistryKey contains "\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\NetworkProvider" or RegistryKey contains "\\System\\CurrentControlSet\\Services\\RDPNP\\NetworkProvider") or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\poqexec.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_runmru_susp_command_execution.yml
Potentially Suspicious Command Executed Via Run Dialog Box - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU" and (((RegistryValueData contains "powershell" or RegistryValueData contains "pwsh") and (RegistryValueData contains " -e " or RegistryValueData contains " -ec " or RegistryValueData contains " -en " or RegistryValueData contains " -enc " or RegistryValueData contains " -enco" or RegistryValueData contains "ftp" or RegistryValueData contains "Hidden" or RegistryValueData contains "http" or RegistryValueData contains "iex" or RegistryValueData contains "Invoke-")) or (RegistryValueData contains "wmic" and (RegistryValueData contains "shadowcopy" or RegistryValueData contains "process call create")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_dsrm_tampering.yml
Directory Service Restore Mode(DSRM) Registry Value Tampering ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Control\\Lsa\\DsrmAdminLogonBehavior" and (not(RegistryValueData =~ "DWORD (0x00000000)"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_terminal_server_tampering.yml
RDP Sensitive Settings Changed ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData in~ ("DWORD (0x00000001)", "DWORD (0x00000002)", "DWORD (0x00000003)", "DWORD (0x00000004)")) and (RegistryKey endswith "\\Control\\Terminal Server*" or RegistryKey endswith "\\Windows NT\\Terminal Services*") and RegistryKey endswith "\\Shadow") or (RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "\\Control\\Terminal Server*" or RegistryKey endswith "\\Windows NT\\Terminal Services*") and (RegistryKey endswith "\\DisableRemoteDesktopAntiAlias" or RegistryKey endswith "\\DisableSecuritySettings" or RegistryKey endswith "\\fAllowUnsolicited" or RegistryKey endswith "\\fAllowUnsolicitedFullControl")) or (RegistryKey contains "\\Control\\Terminal Server\\InitialProgram" or RegistryKey contains "\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram" or RegistryKey contains "\\services\\TermService\\Parameters\\ServiceDll" or RegistryKey contains "\\Windows NT\\Terminal Services\\InitialProgram")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_natural_language.yml
Potential Persistence Via DLLPathOverride ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SYSTEM\\CurrentControlSet\\Control\\ContentIndex\\Language*" and (RegistryKey contains "\\StemmerDLLPathOverride" or RegistryKey contains "\\WBDLLPathOverride" or RegistryKey contains "\\StemmerClass" or RegistryKey contains "\\WBreakerClass")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_mal_blue_mockingbird.yml
Blue Mockingbird - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\CurrentControlSet\\Services\\wercplsupport\\Parameters\\ServiceDll"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml
Potential CobaltStrike Service Installations - Registry ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData contains "ADMIN$" and RegistryValueData contains ".exe") or (RegistryValueData contains "%COMSPEC%" and RegistryValueData contains "start" and RegistryValueData contains "powershell")) and (RegistryKey contains "\\System\\CurrentControlSet\\Services" or (RegistryKey contains "\\System\\ControlSet" and RegistryKey contains "\\Services"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_scrobj_dll.yml
Potential Persistence Via Scrobj.dll COM Hijacking ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "C:\\WINDOWS\\system32\\scrobj.dll" and RegistryKey endswith "InprocServer32\\(Default)"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_net_cli_ngenassemblyusagelog.yml
NET NGenAssemblyUsageLog Registry Key Tamper ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "SOFTWARE\\Microsoft\\.NETFramework\\NGenAssemblyUsageLog"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml
PowerShell as a Service in Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "powershell" or RegistryValueData contains "pwsh") and RegistryKey endswith "\\Services*" and RegistryKey endswith "\\ImagePath"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disabled_pua_protection_on_microsoft_defender.yml
Disable PUA Protection on Windows Defender ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey contains "\\Policies\\Microsoft\\Windows Defender\\PUAProtection"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_vbs_payload_stored.yml
VBScript Payload Stored in Registry ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData contains "vbscript:" or RegistryValueData contains "jscript:" or RegistryValueData contains "mshtml," or RegistryValueData contains "RunHTMLApplication" or RegistryValueData contains "Execute(" or RegistryValueData contains "CreateObject" or RegistryValueData contains "window.close") and RegistryKey contains "Software\\Microsoft\\Windows\\CurrentVersion") and (not((RegistryKey contains "Software\\Microsoft\\Windows\\CurrentVersion\\Run" or ((RegistryValueData contains "\\Microsoft.NET\\Primary Interop Assemblies\\Microsoft.mshtml.dll" or RegistryValueData contains "<\\Microsoft.mshtml,fileVersion=" or RegistryValueData contains "_mshtml_dll_" or RegistryValueData contains "<\\Microsoft.mshtml,culture=") and InitiatingProcessFolderPath endswith "\\msiexec.exe" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData*"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_internet_explorer_disable_first_run_customize.yml
Internet Explorer DisableFirstRunCustomize Enabled ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData in~ ("DWORD (0x00000001)", "DWORD (0x00000002)")) and RegistryKey endswith "\\Microsoft\\Internet Explorer\\Main\\DisableFirstRunCustomize") and (not((InitiatingProcessFolderPath in~ ("C:\\Windows\\explorer.exe", "C:\\Windows\\System32\\ie4uinit.exe"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_privacy_settings_experience.yml
Disable Privacy Settings Experience in Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\Windows\\OOBE\\DisablePrivacyExperience"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_dns_over_https_enabled.yml
DNS-over-HTTPS Enabled by Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "secure" and RegistryKey endswith "\\SOFTWARE\\Google\\Chrome\\DnsOverHttpsMode") or (RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\Edge\\BuiltInDnsClientEnabled") or (RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\SOFTWARE\\Policies\\Mozilla\\Firefox\\DNSOverHTTPS\\Enabled")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_deviceguard_hypervisorenforcedpagingtranslation_disabled.yml
Hypervisor Enforced Paging Translation Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\DisableHypervisorEnforcedPagingTranslation"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_powershell_logging_disabled.yml
PowerShell Logging Disabled Via Registry Key Tampering ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\Microsoft\\Windows\\PowerShell*" or RegistryKey endswith "\\Microsoft\\PowerShellCore*") and (RegistryKey endswith "\\ModuleLogging\\EnableModuleLogging" or RegistryKey endswith "\\ScriptBlockLogging\\EnableScriptBlockLogging" or RegistryKey endswith "\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging" or RegistryKey endswith "\\Transcription\\EnableTranscripting" or RegistryKey endswith "\\Transcription\\EnableInvocationHeader" or RegistryKey endswith "\\EnableScripts")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_tls_protocol_old_version_enabled.yml
Old TLS1.0/TLS1.1 Protocol Version Enabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.0*" or RegistryKey endswith "\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1*") and RegistryKey endswith "\\Enabled"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_user_shell_folders.yml
Modify User Shell Folders Startup Value ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders" and RegistryKey endswith "Startup"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_special_accounts.yml
Hiding User Account Via SpecialAccounts Registry Key ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and ActionType =~ "RegistryValueSet" and RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_outlook_enable_macro_execution.yml
Outlook Macro Execution Without Warning Setting Enabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData contains "0x00000001" and RegistryKey endswith "\\Outlook\\Security\\Level"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_winget_admin_settings_tampering.yml
Winget Admin Settings Modification ---> KQL Query:
DeviceRegistryEvents
| where InitiatingProcessFolderPath endswith "\\winget.exe" and RegistryKey endswith "\\LocalState\\admin_settings" and RegistryKey =~ "\\REGISTRY\\A*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_outlook_homepage.yml
Potential Persistence Via Outlook Home Page ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Software\\Microsoft\\Office*" and RegistryKey endswith "\\Outlook\\WebView*") and RegistryKey endswith "\\URL"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_app_paths.yml
Potential Persistence Via App Paths Default Property ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "\\Users\\Public" or RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "\\Windows\\Temp\\" or RegistryValueData contains "\\Desktop\\" or RegistryValueData contains "\\Downloads\\" or RegistryValueData contains "%temp%" or RegistryValueData contains "%tmp%" or RegistryValueData contains "iex" or RegistryValueData contains "Invoke-" or RegistryValueData contains "rundll32" or RegistryValueData contains "regsvr32" or RegistryValueData contains "mshta" or RegistryValueData contains "cscript" or RegistryValueData contains "wscript" or RegistryValueData contains ".bat" or RegistryValueData contains ".hta" or RegistryValueData contains ".dll" or RegistryValueData contains ".ps1") and RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths" and (RegistryKey endswith "(Default)" or RegistryKey endswith "Path")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_ime_non_default_extension.yml
Uncommon Extension In Keyboard Layout IME File Registry Value ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Control\\Keyboard Layouts*" and RegistryKey contains "Ime File") and (not(RegistryValueData endswith ".ime"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_disable_protected_view_features.yml
Microsoft Office Protected View Disabled ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Office*" and RegistryKey endswith "\\Security\\ProtectedView*") and ((RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\enabledatabasefileprotectedview" or RegistryKey endswith "\\enableforeigntextfileprotectedview")) or (RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "\\DisableAttachementsInPV" or RegistryKey endswith "\\DisableInternetFilesInPV" or RegistryKey endswith "\\DisableIntranetCheck" or RegistryKey endswith "\\DisableUnsafeLocationsInPV")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_run_key_img_folder.yml
New RUN Key Pointing to Suspicious Folder ---> KQL Query:
DeviceRegistryEvents
| where (((RegistryValueData contains ":\\$Recycle.bin\\" or RegistryValueData contains ":\\Temp\\" or RegistryValueData contains ":\\Users\\Default\\" or RegistryValueData contains ":\\Users\\Desktop\\" or RegistryValueData contains ":\\Users\\Public\\" or RegistryValueData contains ":\\Windows\\Temp\\" or RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "%temp%\\" or RegistryValueData contains "%tmp%\\") or (RegistryValueData startswith "%Public%\\" or RegistryValueData startswith "wscript" or RegistryValueData startswith "cscript")) and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce*")) and (not(((RegistryValueData contains "\\AppData\\Local\\Temp\\" or RegistryValueData contains "C:\\Windows\\Temp\\") and (RegistryValueData contains "rundll32.exe " and RegistryValueData contains "C:\\WINDOWS\\system32\\advpack.dll,DelNodeRunDLL32") and InitiatingProcessFolderPath startswith "C:\\Windows\\SoftwareDistribution\\Download\\" and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\RunOnce*")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_function_user.yml
Disable Internal Tools or Feature in Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\shutdownwithoutlogon" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\\ToastEnabled" or RegistryKey endswith "SYSTEM\\CurrentControlSet\\Control\\Storage\\Write Protection" or RegistryKey endswith "SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies\\WriteProtect")) or (RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\StartMenuLogOff" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableLockWorkstation" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskmgr" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispBackgroundPage" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispCPL" or RegistryKey endswith "SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableNotificationCenter" or RegistryKey endswith "SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableCMD"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_sophos_av_tamper.yml
Tamper With Sophos AV Registry Keys ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey contains "\\Sophos Endpoint Defense\\TamperProtection\\Config\\SAVEnabled" or RegistryKey contains "\\Sophos Endpoint Defense\\TamperProtection\\Config\\SEDEnabled" or RegistryKey contains "\\Sophos\\SAVService\\TamperProtection\\Enabled")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_add_port_monitor.yml
Add Port Monitor Persistence in Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData endswith ".dll" and RegistryKey endswith "\\Control\\Print\\Monitors*") and (not(((RegistryValueData =~ "cpwmon64_v40.dll" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\spoolsv.exe" and RegistryKey contains "\\Control\\Print\\Monitors\\CutePDF Writer Monitor v4.0\\Driver" and (InitiatingProcessAccountName contains "AUTHORI" or InitiatingProcessAccountName contains "AUTORI")) or RegistryKey contains "\\Control\\Print\\Monitors\\MONVNC\\Driver" or (RegistryKey endswith "Control\\Print\\Environments*" and RegistryKey endswith "\\Drivers*" and RegistryKey contains "\\VNC Printer"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_fax_dll_persistance.yml
Change the Fax Dll ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Software\\Microsoft\\Fax\\Device Providers*" and RegistryKey contains "\\ImageName") and (not(RegistryValueData =~ "%systemroot%\\system32\\fxst30.dll"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_lsass_usermode_dumping.yml
Lsass Full Dump Request Via DumpType Registry Settings ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000002)" and (RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\LocalDumps\\DumpType" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\LocalDumps\\lsass.exe\\DumpType")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_crashdump_disabled.yml
CrashControl CrashDump Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey contains "SYSTEM\\CurrentControlSet\\Control\\CrashControl"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion.yml
CurrentVersion Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion" and (RegistryKey contains "\\ShellServiceObjectDelayLoad" or RegistryKey endswith "\\Run*" or RegistryKey endswith "\\RunOnce*" or RegistryKey endswith "\\RunOnceEx*" or RegistryKey endswith "\\RunServices*" or RegistryKey endswith "\\RunServicesOnce*" or RegistryKey contains "\\Policies\\System\\Shell" or RegistryKey contains "\\Policies\\Explorer\\Run" or RegistryKey contains "\\Group Policy\\Scripts\\Startup" or RegistryKey contains "\\Group Policy\\Scripts\\Shutdown" or RegistryKey contains "\\Group Policy\\Scripts\\Logon" or RegistryKey contains "\\Group Policy\\Scripts\\Logoff" or RegistryKey contains "\\Explorer\\ShellServiceObjects" or RegistryKey contains "\\Explorer\\ShellIconOverlayIdentifiers" or RegistryKey contains "\\Explorer\\ShellExecuteHooks" or RegistryKey contains "\\Explorer\\SharedTaskScheduler" or RegistryKey contains "\\Explorer\\Browser Helper Objects" or RegistryKey contains "\\Authentication\\PLAP Providers" or RegistryKey contains "\\Authentication\\Credential Providers" or RegistryKey contains "\\Authentication\\Credential Provider Filters")) and (not((((RegistryValueData in~ ("\"C:\\Program Files\\AVG\\Antivirus\\AvLaunch.exe\" /gui", "\"C:\\Program Files (x86)\\AVG\\Antivirus\\AvLaunch.exe\" /gui", "{472083B0-C522-11CF-8763-00608CC02F24}")) and InitiatingProcessFolderPath startswith "C:\\Program Files\\AVG\\Antivirus\\Setup\\") or (RegistryValueData =~ "(Empty)" or RegistryKey endswith "\\NgcFirst\\ConsecutiveSwitchCount" or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe" or InitiatingProcessFolderPath endswith "\\AppData\\Roaming\\Spotify\\Spotify.exe" or InitiatingProcessFolderPath endswith "\\AppData\\Local\\WebEx\\WebexHost.exe") or (InitiatingProcessFolderPath in~ ("C:\\WINDOWS\\system32\\devicecensus.exe", "C:\\Windows\\system32\\winsat.exe", "C:\\Program Files\\Microsoft OneDrive\\StandaloneUpdater\\OneDriveSetup.exe", "C:\\Program Files\\Microsoft OneDrive\\Update\\OneDriveSetup.exe", "C:\\Program Files (x86)\\Microsoft OneDrive\\Update\\OneDriveSetup.exe", "C:\\Program Files\\KeePass Password Safe 2\\ShInstUtil.exe", "C:\\Program Files\\Everything\\Everything.exe", "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"))) or (RegistryValueData =~ "C:\\Program Files\\Aurora-Agent\\tools\\aurora-dashboard.exe" and (InitiatingProcessFolderPath endswith "\\aurora-agent-64.exe" or InitiatingProcessFolderPath endswith "\\aurora-agent.exe") and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\Run\\aurora-dashboard") or (RegistryValueData =~ "ctfmon.exe /n" and InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\userinit.exe") or InitiatingProcessFolderPath =~ "C:\\Program Files\\Windows Defender\\MsMpEng.exe" or (RegistryValueData endswith "A251-47B7-93E1-CDD82E34AF8B}" and InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\regsvr32.exe" and RegistryKey contains "DropboxExt") or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\Install\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe") or (RegistryValueData endswith "\\Everything\\Everything.exe\" -startup" and RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\Run\\Everything") or (RegistryValueData contains "\\GoogleDriveFS.exe" and RegistryValueData startswith "C:\\Program Files\\Google\\Drive File Stream\\" and RegistryKey endswith "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleDriveFS") or ((RegistryValueData in~ ("{CFE8B367-77A7-41D7-9C90-75D16D7DC6B6}", "{A8E52322-8734-481D-A7E2-27B309EF8D56}", "{C973DA94-CBDF-4E77-81D1-E5B794FBD146}", "{51EF1569-67EE-4AD6-9646-E726C3FFC8A2}")) and RegistryKey contains "GoogleDrive") or (RegistryValueData =~ "C:\\Program Files\\Greenshot\\Greenshot.exe" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Greenshot") or (RegistryValueData =~ "\"C:\\Program Files\\iTunes\\iTunesHelper.exe\"" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\iTunesHelper") or (InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\LogonUI.exe" and (RegistryKey endswith "\\Authentication\\Credential Providers\\{D6886603-9D2F-4EB2-B667-1971041FA96B}*" or RegistryKey endswith "\\Authentication\\Credential Providers\\{BEC09223-B018-416D-A0AC-523971B639F5}*" or RegistryKey endswith "\\Authentication\\Credential Providers\\{8AF662BF-65A0-4D0A-A540-A338A999D36F}*" or RegistryKey endswith "\\Authentication\\Credential Providers\\{27FBDB57-B613-4AF2-9D7E-4FA7A66C21AD}*")) or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\")) or (RegistryValueData contains "\\AppData\\Local\\Microsoft\\OneDrive\\" and (RegistryValueData startswith "C:\\Windows\\system32\\cmd.exe /q /c rmdir /s /q \"C:\\Users\\" or RegistryValueData startswith "C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\")) or (RegistryValueData =~ "C:\\Program Files\\Opera\\assistant\\browser_assistant.exe" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Opera Browser Assistant") or ((RegistryValueData contains "\\AppData\\Local\\Package Cache\\{" and RegistryValueData contains "}\\python-") and RegistryValueData endswith ".exe\" /burn.runonce" and RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{") or (RegistryValueData contains "\\Microsoft\\Teams\\Update.exe --processStart " and InitiatingProcessFolderPath endswith "\\Microsoft\\Teams\\current\\Teams.exe") or (RegistryValueData =~ "\"C:\\Program Files\\Zoom\\bin\\installer.exe\" /repair" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\zoommsirepair"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_powershell_in_run_keys.yml
Suspicious Powershell In Registry Run Keys ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "powershell" or RegistryValueData contains "pwsh " or RegistryValueData contains "FromBase64String" or RegistryValueData contains ".DownloadFile(" or RegistryValueData contains ".DownloadString(" or RegistryValueData contains " -w hidden " or RegistryValueData contains " -w 1 " or RegistryValueData contains "-windowstyle hidden" or RegistryValueData contains "-window hidden" or RegistryValueData contains " -nop " or RegistryValueData contains " -encodedcommand " or RegistryValueData contains "-ExecutionPolicy Bypass" or RegistryValueData contains "Invoke-Expression" or RegistryValueData contains "IEX (" or RegistryValueData contains "Invoke-Command" or RegistryValueData contains "ICM -" or RegistryValueData contains "Invoke-WebRequest" or RegistryValueData contains "IWR " or RegistryValueData contains " -noni " or RegistryValueData contains " -noninteractive ") and RegistryKey contains "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_allow_rdp_remote_assistance_feature.yml
Allow RDP Remote Assistance Feature ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "System\\CurrentControlSet\\Control\\Terminal Server\\fAllowToGetHelp"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disabled_exploit_guard_net_protection_on_ms_defender.yml
Disable Exploit Guard Network Protection on Windows Defender ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (00000001)" and RegistryKey contains "SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and Browser protection\\DisallowExploitProtectionOverride"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_chm.yml
Potential Persistence Via CHM Helper DLL ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Microsoft\\HtmlHelp Author\\Location" or RegistryKey contains "\\Software\\WOW6432Node\\Microsoft\\HtmlHelp Author\\Location"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_disable_secure_desktop_prompt.yml
UAC Secure Desktop Prompt Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_wmp.yml
UAC Bypass Using Windows Media Player - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "Binary Data" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Compatibility Assistant\\Store\\C:\\Program Files\\Windows Media Player\\osk.exe"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_lsa_extension.yml
Potential Persistence Via LSA Extensions ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SYSTEM\\CurrentControlSet\\Control\\LsaExtensionConfig\\LsaSrv\\Extensions"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_printer_driver.yml
Suspicious Printer Driver Empty Manufacturer ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "(Empty)" and (RegistryKey contains "\\Control\\Print\\Environments\\Windows x64\\Drivers" and RegistryKey contains "\\Manufacturer")) and (not((RegistryKey endswith "\\CutePDF Writer v4.0*" or RegistryKey endswith "\\Version-3\\PDF24*" or (RegistryKey endswith "\\VNC Printer (PS)*" or RegistryKey endswith "\\VNC Printer (UD)*"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disabled_tamper_protection_on_microsoft_defender.yml
Disable Tamper Protection on Windows Defender ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey contains "\\Microsoft\\Windows Defender\\Features\\TamperProtection") and (not(((InitiatingProcessFolderPath endswith "\\MsMpEng.exe" and InitiatingProcessFolderPath startswith "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\") or InitiatingProcessFolderPath =~ "C:\\Program Files\\Windows Defender\\MsMpEng.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hhctrl_persistence.yml
Persistence Via Hhctrl.ocx ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\CLSID\\{52A2AAAE-085D-4187-97EA-8C30DB990436}\\InprocServer32\\(Default)" and (not(RegistryValueData =~ "C:\\Windows\\System32\\hhctrl.ocx"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_taskcache_entry.yml
Scheduled TaskCache Change by Uncommon Program ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache*" and (not(((RegistryKey contains "Microsoft\\Windows\\UpdateOrchestrator" or RegistryKey contains "Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcRestartTask\\Index" or RegistryKey contains "Microsoft\\Windows\\Flighting\\OneSettings\\RefreshCache\\Index") or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Dropbox\\Update\\DropboxUpdate.exe", "C:\\Program Files\\Dropbox\\Update\\DropboxUpdate.exe")) or (InitiatingProcessFolderPath =~ "C:\\Windows\\explorer.exe" and RegistryKey endswith "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\PLA\\Server Manager Performance Monitor*") or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\msiexec.exe" or (InitiatingProcessFolderPath endswith "\\ngen.exe" and InitiatingProcessFolderPath startswith "C:\\Windows\\Microsoft.NET\\Framework" and (RegistryKey contains "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{B66B135D-DA06-4FC4-95F8-7458E1D10129}" or RegistryKey contains "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\.NET Framework\\.NET Framework NGEN")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Microsoft Office\\root\\Integration\\Integrator.exe", "C:\\Program Files (x86)\\Microsoft Office\\root\\Integration\\Integrator.exe")) or InitiatingProcessFolderPath =~ "C:\\WINDOWS\\system32\\svchost.exe" or InitiatingProcessFolderPath =~ "System" or (InitiatingProcessFolderPath endswith "\\TiWorker.exe" and InitiatingProcessFolderPath startswith "C:\\Windows\\"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_creation_service_susp_folder.yml
Service Binary in Suspicious Folder ---> KQL Query:
DeviceRegistryEvents
| where (((RegistryValueData in~ ("DWORD (0x00000000)", "DWORD (0x00000001)", "DWORD (0x00000002)")) and (InitiatingProcessFolderPath contains "\\Users\\Public\\" or InitiatingProcessFolderPath contains "\\Perflogs\\" or InitiatingProcessFolderPath contains "\\ADMIN$\\" or InitiatingProcessFolderPath contains "\\Temp\\") and RegistryKey endswith "\\Start" and RegistryKey =~ "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet001\\Services*") or ((RegistryValueData contains "\\Users\\Public\\" or RegistryValueData contains "\\Perflogs\\" or RegistryValueData contains "\\ADMIN$\\" or RegistryValueData contains "\\Temp\\") and RegistryKey endswith "\\ImagePath" and RegistryKey =~ "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet001\\Services*")) and (not((InitiatingProcessFolderPath contains "\\Common Files\\" and InitiatingProcessFolderPath contains "\\Temp\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_silentcleanup_task.yml
Bypass UAC Using SilentCleanup Task ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Environment\\windir" and (not(RegistryValueData =~ "%SystemRoot%"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_policies_attachments_tamper.yml
Potential Attachment Manager Settings Attachments Tamper ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments*" and ((RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\HideZoneInfoOnProperties") or (RegistryValueData =~ "DWORD (0x00000002)" and RegistryKey endswith "\\SaveZoneInformation") or (RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey endswith "\\ScanWithAntiVirus"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_susp_pendingfilerenameoperations.yml
Potential PendingFileRenameOperations Tampering ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "RegistryValueSet" and RegistryKey contains "\\CurrentControlSet\\Control\\Session Manager\\PendingFileRenameOperations") and ((InitiatingProcessFolderPath endswith "\\reg.exe" or InitiatingProcessFolderPath endswith "\\regedit.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\" or InitiatingProcessFolderPath contains "\\Users\\Public\\"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_ifilter.yml
Register New IFiltre For Persistence ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryKey contains "\\SOFTWARE\\Classes\\CLSID" and RegistryKey contains "\\PersistentAddinsRegistered\\{89BCB740-6119-101A-BCB7-00DD010655AF}") or (RegistryKey contains "\\SOFTWARE\\Classes\\." and RegistryKey contains "\\PersistentHandler")) and (not(((RegistryKey endswith "\\CLSID\\{4F46F75F-199F-4C63-8B7D-86D48FE7970C}*" or RegistryKey endswith "\\CLSID\\{4887767F-7ADC-4983-B576-88FB643D6F79}*" or RegistryKey endswith "\\CLSID\\{D3B41FA1-01E3-49AF-AA25-1D0D824275AE}*" or RegistryKey endswith "\\CLSID\\{72773E1A-B711-4d8d-81FA-B9A43B0650DD}*" or RegistryKey endswith "\\CLSID\\{098f2470-bae0-11cd-b579-08002b30bfeb}*" or RegistryKey endswith "\\CLSID\\{1AA9BF05-9A97-48c1-BA28-D9DCE795E93C}*" or RegistryKey endswith "\\CLSID\\{2e2294a9-50d7-4fe7-a09f-e6492e185884}*" or RegistryKey endswith "\\CLSID\\{34CEAC8D-CBC0-4f77-B7B1-8A60CB6DA0F7}*" or RegistryKey endswith "\\CLSID\\{3B224B11-9363-407e-850F-C9E1FFACD8FB}*" or RegistryKey endswith "\\CLSID\\{3DDEB7A4-8ABF-4D82-B9EE-E1F4552E95BE}*" or RegistryKey endswith "\\CLSID\\{5645C8C1-E277-11CF-8FDA-00AA00A14F93}*" or RegistryKey endswith "\\CLSID\\{5645C8C4-E277-11CF-8FDA-00AA00A14F93}*" or RegistryKey endswith "\\CLSID\\{58A9EBF6-5755-4554-A67E-A2467AD1447B}*" or RegistryKey endswith "\\CLSID\\{5e941d80-bf96-11cd-b579-08002b30bfeb}*" or RegistryKey endswith "\\CLSID\\{698A4FFC-63A3-4E70-8F00-376AD29363FB}*" or RegistryKey endswith "\\CLSID\\{7E9D8D44-6926-426F-AA2B-217A819A5CCE}*" or RegistryKey endswith "\\CLSID\\{8CD34779-9F10-4f9b-ADFB-B3FAEABDAB5A}*" or RegistryKey endswith "\\CLSID\\{9694E38A-E081-46ac-99A0-8743C909ACB6}*" or RegistryKey endswith "\\CLSID\\{98de59a0-d175-11cd-a7bd-00006b827d94}*" or RegistryKey endswith "\\CLSID\\{AA10385A-F5AA-4EFF-B3DF-71B701E25E18}*" or RegistryKey endswith "\\CLSID\\{B4132098-7A03-423D-9463-163CB07C151F}*" or RegistryKey endswith "\\CLSID\\{d044309b-5da6-4633-b085-4ed02522e5a5}*" or RegistryKey endswith "\\CLSID\\{D169C14A-5148-4322-92C8-754FC9D018D8}*" or RegistryKey endswith "\\CLSID\\{DD75716E-B42E-4978-BB60-1497B92E30C4}*" or RegistryKey endswith "\\CLSID\\{E2F83EED-62DE-4A9F-9CD0-A1D40DCD13B6}*" or RegistryKey endswith "\\CLSID\\{E772CEB3-E203-4828-ADF1-765713D981B8}*" or RegistryKey contains "\\CLSID\\{eec97550-47a9-11cf-b952-00aa0051fe20}" or RegistryKey endswith "\\CLSID\\{FB10BD80-A331-4e9e-9EB7-00279903AD99}*") or (InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml
New Root or CA or AuthRoot Certificate to Store ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "Binary Data" and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\SystemCertificates\\Root\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\SystemCertificates\\CA\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\CA\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\CA\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\SystemCertificates\\AuthRoot\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\AuthRoot\\Certificates*" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\AuthRoot\\Certificates*") and RegistryKey endswith "\\Blob"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_defender_firewall.yml
Disable Microsoft Defender Firewall via Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and RegistryKey endswith "\\Services\\SharedAccess\\Parameters\\FirewallPolicy*" and RegistryKey endswith "\\EnableFirewall"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_odbc_driver_registered.yml
New ODBC Driver Registered ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\SOFTWARE\\ODBC\\ODBCINST.INI*" and RegistryKey endswith "\\Driver") and (not((RegistryValueData =~ "%WINDIR%\\System32\\SQLSRV32.dll" and RegistryKey endswith "\\SQL Server*"))) and (not(((RegistryValueData endswith "\\ACEODBC.DLL" and RegistryValueData startswith "C:\\Progra" and RegistryKey contains "\\Microsoft Access ") or (RegistryValueData endswith "\\ACEODBC.DLL" and RegistryValueData startswith "C:\\Progra" and RegistryKey contains "\\Microsoft Excel Driver"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_aedebug_persistence.yml
Add Debugger Entry To AeDebug For Persistence ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData endswith ".dll" and RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug\\Debugger") and (not(RegistryValueData =~ "\"C:\\WINDOWS\\system32\\vsjitdebugger.exe\" -p %ld -e %ld -j 0x%p"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_custom_file_open_handler_powershell_execution.yml
Custom File Open Handler Executes PowerShell ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "powershell" and RegistryValueData contains "-command") and RegistryKey endswith "shell\\open\\command*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_disable_macroruntimescanscope.yml
Disable Macro Runtime Scan Scope ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\SOFTWARE*" and RegistryKey endswith "\\Microsoft\\Office*" and RegistryKey contains "\\Common\\Security") and RegistryKey endswith "\\MacroRuntimeScanScope"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_dhcp_calloutdll.yml
DHCP Callout DLL Installation ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Services\\DHCPServer\\Parameters\\CalloutDlls" or RegistryKey endswith "\\Services\\DHCPServer\\Parameters\\CalloutEnabled"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_office.yml
Office Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Software\\Wow6432Node\\Microsoft\\Office" or RegistryKey contains "\\Software\\Microsoft\\Office") and (RegistryKey contains "\\Word\\Addins" or RegistryKey contains "\\PowerPoint\\Addins" or RegistryKey contains "\\Outlook\\Addins" or RegistryKey contains "\\Onenote\\Addins" or RegistryKey contains "\\Excel\\Addins" or RegistryKey contains "\\Access\\Addins" or RegistryKey contains "test\\Special\\Perf") and (not(((InitiatingProcessFolderPath =~ "C:\\Program Files\\AVG\\Antivirus\\RegSvr.exe" and RegistryKey endswith "\\Microsoft\\Office\\Outlook\\Addins\\Antivirus.AsOutExt*") or RegistryValueData =~ "(Empty)" or ((InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft Office\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft Office\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\msiexec.exe" or InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\regsvr32.exe") and (RegistryKey endswith "\\Excel\\Addins\\AdHocReportingExcelClientLib.AdHocReportingExcelClientAddIn.1*" or RegistryKey endswith "\\Excel\\Addins\\ExcelPlugInShell.PowerMapConnect*" or RegistryKey endswith "\\Excel\\Addins\\NativeShim*" or RegistryKey endswith "\\Excel\\Addins\\NativeShim.InquireConnector.1*" or RegistryKey endswith "\\Excel\\Addins\\PowerPivotExcelClientAddIn.NativeEntry.1*" or RegistryKey endswith "\\Outlook\\AddIns\\AccessAddin.DC*" or RegistryKey endswith "\\Outlook\\AddIns\\ColleagueImport.ColleagueImportAddin*" or RegistryKey endswith "\\Outlook\\AddIns\\EvernoteCC.EvernoteContactConnector*" or RegistryKey endswith "\\Outlook\\AddIns\\EvernoteOLRD.Connect*" or RegistryKey endswith "\\Outlook\\Addins\\Microsoft.VbaAddinForOutlook.1*" or RegistryKey endswith "\\Outlook\\Addins\\OcOffice.OcForms*" or RegistryKey contains "\\Outlook\\Addins\\OneNote.OutlookAddin" or RegistryKey endswith "\\Outlook\\Addins\\OscAddin.Connect*" or RegistryKey endswith "\\Outlook\\Addins\\OutlookChangeNotifier.Connect*" or RegistryKey contains "\\Outlook\\Addins\\UCAddin.LyncAddin.1" or RegistryKey contains "\\Outlook\\Addins\\UCAddin.UCAddin.1" or RegistryKey endswith "\\Outlook\\Addins\\UmOutlookAddin.FormRegionAddin*")) or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\")))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_amsi_com_hijack.yml
Potential AMSI COM Server Hijacking ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\CLSID\\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\\InProcServer32\\(Default)" and (not(RegistryValueData =~ "%windir%\\system32\\amsi.dll"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_set_nopolicies_user.yml
Registry Explorer Policy Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoLogOff" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFind" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFileMenu" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetTaskbar" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyDocuments" or RegistryKey endswith "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoTrayContextMenu")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_winlogon_allow_multiple_tssessions.yml
Winlogon AllowMultipleTSSessions Enable ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData endswith "DWORD (0x00000001)" and RegistryKey endswith "\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AllowMultipleTSSessions"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_shim_database_susp_application.yml
Suspicious Shim Database Patching Activity ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Custom*" and (RegistryKey endswith "\\csrss.exe" or RegistryKey endswith "\\dllhost.exe" or RegistryKey endswith "\\explorer.exe" or RegistryKey endswith "\\RuntimeBroker.exe" or RegistryKey endswith "\\services.exe" or RegistryKey endswith "\\sihost.exe" or RegistryKey endswith "\\svchost.exe" or RegistryKey endswith "\\taskhostw.exe" or RegistryKey endswith "\\winlogon.exe" or RegistryKey endswith "\\WmiPrvSe.exe")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_classes.yml
Wow6432Node Classes Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Wow6432Node\\Classes" and (RegistryKey contains "\\Folder\\ShellEx\\ExtShellFolderViews" or RegistryKey contains "\\Folder\\ShellEx\\DragDropHandlers" or RegistryKey contains "\\Folder\\ShellEx\\ColumnHandlers" or RegistryKey contains "\\Directory\\Shellex\\DragDropHandlers" or RegistryKey contains "\\Directory\\Shellex\\CopyHookHandlers" or RegistryKey contains "\\CLSID\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\Instance" or RegistryKey contains "\\CLSID\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\Instance" or RegistryKey contains "\\CLSID\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\Instance" or RegistryKey contains "\\CLSID\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\Instance" or RegistryKey contains "\\AllFileSystemObjects\\ShellEx\\DragDropHandlers" or RegistryKey contains "\\ShellEx\\PropertySheetHandlers" or RegistryKey contains "\\ShellEx\\ContextMenuHandlers") and (not(RegistryValueData =~ "(Empty)"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_event_viewer_events_asp.yml
Potential Persistence Via Event Viewer Events.asp ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgram" or RegistryKey contains "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionURL") and (not((RegistryValueData =~ "(Empty)" or (RegistryValueData =~ "%%SystemRoot%%\\PCHealth\\HelpCtr\\Binaries\\HelpCtr.exe" and InitiatingProcessFolderPath endswith "C:\\WINDOWS\\system32\\svchost.exe" and RegistryKey endswith "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgram") or (RegistryValueData =~ "-url hcp://services/centers/support*topic=%%s" and InitiatingProcessFolderPath endswith "C:\\WINDOWS\\system32\\svchost.exe" and RegistryKey endswith "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgramCommandLineParameters") or RegistryValueData =~ "http://go.microsoft.com/fwlink/events.asp")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_winsat.yml
UAC Bypass Abusing Winsat Path Parsing - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData endswith "\\appdata\\local\\temp\\system32\\winsat.exe" and RegistryValueData startswith "c:\\users\\" and RegistryKey contains "\\Root\\InventoryApplicationFile\\winsat.exe|" and RegistryKey endswith "\\LowerCaseLongPath"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_system_scripts.yml
System Scripts Autorun Keys Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Policies\\Microsoft\\Windows\\System\\Scripts" and (RegistryKey contains "\\Startup" or RegistryKey contains "\\Shutdown" or RegistryKey contains "\\Logon" or RegistryKey contains "\\Logoff") and (not(RegistryValueData =~ "(Empty)"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_blackbyte_ransomware.yml
Blackbyte Ransomware Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey in~ ("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy", "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLinkedConnections", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet001\\Control\\FileSystem\\LongPathsEnabled"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_outlook_enable_load_macro_provider_on_boot.yml
Potential Persistence Via Outlook LoadMacroProviderOnBoot Setting ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData contains "0x00000001" and RegistryKey endswith "\\Outlook\\LoadMacroProviderOnBoot"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_office_enable_dde.yml
Enable Microsoft Dynamic Data Exchange ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\Excel\\Security\\DisableDDEServerLaunch" or RegistryKey endswith "\\Excel\\Security\\DisableDDEServerLookup")) or ((RegistryValueData in~ ("DWORD (0x00000001)", "DWORD (0x00000002)")) and RegistryKey endswith "\\Word\\Security\\AllowDDE")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_clickonce_trust_prompt.yml
ClickOnce Trust Prompt Tampering ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "Enabled" and RegistryKey endswith "\\SOFTWARE\\MICROSOFT\\.NETFramework\\Security\\TrustManager\\PromptingLevel*" and (RegistryKey endswith "\\Internet" or RegistryKey endswith "\\LocalIntranet" or RegistryKey endswith "\\MyComputer" or RegistryKey endswith "\\TrustedSites" or RegistryKey endswith "\\UntrustedSites")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_hide_file.yml
Displaying Hidden Files Feature Disabled ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000000)" and (RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowSuperHidden" or RegistryKey endswith "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_sip_persistence.yml
Persistence Via New SIP Provider ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryKey contains "\\Dll" or RegistryKey contains "\\$DLL") and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Cryptography\\Providers*" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType" or RegistryKey endswith "\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\Providers*" or RegistryKey contains "\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\OID\\EncodingType")) and (not(((RegistryValueData in~ ("WINTRUST.DLL", "mso.dll")) or (RegistryValueData =~ "C:\\Windows\\System32\\PsfSip.dll" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\poqexec.exe" and RegistryKey contains "\\CryptSIPDll"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_add_load_service_in_safe_mode.yml
Registry Persistence via Service in Safe Mode ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData =~ "Service" and (RegistryKey endswith "\\Control\\SafeBoot\\Minimal*" or RegistryKey endswith "\\Control\\SafeBoot\\Network*") and RegistryKey endswith "\\(Default)") and (not((InitiatingProcessFolderPath =~ "C:\\WINDOWS\\system32\\msiexec.exe" and (RegistryKey endswith "\\Control\\SafeBoot\\Minimal\\SAVService\\(Default)" or RegistryKey endswith "\\Control\\SafeBoot\\Network\\SAVService\\(Default)"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_persistence_mpnotify.yml
Potential Persistence Via Mpnotify ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\mpnotify"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_change_security_zones.yml
IE Change Domain Zone ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains*" and (not((RegistryValueData in~ ("DWORD (0x00000000)", "DWORD (0x00000001)", "(Empty)"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_sdclt.yml
UAC Bypass via Sdclt ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand" or (RegistryValueData matches regex "-1[0-9]{3}\\\\Software\\\\Classes\\\\" and RegistryKey endswith "Software\\Classes\\Folder\\shell\\open\\command\\SymbolicLinkValue")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_defender_exclusions.yml
Windows Defender Exclusions Added - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Microsoft\\Windows Defender\\Exclusions"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_telemetry_persistence.yml
Potential Registry Persistence Attempt Via Windows Telemetry ---> KQL Query:
DeviceRegistryEvents
| where ((RegistryValueData contains ".bat" or RegistryValueData contains ".bin" or RegistryValueData contains ".cmd" or RegistryValueData contains ".dat" or RegistryValueData contains ".dll" or RegistryValueData contains ".exe" or RegistryValueData contains ".hta" or RegistryValueData contains ".jar" or RegistryValueData contains ".js" or RegistryValueData contains ".msi" or RegistryValueData contains ".ps" or RegistryValueData contains ".sh" or RegistryValueData contains ".vb") and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController*" and RegistryKey endswith "\\Command") and (not((RegistryValueData contains "\\system32\\CompatTelRunner.exe" or RegistryValueData contains "\\system32\\DeviceCensus.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_dbgmanageddebugger_persistence.yml
Potential Registry Persistence Attempt Via DbgManagedDebugger ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Microsoft\\.NETFramework\\DbgManagedDebugger" and (not(RegistryValueData =~ "\"C:\\Windows\\system32\\vsjitdebugger.exe\" PID %d APPDOM %d EXTEXT \"%s\" EVTHDL %d"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_turn_on_dev_features.yml
Potential Signing Bypass Via Windows Developer Features - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and (RegistryKey contains "\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock" or RegistryKey endswith "\\Policies\\Microsoft\\Windows\\Appx*") and (RegistryKey endswith "\\AllowAllTrustedApps" or RegistryKey endswith "\\AllowDevelopmentWithoutDevLicense")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_dns_server_level_plugin_dll.yml
New DNS ServerLevelPluginDll Installed ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\services\\DNS\\Parameters\\ServerLevelPluginDll"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_set/registry_set_file_association_exefile.yml
New File Association Using Exefile ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "exefile" and RegistryKey contains "Classes\\."

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_pua_sysinternals_execution_via_eula.yml
PUA - Sysinternal Tool Execution - Registry ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "RegistryKeyCreated" and RegistryKey endswith "\\EulaAccepted"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_malware_netwire.yml
Potential NetWire RAT Activity - Registry ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "RegistryKeyCreated" and RegistryKey contains "\\software\\NetWire"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_persistence_com_key_linking.yml
Potential COM Object Hijacking Via TreatAs Subkey - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "RegistryKeyCreated" and (RegistryKey endswith "HKU*" and RegistryKey endswith "Classes\\CLSID*" and RegistryKey contains "\\TreatAs")) and (not(InitiatingProcessFolderPath =~ "C:\\WINDOWS\\system32\\svchost.exe"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_persistence_amsi_providers.yml
Potential Persistence Via New AMSI Providers - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "RegistryKeyCreated" and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\AMSI\\Providers*" or RegistryKey endswith "\\SOFTWARE\\WOW6432Node\\Microsoft\\AMSI\\Providers*")) and (not((InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_pua_sysinternals_susp_execution_via_eula.yml
PUA - Sysinternals Tools Execution - Registry ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "RegistryKeyCreated" and (RegistryKey contains "\\Active Directory Explorer" or RegistryKey contains "\\Handle" or RegistryKey contains "\\LiveKd" or RegistryKey contains "\\Process Explorer" or RegistryKey contains "\\ProcDump" or RegistryKey contains "\\PsExec" or RegistryKey contains "\\PsLoglist" or RegistryKey contains "\\PsPasswd" or RegistryKey contains "\\SDelete" or RegistryKey contains "\\Sysinternals") and RegistryKey endswith "\\EulaAccepted"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_persistence_logon_scripts_userinitmprlogonscript.yml
Potential Persistence Via Logon Scripts - Registry ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "RegistryKeyCreated" and RegistryKey contains "UserInitMprLogonScript"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_pua_sysinternals_renamed_execution_via_eula.yml
Suspicious Execution Of Renamed Sysinternals Tools - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "RegistryKeyCreated" and (RegistryKey contains "\\Active Directory Explorer" or RegistryKey contains "\\Handle" or RegistryKey contains "\\LiveKd" or RegistryKey contains "\\ProcDump" or RegistryKey contains "\\Process Explorer" or RegistryKey contains "\\PsExec" or RegistryKey contains "\\PsLoggedon" or RegistryKey contains "\\PsLoglist" or RegistryKey contains "\\PsPasswd" or RegistryKey contains "\\PsPing" or RegistryKey contains "\\PsService" or RegistryKey contains "\\SDelete") and RegistryKey endswith "\\EulaAccepted") and (not((InitiatingProcessFolderPath endswith "\\ADExplorer.exe" or InitiatingProcessFolderPath endswith "\\ADExplorer64.exe" or InitiatingProcessFolderPath endswith "\\handle.exe" or InitiatingProcessFolderPath endswith "\\handle64.exe" or InitiatingProcessFolderPath endswith "\\livekd.exe" or InitiatingProcessFolderPath endswith "\\livekd64.exe" or InitiatingProcessFolderPath endswith "\\procdump.exe" or InitiatingProcessFolderPath endswith "\\procdump64.exe" or InitiatingProcessFolderPath endswith "\\procexp.exe" or InitiatingProcessFolderPath endswith "\\procexp64.exe" or InitiatingProcessFolderPath endswith "\\PsExec.exe" or InitiatingProcessFolderPath endswith "\\PsExec64.exe" or InitiatingProcessFolderPath endswith "\\PsLoggedon.exe" or InitiatingProcessFolderPath endswith "\\PsLoggedon64.exe" or InitiatingProcessFolderPath endswith "\\psloglist.exe" or InitiatingProcessFolderPath endswith "\\psloglist64.exe" or InitiatingProcessFolderPath endswith "\\pspasswd.exe" or InitiatingProcessFolderPath endswith "\\pspasswd64.exe" or InitiatingProcessFolderPath endswith "\\PsPing.exe" or InitiatingProcessFolderPath endswith "\\PsPing64.exe" or InitiatingProcessFolderPath endswith "\\PsService.exe" or InitiatingProcessFolderPath endswith "\\PsService64.exe" or InitiatingProcessFolderPath endswith "\\sdelete.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_add/registry_add_persistence_disk_cleanup_handler_entry.yml
Potential Persistence Via Disk Cleanup Handler - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "RegistryKeyCreated" and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VolumeCaches*") and (not((RegistryKey endswith "\\Active Setup Temp Folders" or RegistryKey endswith "\\BranchCache" or RegistryKey endswith "\\Content Indexer Cleaner" or RegistryKey endswith "\\D3D Shader Cache" or RegistryKey endswith "\\Delivery Optimization Files" or RegistryKey endswith "\\Device Driver Packages" or RegistryKey endswith "\\Diagnostic Data Viewer database files" or RegistryKey endswith "\\Downloaded Program Files" or RegistryKey endswith "\\DownloadsFolder" or RegistryKey endswith "\\Feedback Hub Archive log files" or RegistryKey endswith "\\Internet Cache Files" or RegistryKey endswith "\\Language Pack" or RegistryKey endswith "\\Microsoft Office Temp Files" or RegistryKey endswith "\\Offline Pages Files" or RegistryKey endswith "\\Old ChkDsk Files" or RegistryKey endswith "\\Previous Installations" or RegistryKey endswith "\\Recycle Bin" or RegistryKey endswith "\\RetailDemo Offline Content" or RegistryKey endswith "\\Setup Log Files" or RegistryKey endswith "\\System error memory dump files" or RegistryKey endswith "\\System error minidump files" or RegistryKey endswith "\\Temporary Files" or RegistryKey endswith "\\Temporary Setup Files" or RegistryKey endswith "\\Temporary Sync Files" or RegistryKey endswith "\\Thumbnail Cache" or RegistryKey endswith "\\Update Cleanup" or RegistryKey endswith "\\Upgrade Discarded Files" or RegistryKey endswith "\\User file versions" or RegistryKey endswith "\\Windows Defender" or RegistryKey endswith "\\Windows Error Reporting Files" or RegistryKey endswith "\\Windows ESD installation files" or RegistryKey endswith "\\Windows Upgrade Log Files")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_sd_value_removal.yml
Removal Of SD Value to Hide Schedule Task - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType in~ ("RegistryKeyDeleted", "RegistryValueDeleted")) and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree*" and RegistryKey contains "SD")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_exploit_guard_protected_folders.yml
Folder Removed From Exploit Guard ProtectedFolders List - Registry ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "DeleteValue" and RegistryKey contains "SOFTWARE\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\ProtectedFolders"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_enable_windows_recall.yml
Windows Recall Feature Enabled - DisableAIDataAnalysis Value Deleted ---> KQL Query:
DeviceRegistryEvents
| where ActionType =~ "DeleteValue" and RegistryKey endswith "\\Microsoft\\Windows\\WindowsAI\\DisableAIDataAnalysis"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_index_value_removal.yml
Removal Of Index Value to Hide Schedule Task - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType in~ ("RegistryKeyDeleted", "RegistryValueDeleted")) and (RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree*" and RegistryKey contains "Index")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_mstsc_history_cleared.yml
Terminal Server Client Connection History Cleared - Registry ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "DeleteValue" and RegistryKey contains "\\Microsoft\\Terminal Server Client\\Default\\MRU") or ((ActionType in~ ("RegistryKeyDeleted", "RegistryValueDeleted")) and RegistryKey endswith "\\Microsoft\\Terminal Server Client\\Servers*")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_removal_amsi_registry_key.yml
Removal Of AMSI Provider Registry Keys ---> KQL Query:
DeviceRegistryEvents
| where (ActionType in~ ("RegistryKeyDeleted", "RegistryValueDeleted")) and (RegistryKey endswith "{2781761E-28E0-4109-99FE-B9D127C57AFE}" or RegistryKey endswith "{A7C452EF-8E9F-42EB-9F2B-245613CA0DC9}")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_delete/registry_delete_removal_com_hijacking_registry_key.yml
Removal of Potential COM Hijacking Registry Keys ---> KQL Query:
DeviceRegistryEvents
| where ((ActionType in~ ("RegistryKeyDeleted", "RegistryValueDeleted")) and RegistryKey endswith "\\shell\\open\\command") and (not(((InitiatingProcessFolderPath endswith "\\Dropbox.exe" and RegistryKey contains "\\Dropbox.") or (InitiatingProcessFolderPath endswith "\\Everything.exe" and RegistryKey contains "\\Everything.") or InitiatingProcessFolderPath =~ "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe" or (InitiatingProcessFolderPath endswith "\\installer.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Java\\" and RegistryKey contains "\\Classes\\WOW6432Node\\CLSID\\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}") or (InitiatingProcessFolderPath endswith "\\OfficeClickToRun.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\")) or (InitiatingProcessFolderPath endswith "\\installer.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Opera\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Opera\\")) or (InitiatingProcessFolderPath contains "peazip" and RegistryKey contains "\\PeaZip.") or InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\svchost.exe" or InitiatingProcessFolderPath startswith "C:\\Windows\\Installer\\MSI" or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\Temp\\Wireshark_uninstaller.exe" and RegistryKey endswith "\\wireshark-capture-file*"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appcertdlls_registry_key.yml
Sigma Transformation Error for 'New DLL Added to AppCertDlls Registry Key': Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appinit_dlls_registry_key.yml
Sigma Transformation Error for 'New DLL Added to AppInit_DLLs Registry Key': Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_narrator_feedback_persistance.yml
Narrator's Feedback-Hub Persistence ---> KQL Query:
DeviceRegistryEvents
| where (ActionType =~ "DeleteValue" and RegistryKey endswith "\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute") or RegistryKey endswith "\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\(Default)"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_runkey_winekey.yml
WINEKEY Registry Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Backup Mgr"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_office_test_regadd.yml
Office Application Startup - Office Test ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Software\\Microsoft\\Office test\\Special\\Perf"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_mimikatz_printernightmare.yml
PrinterNightmare Mimikatz Driver Name ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Control\\Print\\Environments\\Windows x64\\Drivers\\Version-3\\QMS 810*" or RegistryKey contains "\\Control\\Print\\Environments\\Windows x64\\Drivers\\Version-3\\mimikatz") or (RegistryKey contains "legitprinter" and RegistryKey contains "\\Control\\Print\\Environments\\Windows") or ((RegistryKey contains "\\Control\\Print\\Environments" or RegistryKey contains "\\CurrentVersion\\Print\\Printers") and (RegistryKey contains "Gentil Kiwi" or RegistryKey contains "mimikatz printer" or RegistryKey contains "Kiwi Legit Printer"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml
UAC Bypass Via Wsreset ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_stickykey_like_backdoor.yml
Sticky Key Like Backdoor Usage - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\atbroker.exe\\Debugger" or RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\HelpPane.exe\\Debugger"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_susp_lsass_dll_load.yml
DLL Load via LSASS ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt" or RegistryKey contains "\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt") and (not(((RegistryValueData in~ ("%%systemroot%%\\system32\\ntdsa.dll", "%%systemroot%%\\system32\\lsadb.dll")) and InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\lsass.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_susp_download_run_key.yml
Suspicious Run Key from Download ---> KQL Query:
DeviceRegistryEvents
| where (InitiatingProcessFolderPath contains "\\Downloads\\" or InitiatingProcessFolderPath contains "\\Temporary Internet Files\\Content.Outlook\\" or InitiatingProcessFolderPath contains "\\Local Settings\\Temporary Internet Files\\") and RegistryKey endswith "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml
Sigma Transformation Error for 'Disable Security Events Logging Adding Reg Key MiniNt': Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_malware_qakbot_registry.yml
Potential Qakbot Registry Activity ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Software\\firm\\soft\\Name"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_susp_mic_cam_access.yml
Suspicious Camera and Microphone Access ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore*" and RegistryKey contains "\\NonPackaged") and (RegistryKey contains "microphone" or RegistryKey contains "webcam") and (RegistryKey contains ":#Windows#Temp#" or RegistryKey contains ":#$Recycle.bin#" or RegistryKey contains ":#Temp#" or RegistryKey contains ":#Users#Public#" or RegistryKey contains ":#Users#Default#" or RegistryKey contains ":#Users#Desktop#")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_ssp_added_lsa_config.yml
Security Support Provider (SSP) Added to LSA Configuration ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "\\Control\\Lsa\\Security Packages" or RegistryKey endswith "\\Control\\Lsa\\OSConfig\\Security Packages") and (not((InitiatingProcessFolderPath in~ ("C:\\Windows\\system32\\msiexec.exe", "C:\\Windows\\syswow64\\MsiExec.exe"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_cmstp_execution_by_registry.yml
CMSTP Execution Registry Event ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\cmmgr32.exe"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_office_trust_record_modification.yml
Windows Registry Trust Record Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Security\\Trusted Documents\\TrustRecords"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_portproxy_registry_key.yml
New PortProxy Registry Entry Added ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Services\\PortProxy\\v4tov4\\tcp*"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_disable_wdigest_credential_guard.yml
Wdigest CredGuard Registry Modification ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\IsCredGuardEnabled"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_susp_atbroker_change.yml
Atbroker Registry Change ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs" or RegistryKey contains "Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\Configuration") and (not(((RegistryValueData =~ "(Empty)" and InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\atbroker.exe" and RegistryKey contains "\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\Configuration") or (InitiatingProcessFolderPath startswith "C:\\Windows\\Installer\\MSI" and RegistryKey contains "Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml
NetNTLM Downgrade Attack - Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey endswith "SYSTEM*" and RegistryKey contains "ControlSet" and RegistryKey contains "\\Control\\Lsa") and (((RegistryValueData in~ ("DWORD (0x00000000)", "DWORD (0x00000001)", "DWORD (0x00000002)")) and RegistryKey endswith "\\lmcompatibilitylevel") or ((RegistryValueData in~ ("DWORD (0x00000000)", "DWORD (0x00000010)", "DWORD (0x00000020)", "DWORD (0x00000030)")) and RegistryKey endswith "\\NtlmMinClientSec") or RegistryKey endswith "\\RestrictSendingNTLMTraffic")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_add_local_hidden_user.yml
Creation of a Local Hidden User Account by Registry ---> KQL Query:
DeviceRegistryEvents
| where InitiatingProcessFolderPath endswith "\\lsass.exe" and RegistryKey endswith "\\SAM\\SAM\\Domains\\Account\\Users\\Names*" and RegistryKey endswith "$"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_runonce_persistence.yml
Run Once Task Configuration in Registry ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Microsoft\\Active Setup\\Installed Components" and RegistryKey endswith "\\StubPath") and (not(((RegistryValueData contains "C:\\Program Files\\Google\\Chrome\\Application\\" and RegistryValueData contains "\\Installer\\chrmstp.exe\" --configure-user-settings --verbose-logging --system-level") or ((RegistryValueData contains "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\" or RegistryValueData contains "C:\\Program Files\\Microsoft\\Edge\\Application\\") and RegistryValueData endswith "\\Installer\\setup.exe\" --configure-user-settings --verbose-logging --system-level --msedge --channel=stable"))))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_redmimicry_winnti_reg.yml
RedMimicry Winnti Playbook Registry Manipulation ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "HKLM\\SOFTWARE\\Microsoft\\HTMLHelp\\data"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_esentutl_volume_shadow_copy_service_keys.yml
Esentutl Volume Shadow Copy Service Keys ---> KQL Query:
DeviceRegistryEvents
| where (InitiatingProcessFolderPath endswith "esentutl.exe" and RegistryKey contains "System\\CurrentControlSet\\Services\\VSS") and (not(RegistryKey contains "System\\CurrentControlSet\\Services\\VSS\\Start"))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_hack_wce_reg.yml
Windows Credential Editor Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "Services\\WCESERVICE\\Start"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_apt_pandemic.yml
Pandemic Registry Key ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SYSTEM\\CurrentControlSet\\services\\null\\Instance"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml
Path To Screensaver Binary Modified ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Control Panel\\Desktop\\SCRNSAVE.EXE" and (not((InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\explorer.exe")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_set_enable_anonymous_connection.yml
Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback ---> KQL Query:
DeviceRegistryEvents
| where RegistryValueData =~ "DWORD (0x00000001)" and RegistryKey contains "\\Microsoft\\WBEM\\CIMOM\\AllowAnonymousCallback"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_hybridconnectionmgr_svc_installation.yml
HybridConnectionManager Service Installation - Registry ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\Services\\HybridConnectionManager" or (RegistryValueData contains "Microsoft.HybridConnectionManager.Listener.exe" and ActionType =~ "RegistryValueSet")

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_mal_azorult.yml
Registry Entries For Azorult Malware ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "SYSTEM*" and RegistryKey endswith "\\services\\localNETService"

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_persistence_recycle_bin.yml
Sigma Transformation Error for 'Registry Persistence Mechanisms in Recycle Bin': Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml
Shell Open Registry Keys Manipulation ---> KQL Query:
DeviceRegistryEvents
| where (RegistryValueData contains "\\Software\\Classes\\{" and ActionType =~ "RegistryValueSet" and RegistryKey endswith "Classes\\ms-settings\\shell\\open\\command\\SymbolicLinkValue") or RegistryKey endswith "Classes\\ms-settings\\shell\\open\\command\\DelegateExecute" or ((ActionType =~ "RegistryValueSet" and (RegistryKey endswith "Classes\\ms-settings\\shell\\open\\command\\(Default)" or RegistryKey endswith "Classes\\exefile\\shell\\open\\command\\(Default)")) and (not(RegistryValueData =~ "(Empty)")))

----------------------------------------
Processing: sigma/rules/windows/registry/registry_event/registry_event_silentprocessexit_lsass.yml
Potential Credential Dumping Via LSASS SilentProcessExit Technique ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\lsass.exe"

----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_target_shell_application.yml
Sigma Transformation Error for 'Remote Thread Created In Shell Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_keepass.yml
Sigma Transformation Error for 'Remote Thread Created In KeePass.EXE': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_mstsc_susp_location.yml
Sigma Transformation Error for 'Remote Thread Creation In Mstsc.Exe From Suspicious Location': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_hktl_cobaltstrike.yml
Sigma Transformation Error for 'HackTool - Potential CobaltStrike Process Injection': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_ttdinjec.yml
Sigma Transformation Error for 'Remote Thread Creation Ttdinject.exe Proxy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_hktl_cactustorch.yml
Sigma Transformation Error for 'HackTool - CACTUSTORCH Remote Thread Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_powershell_susp_targets.yml
Sigma Transformation Error for 'Remote Thread Creation Via PowerShell In Uncommon Target': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_password_dumper_lsass.yml
Sigma Transformation Error for 'Password Dumper Remote Thread in LSASS': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_powershell_lsass.yml
Sigma Transformation Error for 'Potential Credential Dumping Attempt Via PowerShell Remote Thread': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_uncommon_target_image.yml
Sigma Transformation Error for 'Remote Thread Creation In Uncommon Target Image': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_uncommon_source_image.yml
Sigma Transformation Error for 'Remote Thread Creation By Uncommon Source Image': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_remote_thread/create_remote_thread_win_susp_relevant_source_image.yml
Sigma Transformation Error for 'Rare Remote Thread Creation By Uncommon Source Image': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_quickassist_execution.yml
QuickAssist Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\QuickAssist.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_token_obfuscation.yml
Powershell Token Obfuscation - Process Creation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine matches regex "\\w+`(\\w+|-|.)`[\\w+|\\s]" or ProcessCommandLine matches regex ""(\\{\\d\\})+"\\s*-f" or ProcessCommandLine matches regex "(?i)\\$\\{`?e`?n`?v`?:`?p`?a`?t`?h`?\\}") and (not(ProcessCommandLine contains "${env:path}"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_namespace_defender.yml
Potential Windows Defender Tampering Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/Namespace:\\\\root\\Microsoft\\Windows\\Defender" and (ProcessVersionInfoOriginalFileName =~ "wmic.exe" or FolderPath endswith "\\WMIC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rar_susp_greedy_compression.yml
Suspicious Greedy Compression Using Rar.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\rar.exe" or ProcessVersionInfoFileDescription =~ "Command line RAR") or (ProcessCommandLine contains ".exe a " or ProcessCommandLine contains " a -m")) and ((ProcessCommandLine contains " -hp" and ProcessCommandLine contains " -r ") and ((ProcessCommandLine contains " " and ProcessCommandLine contains ":*.") or (ProcessCommandLine contains " " and ProcessCommandLine contains ":\*.") or (ProcessCommandLine contains " " and ProcessCommandLine contains ":\\$Recycle.bin\\") or (ProcessCommandLine contains " " and ProcessCommandLine contains ":\\PerfLogs\\") or (ProcessCommandLine contains " " and ProcessCommandLine contains ":\\Temp") or (ProcessCommandLine contains " " and ProcessCommandLine contains ":\\Users\\Public\\") or (ProcessCommandLine contains " " and ProcessCommandLine contains ":\\Windows\\") or ProcessCommandLine contains " %public%"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_wmiexec_default_powershell.yml
HackTool - Wmiexec Default Powershell Command ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml
UAC Bypass Using ChangePK and SLUI ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\changepk.exe" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessFolderPath endswith "\\slui.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_remote_execution.yml
Potential PsExec Remote Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "accepteula" and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -p " and ProcessCommandLine contains " \\\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_sysmon_discovery_via_default_altitude.yml
Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " 385201" and ((FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe") or (ProcessVersionInfoOriginalFileName in~ ("FIND.EXE", "FINDSTR.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msdt_arbitrary_command_execution.yml
Potential Arbitrary Command Execution Using Msdt.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\msdt.exe" or ProcessVersionInfoOriginalFileName =~ "msdt.exe") and (ProcessCommandLine contains "IT_BrowseForFile=" or (ProcessCommandLine contains " PCWDiagnostic" and (ProcessCommandLine contains " -af " or ProcessCommandLine contains " /af " or ProcessCommandLine contains " af " or ProcessCommandLine contains " af " or ProcessCommandLine contains " af ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ping_hex_ip.yml
Ping Hex IP ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "0x" and FolderPath endswith "\\ping.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_sysnative.yml
Process Creation Using Sysnative Folder ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ":\\Windows\\Sysnative\\" or FolderPath contains ":\\Windows\\Sysnative\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_explorer_break_process_tree.yml
Explorer Process Tree Break ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}" or ((ProcessCommandLine contains "explorer.exe") and (ProcessCommandLine contains " -root," or ProcessCommandLine contains " /root," or ProcessCommandLine contains " root," or ProcessCommandLine contains " root," or ProcessCommandLine contains " root,"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_shell32_susp_execution.yml
Shell32 DLL Execution in Suspicious Directory ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "%AppData%" or ProcessCommandLine contains "%LocalAppData%" or ProcessCommandLine contains "%Temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains "\\AppData\\" or ProcessCommandLine contains "\\Temp\\" or ProcessCommandLine contains "\\Users\\Public\\") and (ProcessCommandLine contains "shell32.dll" and ProcessCommandLine contains "Control_RunDLL")) and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_child_process_as_system_.yml
Suspicious Child Process Created as System ---> KQL Query:
DeviceProcessEvents
| where ((ProcessIntegrityLevel in~ ("System", "S-1-16-16384")) and (InitiatingProcessAccountName contains "AUTHORI" or InitiatingProcessAccountName contains "AUTORI") and ((InitiatingProcessAccountName =~ "NETWORK SERVICE" and InitiatingProcessAccountDomain startswith "") or (InitiatingProcessAccountName =~ "LOCAL SERVICE" and InitiatingProcessAccountDomain startswith "")) and (AccountName contains "AUTHORI" or AccountName contains "AUTORI") and ((AccountName =~ "SYSTEM" and AccountDomain startswith "") or (AccountName =~ "Systme" and AccountDomain startswith "") or (AccountName =~ "" and AccountDomain startswith ""))) and (not((ProcessCommandLine contains "DavSetCookie" and FolderPath endswith "\\rundll32.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bginfo_suspicious_child_process.yml
Suspicious Child Process Of BgInfo.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\notepad.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe") or (FolderPath contains "\\AppData\\Local\\" or FolderPath contains "\\AppData\\Roaming\\" or FolderPath contains ":\\Users\\Public\\" or FolderPath contains ":\\Temp\\" or FolderPath contains ":\\Windows\\Temp\\" or FolderPath contains ":\\PerfLogs\\")) and (InitiatingProcessFolderPath endswith "\\bginfo.exe" or InitiatingProcessFolderPath endswith "\\bginfo64.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winzip_password_compression.yml
Compress Data and Lock With Password for Exfiltration With WINZIP ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -min " or ProcessCommandLine contains " -a ") and ProcessCommandLine contains "-s\"" and (ProcessCommandLine contains "winzip.exe" or ProcessCommandLine contains "winzip64.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_ttdinject.yml
Use of TTDInject.exe ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "ttdinject.exe" or ProcessVersionInfoOriginalFileName =~ "TTDInject.EXE"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_patterns.yml
PowerShell Download Pattern ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "string(" or ProcessCommandLine contains "file(") and (ProcessCommandLine contains "new-object" and ProcessCommandLine contains "net.webclient)." and ProcessCommandLine contains "download")) and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_conhost_uncommon_parent.yml
Conhost Spawned By Uncommon Parent Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\conhost.exe" and (InitiatingProcessFolderPath endswith "\\explorer.exe" or InitiatingProcessFolderPath endswith "\\lsass.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\services.exe" or InitiatingProcessFolderPath endswith "\\smss.exe" or InitiatingProcessFolderPath endswith "\\spoolsv.exe" or InitiatingProcessFolderPath endswith "\\svchost.exe" or InitiatingProcessFolderPath endswith "\\userinit.exe" or InitiatingProcessFolderPath endswith "\\wininit.exe" or InitiatingProcessFolderPath endswith "\\winlogon.exe")) and (not((InitiatingProcessCommandLine contains "-k apphost -s AppHostSvc" or InitiatingProcessCommandLine contains "-k imgsvc" or InitiatingProcessCommandLine contains "-k localService -p -s RemoteRegistry" or InitiatingProcessCommandLine contains "-k LocalSystemNetworkRestricted -p -s NgcSvc" or InitiatingProcessCommandLine contains "-k NetSvcs -p -s NcaSvc" or InitiatingProcessCommandLine contains "-k netsvcs -p -s NetSetupSvc" or InitiatingProcessCommandLine contains "-k netsvcs -p -s wlidsvc" or InitiatingProcessCommandLine contains "-k NetworkService -p -s DoSvc" or InitiatingProcessCommandLine contains "-k wsappx -p -s AppXSvc" or InitiatingProcessCommandLine contains "-k wsappx -p -s ClipSVC" or InitiatingProcessCommandLine contains "-k wusvcs -p -s WaaSMedicSvc"))) and (not((InitiatingProcessCommandLine contains "C:\\Program Files (x86)\\Dropbox\\Client\\" or InitiatingProcessCommandLine contains "C:\\Program Files\\Dropbox\\Client\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msxsl_execution.yml
Msxsl.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\msxsl.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_encode.yml
Suspicious Execution of Powershell with Base64 ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -e " or ProcessCommandLine contains " -en " or ProcessCommandLine contains " -enc " or ProcessCommandLine contains " -enco" or ProcessCommandLine contains " -ec ") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) and (not(((InitiatingProcessFolderPath contains "C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\" or InitiatingProcessFolderPath contains "\\gc_worker.exe") or ProcessCommandLine contains " -Encoding ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_pypykatz.yml
HackTool - Pypykatz Credentials Dumping Activity ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "live" and ProcessCommandLine contains "registry") and (FolderPath endswith "\\pypykatz.exe" or FolderPath endswith "\\python.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_devtoolslauncher.yml
Devtoolslauncher.exe Executes Specified Binary ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "LaunchForDeploy" and FolderPath endswith "\\devtoolslauncher.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_db_recon.yml
Veeam Backup Database Suspicious Query ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "BackupRepositories" or ProcessCommandLine contains "Backups" or ProcessCommandLine contains "Credentials" or ProcessCommandLine contains "HostCreds" or ProcessCommandLine contains "SmbFileShares" or ProcessCommandLine contains "Ssh_creds" or ProcessCommandLine contains "VSphereInfo") and ((ProcessCommandLine contains "VeeamBackup" and ProcessCommandLine contains "From ") and FolderPath endswith "\\sqlcmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_driver_install_susp.yml
Suspicious Driver/DLL Installation Via Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "INSTALLDRIVER " and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe")) and (not(ProcessCommandLine contains ".dll"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml
UAC Bypass Using IEInstal - Process ---> KQL Query:
DeviceProcessEvents
| where FolderPath contains "\\AppData\\Local\\Temp\\" and FolderPath endswith "consent.exe" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessFolderPath endswith "\\ieinstal.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_provlaunch_provisioning_command.yml
Potential Provisioning Registry Key Abuse For Binary Proxy Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "SOFTWARE\\Microsoft\\Provisioning\\Commands\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pressanykey_lolbin_execution.yml
Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\Microsoft.NodejsTools.PressAnyKey.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tscon_rdp_session_hijacking.yml
Potential RDP Session Hijacking Activity ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\tscon.exe" or ProcessVersionInfoOriginalFileName =~ "tscon.exe") and (ProcessIntegrityLevel in~ ("System", "S-1-16-16384"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mssql_susp_child_process.yml
Suspicious Child Process Of SQL Server ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\bash.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\netstat.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\ping.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\tasklist.exe" or FolderPath endswith "\\wsl.exe") and InitiatingProcessFolderPath endswith "\\sqlservr.exe") and (not((ProcessCommandLine startswith "\"C:\\Windows\\system32\\cmd.exe\" " and FolderPath =~ "C:\\Windows\\System32\\cmd.exe" and InitiatingProcessFolderPath endswith "DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft SQL Server\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_stop_service.yml
Stop Windows Service Via PowerShell Stop-Service ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Stop-Service " and ((ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")) or (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_iex.yml
PowerShell Download and Execution Cradles ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".DownloadString(" or ProcessCommandLine contains ".DownloadFile(" or ProcessCommandLine contains "Invoke-WebRequest " or ProcessCommandLine contains "iwr ") and (ProcessCommandLine contains ";iex $" or ProcessCommandLine contains "| IEX" or ProcessCommandLine contains "|IEX " or ProcessCommandLine contains "I`E`X" or ProcessCommandLine contains "I`EX" or ProcessCommandLine contains "IE`X" or ProcessCommandLine contains "iex " or ProcessCommandLine contains "IEX (" or ProcessCommandLine contains "IEX(" or ProcessCommandLine contains "Invoke-Expression")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcwutl.yml
Code Execution via Pcwutl.dll ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "pcwutl" and ProcessCommandLine contains "LaunchApplication") and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_service_tamper.yml
Suspicious Windows Service Tampering ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "143Svc" or ProcessCommandLine contains "Acronis VSS Provider" or ProcessCommandLine contains "AcronisAgent" or ProcessCommandLine contains "AcrSch2Svc" or ProcessCommandLine contains "AdobeARMservice" or ProcessCommandLine contains "AHS Service" or ProcessCommandLine contains "Antivirus" or ProcessCommandLine contains "Apache4" or ProcessCommandLine contains "ARSM" or ProcessCommandLine contains "aswBcc" or ProcessCommandLine contains "AteraAgent" or ProcessCommandLine contains "Avast Business Console Client Antivirus Service" or ProcessCommandLine contains "avast! Antivirus" or ProcessCommandLine contains "AVG Antivirus" or ProcessCommandLine contains "avgAdminClient" or ProcessCommandLine contains "AvgAdminServer" or ProcessCommandLine contains "AVP1" or ProcessCommandLine contains "BackupExec" or ProcessCommandLine contains "bedbg" or ProcessCommandLine contains "BITS" or ProcessCommandLine contains "BrokerInfrastructure" or ProcessCommandLine contains "CASLicenceServer" or ProcessCommandLine contains "CASWebServer" or ProcessCommandLine contains "Client Agent 7.60" or ProcessCommandLine contains "Core Browsing Protection" or ProcessCommandLine contains "Core Mail Protection" or ProcessCommandLine contains "Core Scanning Server" or ProcessCommandLine contains "DCAgent" or ProcessCommandLine contains "dwmrcs" or ProcessCommandLine contains "EhttpSr" or ProcessCommandLine contains "ekrn" or ProcessCommandLine contains "Enterprise Client Service" or ProcessCommandLine contains "epag" or ProcessCommandLine contains "EPIntegrationService" or ProcessCommandLine contains "EPProtectedService" or ProcessCommandLine contains "EPRedline" or ProcessCommandLine contains "EPSecurityService" or ProcessCommandLine contains "EPUpdateService" or ProcessCommandLine contains "EraserSvc11710" or ProcessCommandLine contains "EsgShKernel" or ProcessCommandLine contains "ESHASRV" or ProcessCommandLine contains "FA_Scheduler" or ProcessCommandLine contains "FirebirdGuardianDefaultInstance" or ProcessCommandLine contains "FirebirdServerDefaultInstance" or ProcessCommandLine contains "FontCache3.0.0.0" or ProcessCommandLine contains "HealthTLService" or ProcessCommandLine contains "hmpalertsvc" or ProcessCommandLine contains "HMS" or ProcessCommandLine contains "HostControllerService" or ProcessCommandLine contains "hvdsvc" or ProcessCommandLine contains "IAStorDataMgrSvc" or ProcessCommandLine contains "IBMHPS" or ProcessCommandLine contains "ibmspsvc" or ProcessCommandLine contains "IISAdmin" or ProcessCommandLine contains "IMANSVC" or ProcessCommandLine contains "IMAP4Svc" or ProcessCommandLine contains "instance2" or ProcessCommandLine contains "KAVFS" or ProcessCommandLine contains "KAVFSGT" or ProcessCommandLine contains "kavfsslp" or ProcessCommandLine contains "KeyIso" or ProcessCommandLine contains "klbackupdisk" or ProcessCommandLine contains "klbackupflt" or ProcessCommandLine contains "klflt" or ProcessCommandLine contains "klhk" or ProcessCommandLine contains "KLIF" or ProcessCommandLine contains "klim6" or ProcessCommandLine contains "klkbdflt" or ProcessCommandLine contains "klmouflt" or ProcessCommandLine contains "klnagent" or ProcessCommandLine contains "klpd" or ProcessCommandLine contains "kltap" or ProcessCommandLine contains "KSDE1.0.0" or ProcessCommandLine contains "LogProcessorService" or ProcessCommandLine contains "M8EndpointAgent" or ProcessCommandLine contains "macmnsvc" or ProcessCommandLine contains "masvc" or ProcessCommandLine contains "MBAMService" or ProcessCommandLine contains "MBCloudEA" or ProcessCommandLine contains "MBEndpointAgent" or ProcessCommandLine contains "McAfeeDLPAgentService" or ProcessCommandLine contains "McAfeeEngineService" or ProcessCommandLine contains "MCAFEEEVENTPARSERSRV" or ProcessCommandLine contains "McAfeeFramework" or ProcessCommandLine contains "MCAFEETOMCATSRV530" or ProcessCommandLine contains "McShield" or ProcessCommandLine contains "McTaskManager" or ProcessCommandLine contains "mfefire" or ProcessCommandLine contains "mfemms" or ProcessCommandLine contains "mfevto" or ProcessCommandLine contains "mfevtp" or ProcessCommandLine contains "mfewc" or ProcessCommandLine contains "MMS" or ProcessCommandLine contains "mozyprobackup" or ProcessCommandLine contains "mpssvc" or ProcessCommandLine contains "MSComplianceAudit" or ProcessCommandLine contains "MSDTC" or ProcessCommandLine contains "MsDtsServer" or ProcessCommandLine contains "MSExchange" or ProcessCommandLine contains "msftesq1SPROO" or ProcessCommandLine contains "msftesql$PROD" or ProcessCommandLine contains "msftesql$SQLEXPRESS" or ProcessCommandLine contains "MSOLAP$SQL_2008" or ProcessCommandLine contains "MSOLAP$SYSTEM_BGC" or ProcessCommandLine contains "MSOLAP$TPS" or ProcessCommandLine contains "MSOLAP$TPSAMA" or ProcessCommandLine contains "MSOLAPSTPS" or ProcessCommandLine contains "MSOLAPSTPSAMA" or ProcessCommandLine contains "mssecflt" or ProcessCommandLine contains "MSSQ!I.SPROFXENGAGEMEHT" or ProcessCommandLine contains "MSSQ0SHAREPOINT" or ProcessCommandLine contains "MSSQ0SOPHOS" or ProcessCommandLine contains "MSSQL" or ProcessCommandLine contains "MSSQLFDLauncher$" or ProcessCommandLine contains "MySQL" or ProcessCommandLine contains "NanoServiceMain" or ProcessCommandLine contains "NetMsmqActivator" or ProcessCommandLine contains "NetPipeActivator" or ProcessCommandLine contains "netprofm" or ProcessCommandLine contains "NetTcpActivator" or ProcessCommandLine contains "NetTcpPortSharing" or ProcessCommandLine contains "ntrtscan" or ProcessCommandLine contains "nvspwmi" or ProcessCommandLine contains "ofcservice" or ProcessCommandLine contains "Online Protection System" or ProcessCommandLine contains "OracleClientCache80" or ProcessCommandLine contains "OracleDBConsole" or ProcessCommandLine contains "OracleMTSRecoveryService" or ProcessCommandLine contains "OracleOraDb11g_home1" or ProcessCommandLine contains "OracleService" or ProcessCommandLine contains "OracleVssWriter" or ProcessCommandLine contains "osppsvc" or ProcessCommandLine contains "PandaAetherAgent" or ProcessCommandLine contains "PccNTUpd" or ProcessCommandLine contains "PDVFSService" or ProcessCommandLine contains "POP3Svc" or ProcessCommandLine contains "postgresql-x64-9.4" or ProcessCommandLine contains "POVFSService" or ProcessCommandLine contains "PSUAService" or ProcessCommandLine contains "Quick Update Service" or ProcessCommandLine contains "RepairService" or ProcessCommandLine contains "ReportServer" or ProcessCommandLine contains "ReportServer$" or ProcessCommandLine contains "RESvc" or ProcessCommandLine contains "RpcEptMapper" or ProcessCommandLine contains "sacsvr" or ProcessCommandLine contains "SamSs" or ProcessCommandLine contains "SAVAdminService" or ProcessCommandLine contains "SAVService" or ProcessCommandLine contains "ScSecSvc" or ProcessCommandLine contains "SDRSVC" or ProcessCommandLine contains "SearchExchangeTracing" or ProcessCommandLine contains "sense" or ProcessCommandLine contains "SentinelAgent" or ProcessCommandLine contains "SentinelHelperService" or ProcessCommandLine contains "SepMasterService" or ProcessCommandLine contains "ShMonitor" or ProcessCommandLine contains "Smcinst" or ProcessCommandLine contains "SmcService" or ProcessCommandLine contains "SMTPSvc" or ProcessCommandLine contains "SNAC" or ProcessCommandLine contains "SntpService" or ProcessCommandLine contains "Sophos" or ProcessCommandLine contains "SQ1SafeOLRService" or ProcessCommandLine contains "SQL Backups" or ProcessCommandLine contains "SQL Server" or ProcessCommandLine contains "SQLAgent" or ProcessCommandLine contains "SQLANYs_Sage_FAS_Fixed_Assets" or ProcessCommandLine contains "SQLBrowser" or ProcessCommandLine contains "SQLsafe" or ProcessCommandLine contains "SQLSERVERAGENT" or ProcessCommandLine contains "SQLTELEMETRY" or ProcessCommandLine contains "SQLWriter" or ProcessCommandLine contains "SSISTELEMETRY130" or ProcessCommandLine contains "SstpSvc" or ProcessCommandLine contains "storflt" or ProcessCommandLine contains "svcGenericHost" or ProcessCommandLine contains "swc_service" or ProcessCommandLine contains "swi_filter" or ProcessCommandLine contains "swi_service" or ProcessCommandLine contains "swi_update" or ProcessCommandLine contains "Symantec" or ProcessCommandLine contains "sysmon" or ProcessCommandLine contains "TeamViewer" or ProcessCommandLine contains "Telemetryserver" or ProcessCommandLine contains "ThreatLockerService" or ProcessCommandLine contains "TMBMServer" or ProcessCommandLine contains "TmCCSF" or ProcessCommandLine contains "TmFilter" or ProcessCommandLine contains "TMiCRCScanService" or ProcessCommandLine contains "tmlisten" or ProcessCommandLine contains "TMLWCSService" or ProcessCommandLine contains "TmPfw" or ProcessCommandLine contains "TmPreFilter" or ProcessCommandLine contains "TmProxy" or ProcessCommandLine contains "TMSmartRelayService" or ProcessCommandLine contains "tmusa" or ProcessCommandLine contains "Tomcat" or ProcessCommandLine contains "Trend Micro Deep Security Manager" or ProcessCommandLine contains "TrueKey" or ProcessCommandLine contains "UFNet" or ProcessCommandLine contains "UI0Detect" or ProcessCommandLine contains "UniFi" or ProcessCommandLine contains "UTODetect" or ProcessCommandLine contains "vds" or ProcessCommandLine contains "Veeam" or ProcessCommandLine contains "VeeamDeploySvc" or ProcessCommandLine contains "Veritas System Recovery" or ProcessCommandLine contains "vmic" or ProcessCommandLine contains "VMTools" or ProcessCommandLine contains "vmvss" or ProcessCommandLine contains "VSApiNt" or ProcessCommandLine contains "VSS" or ProcessCommandLine contains "W3Svc" or ProcessCommandLine contains "wbengine" or ProcessCommandLine contains "WdNisSvc" or ProcessCommandLine contains "WeanClOudSve" or ProcessCommandLine contains "Weems JY" or ProcessCommandLine contains "WinDefend" or ProcessCommandLine contains "wmms" or ProcessCommandLine contains "wozyprobackup" or ProcessCommandLine contains "WPFFontCache_v0400" or ProcessCommandLine contains "WRSVC" or ProcessCommandLine contains "wsbexchange" or ProcessCommandLine contains "WSearch" or ProcessCommandLine contains "wscsvc" or ProcessCommandLine contains "Zoolz 2 Service") and ((ProcessCommandLine contains " delete " or ProcessCommandLine contains " pause " or ProcessCommandLine contains " stop " or ProcessCommandLine contains "Stop-Service " or ProcessCommandLine contains "Remove-Service ") or (ProcessCommandLine contains "config" and ProcessCommandLine contains "start=disabled")) and ((ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe", "PowerShell.EXE", "psservice.exe", "pwsh.dll", "sc.exe")) or (FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\PsService.exe" or FolderPath endswith "\\PsService64.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\sc.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_add_windows_capability.yml
Add Windows Capability Via PowerShell Cmdlet ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "OpenSSH." and ProcessCommandLine contains "Add-WindowsCapability" and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_php_inline_command_execution.yml
Php Inline Command Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -r" and (FolderPath endswith "\\php.exe" or ProcessVersionInfoOriginalFileName =~ "php.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_koadic.yml
HackTool - Koadic Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/q" and ProcessCommandLine contains "/c" and ProcessCommandLine contains "chcp") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_use_mount_internet_share.yml
Windows Internet Hosted WebDav Share Mount Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " use " and ProcessCommandLine contains " http") and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_1.yml
Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 1 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains ""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rpd_file_susp_parent.yml
Mstsc.EXE Execution From Uncommon Parent ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\mstsc.exe" or ProcessVersionInfoOriginalFileName =~ "mstsc.exe") and (InitiatingProcessFolderPath endswith "\\brave.exe" or InitiatingProcessFolderPath endswith "\\CCleanerBrowser.exe" or InitiatingProcessFolderPath endswith "\\chrome.exe" or InitiatingProcessFolderPath endswith "\\chromium.exe" or InitiatingProcessFolderPath endswith "\\firefox.exe" or InitiatingProcessFolderPath endswith "\\iexplore.exe" or InitiatingProcessFolderPath endswith "\\microsoftedge.exe" or InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_targetfolder.yml
File Download Via Bitsadmin To A Suspicious Target Folder ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /transfer " or ProcessCommandLine contains " /create " or ProcessCommandLine contains " /addfile ") and (ProcessCommandLine contains ":\\Perflogs" or ProcessCommandLine contains ":\\ProgramData\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\AppData\\Roaming\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "%ProgramData%" or ProcessCommandLine contains "%public%") and (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_imagingdevices_unusual_parents.yml
ImagingDevices Unusual Parent/Child Processes ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\ImagingDevices.exe" or (FolderPath endswith "\\ImagingDevices.exe" and (InitiatingProcessFolderPath endswith "\\WmiPrvSE.exe" or InitiatingProcessFolderPath endswith "\\svchost.exe" or InitiatingProcessFolderPath endswith "\\dllhost.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dnx_execute_csharp_code.yml
Potential Application Whitelisting Bypass via Dnx.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\dnx.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mofcomp_execution.yml
Potential Suspicious Mofcomp Execution ---> KQL Query:
DeviceProcessEvents
| where (((InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\wsl.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe") or (ProcessCommandLine contains "\\AppData\\Local\\Temp" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\WINDOWS\\Temp\\" or ProcessCommandLine contains "%temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains "%appdata%")) and (FolderPath endswith "\\mofcomp.exe" or ProcessVersionInfoOriginalFileName =~ "mofcomp.exe")) and (not((ProcessCommandLine contains "C:\\Windows\\TEMP\\" and ProcessCommandLine endswith ".mof" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"))) and (not((ProcessCommandLine contains "C:\\Windows\\TEMP\\" and ProcessCommandLine endswith ".mof")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_cookie_hijacking.yml
Potential Cookies Session Hijacking ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine matches regex "\\s-c\\s" or ProcessCommandLine contains "--cookie-jar") and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ldifde_file_load.yml
Import LDAP Data Interchange Format File Via Ldifde.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-i" and ProcessCommandLine contains "-f") and (FolderPath endswith "\\ldifde.exe" or ProcessVersionInfoOriginalFileName =~ "ldifde.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_set_policies_to_unsecure_level.yml
Change PowerShell Policies to an Insecure Level ---> KQL Query:
DeviceProcessEvents
| where ((ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")) or (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) and (ProcessCommandLine contains "Bypass" or ProcessCommandLine contains "Unrestricted") and (ProcessCommandLine contains "-executionpolicy " or ProcessCommandLine contains " -ep " or ProcessCommandLine contains " -exec ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_query_registry.yml
Potential Configuration And Service Reconnaissance Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "query" and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe") and (ProcessCommandLine contains "currentVersion\\windows" or ProcessCommandLine contains "winlogon\\" or ProcessCommandLine contains "currentVersion\\shellServiceObjectDelayLoad" or ProcessCommandLine contains "currentVersion\\run" or ProcessCommandLine contains "currentVersion\\policies\\explorer\\run" or ProcessCommandLine contains "currentcontrolset\\services")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_csc_susp_parent.yml
Csc.EXE Execution Form Potentially Suspicious Parent ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\csc.exe" or ProcessVersionInfoOriginalFileName =~ "csc.exe") and ((InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\onenote.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") or ((InitiatingProcessCommandLine contains "-Encoded " or InitiatingProcessCommandLine contains "FromBase64String") and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe")) or (InitiatingProcessCommandLine matches regex "([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\\\[Aa]pp[Dd]ata\\\\([Ll]ocal([Ll]ow)?|[Rr]oaming))\\\\[^\\\\]{1,256}$" or (InitiatingProcessCommandLine contains ":\\PerfLogs\\" or InitiatingProcessCommandLine contains ":\\Users\\Public\\" or InitiatingProcessCommandLine contains ":\\Windows\\Temp\\" or InitiatingProcessCommandLine contains "\\Temporary Internet") or (InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Favorites\\") or (InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Favourites\\") or (InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Contacts\\") or (InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Pictures\\"))) and (not(((InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\") or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\sdiagnhost.exe" or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\inetsrv\\w3wp.exe"))) and (not(((InitiatingProcessCommandLine contains "JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw" or InitiatingProcessCommandLine contains "cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA" or InitiatingProcessCommandLine contains "nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA") or InitiatingProcessFolderPath =~ "C:\\ProgramData\\chocolatey\\choco.exe" or InitiatingProcessCommandLine contains "\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpersist.yml
HackTool - SharPersist Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -t schtask -c " or ProcessCommandLine contains " -t startupfolder -c ") or (ProcessCommandLine contains " -t reg -c " and ProcessCommandLine contains " -m add") or (ProcessCommandLine contains " -t service -c " and ProcessCommandLine contains " -m add") or (ProcessCommandLine contains " -t schtask -c " and ProcessCommandLine contains " -m add") or (FolderPath endswith "\\SharPersist.exe" or ProcessVersionInfoProductName =~ "SharPersist")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_non_interactive_execution.yml
Non Interactive PowerShell Process Spawned ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (not(((InitiatingProcessFolderPath endswith ":\\Windows\\explorer.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\System32\\CompatTelRunner.exe" or InitiatingProcessFolderPath endswith ":\\Windows\\SysWOW64\\explorer.exe") or InitiatingProcessFolderPath =~ ":\\$WINDOWS.~BT\\Sources\\SetupHost.exe"))) and (not(((InitiatingProcessFolderPath contains ":\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal_" and InitiatingProcessFolderPath endswith "\\WindowsTerminal.exe") or (InitiatingProcessCommandLine contains " --ms-enable-electron-run-as-node " and InitiatingProcessFolderPath endswith "\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_livekd_execution.yml
Potential Memory Dumping Activity Via LiveKD ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\livekd.exe" or FolderPath endswith "\\livekd64.exe") or ProcessVersionInfoOriginalFileName =~ "livekd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_dll.yml
Potential DLL File Download Via PowerShell Invoke-WebRequest ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Invoke-WebRequest " or ProcessCommandLine contains "IWR ") and (ProcessCommandLine contains "http" and ProcessCommandLine contains "OutFile" and ProcessCommandLine contains ".dll")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wget_download_susp_file_sharing_domains.yml
Suspicious File Download From File Sharing Domain Via Wget.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".ps1" or ProcessCommandLine endswith ".ps1'" or ProcessCommandLine endswith ".ps1\"" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".dat'" or ProcessCommandLine endswith ".dat\"" or ProcessCommandLine endswith ".msi" or ProcessCommandLine endswith ".msi'" or ProcessCommandLine endswith ".msi\"" or ProcessCommandLine endswith ".bat" or ProcessCommandLine endswith ".bat'" or ProcessCommandLine endswith ".bat\"" or ProcessCommandLine endswith ".exe" or ProcessCommandLine endswith ".exe'" or ProcessCommandLine endswith ".exe\"" or ProcessCommandLine endswith ".vbs" or ProcessCommandLine endswith ".vbs'" or ProcessCommandLine endswith ".vbs\"" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbe'" or ProcessCommandLine endswith ".vbe\"" or ProcessCommandLine endswith ".hta" or ProcessCommandLine endswith ".hta'" or ProcessCommandLine endswith ".hta\"" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".dll'" or ProcessCommandLine endswith ".dll\"" or ProcessCommandLine endswith ".psm1" or ProcessCommandLine endswith ".psm1'" or ProcessCommandLine endswith ".psm1\"") and (ProcessCommandLine matches regex "\\s-O\\s" or ProcessCommandLine contains "--output-document") and ProcessCommandLine contains "http" and (FolderPath endswith "\\wget.exe" or ProcessVersionInfoOriginalFileName =~ "wget.exe") and (ProcessCommandLine contains ".githubusercontent.com" or ProcessCommandLine contains "anonfiles.com" or ProcessCommandLine contains "cdn.discordapp.com" or ProcessCommandLine contains "ddns.net" or ProcessCommandLine contains "dl.dropboxusercontent.com" or ProcessCommandLine contains "ghostbin.co" or ProcessCommandLine contains "glitch.me" or ProcessCommandLine contains "gofile.io" or ProcessCommandLine contains "hastebin.com" or ProcessCommandLine contains "mediafire.com" or ProcessCommandLine contains "mega.nz" or ProcessCommandLine contains "onrender.com" or ProcessCommandLine contains "pages.dev" or ProcessCommandLine contains "paste.ee" or ProcessCommandLine contains "pastebin.com" or ProcessCommandLine contains "pastebin.pl" or ProcessCommandLine contains "pastetext.net" or ProcessCommandLine contains "pixeldrain.com" or ProcessCommandLine contains "privatlab.com" or ProcessCommandLine contains "privatlab.net" or ProcessCommandLine contains "send.exploit.in" or ProcessCommandLine contains "sendspace.com" or ProcessCommandLine contains "storage.googleapis.com" or ProcessCommandLine contains "storjshare.io" or ProcessCommandLine contains "supabase.co" or ProcessCommandLine contains "temp.sh" or ProcessCommandLine contains "transfer.sh" or ProcessCommandLine contains "trycloudflare.com" or ProcessCommandLine contains "ufile.io" or ProcessCommandLine contains "w3spaces.com" or ProcessCommandLine contains "workers.dev")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gup_download.yml
File Download Using Notepad++ GUP Utility ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -unzipTo " and ProcessCommandLine contains "http") and (FolderPath endswith "\\GUP.exe" or ProcessVersionInfoOriginalFileName =~ "gup.exe")) and (not(InitiatingProcessFolderPath endswith "\\notepad++.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_wmi_classes.yml
PowerShell Base64 Encoded WMI Classes ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and ((ProcessCommandLine contains "VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA" or ProcessCommandLine contains "cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA" or ProcessCommandLine contains "XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg" or ProcessCommandLine contains "V2luMzJfTG9nZ2VkT25Vc2Vy" or ProcessCommandLine contains "dpbjMyX0xvZ2dlZE9uVXNlc" or ProcessCommandLine contains "XaW4zMl9Mb2dnZWRPblVzZX") or (ProcessCommandLine contains "VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw" or ProcessCommandLine contains "cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA" or ProcessCommandLine contains "XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA" or ProcessCommandLine contains "V2luMzJfUHJvY2Vzc" or ProcessCommandLine contains "dpbjMyX1Byb2Nlc3" or ProcessCommandLine contains "XaW4zMl9Qcm9jZXNz") or (ProcessCommandLine contains "VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA" or ProcessCommandLine contains "cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA" or ProcessCommandLine contains "XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg" or ProcessCommandLine contains "V2luMzJfU2NoZWR1bGVkSm9i" or ProcessCommandLine contains "dpbjMyX1NjaGVkdWxlZEpvY" or ProcessCommandLine contains "XaW4zMl9TY2hlZHVsZWRKb2") or (ProcessCommandLine contains "VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ" or ProcessCommandLine contains "cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA" or ProcessCommandLine contains "XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A" or ProcessCommandLine contains "V2luMzJfU2hhZG93Y29we" or ProcessCommandLine contains "dpbjMyX1NoYWRvd2NvcH" or ProcessCommandLine contains "XaW4zMl9TaGFkb3djb3B5") or (ProcessCommandLine contains "VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A" or ProcessCommandLine contains "cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA" or ProcessCommandLine contains "XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA" or ProcessCommandLine contains "V2luMzJfVXNlckFjY291bn" or ProcessCommandLine contains "dpbjMyX1VzZXJBY2NvdW50" or ProcessCommandLine contains "XaW4zMl9Vc2VyQWNjb3Vud"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_settingsynchost.yml
Using SettingSyncHost.exe as LOLBin ---> KQL Query:
DeviceProcessEvents
| where (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\"))) and (InitiatingProcessCommandLine contains "cmd.exe /c" and InitiatingProcessCommandLine contains "RoamDiag.cmd" and InitiatingProcessCommandLine contains "-outputpath")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_taskmgr_localsystem.yml
Taskmgr as LOCAL_SYSTEM ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\taskmgr.exe" and (AccountName contains "AUTHORI" or AccountName contains "AUTORI")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_allow_service_changes.yml
Allow Service Access Using Security Descriptor Tampering Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe") and (ProcessCommandLine contains "sdset" and ProcessCommandLine contains "A;") and (ProcessCommandLine contains ";IU" or ProcessCommandLine contains ";SU" or ProcessCommandLine contains ";BA" or ProcessCommandLine contains ";SY" or ProcessCommandLine contains ";WD")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_parent_process.yml
Suspicious PowerShell Parent Process ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath contains "tomcat" or (InitiatingProcessFolderPath endswith "\\amigo.exe" or InitiatingProcessFolderPath endswith "\\browser.exe" or InitiatingProcessFolderPath endswith "\\chrome.exe" or InitiatingProcessFolderPath endswith "\\firefox.exe" or InitiatingProcessFolderPath endswith "\\httpd.exe" or InitiatingProcessFolderPath endswith "\\iexplore.exe" or InitiatingProcessFolderPath endswith "\\jbosssvc.exe" or InitiatingProcessFolderPath endswith "\\microsoftedge.exe" or InitiatingProcessFolderPath endswith "\\microsoftedgecp.exe" or InitiatingProcessFolderPath endswith "\\MicrosoftEdgeSH.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\nginx.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\php-cgi.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\services.exe" or InitiatingProcessFolderPath endswith "\\sqlagent.exe" or InitiatingProcessFolderPath endswith "\\sqlserver.exe" or InitiatingProcessFolderPath endswith "\\sqlservr.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\w3wp.exe")) and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessCommandLine contains "/c powershell" or ProcessCommandLine contains "/c pwsh") or ProcessVersionInfoFileDescription =~ "Windows PowerShell" or ProcessVersionInfoProductName =~ "PowerShell Core 6" or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_link_uncommon_parent_process.yml
Uncommon Link.EXE Parent Process ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "LINK /" and FolderPath endswith "\\link.exe") and (not(((InitiatingProcessFolderPath contains "\\VC\\bin\\" or InitiatingProcessFolderPath contains "\\VC\\Tools\\") and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft Visual Studio\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft Visual Studio\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_xwizard_execution_non_default_location.yml
Xwizard.EXE Execution From Non-Default Location ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\xwizard.exe" or ProcessVersionInfoOriginalFileName =~ "xwizard.exe") and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport_susp_exec.yml
Unexpected Error processing 'Remote Access Tool - NetSupport Execution From Unusual Location' (sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport_susp_exec.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wusa_cab_files_extraction_from_susp_paths.yml
Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ":\\PerfLogs\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\Appdata\\Local\\Temp\\") and (ProcessCommandLine contains "/extract:" and FolderPath endswith "\\wusa.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hh_chm_remote_download_or_execution.yml
Remote CHM File Download/Execution Via HH.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://" or ProcessCommandLine contains "\\\\") and (ProcessVersionInfoOriginalFileName =~ "HH.exe" or FolderPath endswith "\\hh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_addinutil_uncommon_cmdline.yml
Uncommon AddinUtil.EXE CommandLine Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-AddInRoot:" or ProcessCommandLine contains "-PipelineRoot:") and (FolderPath endswith "\\addinutil.exe" or ProcessVersionInfoOriginalFileName =~ "AddInUtil.exe")) and (not((ProcessCommandLine contains "-AddInRoot:\"C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA" or ProcessCommandLine contains "-AddInRoot:C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA" or ProcessCommandLine contains "-PipelineRoot:\"C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA" or ProcessCommandLine contains "-PipelineRoot:C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sysmoneop.yml
Unexpected Error processing 'HackTool - SysmonEOP Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_sysmoneop.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_etw_trace_evasion.yml
ETW Trace Evasion Activity ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "cl" and ProcessCommandLine contains "/Trace") or (ProcessCommandLine contains "clear-log" and ProcessCommandLine contains "/Trace") or (ProcessCommandLine contains "sl" and ProcessCommandLine contains "/e:false") or (ProcessCommandLine contains "set-log" and ProcessCommandLine contains "/e:false") or (ProcessCommandLine contains "logman" and ProcessCommandLine contains "update" and ProcessCommandLine contains "trace" and ProcessCommandLine contains "--p" and ProcessCommandLine contains "-ets") or ProcessCommandLine contains "Remove-EtwTraceProvider" or (ProcessCommandLine contains "Set-EtwTraceProvider" and ProcessCommandLine contains "0x11")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_import_module_susp_dirs.yml
Import PowerShell Modules From Suspicious Directories - ProcCreation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Import-Module \"$Env:Temp\\" or ProcessCommandLine contains "Import-Module '$Env:Temp\\" or ProcessCommandLine contains "Import-Module $Env:Temp\\" or ProcessCommandLine contains "Import-Module \"$Env:Appdata\\" or ProcessCommandLine contains "Import-Module '$Env:Appdata\\" or ProcessCommandLine contains "Import-Module $Env:Appdata\\" or ProcessCommandLine contains "Import-Module C:\\Users\\Public\\" or ProcessCommandLine contains "ipmo \"$Env:Temp\\" or ProcessCommandLine contains "ipmo '$Env:Temp\\" or ProcessCommandLine contains "ipmo $Env:Temp\\" or ProcessCommandLine contains "ipmo \"$Env:Appdata\\" or ProcessCommandLine contains "ipmo '$Env:Appdata\\" or ProcessCommandLine contains "ipmo $Env:Appdata\\" or ProcessCommandLine contains "ipmo C:\\Users\\Public\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wbadmin_restore_sensitive_files.yml
Sensitive File Recovery From Backup Via Wbadmin.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "\\config\\SAM" or ProcessCommandLine contains "\\config\\SECURITY" or ProcessCommandLine contains "\\config\\SYSTEM" or ProcessCommandLine contains "\\Windows\\NTDS\\NTDS.dit") and (ProcessCommandLine contains " recovery" and ProcessCommandLine contains "recoveryTarget" and ProcessCommandLine contains "itemtype:File")) and (FolderPath endswith "\\wbadmin.exe" or ProcessVersionInfoOriginalFileName =~ "WBADMIN.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_java_remote_debugging.yml
Java Running with Remote Debugging ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "transport=dt_socket,address=" and (ProcessCommandLine contains "jre1." or ProcessCommandLine contains "jdk1.")) and (not((ProcessCommandLine contains "address=127.0.0.1" or ProcessCommandLine contains "address=localhost")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_eventvwr_recentviews.yml
UAC Bypass Using Event Viewer RecentViews ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\Event Viewer\\RecentViews" or ProcessCommandLine contains "\\EventV~1\\RecentViews") and ProcessCommandLine contains ">"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_response_file.yml
Response File Execution Via Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -f " or ProcessCommandLine contains " /f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " f ") and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe") and ProcessCommandLine contains ".rsp"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_node_abuse.yml
Potential Arbitrary Code Execution Via Node.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -e " or ProcessCommandLine contains " --eval ") and FolderPath endswith "\\node.exe") and (ProcessCommandLine contains ".exec(" and ProcessCommandLine contains "net.socket" and ProcessCommandLine contains ".connect" and ProcessCommandLine contains "child_process")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_masquerading.yml
Potential MsiExec Masquerading ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\msiexec.exe" or ProcessVersionInfoOriginalFileName =~ "\\msiexec.exe") and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_load_by_rundll32.yml
CobaltStrike Load by Rundll32 ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".dll" and (ProcessCommandLine endswith " StartW" or ProcessCommandLine endswith ",StartW")) and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE" or (ProcessCommandLine contains "rundll32.exe" or ProcessCommandLine contains "rundll32 "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_cmd.yml
Operator Bloopers Cobalt Strike Commands ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "psinject" or ProcessCommandLine contains "spawnas" or ProcessCommandLine contains "make_token" or ProcessCommandLine contains "remote-exec" or ProcessCommandLine contains "rev2self" or ProcessCommandLine contains "dcsync" or ProcessCommandLine contains "logonpasswords" or ProcessCommandLine contains "execute-assembly" or ProcessCommandLine contains "getsystem") and (ProcessCommandLine startswith "cmd " or ProcessCommandLine startswith "cmd.exe" or ProcessCommandLine startswith "c:\\windows\\system32\\cmd.exe")) and (ProcessVersionInfoOriginalFileName =~ "Cmd.Exe" or FolderPath endswith "\\cmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_service_dacl_modification_set_service.yml
Suspicious Service DACL Modification Via Set-Service Cmdlet ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\pwsh.exe" or ProcessVersionInfoOriginalFileName =~ "pwsh.dll") and (ProcessCommandLine contains "-SecurityDescriptorSddl " or ProcessCommandLine contains "-sd ") and ((ProcessCommandLine contains ";;;IU" or ProcessCommandLine contains ";;;SU" or ProcessCommandLine contains ";;;BA" or ProcessCommandLine contains ";;;SY" or ProcessCommandLine contains ";;;WD") and (ProcessCommandLine contains "Set-Service " and ProcessCommandLine contains "D;;"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_lsass.yml
LSASS Process Reconnaissance Via Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "lsass" and ((FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe") or (ProcessVersionInfoOriginalFileName in~ ("FIND.EXE", "FINDSTR.EXE")))) or (ProcessCommandLine contains " -i \"lsass" or ProcessCommandLine contains " /i \"lsass" or ProcessCommandLine contains " i \"lsass" or ProcessCommandLine contains " i \"lsass" or ProcessCommandLine contains " i \"lsass" or ProcessCommandLine contains " -i lsass.exe" or ProcessCommandLine contains " /i lsass.exe" or ProcessCommandLine contains " i lsass.exe" or ProcessCommandLine contains " i lsass.exe" or ProcessCommandLine contains " i lsass.exe" or ProcessCommandLine contains "findstr \"lsass" or ProcessCommandLine contains "findstr lsass" or ProcessCommandLine contains "findstr.exe \"lsass" or ProcessCommandLine contains "findstr.exe lsass")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_runonce_execution.yml
Run Once Task Execution as Configured in Registry ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/AlternateShellStartup" or ProcessCommandLine endswith "/r") and (FolderPath endswith "\\runonce.exe" or ProcessVersionInfoFileDescription =~ "Run Once Wrapper")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_keyscrambler_susp_child_process.yml
Potentially Suspicious Child Process of KeyScrambler.exe ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "cscript.exe", "mshta.exe", "PowerShell.EXE", "pwsh.dll", "regsvr32.exe", "RUNDLL32.EXE", "wscript.exe"))) and InitiatingProcessFolderPath endswith "\\KeyScrambler.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_install_quiet.yml
Msiexec Quiet Installation ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-i" or ProcessCommandLine contains "/i" or ProcessCommandLine contains "i" or ProcessCommandLine contains "i" or ProcessCommandLine contains "i" or ProcessCommandLine contains "-package" or ProcessCommandLine contains "/package" or ProcessCommandLine contains "package" or ProcessCommandLine contains "package" or ProcessCommandLine contains "package" or ProcessCommandLine contains "-a" or ProcessCommandLine contains "/a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "-j" or ProcessCommandLine contains "/j" or ProcessCommandLine contains "j" or ProcessCommandLine contains "j" or ProcessCommandLine contains "j") and (FolderPath endswith "\\msiexec.exe" or ProcessVersionInfoOriginalFileName =~ "msiexec.exe") and (ProcessCommandLine contains "-q" or ProcessCommandLine contains "/q" or ProcessCommandLine contains "q" or ProcessCommandLine contains "q" or ProcessCommandLine contains "q")) and (not((((ProcessIntegrityLevel in~ ("System", "S-1-16-16384")) and InitiatingProcessFolderPath =~ "C:\\Windows\\CCM\\Ccm32BitLauncher.exe") or InitiatingProcessFolderPath startswith "C:\\Windows\\Temp\\" or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\" and InitiatingProcessFolderPath startswith "C:\\Users\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_whoami_as_param.yml
WhoAmI as Parameter ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".exe whoami"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_disable_service.yml
Service StartupType Change Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "disabled" or ProcessCommandLine contains "demand") and (ProcessCommandLine contains " config " and ProcessCommandLine contains "start")) and (FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bash_file_execution.yml
Indirect Command Execution From Script File Via Bash.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith ":\\Windows\\System32\\bash.exe" or FolderPath endswith ":\\Windows\\SysWOW64\\bash.exe") or ProcessVersionInfoOriginalFileName =~ "Bash.exe") and (not(((ProcessCommandLine contains "bash.exe -" or ProcessCommandLine contains "bash -") or ProcessCommandLine =~ "" or isnull(ProcessCommandLine) or (ProcessCommandLine in~ ("bash.exe", "bash")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_execution_from_high_priv_process.yml
Whoami.EXE Execution From Privileged Process ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName =~ "whoami.exe" or FolderPath endswith "\\whoami.exe") and (AccountName contains "AUTHORI" or AccountName contains "AUTORI" or AccountName contains "TrustedInstaller")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_servu_susp_child_process.yml
Suspicious Serv-U Process Pattern ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\scriptrunner.exe") and InitiatingProcessFolderPath endswith "\\Serv-U.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_addinutil_uncommon_child_process.yml
Uncommon Child Process Of AddinUtil.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\addinutil.exe" and (not((FolderPath endswith ":\\Windows\\System32\\conhost.exe" or FolderPath endswith ":\\Windows\\System32\\werfault.exe" or FolderPath endswith ":\\Windows\\SysWOW64\\werfault.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_verclsid_runs_com.yml
Verclsid.exe Runs COM Object ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/S" and ProcessCommandLine contains "/C") and (FolderPath endswith "\\verclsid.exe" or ProcessVersionInfoOriginalFileName =~ "verclsid.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrm_remote_powershell_session_process.yml
Remote PowerShell Session Host Process (WinRM) ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\wsmprovhost.exe" or InitiatingProcessFolderPath endswith "\\wsmprovhost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nsudo.yml
PUA - NSudo Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-U:S " or ProcessCommandLine contains "-U:T " or ProcessCommandLine contains "-U:E " or ProcessCommandLine contains "-P:E " or ProcessCommandLine contains "-M:S " or ProcessCommandLine contains "-M:H " or ProcessCommandLine contains "-U=S " or ProcessCommandLine contains "-U=T " or ProcessCommandLine contains "-U=E " or ProcessCommandLine contains "-P=E " or ProcessCommandLine contains "-M=S " or ProcessCommandLine contains "-M=H " or ProcessCommandLine contains "-ShowWindowMode:Hide") and ((FolderPath endswith "\\NSudo.exe" or FolderPath endswith "\\NSudoLC.exe" or FolderPath endswith "\\NSudoLG.exe") or (ProcessVersionInfoOriginalFileName in~ ("NSudo.exe", "NSudoLC.exe", "NSudoLG.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_safetykatz.yml
HackTool - SafetyKatz Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\SafetyKatz.exe" or ProcessVersionInfoOriginalFileName =~ "SafetyKatz.exe" or ProcessVersionInfoFileDescription =~ "SafetyKatz"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_system_informer.yml
PUA - System Informer Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\SystemInformer.exe" or ProcessVersionInfoOriginalFileName =~ "SystemInformer.exe" or ProcessVersionInfoFileDescription =~ "System Informer" or ProcessVersionInfoProductName =~ "System Informer" or (MD5 startswith "19426363A37C03C3ED6FEDF57B6696EC" or SHA1 startswith "8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC" or SHA256 startswith "8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_procdump.yml
Renamed ProcDump Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName =~ "procdump" or ((ProcessCommandLine contains " -ma " or ProcessCommandLine contains " /ma " or ProcessCommandLine contains " ma " or ProcessCommandLine contains " ma " or ProcessCommandLine contains " ma " or ProcessCommandLine contains " -mp " or ProcessCommandLine contains " /mp " or ProcessCommandLine contains " mp " or ProcessCommandLine contains " mp " or ProcessCommandLine contains " mp ") and (ProcessCommandLine contains " -accepteula" or ProcessCommandLine contains " /accepteula" or ProcessCommandLine contains " accepteula" or ProcessCommandLine contains " accepteula" or ProcessCommandLine contains " accepteula"))) and (not((FolderPath endswith "\\procdump.exe" or FolderPath endswith "\\procdump64.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ssh_rdp_tunneling.yml
Potential RDP Tunneling Via SSH ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ":3389" and FolderPath endswith "\\ssh.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_meterpreter_getsystem.yml
Potential Meterpreter/CobaltStrike Activity ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\services.exe" and (((ProcessCommandLine contains "cmd" or ProcessCommandLine contains "%COMSPEC%") and (ProcessCommandLine contains "/c" and ProcessCommandLine contains "echo" and ProcessCommandLine contains "\\pipe\\")) or (ProcessCommandLine contains "rundll32" and ProcessCommandLine contains ".dll,a" and ProcessCommandLine contains "/p:")) and (not(ProcessCommandLine contains "MpCmdRun"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_parent_anomaly.yml
Whoami.EXE Execution Anomaly ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\whoami.exe" or ProcessVersionInfoOriginalFileName =~ "whoami.exe") and (not(((InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\powershell_ise.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe") or (InitiatingProcessFolderPath in~ ("", "-")) or isnull(InitiatingProcessFolderPath)))) and (not(InitiatingProcessFolderPath endswith ":\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_csvde_export.yml
Active Directory Structure Export Via Csvde.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\csvde.exe" or ProcessVersionInfoOriginalFileName =~ "csvde.exe") and ProcessCommandLine contains " -f") and (not(ProcessCommandLine contains " -i"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_userinit_child.yml
Suspicious Userinit Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\userinit.exe" and (not((ProcessCommandLine contains "\\netlogon\\" or (FolderPath endswith "\\explorer.exe" or ProcessVersionInfoOriginalFileName =~ "explorer.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_task_folder_evasion.yml
Tasks Folder Evasion ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "echo " or ProcessCommandLine contains "copy " or ProcessCommandLine contains "type " or ProcessCommandLine contains "file createnew") and (ProcessCommandLine contains " C:\\Windows\\System32\\Tasks\\" or ProcessCommandLine contains " C:\\Windows\\SysWow64\\Tasks\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_stdin.yml
Invoke-Obfuscation Via Stdin ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "(?i)(set).*&&\\s?set.*(environment|invoke|\\$\\{?input).*&&.*""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wbadmin_dump_sensitive_files.yml
Sensitive File Dump Via Wbadmin.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "start" or ProcessCommandLine contains "backup") and (FolderPath endswith "\\wbadmin.exe" or ProcessVersionInfoOriginalFileName =~ "WBADMIN.EXE") and (ProcessCommandLine contains "\\config\\SAM" or ProcessCommandLine contains "\\config\\SECURITY" or ProcessCommandLine contains "\\config\\SYSTEM" or ProcessCommandLine contains "\\Windows\\NTDS\\NTDS.dit")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_insecure_connection.yml
Insecure Transfer Via Curl.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine matches regex "\\s-k\\s" or ProcessCommandLine contains "--insecure") and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_3.yml
Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "0" or ProcessCommandLine contains "1" or ProcessCommandLine contains "2" or ProcessCommandLine contains "3" or ProcessCommandLine contains "4" or ProcessCommandLine contains "5" or ProcessCommandLine contains "6" or ProcessCommandLine contains "7" or ProcessCommandLine contains "8" or ProcessCommandLine contains "9" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "#" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains ""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml
Potential Dosfuscation Activity ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "^^" or ProcessCommandLine contains "^|^" or ProcessCommandLine contains ",;," or ProcessCommandLine contains ";;;;" or ProcessCommandLine contains ";; ;;" or ProcessCommandLine contains "(,(," or ProcessCommandLine contains "%COMSPEC:~" or ProcessCommandLine contains " c^m^d" or ProcessCommandLine contains "^c^m^d" or ProcessCommandLine contains " c^md" or ProcessCommandLine contains " cm^d" or ProcessCommandLine contains "^cm^d" or ProcessCommandLine contains " s^et " or ProcessCommandLine contains " s^e^t " or ProcessCommandLine contains " se^t "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_lnk_exec_hidden_cmd.yml
Suspicious LNK Command-Line Padding with Whitespace Characters ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "                 " or ProcessCommandLine contains "\\u0009" or ProcessCommandLine contains "\\u000A" or ProcessCommandLine contains "\\u0011" or ProcessCommandLine contains "\\u0012" or ProcessCommandLine contains "\\u0013" or ProcessCommandLine contains "\\u000B" or ProcessCommandLine contains "\\u000C" or ProcessCommandLine contains "\\u000D") or ProcessCommandLine matches regex "\\n\\n\\n\\n\\n\\n") and (InitiatingProcessFolderPath endswith "\\explorer.exe" or InitiatingProcessCommandLine contains ".lnk")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_csi_execution.yml
Suspicious Csi.exe Usage ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoCompanyName =~ "Microsoft Corporation" and ((FolderPath endswith "\\csi.exe" or FolderPath endswith "\\rcsi.exe") or (ProcessVersionInfoOriginalFileName in~ ("csi.exe", "rcsi.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_taskkill_sep.yml
Taskkill Symantec Endpoint Protection ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "taskkill" and ProcessCommandLine contains " /F " and ProcessCommandLine contains " /IM " and ProcessCommandLine contains "ccSvcHst.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msdt_susp_cab_options.yml
Suspicious Cabinet File Execution Via Msdt.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -cab " or ProcessCommandLine contains " /cab " or ProcessCommandLine contains " cab " or ProcessCommandLine contains " cab " or ProcessCommandLine contains " cab ") and (FolderPath endswith "\\msdt.exe" or ProcessVersionInfoOriginalFileName =~ "msdt.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_mhsta.yml
Invoke-Obfuscation Via Use MSHTA ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "set" and ProcessCommandLine contains "&&" and ProcessCommandLine contains "mshta" and ProcessCommandLine contains "vbscript:createobject" and ProcessCommandLine contains ".run" and ProcessCommandLine contains "(window.close)"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_snapins_hafnium.yml
Exchange PowerShell Snap-Ins Usage ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Add-PSSnapin" and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine contains "Microsoft.Exchange.Powershell.Snapin" or ProcessCommandLine contains "Microsoft.Exchange.Management.PowerShell.SnapIn")) and (not((ProcessCommandLine contains "$exserver=Get-ExchangeServer ([Environment]::MachineName) -ErrorVariable exerr 2> $null" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\msiexec.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_impacket_lateral_movement.yml
HackTool - Potential Impacket Lateral Movement Activity ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "cmd.exe" and ProcessCommandLine contains "/C" and ProcessCommandLine contains "Windows\\Temp\\" and ProcessCommandLine contains "&1") and (InitiatingProcessCommandLine contains "svchost.exe -k netsvcs" or InitiatingProcessCommandLine contains "taskeng.exe")) or ((ProcessCommandLine contains "cmd.exe" and ProcessCommandLine contains "/Q" and ProcessCommandLine contains "/c" and ProcessCommandLine contains "\\\\127.0.0.1\\" and ProcessCommandLine contains "&1") and (InitiatingProcessFolderPath endswith "\\wmiprvse.exe" or InitiatingProcessFolderPath endswith "\\mmc.exe" or InitiatingProcessFolderPath endswith "\\explorer.exe" or InitiatingProcessFolderPath endswith "\\services.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_plink_susp_tunneling.yml
Potential RDP Tunneling Via Plink ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ":127.0.0.1:3389" and FolderPath endswith "\\plink.exe") or ((ProcessCommandLine contains ":3389" and FolderPath endswith "\\plink.exe") and (ProcessCommandLine contains " -P 443" or ProcessCommandLine contains " -P 22"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_2.yml
Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 2 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains ""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_keymgr.yml
Suspicious Key Manager Access ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "keymgr" and ProcessCommandLine contains "KRShowKeyMgr") and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_file_sharing_domains.yml
Suspicious Download From File-Sharing Website Via Bitsadmin ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".githubusercontent.com" or ProcessCommandLine contains "anonfiles.com" or ProcessCommandLine contains "cdn.discordapp.com" or ProcessCommandLine contains "ddns.net" or ProcessCommandLine contains "dl.dropboxusercontent.com" or ProcessCommandLine contains "ghostbin.co" or ProcessCommandLine contains "glitch.me" or ProcessCommandLine contains "gofile.io" or ProcessCommandLine contains "hastebin.com" or ProcessCommandLine contains "mediafire.com" or ProcessCommandLine contains "mega.nz" or ProcessCommandLine contains "onrender.com" or ProcessCommandLine contains "pages.dev" or ProcessCommandLine contains "paste.ee" or ProcessCommandLine contains "pastebin.com" or ProcessCommandLine contains "pastebin.pl" or ProcessCommandLine contains "pastetext.net" or ProcessCommandLine contains "privatlab.com" or ProcessCommandLine contains "privatlab.net" or ProcessCommandLine contains "send.exploit.in" or ProcessCommandLine contains "sendspace.com" or ProcessCommandLine contains "storage.googleapis.com" or ProcessCommandLine contains "storjshare.io" or ProcessCommandLine contains "supabase.co" or ProcessCommandLine contains "temp.sh" or ProcessCommandLine contains "transfer.sh" or ProcessCommandLine contains "trycloudflare.com" or ProcessCommandLine contains "ufile.io" or ProcessCommandLine contains "w3spaces.com" or ProcessCommandLine contains "workers.dev") and (ProcessCommandLine contains " /transfer " or ProcessCommandLine contains " /create " or ProcessCommandLine contains " /addfile ") and (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_allow_rdp.yml
RDP Connection Allowed Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "portopening" or ProcessCommandLine contains "allow") and (ProcessCommandLine contains "firewall " and ProcessCommandLine contains "add " and ProcessCommandLine contains "tcp " and ProcessCommandLine contains "3389")) and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_image_missing.yml
Execution Of Non-Existing File ---> KQL Query:
DeviceProcessEvents
| where (not(FolderPath contains "\\")) and (not((((FolderPath in~ ("System", "Registry", "MemCompression", "vmmem")) or (ProcessCommandLine in~ ("Registry", "MemCompression", "vmmem"))) or (FolderPath in~ ("-", "")) or isnull(FolderPath))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_system_info_uncommon.yml
Uncommon System Information Discovery Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "LOGICALDISK get Name,Size,FreeSpace" or ProcessCommandLine contains "os get Caption,OSArchitecture,Version") and (ProcessVersionInfoFileDescription =~ "WMI Commandline Utility" or ProcessVersionInfoOriginalFileName =~ "wmic.exe" or FolderPath endswith "\\WMIC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_squirrel_download.yml
Arbitrary File Download Via Squirrel.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " --download " or ProcessCommandLine contains " --update " or ProcessCommandLine contains " --updateRollback=") and ProcessCommandLine contains "http" and (FolderPath endswith "\\squirrel.exe" or FolderPath endswith "\\update.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_export_pfx.yml
Certificate Exported Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-exportPFX " or ProcessCommandLine contains "/exportPFX " or ProcessCommandLine contains "exportPFX " or ProcessCommandLine contains "exportPFX " or ProcessCommandLine contains "exportPFX ") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_wce.yml
Unexpected Error processing 'HackTool - Windows Credential Editor (WCE) Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_wce.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_create_service.yml
New Service Creation Using Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "create" and ProcessCommandLine contains "binPath") and FolderPath endswith "\\sc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vscode_child_processes_anomalies.yml
Potentially Suspicious Child Process Of VsCode ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\code.exe" and (((ProcessCommandLine contains "Invoke-Expressions" or ProcessCommandLine contains "IEX" or ProcessCommandLine contains "Invoke-Command" or ProcessCommandLine contains "ICM" or ProcessCommandLine contains "DownloadString" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "cscript") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\cmd.exe")) or (FolderPath endswith "\\calc.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\wscript.exe") or (FolderPath contains ":\\Users\\Public\\" or FolderPath contains ":\\Windows\\Temp\\" or FolderPath contains ":\\Temp\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_where_browser_data_recon.yml
Suspicious Where Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\where.exe" or ProcessVersionInfoOriginalFileName =~ "where.exe") and (ProcessCommandLine contains "places.sqlite" or ProcessCommandLine contains "cookies.sqlite" or ProcessCommandLine contains "formhistory.sqlite" or ProcessCommandLine contains "logins.json" or ProcessCommandLine contains "key4.db" or ProcessCommandLine contains "key3.db" or ProcessCommandLine contains "sessionstore.jsonlz4" or ProcessCommandLine contains "History" or ProcessCommandLine contains "Bookmarks" or ProcessCommandLine contains "Cookies" or ProcessCommandLine contains "Login Data")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_adfind_susp_usage.yml
PUA - AdFind Suspicious Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "domainlist" or ProcessCommandLine contains "trustdmp" or ProcessCommandLine contains "dcmodes" or ProcessCommandLine contains "adinfo" or ProcessCommandLine contains " dclist " or ProcessCommandLine contains "computer_pwdnotreqd" or ProcessCommandLine contains "objectcategory=" or ProcessCommandLine contains "-subnets -f" or ProcessCommandLine contains "name=\"Domain Admins\"" or ProcessCommandLine contains "-sc u:" or ProcessCommandLine contains "domainncs" or ProcessCommandLine contains "dompol" or ProcessCommandLine contains " oudmp " or ProcessCommandLine contains "subnetdmp" or ProcessCommandLine contains "gpodmp" or ProcessCommandLine contains "fspdmp" or ProcessCommandLine contains "users_noexpire" or ProcessCommandLine contains "computers_active" or ProcessCommandLine contains "computers_pwdnotreqd"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dism_enable_powershell_web_access_feature.yml
PowerShell Web Access Feature Enabled Via DISM ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "WindowsPowerShellWebAccess" and ProcessCommandLine contains "/online" and ProcessCommandLine contains "/enable-feature") and (FolderPath endswith "\\dism.exe" or ProcessVersionInfoOriginalFileName =~ "DISM.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_remotefxvgpudisablement_abuse.yml
RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Invoke-ATHRemoteFXvGPUDisablementCommand" or ProcessCommandLine contains "Invoke-ATHRemoteFXvGPUDisableme"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_frombase64string.yml
PowerShell Base64 Encoded FromBase64String Cmdlet ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "OjpGcm9tQmFzZTY0U3RyaW5n" or ProcessCommandLine contains "o6RnJvbUJhc2U2NFN0cmluZ" or ProcessCommandLine contains "6OkZyb21CYXNlNjRTdHJpbm" or (ProcessCommandLine contains "OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA" or ProcessCommandLine contains "oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA" or ProcessCommandLine contains "6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_krbrelay_remote.yml
HackTool - RemoteKrbRelay Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\RemoteKrbRelay.exe" or ProcessVersionInfoOriginalFileName =~ "RemoteKrbRelay.exe") or (ProcessCommandLine contains " -clsid " and ProcessCommandLine contains " -target " and ProcessCommandLine contains " -victim ") or (ProcessCommandLine contains "-rbcd " and (ProcessCommandLine contains "-cn " or ProcessCommandLine contains "--computername ")) or (ProcessCommandLine contains "-chp " and (ProcessCommandLine contains "-chpPass " and ProcessCommandLine contains "-chpUser ")) or (ProcessCommandLine contains "-addgroupmember " and ProcessCommandLine contains "-group " and ProcessCommandLine contains "-groupuser ") or ((ProcessCommandLine contains "interactive" or ProcessCommandLine contains "secrets" or ProcessCommandLine contains "service-add") and (ProcessCommandLine contains "-smb " and ProcessCommandLine contains "--smbkeyword "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_advanced_ip_scanner.yml
PUA - Advanced IP Scanner Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/portable" and ProcessCommandLine contains "/lng") or (FolderPath contains "\\advanced_ip_scanner" or ProcessVersionInfoOriginalFileName contains "advanced_ip_scanner" or ProcessVersionInfoFileDescription contains "Advanced IP Scanner")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_cli.yml
Use NTFS Short Name in Command Line ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "~1.exe" or ProcessCommandLine contains "~1.bat" or ProcessCommandLine contains "~1.msi" or ProcessCommandLine contains "~1.vbe" or ProcessCommandLine contains "~1.vbs" or ProcessCommandLine contains "~1.dll" or ProcessCommandLine contains "~1.ps1" or ProcessCommandLine contains "~1.js" or ProcessCommandLine contains "~1.hta" or ProcessCommandLine contains "~2.exe" or ProcessCommandLine contains "~2.bat" or ProcessCommandLine contains "~2.msi" or ProcessCommandLine contains "~2.vbe" or ProcessCommandLine contains "~2.vbs" or ProcessCommandLine contains "~2.dll" or ProcessCommandLine contains "~2.ps1" or ProcessCommandLine contains "~2.js" or ProcessCommandLine contains "~2.hta") and (not(((InitiatingProcessFolderPath endswith "\\WebEx\\WebexHost.exe" or InitiatingProcessFolderPath endswith "\\thor\\thor64.exe") or ProcessCommandLine contains "C:\\xampp\\vcredist\\VCREDI~1.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_x509enrollment.yml
Suspicious X509Enrollment - Process Creation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "X509Enrollment.CBinaryConverter" or ProcessCommandLine contains "884e2002-217d-11da-b2a4-000e7bbb2b09"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_wifi_credential_harvesting.yml
Harvesting Of Wifi Credentials Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "wlan" and ProcessCommandLine contains " s" and ProcessCommandLine contains " p" and ProcessCommandLine contains " k" and ProcessCommandLine contains "=clear") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_output.yml
Whoami.EXE Execution With Output Option ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " /FO CSV" or ProcessCommandLine contains " -FO CSV") and (FolderPath endswith "\\whoami.exe" or ProcessVersionInfoOriginalFileName =~ "whoami.exe")) or ProcessCommandLine =~ "*whoami*>*"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_allow_program_in_susp_location.yml
Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "firewall" and ProcessCommandLine contains "add" and ProcessCommandLine contains "allowedprogram") or (ProcessCommandLine contains "advfirewall" and ProcessCommandLine contains "firewall" and ProcessCommandLine contains "add" and ProcessCommandLine contains "rule" and ProcessCommandLine contains "action=allow" and ProcessCommandLine contains "program=")) and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe") and (ProcessCommandLine contains ":\\$Recycle.bin\\" or ProcessCommandLine contains ":\\RECYCLER.BIN\\" or ProcessCommandLine contains ":\\RECYCLERS.BIN\\" or ProcessCommandLine contains ":\\SystemVolumeInformation\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Users\\Default\\" or ProcessCommandLine contains ":\\Users\\Desktop\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\addins\\" or ProcessCommandLine contains ":\\Windows\\cursors\\" or ProcessCommandLine contains ":\\Windows\\debug\\" or ProcessCommandLine contains ":\\Windows\\drivers\\" or ProcessCommandLine contains ":\\Windows\\fonts\\" or ProcessCommandLine contains ":\\Windows\\help\\" or ProcessCommandLine contains ":\\Windows\\system32\\tasks\\" or ProcessCommandLine contains ":\\Windows\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Local Settings\\Temporary Internet Files\\" or ProcessCommandLine contains "\\Temporary Internet Files\\Content.Outlook\\" or ProcessCommandLine contains "%Public%\\" or ProcessCommandLine contains "%TEMP%" or ProcessCommandLine contains "%TMP%")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_assoc_tamper_exe_file_association.yml
Change Default File Association To Executable Via Assoc ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "assoc " and ProcessCommandLine contains "exefile") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")) and (not(ProcessCommandLine contains ".exe=exefile"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_use_of_te_bin.yml
Malicious Windows Script Components File Execution by TAEF Detection ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\te.exe" or InitiatingProcessFolderPath endswith "\\te.exe" or ProcessVersionInfoOriginalFileName =~ "\\te.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bcdedit_boot_conf_tamper.yml
Boot Configuration Tampering Via Bcdedit.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "bootstatuspolicy" and ProcessCommandLine contains "ignoreallfailures") or (ProcessCommandLine contains "recoveryenabled" and ProcessCommandLine contains "no")) and (FolderPath endswith "\\bcdedit.exe" or ProcessVersionInfoOriginalFileName =~ "bcdedit.exe") and ProcessCommandLine contains "set"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_driverquery_usage.yml
DriverQuery.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "driverquery.exe" or ProcessVersionInfoOriginalFileName =~ "drvqry.exe") and (not(((InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\" or InitiatingProcessFolderPath contains "\\Users\\Public\\" or InitiatingProcessFolderPath contains "\\Windows\\Temp\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_unregmp2.yml
Lolbin Unregmp2.exe Use As Proxy ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -HideWMP" or ProcessCommandLine contains " /HideWMP" or ProcessCommandLine contains " HideWMP" or ProcessCommandLine contains " HideWMP" or ProcessCommandLine contains " HideWMP") and (FolderPath endswith "\\unregmp2.exe" or ProcessVersionInfoOriginalFileName =~ "unregmp2.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_security_keyword_lookup.yml
Security Tools Keyword Lookup Via Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith " avira" or ProcessCommandLine endswith " avira\"" or ProcessCommandLine endswith " cb" or ProcessCommandLine endswith " cb\"" or ProcessCommandLine endswith " cylance" or ProcessCommandLine endswith " cylance\"" or ProcessCommandLine endswith " defender" or ProcessCommandLine endswith " defender\"" or ProcessCommandLine endswith " kaspersky" or ProcessCommandLine endswith " kaspersky\"" or ProcessCommandLine endswith " kes" or ProcessCommandLine endswith " kes\"" or ProcessCommandLine endswith " mc" or ProcessCommandLine endswith " mc\"" or ProcessCommandLine endswith " sec" or ProcessCommandLine endswith " sec\"" or ProcessCommandLine endswith " sentinel" or ProcessCommandLine endswith " sentinel\"" or ProcessCommandLine endswith " symantec" or ProcessCommandLine endswith " symantec\"" or ProcessCommandLine endswith " virus" or ProcessCommandLine endswith " virus\"") and ((FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe") or (ProcessVersionInfoOriginalFileName in~ ("FIND.EXE", "FINDSTR.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml
UAC Bypass Using MSConfig Token Modification - Process ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine =~ "\"C:\\Windows\\system32\\msconfig.exe\" -5" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessFolderPath endswith "\\AppData\\Local\\Temp\\pkgmgr.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_uninstall_security_products.yml
Potential Tampering With Security Products Via WMIC ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "wmic" and ProcessCommandLine contains "product where " and ProcessCommandLine contains "call" and ProcessCommandLine contains "uninstall" and ProcessCommandLine contains "/nointeractive") or ((ProcessCommandLine contains "call delete" or ProcessCommandLine contains "call terminate") and (ProcessCommandLine contains "wmic" and ProcessCommandLine contains "caption like ")) or (ProcessCommandLine contains "process " and ProcessCommandLine contains "where " and ProcessCommandLine contains "delete")) and (ProcessCommandLine contains "%carbon%" or ProcessCommandLine contains "%cylance%" or ProcessCommandLine contains "%endpoint%" or ProcessCommandLine contains "%eset%" or ProcessCommandLine contains "%malware%" or ProcessCommandLine contains "%Sophos%" or ProcessCommandLine contains "%symantec%" or ProcessCommandLine contains "Antivirus" or ProcessCommandLine contains "AVG " or ProcessCommandLine contains "Carbon Black" or ProcessCommandLine contains "CarbonBlack" or ProcessCommandLine contains "Cb Defense Sensor 64-bit" or ProcessCommandLine contains "Crowdstrike Sensor" or ProcessCommandLine contains "Cylance " or ProcessCommandLine contains "Dell Threat Defense" or ProcessCommandLine contains "DLP Endpoint" or ProcessCommandLine contains "Endpoint Detection" or ProcessCommandLine contains "Endpoint Protection" or ProcessCommandLine contains "Endpoint Security" or ProcessCommandLine contains "Endpoint Sensor" or ProcessCommandLine contains "ESET File Security" or ProcessCommandLine contains "LogRhythm System Monitor Service" or ProcessCommandLine contains "Malwarebytes" or ProcessCommandLine contains "McAfee Agent" or ProcessCommandLine contains "Microsoft Security Client" or ProcessCommandLine contains "Sophos Anti-Virus" or ProcessCommandLine contains "Sophos AutoUpdate" or ProcessCommandLine contains "Sophos Credential Store" or ProcessCommandLine contains "Sophos Management Console" or ProcessCommandLine contains "Sophos Management Database" or ProcessCommandLine contains "Sophos Management Server" or ProcessCommandLine contains "Sophos Remote Management System" or ProcessCommandLine contains "Sophos Update Manager" or ProcessCommandLine contains "Threat Protection" or ProcessCommandLine contains "VirusScan" or ProcessCommandLine contains "Webroot SecureAnywhere" or ProcessCommandLine contains "Windows Defender")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regasm_regsvcs_uncommon_extension_execution.yml
Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon Extension ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".dat" or ProcessCommandLine contains ".gif" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".txt") and ((FolderPath endswith "\\Regsvcs.exe" or FolderPath endswith "\\Regasm.exe") or (ProcessVersionInfoOriginalFileName in~ ("RegSvcs.exe", "RegAsm.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_execution.yml
WebDav Client Execution Via Rundll32.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "C:\\windows\\system32\\davclnt.dll,DavSetCookie" and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE") and InitiatingProcessFolderPath endswith "\\svchost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_del_execution.yml
File Deletion Via Del ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "del " or ProcessCommandLine contains "erase ") and (ProcessCommandLine contains " -f" or ProcessCommandLine contains " /f" or ProcessCommandLine contains " f" or ProcessCommandLine contains " f" or ProcessCommandLine contains " f" or ProcessCommandLine contains " -s" or ProcessCommandLine contains " /s" or ProcessCommandLine contains " s" or ProcessCommandLine contains " s" or ProcessCommandLine contains " s" or ProcessCommandLine contains " -q" or ProcessCommandLine contains " /q" or ProcessCommandLine contains " q" or ProcessCommandLine contains " q" or ProcessCommandLine contains " q") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_winsat.yml
UAC Bypass Abusing Winsat Path Parsing - Process ---> KQL Query:
DeviceProcessEvents
| where (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessCommandLine contains "C:\\Windows \\system32\\winsat.exe" and InitiatingProcessFolderPath endswith "\\AppData\\Local\\Temp\\system32\\winsat.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dnscmd_discovery.yml
Potential Discovery Activity Via Dnscmd.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/enumrecords" or ProcessCommandLine contains "/enumzones" or ProcessCommandLine contains "/ZonePrint" or ProcessCommandLine contains "/info") and FolderPath endswith "\\dnscmd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sdiagnhost_susp_child.yml
Sdiagnhost Calling Suspicious Child Process ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\taskkill.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\calc.exe") and InitiatingProcessFolderPath endswith "\\sdiagnhost.exe") and (not(((ProcessCommandLine contains "bits" and FolderPath endswith "\\cmd.exe") or ((ProcessCommandLine endswith "-noprofile -" or ProcessCommandLine endswith "-noprofile") and FolderPath endswith "\\powershell.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_winpeas.yml
HackTool - winPEAS Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "https://github.com/carlospolop/PEASS-ng/releases/latest/download/" or (ProcessCommandLine contains " applicationsinfo" or ProcessCommandLine contains " browserinfo" or ProcessCommandLine contains " eventsinfo" or ProcessCommandLine contains " fileanalysis" or ProcessCommandLine contains " filesinfo" or ProcessCommandLine contains " processinfo" or ProcessCommandLine contains " servicesinfo" or ProcessCommandLine contains " windowscreds") or (InitiatingProcessCommandLine endswith " -linpeas" or ProcessCommandLine endswith " -linpeas") or (ProcessVersionInfoOriginalFileName =~ "winPEAS.exe" or (FolderPath endswith "\\winPEASany_ofs.exe" or FolderPath endswith "\\winPEASany.exe" or FolderPath endswith "\\winPEASx64_ofs.exe" or FolderPath endswith "\\winPEASx64.exe" or FolderPath endswith "\\winPEASx86_ofs.exe" or FolderPath endswith "\\winPEASx86.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_execution_via_pe_metadata.yml
Hacktool Execution - PE Metadata ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoCompanyName =~ "Cube0x0"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_jsc_execution.yml
JScript Compiler Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\jsc.exe" or ProcessVersionInfoOriginalFileName =~ "jsc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mssql_sqltoolsps_susp_execution.yml
SQL Client Tools PowerShell Session Detection ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\sqltoolsps.exe" or InitiatingProcessFolderPath endswith "\\sqltoolsps.exe" or ProcessVersionInfoOriginalFileName =~ "\\sqltoolsps.exe") and (not(InitiatingProcessFolderPath endswith "\\smss.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpldapwhoami.yml
HackTool - SharpLdapWhoami Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith " /method:ntlm" or ProcessCommandLine endswith " /method:kerb" or ProcessCommandLine endswith " /method:nego" or ProcessCommandLine endswith " /m:nego" or ProcessCommandLine endswith " /m:ntlm" or ProcessCommandLine endswith " /m:kerb") or FolderPath endswith "\\SharpLdapWhoami.exe" or (ProcessVersionInfoOriginalFileName contains "SharpLdapWhoami" or ProcessVersionInfoProductName =~ "SharpLdapWhoami")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mspub_download.yml
Arbitrary File Download Via MSPUB.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ftp://" or ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\MSPUB.exe" or ProcessVersionInfoOriginalFileName =~ "MSPUB.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_netscan.yml
PUA - SoftPerfect Netscan Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\netscan.exe" or ProcessVersionInfoProductName =~ "Network Scanner" or ProcessVersionInfoFileDescription =~ "Application for scanning networks"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_powershell_obfuscation.yml
HackTool - CrackMapExec PowerShell Obfuscation ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "join" and ProcessCommandLine contains "split") or ProcessCommandLine contains "( $ShellId[1]+$ShellId[13]+'x')" or (ProcessCommandLine contains "( $PSHome[" and ProcessCommandLine contains "]+$PSHOME[" and ProcessCommandLine contains "]+") or ProcessCommandLine contains "( $env:Public[13]+$env:Public[5]+'x')" or (ProcessCommandLine contains "( $env:ComSpec[4," and ProcessCommandLine contains ",25]-Join'')") or ProcessCommandLine contains "[1,3]+'x'-Join'')") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_certificate_installation.yml
New Root Certificate Installed Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-addstore" or ProcessCommandLine contains "/addstore" or ProcessCommandLine contains "addstore" or ProcessCommandLine contains "addstore" or ProcessCommandLine contains "addstore") and ProcessCommandLine contains "root" and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_jusched.yml
Renamed Jusched.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoFileDescription in~ ("Java Update Scheduler", "Java(TM) Update Scheduler")) and (not(FolderPath endswith "\\jusched.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hostname_execution.yml
Suspicious Execution of Hostname ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\HOSTNAME.EXE"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_auditpol_susp_execution.yml
Audit Policy Tampering Via Auditpol ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "disable" or ProcessCommandLine contains "clear" or ProcessCommandLine contains "remove" or ProcessCommandLine contains "restore") and (FolderPath endswith "\\auditpol.exe" or ProcessVersionInfoOriginalFileName =~ "AUDITPOL.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_hide_services_via_set_service.yml
Abuse of Service Permissions to Hide Services Via Set-Service ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-SecurityDescriptorSddl " or ProcessCommandLine contains "-sd ") and (FolderPath endswith "\\pwsh.exe" or ProcessVersionInfoOriginalFileName =~ "pwsh.dll") and (ProcessCommandLine contains "Set-Service " and ProcessCommandLine contains "DCLCWPDTSD")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_volsnap_disable.yml
Disabled Volume Snapshots ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\Services\\VSS\\Diag" and ProcessCommandLine contains "/d Disabled"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml
Suspicious Reg Add BitLocker ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "EnableBDEWithNoTPM" or ProcessCommandLine contains "UseAdvancedStartup" or ProcessCommandLine contains "UseTPM" or ProcessCommandLine contains "UseTPMKey" or ProcessCommandLine contains "UseTPMKeyPIN" or ProcessCommandLine contains "RecoveryKeyMessageSource" or ProcessCommandLine contains "UseTPMPIN" or ProcessCommandLine contains "RecoveryKeyMessage") and (ProcessCommandLine contains "REG" and ProcessCommandLine contains "ADD" and ProcessCommandLine contains "\\SOFTWARE\\Policies\\Microsoft\\FVE" and ProcessCommandLine contains "/v" and ProcessCommandLine contains "/f")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_uncommon_child_process.yml
Uncommon Child Process Spawned By Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\odbcconf.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_ie_features.yml
Disabled IE Security Features ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -name IEHarden " and ProcessCommandLine contains " -value 0 ") or (ProcessCommandLine contains " -name DEPOff " and ProcessCommandLine contains " -value 1 ") or (ProcessCommandLine contains " -name DisableFirstRunCustomize " and ProcessCommandLine contains " -value 2 ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_certify.yml
HackTool - Certify Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\Certify.exe" or ProcessVersionInfoOriginalFileName =~ "Certify.exe" or ProcessVersionInfoFileDescription contains "Certify") or ((ProcessCommandLine contains ".exe cas " or ProcessCommandLine contains ".exe find " or ProcessCommandLine contains ".exe pkiobjects " or ProcessCommandLine contains ".exe request " or ProcessCommandLine contains ".exe download ") and (ProcessCommandLine contains " /vulnerable" or ProcessCommandLine contains " /template:" or ProcessCommandLine contains " /altname:" or ProcessCommandLine contains " /domain:" or ProcessCommandLine contains " /path:" or ProcessCommandLine contains " /ca:"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_user_default_accounts_manipulation.yml
Suspicious Manipulation Of Default Accounts Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe"))) and ProcessCommandLine contains " user " and (ProcessCommandLine contains " Jrjestelmnvalvoja " or ProcessCommandLine contains " Rendszergazda " or ProcessCommandLine contains "  " or ProcessCommandLine contains " Administrateur " or ProcessCommandLine contains " Administrador " or ProcessCommandLine contains " Administratr " or ProcessCommandLine contains " Administrator " or ProcessCommandLine contains " guest " or ProcessCommandLine contains " DefaultAccount " or ProcessCommandLine contains " \"Jrjestelmnvalvoja\" " or ProcessCommandLine contains " \"Rendszergazda\" " or ProcessCommandLine contains " \"\" " or ProcessCommandLine contains " \"Administrateur\" " or ProcessCommandLine contains " \"Administrador\" " or ProcessCommandLine contains " \"Administratr\" " or ProcessCommandLine contains " \"Administrator\" " or ProcessCommandLine contains " \"guest\" " or ProcessCommandLine contains " \"DefaultAccount\" " or ProcessCommandLine contains " 'Jrjestelmnvalvoja' " or ProcessCommandLine contains " 'Rendszergazda' " or ProcessCommandLine contains " '' " or ProcessCommandLine contains " 'Administrateur' " or ProcessCommandLine contains " 'Administrador' " or ProcessCommandLine contains " 'Administratr' " or ProcessCommandLine contains " 'Administrator' " or ProcessCommandLine contains " 'guest' " or ProcessCommandLine contains " 'DefaultAccount' ")) and (not((ProcessCommandLine contains "guest" and ProcessCommandLine contains "/active no")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_fltmc_unload_driver.yml
Filter Driver Unloaded Via Fltmc.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "unload" and (FolderPath endswith "\\fltMC.exe" or ProcessVersionInfoOriginalFileName =~ "fltMC.exe")) and (not(((ProcessCommandLine endswith "unload rtp_filesystem_filter" and InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\" and InitiatingProcessFolderPath endswith "\\endpoint-protection-installer-x64.tmp" and InitiatingProcessFolderPath startswith "C:\\Users\\") or (ProcessCommandLine endswith "unload DFMFilter" and InitiatingProcessFolderPath =~ "C:\\Program Files (x86)\\ManageEngine\\uems_agent\\bin\\dcfaservice64.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_conhost_headless_powershell.yml
Powershell Executed From Headless ConHost Process ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--headless" and ProcessCommandLine contains "powershell") and (FolderPath endswith "\\conhost.exe" or ProcessVersionInfoOriginalFileName =~ "CONHOST.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_decode_gzip.yml
Gzip Archive Decode Via PowerShell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "GZipStream" and ProcessCommandLine contains "::Decompress"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_windows_terminal_susp_children.yml
Suspicious WindowsTerminal Child Processes ---> KQL Query:
DeviceProcessEvents
| where ((InitiatingProcessFolderPath endswith "\\WindowsTerminal.exe" or InitiatingProcessFolderPath endswith "\\wt.exe") and ((FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\csc.exe") or (FolderPath contains "C:\\Users\\Public\\" or FolderPath contains "\\Downloads\\" or FolderPath contains "\\Desktop\\" or FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "\\Windows\\TEMP\\") or (ProcessCommandLine contains " iex " or ProcessCommandLine contains " icm" or ProcessCommandLine contains "Invoke-" or ProcessCommandLine contains "Import-Module " or ProcessCommandLine contains "ipmo " or ProcessCommandLine contains "DownloadString(" or ProcessCommandLine contains " /c " or ProcessCommandLine contains " /k " or ProcessCommandLine contains " /r "))) and (not(((ProcessCommandLine contains "Import-Module" and ProcessCommandLine contains "Microsoft.VisualStudio.DevShell.dll" and ProcessCommandLine contains "Enter-VsDevShell") or (ProcessCommandLine contains "\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_" and ProcessCommandLine contains "\\LocalState\\settings.json") or (ProcessCommandLine contains "C:\\Program Files\\Microsoft Visual Studio\\" and ProcessCommandLine contains "\\Common7\\Tools\\VsDevCmd.bat"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmi_backdoor_exchange_transport_agent.yml
WMI Backdoor Exchange Transport Agent ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\EdgeTransport.exe" and (not((FolderPath =~ "C:\\Windows\\System32\\conhost.exe" or (FolderPath endswith "\\Bin\\OleConverter.exe" and FolderPath startswith "C:\\Program Files\\Microsoft\\Exchange Server\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_helper_dll_persistence.yml
Potential Persistence Via Netsh Helper DLL ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "add" and ProcessCommandLine contains "helper") and (ProcessVersionInfoOriginalFileName =~ "netsh.exe" or FolderPath endswith "\\netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_encode_susp_extensions.yml
Suspicious File Encoded To Base64 Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-encode" or ProcessCommandLine contains "/encode" or ProcessCommandLine contains "encode" or ProcessCommandLine contains "encode" or ProcessCommandLine contains "encode") and (ProcessCommandLine contains ".acl" or ProcessCommandLine contains ".bat" or ProcessCommandLine contains ".doc" or ProcessCommandLine contains ".gif" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".mp3" or ProcessCommandLine contains ".pdf" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".ppt" or ProcessCommandLine contains ".tmp" or ProcessCommandLine contains ".xls" or ProcessCommandLine contains ".xml") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_silent_install.yml
Remote Access Tool - AnyDesk Silent Installation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--install" and ProcessCommandLine contains "--start-with-win" and ProcessCommandLine contains "--silent"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_hide_sevices.yml
Service DACL Abuse To Hide Services Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "sdset" and ProcessCommandLine contains "DCLCWPDTSD") and (FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_extensions.yml
Regsvr32 DLL Execution With Suspicious File Extension ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".bin" or ProcessCommandLine endswith ".bmp" or ProcessCommandLine endswith ".cr2" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".eps" or ProcessCommandLine endswith ".gif" or ProcessCommandLine endswith ".ico" or ProcessCommandLine endswith ".jpeg" or ProcessCommandLine endswith ".jpg" or ProcessCommandLine endswith ".nef" or ProcessCommandLine endswith ".orf" or ProcessCommandLine endswith ".png" or ProcessCommandLine endswith ".raw" or ProcessCommandLine endswith ".sr2" or ProcessCommandLine endswith ".temp" or ProcessCommandLine endswith ".tif" or ProcessCommandLine endswith ".tiff" or ProcessCommandLine endswith ".tmp" or ProcessCommandLine endswith ".rtf" or ProcessCommandLine endswith ".txt") and (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "REGSVR32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_installation_cli_param.yml
Remote Access Tool - ScreenConnect Installation Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "e=Access&" and ProcessCommandLine contains "y=Guest&" and ProcessCommandLine contains "&p=" and ProcessCommandLine contains "&c=" and ProcessCommandLine contains "&k="

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_creation_temp_folder.yml
Suspicious Scheduled Task Creation Involving Temp Folder ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /create " and ProcessCommandLine contains " /sc once " and ProcessCommandLine contains "\\Temp\\") and FolderPath endswith "\\schtasks.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rdrleakdiag_process_dumping.yml
Process Memory Dump via RdrLeakDiag.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-memdmp" or ProcessCommandLine contains "/memdmp" or ProcessCommandLine contains "memdmp" or ProcessCommandLine contains "memdmp" or ProcessCommandLine contains "memdmp" or ProcessCommandLine contains "fullmemdmp") and (ProcessCommandLine contains " -o " or ProcessCommandLine contains " /o " or ProcessCommandLine contains " o " or ProcessCommandLine contains " o " or ProcessCommandLine contains " o " or ProcessCommandLine contains " -p " or ProcessCommandLine contains " /p " or ProcessCommandLine contains " p " or ProcessCommandLine contains " p " or ProcessCommandLine contains " p ") and (FolderPath endswith "\\rdrleakdiag.exe" or ProcessVersionInfoOriginalFileName =~ "RdrLeakDiag.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_double_extension_parent.yml
Suspicious Parent Double Extension File Execution ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith ".doc.lnk" or InitiatingProcessFolderPath endswith ".docx.lnk" or InitiatingProcessFolderPath endswith ".xls.lnk" or InitiatingProcessFolderPath endswith ".xlsx.lnk" or InitiatingProcessFolderPath endswith ".ppt.lnk" or InitiatingProcessFolderPath endswith ".pptx.lnk" or InitiatingProcessFolderPath endswith ".rtf.lnk" or InitiatingProcessFolderPath endswith ".pdf.lnk" or InitiatingProcessFolderPath endswith ".txt.lnk" or InitiatingProcessFolderPath endswith ".doc.js" or InitiatingProcessFolderPath endswith ".docx.js" or InitiatingProcessFolderPath endswith ".xls.js" or InitiatingProcessFolderPath endswith ".xlsx.js" or InitiatingProcessFolderPath endswith ".ppt.js" or InitiatingProcessFolderPath endswith ".pptx.js" or InitiatingProcessFolderPath endswith ".rtf.js" or InitiatingProcessFolderPath endswith ".pdf.js" or InitiatingProcessFolderPath endswith ".txt.js") or (InitiatingProcessCommandLine contains ".doc.lnk" or InitiatingProcessCommandLine contains ".docx.lnk" or InitiatingProcessCommandLine contains ".xls.lnk" or InitiatingProcessCommandLine contains ".xlsx.lnk" or InitiatingProcessCommandLine contains ".ppt.lnk" or InitiatingProcessCommandLine contains ".pptx.lnk" or InitiatingProcessCommandLine contains ".rtf.lnk" or InitiatingProcessCommandLine contains ".pdf.lnk" or InitiatingProcessCommandLine contains ".txt.lnk" or InitiatingProcessCommandLine contains ".doc.js" or InitiatingProcessCommandLine contains ".docx.js" or InitiatingProcessCommandLine contains ".xls.js" or InitiatingProcessCommandLine contains ".xlsx.js" or InitiatingProcessCommandLine contains ".ppt.js" or InitiatingProcessCommandLine contains ".pptx.js" or InitiatingProcessCommandLine contains ".rtf.js" or InitiatingProcessCommandLine contains ".pdf.js" or InitiatingProcessCommandLine contains ".txt.js")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_inline_base64_mz_header.yml
Base64 MZ Header In CommandLine ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "TVqQAAMAAAAEAAAA" or ProcessCommandLine contains "TVpQAAIAAAAEAA8A" or ProcessCommandLine contains "TVqAAAEAAAAEABAA" or ProcessCommandLine contains "TVoAAAAAAAAAAAAA" or ProcessCommandLine contains "TVpTAQEAAAAEAAAA"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_adcspwn.yml
HackTool - ADCSPwn Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " --adcs " and ProcessCommandLine contains " --port "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tscon_rdp_redirect.yml
Suspicious RDP Redirect Using TSCON ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /dest:rdp-tcp#"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpmove.yml
HackTool - SharpMove Tool Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\SharpMove.exe" or ProcessVersionInfoOriginalFileName =~ "SharpMove.exe") or ((ProcessCommandLine contains "action=create" or ProcessCommandLine contains "action=dcom" or ProcessCommandLine contains "action=executevbs" or ProcessCommandLine contains "action=hijackdcom" or ProcessCommandLine contains "action=modschtask" or ProcessCommandLine contains "action=modsvc" or ProcessCommandLine contains "action=query" or ProcessCommandLine contains "action=scm" or ProcessCommandLine contains "action=startservice" or ProcessCommandLine contains "action=taskscheduler") and ProcessCommandLine contains "computername=")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_presentationhost_download.yml
Arbitrary File Download Via PresentationHost.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://" or ProcessCommandLine contains "ftp://") and (FolderPath endswith "\\presentationhost.exe" or ProcessVersionInfoOriginalFileName =~ "PresentationHost.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file.yml
Mstsc.EXE Execution With Local RDP File ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine endswith ".rdp" or ProcessCommandLine endswith ".rdp\"") and (FolderPath endswith "\\mstsc.exe" or ProcessVersionInfoOriginalFileName =~ "mstsc.exe")) and (not((ProcessCommandLine contains "C:\\ProgramData\\Microsoft\\WSL\\wslg.rdp" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\lxss\\wslhost.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vsdiagnostics_execution_proxy.yml
Potential Binary Proxy Execution Via VSDiagnostics.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /launch:" or ProcessCommandLine contains " -launch:") and ProcessCommandLine contains "start" and (FolderPath endswith "\\VSDiagnostics.exe" or ProcessVersionInfoOriginalFileName =~ "VSDiagnostics.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_seatbelt.yml
PUA - Seatbelt Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\Seatbelt.exe" or ProcessVersionInfoOriginalFileName =~ "Seatbelt.exe" or ProcessVersionInfoFileDescription =~ "Seatbelt" or (ProcessCommandLine contains " DpapiMasterKeys" or ProcessCommandLine contains " InterestingProcesses" or ProcessCommandLine contains " InterestingFiles" or ProcessCommandLine contains " CertificateThumbprints" or ProcessCommandLine contains " ChromiumBookmarks" or ProcessCommandLine contains " ChromiumHistory" or ProcessCommandLine contains " ChromiumPresence" or ProcessCommandLine contains " CloudCredentials" or ProcessCommandLine contains " CredEnum" or ProcessCommandLine contains " CredGuard" or ProcessCommandLine contains " FirefoxHistory" or ProcessCommandLine contains " ProcessCreationEvents")) or ((ProcessCommandLine contains " -group=misc" or ProcessCommandLine contains " -group=remote" or ProcessCommandLine contains " -group=chromium" or ProcessCommandLine contains " -group=slack" or ProcessCommandLine contains " -group=system" or ProcessCommandLine contains " -group=user" or ProcessCommandLine contains " -group=all") and ProcessCommandLine contains " -outputfile=")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_mklink_shadow_copies_access_symlink.yml
VolumeShadowCopy Symlink Creation Via Mklink ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "mklink" and ProcessCommandLine contains "HarddiskVolumeShadowCopy"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_spawns_powershell.yml
Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and InitiatingProcessFolderPath endswith "\\WmiPrvSE.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_visual_basic_compiler.yml
Visual Basic Command Line Compiler Usage ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\cvtres.exe" and InitiatingProcessFolderPath endswith "\\vbc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_16bit_application.yml
Start of NT Virtual DOS Machine ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\ntvdm.exe" or FolderPath endswith "\\csrstub.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_exec_susp_locations.yml
Odbcconf.EXE Suspicious DLL Location ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ":\\PerfLogs\\" or ProcessCommandLine contains ":\\ProgramData\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Registration\\CRMLog" or ProcessCommandLine contains ":\\Windows\\System32\\com\\dmp\\" or ProcessCommandLine contains ":\\Windows\\System32\\FxsTmp\\" or ProcessCommandLine contains ":\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\" or ProcessCommandLine contains ":\\Windows\\System32\\spool\\drivers\\color\\" or ProcessCommandLine contains ":\\Windows\\System32\\spool\\PRINTERS\\" or ProcessCommandLine contains ":\\Windows\\System32\\spool\\SERVERS\\" or ProcessCommandLine contains ":\\Windows\\System32\\Tasks_Migrated\\" or ProcessCommandLine contains ":\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\" or ProcessCommandLine contains ":\\Windows\\SysWOW64\\com\\dmp\\" or ProcessCommandLine contains ":\\Windows\\SysWOW64\\FxsTmp\\" or ProcessCommandLine contains ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\" or ProcessCommandLine contains ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\" or ProcessCommandLine contains ":\\Windows\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains ":\\Windows\\Tracing\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\AppData\\Roaming\\") and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_cimprovider_dll_load.yml
DLL Execution Via Register-cimprovider.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-path" and ProcessCommandLine contains "dll") and FolderPath endswith "\\register-cimprovider.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_uncommon_dll_extension.yml
Rundll32 Execution With Uncommon DLL Extension ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE") and (not((ProcessCommandLine =~ "" or ((ProcessCommandLine contains ".cpl " or ProcessCommandLine contains ".cpl," or ProcessCommandLine contains ".cpl\"" or ProcessCommandLine contains ".cpl'" or ProcessCommandLine contains ".dll " or ProcessCommandLine contains ".dll," or ProcessCommandLine contains ".dll\"" or ProcessCommandLine contains ".dll'" or ProcessCommandLine contains ".inf " or ProcessCommandLine contains ".inf," or ProcessCommandLine contains ".inf\"" or ProcessCommandLine contains ".inf'") or (ProcessCommandLine endswith ".cpl" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".inf")) or ProcessCommandLine contains " -localserver " or isnull(ProcessCommandLine) or ((ProcessCommandLine contains ":\\Windows\\Installer\\" and ProcessCommandLine contains ".tmp" and ProcessCommandLine contains "zzzzInvokeManagedCustomActionOutOfProc") and InitiatingProcessFolderPath endswith "\\msiexec.exe")))) and (not((InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{" and InitiatingProcessCommandLine contains "\\EDGEMITMP_" and InitiatingProcessCommandLine contains ".tmp\\setup.exe" and InitiatingProcessCommandLine contains "--install-archive=" and InitiatingProcessCommandLine contains "--previous-version=" and InitiatingProcessCommandLine contains "--msedgewebview --verbose-logging --do-not-launch-msedge --user-level")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_ngrok.yml
PUA - Ngrok Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " tcp 139" or ProcessCommandLine contains " tcp 445" or ProcessCommandLine contains " tcp 3389" or ProcessCommandLine contains " tcp 5985" or ProcessCommandLine contains " tcp 5986") or (ProcessCommandLine contains " start " and ProcessCommandLine contains "--all" and ProcessCommandLine contains "--config" and ProcessCommandLine contains ".yml") or ((ProcessCommandLine contains " tcp " or ProcessCommandLine contains " http " or ProcessCommandLine contains " authtoken ") and FolderPath endswith "ngrok.exe") or (ProcessCommandLine contains ".exe authtoken " or ProcessCommandLine contains ".exe start --all")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitlockertogo_execution.yml
BitLockerTogo.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\BitLockerToGo.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psservice.yml
Sysinternals PsService Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "psservice.exe" or (FolderPath endswith "\\PsService.exe" or FolderPath endswith "\\PsService64.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_malicious_cmdlets.yml
Malicious PowerShell Commandlets - ProcessCreation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Add-Exfiltration" or ProcessCommandLine contains "Add-Persistence" or ProcessCommandLine contains "Add-RegBackdoor" or ProcessCommandLine contains "Add-RemoteRegBackdoor" or ProcessCommandLine contains "Add-ScrnSaveBackdoor" or ProcessCommandLine contains "Check-VM" or ProcessCommandLine contains "ConvertTo-Rc4ByteStream" or ProcessCommandLine contains "Decrypt-Hash" or ProcessCommandLine contains "Disable-ADIDNSNode" or ProcessCommandLine contains "Disable-MachineAccount" or ProcessCommandLine contains "Do-Exfiltration" or ProcessCommandLine contains "Enable-ADIDNSNode" or ProcessCommandLine contains "Enable-MachineAccount" or ProcessCommandLine contains "Enabled-DuplicateToken" or ProcessCommandLine contains "Exploit-Jboss" or ProcessCommandLine contains "Export-ADR" or ProcessCommandLine contains "Export-ADRCSV" or ProcessCommandLine contains "Export-ADRExcel" or ProcessCommandLine contains "Export-ADRHTML" or ProcessCommandLine contains "Export-ADRJSON" or ProcessCommandLine contains "Export-ADRXML" or ProcessCommandLine contains "Find-Fruit" or ProcessCommandLine contains "Find-GPOLocation" or ProcessCommandLine contains "Find-TrustedDocuments" or ProcessCommandLine contains "Get-ADIDNS" or ProcessCommandLine contains "Get-ApplicationHost" or ProcessCommandLine contains "Get-ChromeDump" or ProcessCommandLine contains "Get-ClipboardContents" or ProcessCommandLine contains "Get-FoxDump" or ProcessCommandLine contains "Get-GPPPassword" or ProcessCommandLine contains "Get-IndexedItem" or ProcessCommandLine contains "Get-KerberosAESKey" or ProcessCommandLine contains "Get-Keystrokes" or ProcessCommandLine contains "Get-LSASecret" or ProcessCommandLine contains "Get-MachineAccountAttribute" or ProcessCommandLine contains "Get-MachineAccountCreator" or ProcessCommandLine contains "Get-PassHashes" or ProcessCommandLine contains "Get-RegAlwaysInstallElevated" or ProcessCommandLine contains "Get-RegAutoLogon" or ProcessCommandLine contains "Get-RemoteBootKey" or ProcessCommandLine contains "Get-RemoteCachedCredential" or ProcessCommandLine contains "Get-RemoteLocalAccountHash" or ProcessCommandLine contains "Get-RemoteLSAKey" or ProcessCommandLine contains "Get-RemoteMachineAccountHash" or ProcessCommandLine contains "Get-RemoteNLKMKey" or ProcessCommandLine contains "Get-RickAstley" or ProcessCommandLine contains "Get-Screenshot" or ProcessCommandLine contains "Get-SecurityPackages" or ProcessCommandLine contains "Get-ServiceFilePermission" or ProcessCommandLine contains "Get-ServicePermission" or ProcessCommandLine contains "Get-ServiceUnquoted" or ProcessCommandLine contains "Get-SiteListPassword" or ProcessCommandLine contains "Get-System" or ProcessCommandLine contains "Get-TimedScreenshot" or ProcessCommandLine contains "Get-UnattendedInstallFile" or ProcessCommandLine contains "Get-Unconstrained" or ProcessCommandLine contains "Get-USBKeystrokes" or ProcessCommandLine contains "Get-VaultCredential" or ProcessCommandLine contains "Get-VulnAutoRun" or ProcessCommandLine contains "Get-VulnSchTask" or ProcessCommandLine contains "Grant-ADIDNSPermission" or ProcessCommandLine contains "Gupt-Backdoor" or ProcessCommandLine contains "HTTP-Login" or ProcessCommandLine contains "Install-ServiceBinary" or ProcessCommandLine contains "Install-SSP" or ProcessCommandLine contains "Invoke-ACLScanner" or ProcessCommandLine contains "Invoke-ADRecon" or ProcessCommandLine contains "Invoke-ADSBackdoor" or ProcessCommandLine contains "Invoke-AgentSmith" or ProcessCommandLine contains "Invoke-AllChecks" or ProcessCommandLine contains "Invoke-ARPScan" or ProcessCommandLine contains "Invoke-AzureHound" or ProcessCommandLine contains "Invoke-BackdoorLNK" or ProcessCommandLine contains "Invoke-BadPotato" or ProcessCommandLine contains "Invoke-BetterSafetyKatz" or ProcessCommandLine contains "Invoke-BypassUAC" or ProcessCommandLine contains "Invoke-Carbuncle" or ProcessCommandLine contains "Invoke-Certify" or ProcessCommandLine contains "Invoke-ConPtyShell" or ProcessCommandLine contains "Invoke-CredentialInjection" or ProcessCommandLine contains "Invoke-DAFT" or ProcessCommandLine contains "Invoke-DCSync" or ProcessCommandLine contains "Invoke-DinvokeKatz" or ProcessCommandLine contains "Invoke-DllInjection" or ProcessCommandLine contains "Invoke-DNSUpdate" or ProcessCommandLine contains "Invoke-DomainPasswordSpray" or ProcessCommandLine contains "Invoke-DowngradeAccount" or ProcessCommandLine contains "Invoke-EgressCheck" or ProcessCommandLine contains "Invoke-Eyewitness" or ProcessCommandLine contains "Invoke-FakeLogonScreen" or ProcessCommandLine contains "Invoke-Farmer" or ProcessCommandLine contains "Invoke-Get-RBCD-Threaded" or ProcessCommandLine contains "Invoke-Gopher" or ProcessCommandLine contains "Invoke-Grouper" or ProcessCommandLine contains "Invoke-HandleKatz" or ProcessCommandLine contains "Invoke-ImpersonatedProcess" or ProcessCommandLine contains "Invoke-ImpersonateSystem" or ProcessCommandLine contains "Invoke-InteractiveSystemPowerShell" or ProcessCommandLine contains "Invoke-Internalmonologue" or ProcessCommandLine contains "Invoke-Inveigh" or ProcessCommandLine contains "Invoke-InveighRelay" or ProcessCommandLine contains "Invoke-KrbRelay" or ProcessCommandLine contains "Invoke-LdapSignCheck" or ProcessCommandLine contains "Invoke-Lockless" or ProcessCommandLine contains "Invoke-MalSCCM" or ProcessCommandLine contains "Invoke-Mimikatz" or ProcessCommandLine contains "Invoke-Mimikittenz" or ProcessCommandLine contains "Invoke-MITM6" or ProcessCommandLine contains "Invoke-NanoDump" or ProcessCommandLine contains "Invoke-NetRipper" or ProcessCommandLine contains "Invoke-Nightmare" or ProcessCommandLine contains "Invoke-NinjaCopy" or ProcessCommandLine contains "Invoke-OfficeScrape" or ProcessCommandLine contains "Invoke-OxidResolver" or ProcessCommandLine contains "Invoke-P0wnedshell" or ProcessCommandLine contains "Invoke-Paranoia" or ProcessCommandLine contains "Invoke-PortScan" or ProcessCommandLine contains "Invoke-PoshRatHttp" or ProcessCommandLine contains "Invoke-PostExfil" or ProcessCommandLine contains "Invoke-PowerDump" or ProcessCommandLine contains "Invoke-PowerShellTCP" or ProcessCommandLine contains "Invoke-PowerShellWMI" or ProcessCommandLine contains "Invoke-PPLDump" or ProcessCommandLine contains "Invoke-PsExec" or ProcessCommandLine contains "Invoke-PSInject" or ProcessCommandLine contains "Invoke-PsUaCme" or ProcessCommandLine contains "Invoke-ReflectivePEInjection" or ProcessCommandLine contains "Invoke-ReverseDNSLookup" or ProcessCommandLine contains "Invoke-Rubeus" or ProcessCommandLine contains "Invoke-RunAs" or ProcessCommandLine contains "Invoke-SafetyKatz" or ProcessCommandLine contains "Invoke-SauronEye" or ProcessCommandLine contains "Invoke-SCShell" or ProcessCommandLine contains "Invoke-Seatbelt" or ProcessCommandLine contains "Invoke-ServiceAbuse" or ProcessCommandLine contains "Invoke-ShadowSpray" or ProcessCommandLine contains "Invoke-Sharp" or ProcessCommandLine contains "Invoke-Shellcode" or ProcessCommandLine contains "Invoke-SMBScanner" or ProcessCommandLine contains "Invoke-Snaffler" or ProcessCommandLine contains "Invoke-Spoolsample" or ProcessCommandLine contains "Invoke-SpraySinglePassword" or ProcessCommandLine contains "Invoke-SSHCommand" or ProcessCommandLine contains "Invoke-StandIn" or ProcessCommandLine contains "Invoke-StickyNotesExtract" or ProcessCommandLine contains "Invoke-SystemCommand" or ProcessCommandLine contains "Invoke-Tasksbackdoor" or ProcessCommandLine contains "Invoke-Tater" or ProcessCommandLine contains "Invoke-Thunderfox" or ProcessCommandLine contains "Invoke-ThunderStruck" or ProcessCommandLine contains "Invoke-TokenManipulation" or ProcessCommandLine contains "Invoke-Tokenvator" or ProcessCommandLine contains "Invoke-TotalExec" or ProcessCommandLine contains "Invoke-UrbanBishop" or ProcessCommandLine contains "Invoke-UserHunter" or ProcessCommandLine contains "Invoke-VoiceTroll" or ProcessCommandLine contains "Invoke-Whisker" or ProcessCommandLine contains "Invoke-WinEnum" or ProcessCommandLine contains "Invoke-winPEAS" or ProcessCommandLine contains "Invoke-WireTap" or ProcessCommandLine contains "Invoke-WmiCommand" or ProcessCommandLine contains "Invoke-WMIExec" or ProcessCommandLine contains "Invoke-WScriptBypassUAC" or ProcessCommandLine contains "Invoke-Zerologon" or ProcessCommandLine contains "MailRaider" or ProcessCommandLine contains "New-ADIDNSNode" or ProcessCommandLine contains "New-DNSRecordArray" or ProcessCommandLine contains "New-HoneyHash" or ProcessCommandLine contains "New-InMemoryModule" or ProcessCommandLine contains "New-MachineAccount" or ProcessCommandLine contains "New-SOASerialNumberArray" or ProcessCommandLine contains "Out-Minidump" or ProcessCommandLine contains "Port-Scan" or ProcessCommandLine contains "PowerBreach" or ProcessCommandLine contains "powercat " or ProcessCommandLine contains "PowerUp" or ProcessCommandLine contains "PowerView" or ProcessCommandLine contains "Remove-ADIDNSNode" or ProcessCommandLine contains "Remove-MachineAccount" or ProcessCommandLine contains "Remove-Update" or ProcessCommandLine contains "Rename-ADIDNSNode" or ProcessCommandLine contains "Revoke-ADIDNSPermission" or ProcessCommandLine contains "Set-ADIDNSNode" or ProcessCommandLine contains "Set-MacAttribute" or ProcessCommandLine contains "Set-MachineAccountAttribute" or ProcessCommandLine contains "Set-Wallpaper" or ProcessCommandLine contains "Show-TargetScreen" or ProcessCommandLine contains "Start-CaptureServer" or ProcessCommandLine contains "Start-Dnscat2" or ProcessCommandLine contains "Start-WebcamRecorder" or ProcessCommandLine contains "Veeam-Get-Creds" or ProcessCommandLine contains "VolumeShadowCopyTools"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_hijacking_firwall_snap_in.yml
UAC Bypass via Windows Firewall Snap-In Hijack ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains "WF.msc" and InitiatingProcessFolderPath endswith "\\mmc.exe") and (not(FolderPath endswith "\\WerFault.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_werfault_reflect_debugger_exec.yml
Potential ReflectDebugger Content Execution Via WerFault.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -pr " and (FolderPath endswith "\\WerFault.exe" or ProcessVersionInfoOriginalFileName =~ "WerFault.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mstsc_rdp_hijack_shadowing.yml
Potential MSTSC Shadowing Activity ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "noconsentprompt" and ProcessCommandLine contains "shadow:"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_redmimicry_winnti_playbook.yml
HackTool - RedMimicry Winnti Playbook Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "gthread-3.6.dll" or ProcessCommandLine contains "\\Windows\\Temp\\tmp.bat" or ProcessCommandLine contains "sigcmm-2.4.dll") and (FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\cmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_process.yml
Process Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "process" and (FolderPath endswith "\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")) and (not((ProcessCommandLine contains "call" and ProcessCommandLine contains "create")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_zip_compress.yml
Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Compress-Archive -Path" and ProcessCommandLine contains "-DestinationPath $env:TEMP") or (ProcessCommandLine contains "Compress-Archive -Path" and ProcessCommandLine contains "-DestinationPath" and ProcessCommandLine contains "\\AppData\\Local\\Temp\\") or (ProcessCommandLine contains "Compress-Archive -Path" and ProcessCommandLine contains "-DestinationPath" and ProcessCommandLine contains ":\\Windows\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dumpminitool_susp_execution.yml
Suspicious DumpMinitool Execution ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\DumpMinitool.exe" or FolderPath endswith "\\DumpMinitool.x86.exe" or FolderPath endswith "\\DumpMinitool.arm64.exe") or (ProcessVersionInfoOriginalFileName in~ ("DumpMinitool.exe", "DumpMinitool.x86.exe", "DumpMinitool.arm64.exe"))) and ((not((FolderPath contains "\\Microsoft Visual Studio\\" or FolderPath contains "\\Extensions\\"))) or ProcessCommandLine contains ".txt" or ((ProcessCommandLine contains " Full" or ProcessCommandLine contains " Mini" or ProcessCommandLine contains " WithHeap") and (not(ProcessCommandLine contains "--dumpType"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_auditpol_nt_resource_kit_usage.yml
Audit Policy Tampering Via NT Resource Kit Auditpol ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/logon:none" or ProcessCommandLine contains "/system:none" or ProcessCommandLine contains "/sam:none" or ProcessCommandLine contains "/privilege:none" or ProcessCommandLine contains "/object:none" or ProcessCommandLine contains "/process:none" or ProcessCommandLine contains "/policy:none"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_service_install.yml
Visual Studio Code Tunnel Service Installation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "tunnel " and ProcessCommandLine contains "service" and ProcessCommandLine contains "internal-run" and ProcessCommandLine contains "tunnel-service.log"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_http_ip_pattern.yml
Potentially Suspicious Regsvr32 HTTP IP Pattern ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "REGSVR32.EXE") and (ProcessCommandLine contains " /i:http://1" or ProcessCommandLine contains " /i:http://2" or ProcessCommandLine contains " /i:http://3" or ProcessCommandLine contains " /i:http://4" or ProcessCommandLine contains " /i:http://5" or ProcessCommandLine contains " /i:http://6" or ProcessCommandLine contains " /i:http://7" or ProcessCommandLine contains " /i:http://8" or ProcessCommandLine contains " /i:http://9" or ProcessCommandLine contains " /i:https://1" or ProcessCommandLine contains " /i:https://2" or ProcessCommandLine contains " /i:https://3" or ProcessCommandLine contains " /i:https://4" or ProcessCommandLine contains " /i:https://5" or ProcessCommandLine contains " /i:https://6" or ProcessCommandLine contains " /i:https://7" or ProcessCommandLine contains " /i:https://8" or ProcessCommandLine contains " /i:https://9" or ProcessCommandLine contains " -i:http://1" or ProcessCommandLine contains " -i:http://2" or ProcessCommandLine contains " -i:http://3" or ProcessCommandLine contains " -i:http://4" or ProcessCommandLine contains " -i:http://5" or ProcessCommandLine contains " -i:http://6" or ProcessCommandLine contains " -i:http://7" or ProcessCommandLine contains " -i:http://8" or ProcessCommandLine contains " -i:http://9" or ProcessCommandLine contains " -i:https://1" or ProcessCommandLine contains " -i:https://2" or ProcessCommandLine contains " -i:https://3" or ProcessCommandLine contains " -i:https://4" or ProcessCommandLine contains " -i:https://5" or ProcessCommandLine contains " -i:https://6" or ProcessCommandLine contains " -i:https://7" or ProcessCommandLine contains " -i:https://8" or ProcessCommandLine contains " -i:https://9")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_stordiag_susp_child_process.yml
Execution via stordiag.exe ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\fltmc.exe") and InitiatingProcessFolderPath endswith "\\stordiag.exe") and (not((InitiatingProcessFolderPath startswith "c:\\windows\\system32\\" or InitiatingProcessFolderPath startswith "c:\\windows\\syswow64\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regedit_import_keys_ads.yml
Imports Registry Key From an ADS ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " /i " or ProcessCommandLine contains ".reg") and ProcessCommandLine matches regex ":[^ \\\\]") and (FolderPath endswith "\\regedit.exe" or ProcessVersionInfoOriginalFileName =~ "REGEDIT.EXE")) and (not((ProcessCommandLine contains " -e " or ProcessCommandLine contains " /e " or ProcessCommandLine contains " e " or ProcessCommandLine contains " e " or ProcessCommandLine contains " e " or ProcessCommandLine contains " -a " or ProcessCommandLine contains " /a " or ProcessCommandLine contains " a " or ProcessCommandLine contains " a " or ProcessCommandLine contains " a " or ProcessCommandLine contains " -c " or ProcessCommandLine contains " /c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_cmdline_convertto_securestring.yml
ConvertTo-SecureString Cmdlet Usage Via CommandLine ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "ConvertTo-SecureString" and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_shutdown_execution.yml
Suspicious Execution of Shutdown ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/r " or ProcessCommandLine contains "/s ") and FolderPath endswith "\\shutdown.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_get_clipboard.yml
PowerShell Get-Clipboard Cmdlet Via CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Get-Clipboard"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_http.yml
Remotely Hosted HTA File Executed Via Mshta.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://" or ProcessCommandLine contains "ftp://") and (FolderPath endswith "\\mshta.exe" or ProcessVersionInfoOriginalFileName =~ "MSHTA.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sigverif_uncommon_child_process.yml
Uncommon Sigverif.EXE Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\sigverif.exe" and (not((FolderPath in~ ("C:\\Windows\\System32\\WerFault.exe", "C:\\Windows\\SysWOW64\\WerFault.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_ps_downloadfile.yml
PowerShell DownloadFile ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "powershell" and ProcessCommandLine contains ".DownloadFile" and ProcessCommandLine contains "System.Net.WebClient"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_decode.yml
File Decoded From Base64/Hex Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-decode " or ProcessCommandLine contains "/decode " or ProcessCommandLine contains "decode " or ProcessCommandLine contains "decode " or ProcessCommandLine contains "decode " or ProcessCommandLine contains "-decodehex " or ProcessCommandLine contains "/decodehex " or ProcessCommandLine contains "decodehex " or ProcessCommandLine contains "decodehex " or ProcessCommandLine contains "decodehex ") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_obfuscated_ordinal_call.yml
Potential Obfuscated Ordinal Call Via Rundll32 ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "#+" or ProcessCommandLine contains "#-" or ProcessCommandLine contains "#0" or ProcessCommandLine contains "#655" or ProcessCommandLine contains "#656") and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE" or ProcessCommandLine contains "rundll32")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_hotfix.yml
Windows Hotfix Updates Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " qfe" and (ProcessVersionInfoOriginalFileName =~ "wmic.exe" or FolderPath endswith "\\WMIC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_coercedpotato.yml
Unexpected Error processing 'HackTool - CoercedPotato Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_coercedpotato.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nmap_zenmap.yml
PUA - Nmap/Zenmap Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\nmap.exe" or FolderPath endswith "\\zennmap.exe") or (ProcessVersionInfoOriginalFileName in~ ("nmap.exe", "zennmap.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_response_file_susp.yml
Suspicious Response File Execution Via Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -f " or ProcessCommandLine contains " /f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " f ") and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe")) and (not((ProcessCommandLine contains ".rsp" or (ProcessCommandLine contains ".exe /E /F \"C:\\WINDOWS\\system32\\odbcconf.tmp\"" and FolderPath =~ "C:\\Windows\\System32\\odbcconf.exe" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\runonce.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_load_extension.yml
Chromium Browser Instance Executed With Custom Extension ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--load-extension=" and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\vivaldi.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_binary.yml
Potential Defense Evasion Via Binary Rename ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "CONHOST.EXE", "7z.exe", "WinRAR.exe", "wevtutil.exe", "net.exe", "net1.exe", "netsh.exe", "InstallUtil.exe")) and (not((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\conhost.exe" or FolderPath endswith "\\7z.exe" or FolderPath endswith "\\WinRAR.exe" or FolderPath endswith "\\wevtutil.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\netsh.exe" or FolderPath endswith "\\InstallUtil.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_enumeration_for_credentials_cli.yml
Enumeration for 3rd Party Creds From CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\Software\\SimonTatham\\PuTTY\\Sessions" or ProcessCommandLine contains "\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\" or ProcessCommandLine contains "\\Software\\Mobatek\\MobaXterm\\" or ProcessCommandLine contains "\\Software\\WOW6432Node\\Radmin\\v3.0\\Server\\Parameters\\Radmin" or ProcessCommandLine contains "\\Software\\Aerofox\\FoxmailPreview" or ProcessCommandLine contains "\\Software\\Aerofox\\Foxmail\\V3.1" or ProcessCommandLine contains "\\Software\\IncrediMail\\Identities" or ProcessCommandLine contains "\\Software\\Qualcomm\\Eudora\\CommandLine" or ProcessCommandLine contains "\\Software\\RimArts\\B2\\Settings" or ProcessCommandLine contains "\\Software\\OpenVPN-GUI\\configs" or ProcessCommandLine contains "\\Software\\Martin Prikryl\\WinSCP 2\\Sessions" or ProcessCommandLine contains "\\Software\\FTPWare\\COREFTP\\Sites" or ProcessCommandLine contains "\\Software\\DownloadManager\\Passwords" or ProcessCommandLine contains "\\Software\\OpenSSH\\Agent\\Keys" or ProcessCommandLine contains "\\Software\\TightVNC\\Server" or ProcessCommandLine contains "\\Software\\ORL\\WinVNC3\\Password" or ProcessCommandLine contains "\\Software\\RealVNC\\WinVNC4"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_download_direct_ip.yml
Suspicious File Downloaded From Direct IP Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "urlcache " or ProcessCommandLine contains "verifyctl ") and (ProcessCommandLine contains "://1" or ProcessCommandLine contains "://2" or ProcessCommandLine contains "://3" or ProcessCommandLine contains "://4" or ProcessCommandLine contains "://5" or ProcessCommandLine contains "://6" or ProcessCommandLine contains "://7" or ProcessCommandLine contains "://8" or ProcessCommandLine contains "://9") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")) and (not(ProcessCommandLine contains "://7-"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_procdump.yml
Procdump Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\procdump.exe" or FolderPath endswith "\\procdump64.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_view_share_and_sessions_enum.yml
Share And Session Enumeration Using Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "view" and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))) and (not(ProcessCommandLine contains "\\\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_4.yml
Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 4 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains ""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_local_system_owner_account_discovery.yml
Local Accounts Discovery ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " /c" and ProcessCommandLine contains "dir " and ProcessCommandLine contains "\\Users\\") and FolderPath endswith "\\cmd.exe") and (not(ProcessCommandLine contains " rmdir "))) or ((ProcessCommandLine contains "user" and (FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe")) and (not((ProcessCommandLine contains "/domain" or ProcessCommandLine contains "/add" or ProcessCommandLine contains "/delete" or ProcessCommandLine contains "/active" or ProcessCommandLine contains "/expires" or ProcessCommandLine contains "/passwordreq" or ProcessCommandLine contains "/scriptpath" or ProcessCommandLine contains "/times" or ProcessCommandLine contains "/workstations")))) or ((ProcessCommandLine contains " /l" and FolderPath endswith "\\cmdkey.exe") or (FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\quser.exe" or FolderPath endswith "\\qwinsta.exe") or ((ProcessCommandLine contains "useraccount" and ProcessCommandLine contains "get") and FolderPath endswith "\\wmic.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_susp_child_processes.yml
Suspicious WmiPrvSE Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\wbem\\WmiPrvSE.exe" and ((FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\verclsid.exe" or FolderPath endswith "\\wscript.exe") or ((ProcessCommandLine contains "cscript" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "powershell" or ProcessCommandLine contains "pwsh" or ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "wscript") and FolderPath endswith "\\cmd.exe")) and (not(((ProcessCommandLine contains "/i " and FolderPath endswith "\\msiexec.exe") or FolderPath endswith "\\WerFault.exe" or FolderPath endswith "\\WmiPrvSE.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_var.yml
Invoke-Obfuscation VAR+ Launcher ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "cmd.{0,5}(?:/c|/r)(?:\\s|)\\"set\\s[a-zA-Z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_launch.yml
HackTool - Empire PowerShell Launch Parameters ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -NoP -sta -NonI -W Hidden -Enc " or ProcessCommandLine contains " -noP -sta -w 1 -enc " or ProcessCommandLine contains " -NoP -NonI -W Hidden -enc " or ProcessCommandLine contains " -noP -sta -w 1 -enc" or ProcessCommandLine contains " -enc  SQB" or ProcessCommandLine contains " -nop -exec bypass -EncodedCommand "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regasm_regsvcs_uncommon_location_execution.yml
Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon Location ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\" or ProcessCommandLine contains "\\PerfLogs\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\Windows\\Temp\\") and ((FolderPath endswith "\\Regsvcs.exe" or FolderPath endswith "\\Regasm.exe") or (ProcessVersionInfoOriginalFileName in~ ("RegSvcs.exe", "RegAsm.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_email_exfil.yml
Email Exifiltration Via Powershell ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Add-PSSnapin" and ProcessCommandLine contains "Get-Recipient" and ProcessCommandLine contains "-ExpandProperty" and ProcessCommandLine contains "EmailAddresses" and ProcessCommandLine contains "SmtpAddress" and ProcessCommandLine contains "-hidetableheaders") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_extrac32_ads.yml
Suspicious Extrac32 Alternate Data Stream Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "extrac32.exe" and ProcessCommandLine contains ".cab") and ProcessCommandLine matches regex ":[^\\\\]"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_image.yml
Use Short Name Path in Image ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "~1\\" or FolderPath contains "~2\\") and (not((((InitiatingProcessFolderPath in~ ("C:\\Windows\\System32\\Dism.exe", "C:\\Windows\\System32\\cleanmgr.exe")) or (InitiatingProcessFolderPath endswith "\\WebEx\\WebexHost.exe" or InitiatingProcessFolderPath endswith "\\thor\\thor64.exe") or ProcessVersionInfoProductName =~ "InstallShield (R)" or ProcessVersionInfoFileDescription =~ "InstallShield (R) Setup Engine" or ProcessVersionInfoCompanyName =~ "InstallShield Software Corporation") or ((FolderPath contains "\\AppData\\" and FolderPath contains "\\Temp\\") or (FolderPath endswith "~1\\unzip.exe" or FolderPath endswith "~1\\7zG.exe")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_commandline_path_traversal_evasion.yml
Potential Command Line Path Traversal Evasion Attempt ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains "\\..\\Windows\\" or ProcessCommandLine contains "\\..\\System32\\" or ProcessCommandLine contains "\\..\\..\\") and FolderPath contains "\\Windows\\") or ProcessCommandLine contains ".exe\\..\\") and (not((ProcessCommandLine contains "\\Citrix\\Virtual Smart Card\\Citrix.Authentication.VirtualSmartcard.Launcher.exe\\..\\" or ProcessCommandLine contains "\\Google\\Drive\\googledrivesync.exe\\..\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_advpack_obfuscated_ordinal_call.yml
Suspicious Advpack Call Via Rundll32.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "advpack" and ((ProcessCommandLine contains "#+" and ProcessCommandLine contains "12") or ProcessCommandLine contains "#-") and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE" or ProcessCommandLine contains "rundll32")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_silenttrinity_stager.yml
HackTool - SILENTTRINITY Stager Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription contains "st2stager"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_revoked_cert.yml
Remote Access Tool - AnyDesk Execution With Known Revoked Signing Certificate ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\AnyDesk.exe" or ProcessVersionInfoFileDescription =~ "AnyDesk" or ProcessVersionInfoProductName =~ "AnyDesk" or ProcessVersionInfoCompanyName =~ "AnyDesk Software GmbH") and (ProcessVersionInfoProductVersion startswith "7.0." or ProcessVersionInfoProductVersion startswith "7.1." or ProcessVersionInfoProductVersion startswith "8.0.1" or ProcessVersionInfoProductVersion startswith "8.0.2" or ProcessVersionInfoProductVersion startswith "8.0.3" or ProcessVersionInfoProductVersion startswith "8.0.4" or ProcessVersionInfoProductVersion startswith "8.0.5" or ProcessVersionInfoProductVersion startswith "8.0.6" or ProcessVersionInfoProductVersion startswith "8.0.7")) and (not((ProcessCommandLine contains " --remove" or ProcessCommandLine contains " --uninstall")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_import_cert_susp_locations.yml
Root Certificate Installed From Susp Locations ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains ":\\Windows\\TEMP\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Perflogs\\" or ProcessCommandLine contains ":\\Users\\Public\\") and (ProcessCommandLine contains "Import-Certificate" and ProcessCommandLine contains " -FilePath " and ProcessCommandLine contains "Cert:\\LocalMachine\\Root")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml
Exports Critical Registry Keys To a File ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -E " or ProcessCommandLine contains " /E " or ProcessCommandLine contains " E " or ProcessCommandLine contains " E " or ProcessCommandLine contains " E ") and (ProcessCommandLine contains "hklm" or ProcessCommandLine contains "hkey_local_machine") and (ProcessCommandLine endswith "\\system" or ProcessCommandLine endswith "\\sam" or ProcessCommandLine endswith "\\security") and (FolderPath endswith "\\regedit.exe" or ProcessVersionInfoOriginalFileName =~ "REGEDIT.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml
Rundll32 Execution Without Parameters ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine in~ ("rundll32.exe", "rundll32")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_custom_user_agent.yml
Curl Web Request With Potential Custom User-Agent ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "User-Agent:" and ProcessCommandLine matches regex "\\s-H\\s") and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_c3_rundll32_pattern.yml
HackTool - F-Secure C3 Load by Rundll32 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "rundll32.exe" and ProcessCommandLine contains ".dll" and ProcessCommandLine contains "StartNodeRelay"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gpg4win_susp_location.yml
File Encryption/Decryption Via Gpg4win From Suspicious Locations ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-passphrase" and ((FolderPath endswith "\\gpg.exe" or FolderPath endswith "\\gpg2.exe") or ProcessVersionInfoProductName =~ "GNU Privacy Guard (GnuPG)" or ProcessVersionInfoFileDescription =~ "GnuPGs OpenPGP tool") and (ProcessCommandLine contains ":\\PerfLogs\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\AppData\\Roaming\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolscript_register_app.yml
Potential Register_App.Vbs LOLScript Abuse ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".vbs -register " and ((FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\wscript.exe") or (ProcessVersionInfoOriginalFileName in~ ("cscript.exe", "wscript.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_krbrelayup.yml
HackTool - KrbRelayUp Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " relay " and ProcessCommandLine contains " -Domain " and ProcessCommandLine contains " -ComputerName ") or (ProcessCommandLine contains " krbscm " and ProcessCommandLine contains " -sc ") or (ProcessCommandLine contains " spawn " and ProcessCommandLine contains " -d " and ProcessCommandLine contains " -cn " and ProcessCommandLine contains " -cp ") or (FolderPath endswith "\\KrbRelayUp.exe" or ProcessVersionInfoOriginalFileName =~ "KrbRelayUp.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_execution_via_imphashes.yml
Unexpected Error processing 'Hacktool Execution - Imphash' (sigma/rules/windows/process_creation/proc_creation_win_hktl_execution_via_imphashes.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dns_susp_child_process.yml
Unusual Child Process of dns.exe ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\dns.exe" and (not(FolderPath endswith "\\conhost.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_data_exfiltration_by_using_datasvcutil.yml
LOLBAS Data Exfiltration by DataSvcUtil.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/in:" or ProcessCommandLine contains "/out:" or ProcessCommandLine contains "/uri:") and (FolderPath endswith "\\DataSvcUtil.exe" or ProcessVersionInfoOriginalFileName =~ "DataSvcUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_ms_appinstaller_download.yml
Potential File Download Via MS-AppInstaller Protocol Handler ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ms-appinstaller://" and ProcessCommandLine contains "source=") and ProcessCommandLine contains "http"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tpmvscmgr_add_virtual_smartcard.yml
New Virtual Smart Card Created Via TpmVscMgr.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "create" and (FolderPath endswith "\\tpmvscmgr.exe" and ProcessVersionInfoOriginalFileName =~ "TpmVscMgr.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_curl_download_exec_combo.yml
Curl Download And Execute Combination ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "curl " and ProcessCommandLine contains "http" and ProcessCommandLine contains "-o" and ProcessCommandLine contains "&") and (ProcessCommandLine contains " -c " or ProcessCommandLine contains " /c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_uninstall_application.yml
Application Removed Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "call" and ProcessCommandLine contains "uninstall") and (FolderPath endswith "\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_time_discovery.yml
Discovery of a System Time ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "time" and (FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe")) or (ProcessCommandLine contains "tz" and FolderPath endswith "\\w32tm.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_no_space_execution.yml
Cmd.EXE Missing Space Characters Execution Anomaly ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "cmd.exe/c" or ProcessCommandLine contains "\\cmd/c" or ProcessCommandLine contains "\"cmd/c" or ProcessCommandLine contains "cmd.exe/k" or ProcessCommandLine contains "\\cmd/k" or ProcessCommandLine contains "\"cmd/k" or ProcessCommandLine contains "cmd.exe/r" or ProcessCommandLine contains "\\cmd/r" or ProcessCommandLine contains "\"cmd/r") or (ProcessCommandLine contains "/cwhoami" or ProcessCommandLine contains "/cpowershell" or ProcessCommandLine contains "/cschtasks" or ProcessCommandLine contains "/cbitsadmin" or ProcessCommandLine contains "/ccertutil" or ProcessCommandLine contains "/kwhoami" or ProcessCommandLine contains "/kpowershell" or ProcessCommandLine contains "/kschtasks" or ProcessCommandLine contains "/kbitsadmin" or ProcessCommandLine contains "/kcertutil") or (ProcessCommandLine contains "cmd.exe /c" or ProcessCommandLine contains "cmd /c" or ProcessCommandLine contains "cmd.exe /k" or ProcessCommandLine contains "cmd /k" or ProcessCommandLine contains "cmd.exe /r" or ProcessCommandLine contains "cmd /r")) and (not(((ProcessCommandLine in~ ("cmd.exe /c") or ProcessCommandLine contains "AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\node_modules" or ProcessCommandLine endswith "cmd.exe/c .") or (ProcessCommandLine contains "cmd.exe /c " or ProcessCommandLine contains "cmd /c " or ProcessCommandLine contains "cmd.exe /k " or ProcessCommandLine contains "cmd /k " or ProcessCommandLine contains "cmd.exe /r " or ProcessCommandLine contains "cmd /r "))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml
UAC Bypass Using Consent and Comctl32 - Process ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\werfault.exe" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessFolderPath endswith "\\consent.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_javascript.yml
Suspicious JavaScript Execution Via Mshta.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "javascript" and (FolderPath endswith "\\mshta.exe" or ProcessVersionInfoOriginalFileName =~ "MSHTA.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_finger_execution.yml
Finger.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "finger.exe" or FolderPath endswith "\\finger.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_decrypt_pattern.yml
PowerShell Execution With Potential Decryption Capabilities ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Get-ChildItem " or ProcessCommandLine contains "dir " or ProcessCommandLine contains "gci " or ProcessCommandLine contains "ls ") and (ProcessCommandLine contains "Get-Content " or ProcessCommandLine contains "gc " or ProcessCommandLine contains "cat " or ProcessCommandLine contains "type " or ProcessCommandLine contains "ReadAllBytes") and ((ProcessCommandLine contains " ^| " and ProcessCommandLine contains "*.lnk" and ProcessCommandLine contains "-Recurse" and ProcessCommandLine contains "-Skip ") or (ProcessCommandLine contains " -ExpandProperty " and ProcessCommandLine contains "*.lnk" and ProcessCommandLine contains "WriteAllBytes" and ProcessCommandLine contains " .length ")) and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") and (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml
Powershell Defender Disable Scan Feature ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "Add-MpPreference " or ProcessCommandLine contains "Set-MpPreference ") and (ProcessCommandLine contains "DisableArchiveScanning " or ProcessCommandLine contains "DisableRealtimeMonitoring " or ProcessCommandLine contains "DisableIOAVProtection " or ProcessCommandLine contains "DisableBehaviorMonitoring " or ProcessCommandLine contains "DisableBlockAtFirstSeen " or ProcessCommandLine contains "DisableCatchupFullScan " or ProcessCommandLine contains "DisableCatchupQuickScan ") and (ProcessCommandLine contains "$true" or ProcessCommandLine contains " 1 ")) or ((ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA" or ProcessCommandLine contains "EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA" or ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA" or ProcessCommandLine contains "EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA" or ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA" or ProcessCommandLine contains "EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA" or ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA" or ProcessCommandLine contains "EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA" or ProcessCommandLine contains "ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA" or ProcessCommandLine contains "kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA" or ProcessCommandLine contains "ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA" or ProcessCommandLine contains "kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA" or ProcessCommandLine contains "ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA" or ProcessCommandLine contains "kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA" or ProcessCommandLine contains "ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA" or ProcessCommandLine contains "QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA" or ProcessCommandLine contains "kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA" or ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA" or ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA" or ProcessCommandLine contains "RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA") or (ProcessCommandLine contains "ZGlzYWJsZWFyY2hpdmVzY2FubmluZy" or ProcessCommandLine contains "Rpc2FibGVhcmNoaXZlc2Nhbm5pbmcg" or ProcessCommandLine contains "kaXNhYmxlYXJjaGl2ZXNjYW5uaW5nI" or ProcessCommandLine contains "RGlzYWJsZUFyY2hpdmVTY2FubmluZy" or ProcessCommandLine contains "Rpc2FibGVBcmNoaXZlU2Nhbm5pbmcg" or ProcessCommandLine contains "EaXNhYmxlQXJjaGl2ZVNjYW5uaW5nI" or ProcessCommandLine contains "ZGlzYWJsZWJlaGF2aW9ybW9uaXRvcmluZy" or ProcessCommandLine contains "Rpc2FibGViZWhhdmlvcm1vbml0b3Jpbmcg" or ProcessCommandLine contains "kaXNhYmxlYmVoYXZpb3Jtb25pdG9yaW5nI" or ProcessCommandLine contains "RGlzYWJsZUJlaGF2aW9yTW9uaXRvcmluZy" or ProcessCommandLine contains "Rpc2FibGVCZWhhdmlvck1vbml0b3Jpbmcg" or ProcessCommandLine contains "EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nI" or ProcessCommandLine contains "ZGlzYWJsZWJsb2NrYXRmaXJzdHNlZW4g" or ProcessCommandLine contains "Rpc2FibGVibG9ja2F0Zmlyc3RzZWVuI" or ProcessCommandLine contains "kaXNhYmxlYmxvY2thdGZpcnN0c2Vlbi" or ProcessCommandLine contains "RGlzYWJsZUJsb2NrQXRGaXJzdFNlZW4g" or ProcessCommandLine contains "Rpc2FibGVCbG9ja0F0Rmlyc3RTZWVuI" or ProcessCommandLine contains "EaXNhYmxlQmxvY2tBdEZpcnN0U2Vlbi" or ProcessCommandLine contains "ZGlzYWJsZWNhdGNodXBmdWxsc2Nhbi" or ProcessCommandLine contains "Rpc2FibGVjYXRjaHVwZnVsbHNjYW4g" or ProcessCommandLine contains "kaXNhYmxlY2F0Y2h1cGZ1bGxzY2FuI" or ProcessCommandLine contains "RGlzYWJsZUNhdGNodXBGdWxsU2Nhbi" or ProcessCommandLine contains "Rpc2FibGVDYXRjaHVwRnVsbFNjYW4g" or ProcessCommandLine contains "EaXNhYmxlQ2F0Y2h1cEZ1bGxTY2FuI" or ProcessCommandLine contains "ZGlzYWJsZWNhdGNodXBxdWlja3NjYW4g" or ProcessCommandLine contains "Rpc2FibGVjYXRjaHVwcXVpY2tzY2FuI" or ProcessCommandLine contains "kaXNhYmxlY2F0Y2h1cHF1aWNrc2Nhbi" or ProcessCommandLine contains "RGlzYWJsZUNhdGNodXBRdWlja1NjYW4g" or ProcessCommandLine contains "Rpc2FibGVDYXRjaHVwUXVpY2tTY2FuI" or ProcessCommandLine contains "EaXNhYmxlQ2F0Y2h1cFF1aWNrU2Nhbi" or ProcessCommandLine contains "ZGlzYWJsZWlvYXZwcm90ZWN0aW9uI" or ProcessCommandLine contains "Rpc2FibGVpb2F2cHJvdGVjdGlvbi" or ProcessCommandLine contains "kaXNhYmxlaW9hdnByb3RlY3Rpb24g" or ProcessCommandLine contains "RGlzYWJsZUlPQVZQcm90ZWN0aW9uI" or ProcessCommandLine contains "Rpc2FibGVJT0FWUHJvdGVjdGlvbi" or ProcessCommandLine contains "EaXNhYmxlSU9BVlByb3RlY3Rpb24g" or ProcessCommandLine contains "ZGlzYWJsZXJlYWx0aW1lbW9uaXRvcmluZy" or ProcessCommandLine contains "Rpc2FibGVyZWFsdGltZW1vbml0b3Jpbmcg" or ProcessCommandLine contains "kaXNhYmxlcmVhbHRpbWVtb25pdG9yaW5nI" or ProcessCommandLine contains "RGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZy" or ProcessCommandLine contains "Rpc2FibGVSZWFsdGltZU1vbml0b3Jpbmcg" or ProcessCommandLine contains "EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nI"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_csi_use_of_csharp_console.yml
Suspicious Use of CSharp Interactive Console ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\csi.exe" and ProcessVersionInfoOriginalFileName =~ "csi.exe" and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\powershell_ise.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_relay_attacks_tools.yml
Potential SMB Relay Attack Tool Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains ".exe -c \"{" and ProcessCommandLine endswith "}\" -z") or (FolderPath contains "PetitPotam" or FolderPath contains "RottenPotato" or FolderPath contains "HotPotato" or FolderPath contains "JuicyPotato" or FolderPath contains "\\just_dce_" or FolderPath contains "Juicy Potato" or FolderPath contains "\\temp\\rot.exe" or FolderPath contains "\\Potato.exe" or FolderPath contains "\\SpoolSample.exe" or FolderPath contains "\\Responder.exe" or FolderPath contains "\\smbrelayx" or FolderPath contains "\\ntlmrelayx" or FolderPath contains "\\LocalPotato") or (ProcessCommandLine contains "Invoke-Tater" or ProcessCommandLine contains " smbrelay" or ProcessCommandLine contains " ntlmrelay" or ProcessCommandLine contains "cme smb " or ProcessCommandLine contains " /ntlm:NTLMhash " or ProcessCommandLine contains "Invoke-PetitPotam" or (ProcessCommandLine contains ".exe -t " and ProcessCommandLine contains " -p "))) and (not((FolderPath contains "HotPotatoes6" or FolderPath contains "HotPotatoes7" or FolderPath contains "HotPotatoes ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_uninstall.yml
Uninstall Sysinternals Sysmon ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-u" or ProcessCommandLine contains "/u" or ProcessCommandLine contains "u" or ProcessCommandLine contains "u" or ProcessCommandLine contains "u") and ((FolderPath endswith "\\Sysmon64.exe" or FolderPath endswith "\\Sysmon.exe") or ProcessVersionInfoFileDescription =~ "System activity monitor")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_download_direct_ip_exec.yml
File Download From IP URL Via Curl.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -O" or ProcessCommandLine contains "--remote-name" or ProcessCommandLine contains "--output") and ProcessCommandLine contains "http" and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe") and ProcessCommandLine matches regex "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}") and (not((ProcessCommandLine endswith ".bat" or ProcessCommandLine endswith ".bat\"" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".dat\"" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".dll\"" or ProcessCommandLine endswith ".exe" or ProcessCommandLine endswith ".exe\"" or ProcessCommandLine endswith ".gif" or ProcessCommandLine endswith ".gif\"" or ProcessCommandLine endswith ".hta" or ProcessCommandLine endswith ".hta\"" or ProcessCommandLine endswith ".jpeg" or ProcessCommandLine endswith ".jpeg\"" or ProcessCommandLine endswith ".log" or ProcessCommandLine endswith ".log\"" or ProcessCommandLine endswith ".msi" or ProcessCommandLine endswith ".msi\"" or ProcessCommandLine endswith ".png" or ProcessCommandLine endswith ".png\"" or ProcessCommandLine endswith ".ps1" or ProcessCommandLine endswith ".ps1\"" or ProcessCommandLine endswith ".psm1" or ProcessCommandLine endswith ".psm1\"" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbe\"" or ProcessCommandLine endswith ".vbs" or ProcessCommandLine endswith ".vbs\"" or ProcessCommandLine endswith ".bat'" or ProcessCommandLine endswith ".dat'" or ProcessCommandLine endswith ".dll'" or ProcessCommandLine endswith ".exe'" or ProcessCommandLine endswith ".gif'" or ProcessCommandLine endswith ".hta'" or ProcessCommandLine endswith ".jpeg'" or ProcessCommandLine endswith ".log'" or ProcessCommandLine endswith ".msi'" or ProcessCommandLine endswith ".png'" or ProcessCommandLine endswith ".ps1'" or ProcessCommandLine endswith ".psm1'" or ProcessCommandLine endswith ".vbe'" or ProcessCommandLine endswith ".vbs'")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_register_dll_regsvr.yml
New DLL Registered Via Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "REGSVR " and ProcessCommandLine contains ".dll") and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wsl_windows_binaries_execution.yml
Sigma Transformation Error for 'Windows Binary Executed From WSL': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bginfo_uncommon_child_process.yml
Uncommon Child Process Of BgInfo.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\bginfo.exe" or InitiatingProcessFolderPath endswith "\\bginfo64.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_zipexec.yml
Suspicious ZipExec Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/generic:Microsoft_Windows_Shell_ZipFolder:filename=" and ProcessCommandLine contains ".zip" and ProcessCommandLine contains "/pass:" and ProcessCommandLine contains "/user:") or (ProcessCommandLine contains "/delete" and ProcessCommandLine contains "Microsoft_Windows_Shell_ZipFolder:filename=" and ProcessCommandLine contains ".zip")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_electron_execution_proxy.yml
Potentially Suspicious Electron Application CommandLine ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--browser-subprocess-path" or ProcessCommandLine contains "--gpu-launcher" or ProcessCommandLine contains "--renderer-cmd-prefix" or ProcessCommandLine contains "--utility-cmd-prefix") and ((FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\code.exe" or FolderPath endswith "\\discord.exe" or FolderPath endswith "\\GitHubDesktop.exe" or FolderPath endswith "\\keybase.exe" or FolderPath endswith "\\msedge_proxy.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\msedgewebview2.exe" or FolderPath endswith "\\msteams.exe" or FolderPath endswith "\\slack.exe" or FolderPath endswith "\\Teams.exe") or (ProcessVersionInfoOriginalFileName in~ ("chrome.exe", "code.exe", "discord.exe", "GitHubDesktop.exe", "keybase.exe", "msedge_proxy.exe", "msedge.exe", "msedgewebview2.exe", "msteams.exe", "slack.exe", "Teams.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wusa_susp_parent_execution.yml
Wusa.EXE Executed By Parent Process Located In Suspicious Location ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\wusa.exe" and ((InitiatingProcessFolderPath contains ":\\Perflogs\\" or InitiatingProcessFolderPath contains ":\\Users\\Public\\" or InitiatingProcessFolderPath contains ":\\Windows\\Temp\\" or InitiatingProcessFolderPath contains "\\Appdata\\Local\\Temp\\" or InitiatingProcessFolderPath contains "\\Temporary Internet") or ((InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Favorites\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Favourites\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Contacts\\") or (InitiatingProcessFolderPath contains ":\\Users\\" and InitiatingProcessFolderPath contains "\\Pictures\\"))) and (not(ProcessCommandLine contains ".msu"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sdbinst_shim_persistence.yml
Potential Shim Database Persistence via Sdbinst.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".sdb" and (FolderPath endswith "\\sdbinst.exe" or ProcessVersionInfoOriginalFileName =~ "sdbinst.exe")) and (not(((ProcessCommandLine contains ":\\Program Files (x86)\\IIS Express\\iisexpressshim.sdb" or ProcessCommandLine contains ":\\Program Files\\IIS Express\\iisexpressshim.sdb") and InitiatingProcessFolderPath endswith "\\msiexec.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_privilege_escalation_via_service_key.yml
Potential Privilege Escalation via Service Permissions Weakness ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\ImagePath" or ProcessCommandLine contains "\\FailureCommand" or ProcessCommandLine contains "\\ServiceDll") and (ProcessCommandLine contains "ControlSet" and ProcessCommandLine contains "services") and (ProcessIntegrityLevel in~ ("Medium", "S-1-16-8192"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_get_localgroup_member_recon.yml
Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Get-LocalGroupMember " and (ProcessCommandLine contains "domain admins" or ProcessCommandLine contains " administrator" or ProcessCommandLine contains " administrateur" or ProcessCommandLine contains "enterprise admins" or ProcessCommandLine contains "Exchange Trusted Subsystem" or ProcessCommandLine contains "Remote Desktop Users" or ProcessCommandLine contains "Utilisateurs du Bureau  distance" or ProcessCommandLine contains "Usuarios de escritorio remoto")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_system_user_anomaly.yml
Suspicious SYSTEM User Process Creation ---> KQL Query:
DeviceProcessEvents
| where (((ProcessIntegrityLevel in~ ("System", "S-1-16-16384")) and (AccountName contains "AUTHORI" or AccountName contains "AUTORI")) and ((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\hh.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\ping.exe" or FolderPath endswith "\\wscript.exe") or (ProcessCommandLine contains " -NoP " or ProcessCommandLine contains " -W Hidden " or ProcessCommandLine contains " -decode " or ProcessCommandLine contains " /decode " or ProcessCommandLine contains " /urlcache " or ProcessCommandLine contains " -urlcache " or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " JAB") or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " SUVYI") or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " SQBFAFgA") or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " aWV4I") or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " IAB") or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " PAA") or (ProcessCommandLine contains " -e" and ProcessCommandLine contains " aQBlAHgA") or ProcessCommandLine contains "vssadmin delete shadows" or ProcessCommandLine contains "reg SAVE HKLM" or ProcessCommandLine contains " -ma " or ProcessCommandLine contains "Microsoft\\Windows\\CurrentVersion\\Run" or ProcessCommandLine contains ".downloadstring(" or ProcessCommandLine contains ".downloadfile(" or ProcessCommandLine contains " /ticket:" or ProcessCommandLine contains "dpapi::" or ProcessCommandLine contains "event::clear" or ProcessCommandLine contains "event::drop" or ProcessCommandLine contains "id::modify" or ProcessCommandLine contains "kerberos::" or ProcessCommandLine contains "lsadump::" or ProcessCommandLine contains "misc::" or ProcessCommandLine contains "privilege::" or ProcessCommandLine contains "rpc::" or ProcessCommandLine contains "sekurlsa::" or ProcessCommandLine contains "sid::" or ProcessCommandLine contains "token::" or ProcessCommandLine contains "vault::cred" or ProcessCommandLine contains "vault::list" or ProcessCommandLine contains " p::d " or ProcessCommandLine contains ";iex(" or ProcessCommandLine contains "MiniDump" or ProcessCommandLine contains "net user "))) and (not((InitiatingProcessFolderPath contains ":\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\" or (ProcessCommandLine contains " -ma " and (FolderPath contains ":\\Program Files (x86)\\Java\\" or FolderPath contains ":\\Program Files\\Java\\") and FolderPath endswith "\\bin\\jp2launcher.exe" and (InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Java\\" or InitiatingProcessFolderPath contains ":\\Program Files\\Java\\") and InitiatingProcessFolderPath endswith "\\bin\\javaws.exe") or (ProcessCommandLine contains "ping" and ProcessCommandLine contains "127.0.0.1" and ProcessCommandLine contains " -n ") or (FolderPath endswith "\\PING.EXE" and InitiatingProcessCommandLine contains "\\DismFoDInstall.cmd"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_perl_inline_command_execution.yml
Perl Inline Command Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -e" and (FolderPath endswith "\\perl.exe" or ProcessVersionInfoOriginalFileName =~ "perl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_env_folder.yml
Schedule Task Creation From Env Variable Or Potentially Suspicious Path Via Schtasks.EXE ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains ":\\Perflogs" or ProcessCommandLine contains ":\\Users\\All Users\\" or ProcessCommandLine contains ":\\Users\\Default\\" or ProcessCommandLine contains ":\\Users\\Public" or ProcessCommandLine contains ":\\Windows\\Temp" or ProcessCommandLine contains "\\AppData\\Local\\" or ProcessCommandLine contains "\\AppData\\Roaming\\" or ProcessCommandLine contains "%AppData%" or ProcessCommandLine contains "%Public%") and (ProcessCommandLine contains " /create " and FolderPath endswith "\\schtasks.exe")) or (InitiatingProcessCommandLine endswith "\\svchost.exe -k netsvcs -p -s Schedule" and (ProcessCommandLine contains ":\\Perflogs" or ProcessCommandLine contains ":\\Windows\\Temp" or ProcessCommandLine contains "\\Users\\Public" or ProcessCommandLine contains "%Public%"))) and (not(((ProcessCommandLine contains "/Create /Xml \"C:\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\Temp\\.CR." and ProcessCommandLine contains "Avira_Security_Installation.xml") or ((ProcessCommandLine contains ".tmp\\UpdateFallbackTask.xml" or ProcessCommandLine contains ".tmp\\WatchdogServiceControlManagerTimeout.xml" or ProcessCommandLine contains ".tmp\\SystrayAutostart.xml" or ProcessCommandLine contains ".tmp\\MaintenanceTask.xml") and (ProcessCommandLine contains "/Create /F /TN" and ProcessCommandLine contains "/Xml " and ProcessCommandLine contains "\\AppData\\Local\\Temp\\is-" and ProcessCommandLine contains "Avira_")) or (ProcessCommandLine contains "\\AppData\\Local\\Temp\\" and ProcessCommandLine contains "/Create /TN \"klcp_update\" /XML " and ProcessCommandLine contains "\\klcp_update_task.xml") or (InitiatingProcessCommandLine contains "unattended.ini" or ProcessCommandLine contains "update_task.xml") or ProcessCommandLine contains "/Create /TN TVInstallRestore /TR")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_download.yml
Suspicious Invoke-WebRequest Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "curl " or ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "wget ") and (ProcessCommandLine contains " -ur" or ProcessCommandLine contains " -o") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine contains "\\AppData\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Temp\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "%AppData%" or ProcessCommandLine contains "%Public%" or ProcessCommandLine contains "%Temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains ":\\Windows\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_encode.yml
File Encoded To Base64 Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-encode" or ProcessCommandLine contains "/encode" or ProcessCommandLine contains "encode" or ProcessCommandLine contains "encode" or ProcessCommandLine contains "encode") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_ordinal_execution.yml
Suspicious ShellExec_RunDLL Call Via Ordinal ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains "SHELL32.DLL" and (InitiatingProcessCommandLine contains "#568" or InitiatingProcessCommandLine contains "#570" or InitiatingProcessCommandLine contains "#572" or InitiatingProcessCommandLine contains "#576")) and ((FolderPath endswith "\\bash.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\msxsl.exe" or FolderPath endswith "\\odbcconf.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe") or ((InitiatingProcessCommandLine contains "comspec" or InitiatingProcessCommandLine contains "iex" or InitiatingProcessCommandLine contains "Invoke-" or InitiatingProcessCommandLine contains "msiexec" or InitiatingProcessCommandLine contains "odbcconf" or InitiatingProcessCommandLine contains "regsvr32") or (InitiatingProcessCommandLine contains "\\Desktop\\" or InitiatingProcessCommandLine contains "\\ProgramData\\" or InitiatingProcessCommandLine contains "\\Temp\\" or InitiatingProcessCommandLine contains "\\Users\\Public\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_ditsnap.yml
PUA - DIT Snapshot Viewer ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\ditsnap.exe" or ProcessCommandLine contains "ditsnap.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bash_command_execution.yml
Indirect Inline Command Execution Via Bash.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -c " and ((FolderPath endswith ":\\Windows\\System32\\bash.exe" or FolderPath endswith ":\\Windows\\SysWOW64\\bash.exe") or ProcessVersionInfoOriginalFileName =~ "Bash.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_always_install_elevated_windows_installer.yml
Always Install Elevated Windows Installer ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath contains "\\Windows\\Installer\\" and FolderPath contains "msi") and FolderPath endswith "tmp") or (FolderPath endswith "\\msiexec.exe" and (ProcessIntegrityLevel in~ ("System", "S-1-16-16384")))) and (AccountName contains "AUTHORI" or AccountName contains "AUTORI") and (not(((InitiatingProcessFolderPath startswith "C:\\Program Files\\Avast Software\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Avast Software\\") or InitiatingProcessFolderPath startswith "C:\\ProgramData\\Avira\\" or (InitiatingProcessFolderPath startswith "C:\\Program Files\\Google\\Update\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Google\\Update\\") or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\services.exe" or (ProcessCommandLine endswith "\\system32\\msiexec.exe /V" or InitiatingProcessCommandLine endswith "\\system32\\msiexec.exe /V") or InitiatingProcessFolderPath startswith "C:\\ProgramData\\Sophos\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml
Copy From Or To Admin Share Or Sysvol Folder ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "\\" and ProcessCommandLine contains "$") or ProcessCommandLine contains "\\Sysvol\\") and (((FolderPath endswith "\\robocopy.exe" or FolderPath endswith "\\xcopy.exe") or (ProcessVersionInfoOriginalFileName in~ ("robocopy.exe", "XCOPY.EXE"))) or (ProcessCommandLine contains "copy" and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")) or ((ProcessCommandLine contains "copy-item" or ProcessCommandLine contains "copy " or ProcessCommandLine contains "cpi " or ProcessCommandLine contains " cp " or ProcessCommandLine contains "move " or ProcessCommandLine contains "move-item" or ProcessCommandLine contains " mi " or ProcessCommandLine contains " mv ") and ((FolderPath contains "\\powershell.exe" or FolderPath contains "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_printbrm.yml
PrintBrm ZIP Creation of Extraction ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -f" and ProcessCommandLine contains ".zip") and FolderPath endswith "\\PrintBrm.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_download.yml
Suspicious Download Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "urlcache " or ProcessCommandLine contains "verifyctl ") and ProcessCommandLine contains "http" and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_infdefaultinstall_execute_sct_scripts.yml
InfDefaultInstall.exe .inf Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "InfDefaultInstall.exe " and ProcessCommandLine contains ".inf"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_device_credential_deployment.yml
DeviceCredentialDeployment Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\DeviceCredentialDeployment.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_onenote_embedded_script_execution.yml
OneNote.EXE Execution of Malicious Embedded Scripts ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\exported\\" or ProcessCommandLine contains "\\onenoteofflinecache_files\\") and (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\onenote.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_megasync.yml
Renamed MegaSync Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "megasync.exe" and (not(FolderPath endswith "\\megasync.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_squiblytwo_bypass.yml
Unexpected Error processing 'Potential SquiblyTwo Technique Execution' (sigma/rules/windows/process_creation/proc_creation_win_wmic_squiblytwo_bypass.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_mouselock_execution.yml
PUA - Mouse Lock Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoProductName contains "Mouse Lock" or ProcessVersionInfoCompanyName contains "Misc314" or ProcessCommandLine contains "Mouse Lock_"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_use_mount_share.yml
Windows Share Mount Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " use " or ProcessCommandLine contains " \\\\") and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_download.yml
Remote File Download Via Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "findstr" or FolderPath endswith "findstr.exe" or ProcessVersionInfoOriginalFileName =~ "FINDSTR.EXE") and ((ProcessCommandLine contains " -v " or ProcessCommandLine contains " /v " or ProcessCommandLine contains " v " or ProcessCommandLine contains " v " or ProcessCommandLine contains " v ") and (ProcessCommandLine contains " -l " or ProcessCommandLine contains " /l " or ProcessCommandLine contains " l " or ProcessCommandLine contains " l " or ProcessCommandLine contains " l ") and ProcessCommandLine contains "\\\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lsass_process_clone.yml
Potential Credential Dumping Via LSASS Process Clone ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\Windows\\System32\\lsass.exe" and InitiatingProcessFolderPath endswith "\\Windows\\System32\\lsass.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_nslookup_poweshell_download.yml
Nslookup PowerShell Download Cradle - ProcessCreation ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -q=txt " or ProcessCommandLine contains " -querytype=txt ") and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe")) and (FolderPath contains "\\nslookup.exe" or ProcessVersionInfoOriginalFileName =~ "\\nslookup.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_ping_copy_combined_execution.yml
Potentially Suspicious Ping/Copy Command Combination ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ping" and ProcessCommandLine contains "copy ") and (ProcessCommandLine contains " -n " or ProcessCommandLine contains " /n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n ") and (ProcessCommandLine contains " -y " or ProcessCommandLine contains " /y " or ProcessCommandLine contains " y " or ProcessCommandLine contains " y " or ProcessCommandLine contains " y ") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_arbitrary_shell_execution_via_settingcontent.yml
Arbitrary Shell Command Execution Via Settingcontent-Ms ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".SettingContent-ms" and (not(ProcessCommandLine contains "immersivecontrolpanel"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_etw_modification_cmdline.yml
ETW Logging Tamper In .NET Processes Via CommandLine ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "COMPlus_ETWEnabled" or ProcessCommandLine contains "COMPlus_ETWFlags"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_dll.yml
DllUnregisterServer Function Call Via Msiexec.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".dll" and (ProcessCommandLine contains " -z " or ProcessCommandLine contains " /z " or ProcessCommandLine contains " z " or ProcessCommandLine contains " z " or ProcessCommandLine contains " z ") and (FolderPath endswith "\\msiexec.exe" or ProcessVersionInfoOriginalFileName =~ "\\msiexec.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wbadmin_delete_all_backups.yml
All Backups Deleted Via Wbadmin.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "keepVersions:0" and (ProcessCommandLine contains "delete" and ProcessCommandLine contains "backup")) and (FolderPath endswith "\\wbadmin.exe" or ProcessVersionInfoOriginalFileName =~ "WBADMIN.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regini_execution.yml
Registry Modification Via Regini.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\regini.exe" or ProcessVersionInfoOriginalFileName =~ "REGINI.EXE") and (not(ProcessCommandLine matches regex ":[^ \\\\]"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_extensions.yml
File With Suspicious Extension Downloaded Via Bitsadmin ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".7z" or ProcessCommandLine contains ".asax" or ProcessCommandLine contains ".ashx" or ProcessCommandLine contains ".asmx" or ProcessCommandLine contains ".asp" or ProcessCommandLine contains ".aspx" or ProcessCommandLine contains ".bat" or ProcessCommandLine contains ".cfm" or ProcessCommandLine contains ".cgi" or ProcessCommandLine contains ".chm" or ProcessCommandLine contains ".cmd" or ProcessCommandLine contains ".dll" or ProcessCommandLine contains ".gif" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".jsp" or ProcessCommandLine contains ".jspx" or ProcessCommandLine contains ".log" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".ps1" or ProcessCommandLine contains ".psm1" or ProcessCommandLine contains ".rar" or ProcessCommandLine contains ".scf" or ProcessCommandLine contains ".sct" or ProcessCommandLine contains ".txt" or ProcessCommandLine contains ".vbe" or ProcessCommandLine contains ".vbs" or ProcessCommandLine contains ".war" or ProcessCommandLine contains ".wsf" or ProcessCommandLine contains ".wsh" or ProcessCommandLine contains ".xll" or ProcessCommandLine contains ".zip") and (ProcessCommandLine contains " /transfer " or ProcessCommandLine contains " /create " or ProcessCommandLine contains " /addfile ") and (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certoc_load_dll_susp_locations.yml
Suspicious DLL Loaded via CertOC.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -LoadDLL " or ProcessCommandLine contains " /LoadDLL " or ProcessCommandLine contains " LoadDLL " or ProcessCommandLine contains " LoadDLL " or ProcessCommandLine contains " LoadDLL ") and (FolderPath endswith "\\certoc.exe" or ProcessVersionInfoOriginalFileName =~ "CertOC.exe") and (ProcessCommandLine contains "\\Appdata\\Local\\Temp\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "C:\\Windows\\Tasks\\" or ProcessCommandLine contains "C:\\Windows\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml
Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths" or ProcessCommandLine contains "SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths") and (ProcessCommandLine contains "ADD " and ProcessCommandLine contains "/t " and ProcessCommandLine contains "REG_DWORD " and ProcessCommandLine contains "/v " and ProcessCommandLine contains "/d " and ProcessCommandLine contains "0") and FolderPath endswith "\\reg.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_offlinescannershell_mpclient_sideloading.yml
Sigma Transformation Error for 'Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_computersystem.yml
Computer System Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "computersystem" and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_powersploit_empire_default_schtasks.yml
HackTool - Default PowerSploit/Empire Scheduled Task Creation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/SC ONLOGON" or ProcessCommandLine contains "/SC DAILY /ST" or ProcessCommandLine contains "/SC ONIDLE" or ProcessCommandLine contains "/SC HOURLY") and (ProcessCommandLine contains "/Create" and ProcessCommandLine contains "powershell.exe -NonI" and ProcessCommandLine contains "/TN Updater /TR") and FolderPath endswith "\\schtasks.exe" and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_remove_mppreference.yml
Tamper Windows Defender Remove-MpPreference ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Remove-MpPreference" and (ProcessCommandLine contains "-ControlledFolderAccessProtectedFolders " or ProcessCommandLine contains "-AttackSurfaceReductionRules_Ids " or ProcessCommandLine contains "-AttackSurfaceReductionRules_Actions " or ProcessCommandLine contains "-CheckForSignaturesBeforeRunningScan ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iexpress_susp_execution.yml
Self Extracting Package Creation Via Iexpress.EXE From Potentially Suspicious Location ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -n " or ProcessCommandLine contains " /n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n ") and (FolderPath endswith "\\iexpress.exe" or ProcessVersionInfoOriginalFileName =~ "IEXPRESS.exe") and (ProcessCommandLine contains ":\\ProgramData\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Windows\\System32\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_diantz_ads.yml
Suspicious Diantz Alternate Data Stream Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "diantz.exe" and ProcessCommandLine contains ".cab") and ProcessCommandLine matches regex ":[^\\\\]"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_adplus_memory_dump.yml
Potential Adplus.EXE Abuse ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -hang " or ProcessCommandLine contains " -pn " or ProcessCommandLine contains " -pmn " or ProcessCommandLine contains " -p " or ProcessCommandLine contains " -po " or ProcessCommandLine contains " -c " or ProcessCommandLine contains " -sc ") and (FolderPath endswith "\\adplus.exe" or ProcessVersionInfoOriginalFileName =~ "Adplus.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_cradle_obfuscated.yml
Obfuscated PowerShell OneLiner Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://127.0.0.1" and ProcessCommandLine contains "%{(IRM $_)}" and ProcessCommandLine contains "Invoke") and FolderPath endswith "\\powershell.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_user_add.yml
New User Created Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "user" and ProcessCommandLine contains "add") and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mmc_mmc20_lateral_movement.yml
MMC20 Lateral Movement ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-Embedding" and FolderPath endswith "\\mmc.exe" and InitiatingProcessFolderPath endswith "\\svchost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport.yml
Remote Access Tool - NetSupport Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "NetSupport Client Configurator" or ProcessVersionInfoProductName =~ "NetSupport Remote Control" or ProcessVersionInfoCompanyName =~ "NetSupport Ltd" or ProcessVersionInfoOriginalFileName =~ "PCICFGUI.EXE"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winget_add_insecure_custom_source.yml
Add Insecure Download Source To Winget ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "source " and ProcessCommandLine contains "add " and ProcessCommandLine contains "http://") and (FolderPath endswith "\\winget.exe" or ProcessVersionInfoOriginalFileName =~ "winget.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_dumpstack_log_evasion.yml
DumpStack.log Defender Evasion ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\DumpStack.log" or ProcessCommandLine contains " -o DumpStack.log"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cipher_overwrite_deleted_data.yml
Deleted Data Overwritten Via Cipher.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /w:" and (ProcessVersionInfoOriginalFileName =~ "CIPHER.EXE" or FolderPath endswith "\\cipher.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_groups_and_accounts_recon.yml
Suspicious Group And Account Reconnaissance Activity Using Net.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe"))) and ((((ProcessCommandLine contains "domain admins" or ProcessCommandLine contains " administrator" or ProcessCommandLine contains " administrateur" or ProcessCommandLine contains "enterprise admins" or ProcessCommandLine contains "Exchange Trusted Subsystem" or ProcessCommandLine contains "Remote Desktop Users" or ProcessCommandLine contains "Utilisateurs du Bureau  distance" or ProcessCommandLine contains "Usuarios de escritorio remoto" or ProcessCommandLine contains " /do") and (ProcessCommandLine contains " group " or ProcessCommandLine contains " localgroup ")) and (not(ProcessCommandLine contains " /add"))) or (ProcessCommandLine contains " /do" and ProcessCommandLine contains " accounts "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_typed_paths_persistence.yml
Persistence Via TypedPaths - CommandLine ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_diskshadow_child_process_susp.yml
Potentially Suspicious Child Process Of DiskShadow.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\diskshadow.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_deletion.yml
Shadow Copies Deletion Using Operating Systems Utilities ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "shadow" and ProcessCommandLine contains "delete") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\vssadmin.exe" or FolderPath endswith "\\diskshadow.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll", "wmic.exe", "VSSADMIN.EXE", "diskshadow.exe")))) or ((ProcessCommandLine contains "delete" and ProcessCommandLine contains "catalog" and ProcessCommandLine contains "quiet") and (FolderPath endswith "\\wbadmin.exe" or ProcessVersionInfoOriginalFileName =~ "WBADMIN.EXE")) or (((ProcessCommandLine contains "unbounded" or ProcessCommandLine contains "/MaxSize=") and (ProcessCommandLine contains "resize" and ProcessCommandLine contains "shadowstorage")) and (FolderPath endswith "\\vssadmin.exe" or ProcessVersionInfoOriginalFileName =~ "VSSADMIN.EXE"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_tools_masquerading.yml
Potential Binary Impersonating Sysinternals Tools ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\accesschk64a.exe" or FolderPath endswith "\\ADExplorer64a.exe" or FolderPath endswith "\\ADInsight64a.exe" or FolderPath endswith "\\adrestore64a.exe" or FolderPath endswith "\\Autologon64a.exe" or FolderPath endswith "\\Autoruns64a.exe" or FolderPath endswith "\\autorunsc64a.exe" or FolderPath endswith "\\Clockres64a.exe" or FolderPath endswith "\\Contig64a.exe" or FolderPath endswith "\\Coreinfo64a.exe" or FolderPath endswith "\\Dbgview64a.exe" or FolderPath endswith "\\disk2vhd64a.exe" or FolderPath endswith "\\diskext64a.exe" or FolderPath endswith "\\DiskView64a.exe" or FolderPath endswith "\\du64a.exe" or FolderPath endswith "\\FindLinks64a.exe" or FolderPath endswith "\\handle64a.exe" or FolderPath endswith "\\hex2dec64a.exe" or FolderPath endswith "\\junction64a.exe" or FolderPath endswith "\\LoadOrd64a.exe" or FolderPath endswith "\\LoadOrdC64a.exe" or FolderPath endswith "\\logonsessions64a.exe" or FolderPath endswith "\\movefile64a.exe" or FolderPath endswith "\\notmyfault64a.exe" or FolderPath endswith "\\notmyfaultc64a.exe" or FolderPath endswith "\\pendmoves64a.exe" or FolderPath endswith "\\pipelist64a.exe" or FolderPath endswith "\\procdump64a.exe" or FolderPath endswith "\\procexp64a.exe" or FolderPath endswith "\\Procmon64a.exe" or FolderPath endswith "\\PsExec64a.exe" or FolderPath endswith "\\psfile64a.exe" or FolderPath endswith "\\PsGetsid64a.exe" or FolderPath endswith "\\PsInfo64a.exe" or FolderPath endswith "\\pskill64a.exe" or FolderPath endswith "\\psloglist64a.exe" or FolderPath endswith "\\pspasswd64a.exe" or FolderPath endswith "\\psping64a.exe" or FolderPath endswith "\\PsService64a.exe" or FolderPath endswith "\\pssuspend64a.exe" or FolderPath endswith "\\RAMMap64a.exe" or FolderPath endswith "\\RegDelNull64a.exe" or FolderPath endswith "\\ru64a.exe" or FolderPath endswith "\\sdelete64a.exe" or FolderPath endswith "\\sigcheck64a.exe" or FolderPath endswith "\\streams64a.exe" or FolderPath endswith "\\strings64a.exe" or FolderPath endswith "\\sync64a.exe" or FolderPath endswith "\\Sysmon64a.exe" or FolderPath endswith "\\tcpvcon64a.exe" or FolderPath endswith "\\tcpview64a.exe" or FolderPath endswith "\\vmmap64a.exe" or FolderPath endswith "\\whois64a.exe" or FolderPath endswith "\\Winobj64a.exe" or FolderPath endswith "\\ZoomIt64a.exe") or (FolderPath endswith "\\accesschk.exe" or FolderPath endswith "\\accesschk64.exe" or FolderPath endswith "\\AccessEnum.exe" or FolderPath endswith "\\ADExplorer.exe" or FolderPath endswith "\\ADExplorer64.exe" or FolderPath endswith "\\ADInsight.exe" or FolderPath endswith "\\ADInsight64.exe" or FolderPath endswith "\\adrestore.exe" or FolderPath endswith "\\adrestore64.exe" or FolderPath endswith "\\Autologon.exe" or FolderPath endswith "\\Autologon64.exe" or FolderPath endswith "\\Autoruns.exe" or FolderPath endswith "\\Autoruns64.exe" or FolderPath endswith "\\autorunsc.exe" or FolderPath endswith "\\autorunsc64.exe" or FolderPath endswith "\\Bginfo.exe" or FolderPath endswith "\\Bginfo64.exe" or FolderPath endswith "\\Cacheset.exe" or FolderPath endswith "\\Cacheset64.exe" or FolderPath endswith "\\Clockres.exe" or FolderPath endswith "\\Clockres64.exe" or FolderPath endswith "\\Contig.exe" or FolderPath endswith "\\Contig64.exe" or FolderPath endswith "\\Coreinfo.exe" or FolderPath endswith "\\Coreinfo64.exe" or FolderPath endswith "\\CPUSTRES.EXE" or FolderPath endswith "\\CPUSTRES64.EXE" or FolderPath endswith "\\ctrl2cap.exe" or FolderPath endswith "\\Dbgview.exe" or FolderPath endswith "\\dbgview64.exe" or FolderPath endswith "\\Desktops.exe" or FolderPath endswith "\\Desktops64.exe" or FolderPath endswith "\\disk2vhd.exe" or FolderPath endswith "\\disk2vhd64.exe" or FolderPath endswith "\\diskext.exe" or FolderPath endswith "\\diskext64.exe" or FolderPath endswith "\\Diskmon.exe" or FolderPath endswith "\\Diskmon64.exe" or FolderPath endswith "\\DiskView.exe" or FolderPath endswith "\\DiskView64.exe" or FolderPath endswith "\\du.exe" or FolderPath endswith "\\du64.exe" or FolderPath endswith "\\efsdump.exe" or FolderPath endswith "\\FindLinks.exe" or FolderPath endswith "\\FindLinks64.exe" or FolderPath endswith "\\handle.exe" or FolderPath endswith "\\handle64.exe" or FolderPath endswith "\\hex2dec.exe" or FolderPath endswith "\\hex2dec64.exe" or FolderPath endswith "\\junction.exe" or FolderPath endswith "\\junction64.exe" or FolderPath endswith "\\ldmdump.exe" or FolderPath endswith "\\listdlls.exe" or FolderPath endswith "\\listdlls64.exe" or FolderPath endswith "\\livekd.exe" or FolderPath endswith "\\livekd64.exe" or FolderPath endswith "\\loadOrd.exe" or FolderPath endswith "\\loadOrd64.exe" or FolderPath endswith "\\loadOrdC.exe" or FolderPath endswith "\\loadOrdC64.exe" or FolderPath endswith "\\logonsessions.exe" or FolderPath endswith "\\logonsessions64.exe" or FolderPath endswith "\\movefile.exe" or FolderPath endswith "\\movefile64.exe" or FolderPath endswith "\\notmyfault.exe" or FolderPath endswith "\\notmyfault64.exe" or FolderPath endswith "\\notmyfaultc.exe" or FolderPath endswith "\\notmyfaultc64.exe" or FolderPath endswith "\\ntfsinfo.exe" or FolderPath endswith "\\ntfsinfo64.exe" or FolderPath endswith "\\pendmoves.exe" or FolderPath endswith "\\pendmoves64.exe" or FolderPath endswith "\\pipelist.exe" or FolderPath endswith "\\pipelist64.exe" or FolderPath endswith "\\portmon.exe" or FolderPath endswith "\\procdump.exe" or FolderPath endswith "\\procdump64.exe" or FolderPath endswith "\\procexp.exe" or FolderPath endswith "\\procexp64.exe" or FolderPath endswith "\\Procmon.exe" or FolderPath endswith "\\Procmon64.exe" or FolderPath endswith "\\psExec.exe" or FolderPath endswith "\\psExec64.exe" or FolderPath endswith "\\psfile.exe" or FolderPath endswith "\\psfile64.exe" or FolderPath endswith "\\psGetsid.exe" or FolderPath endswith "\\psGetsid64.exe" or FolderPath endswith "\\psInfo.exe" or FolderPath endswith "\\psInfo64.exe" or FolderPath endswith "\\pskill.exe" or FolderPath endswith "\\pskill64.exe" or FolderPath endswith "\\pslist.exe" or FolderPath endswith "\\pslist64.exe" or FolderPath endswith "\\psLoggedon.exe" or FolderPath endswith "\\psLoggedon64.exe" or FolderPath endswith "\\psloglist.exe" or FolderPath endswith "\\psloglist64.exe" or FolderPath endswith "\\pspasswd.exe" or FolderPath endswith "\\pspasswd64.exe" or FolderPath endswith "\\psping.exe" or FolderPath endswith "\\psping64.exe" or FolderPath endswith "\\psService.exe" or FolderPath endswith "\\psService64.exe" or FolderPath endswith "\\psshutdown.exe" or FolderPath endswith "\\psshutdown64.exe" or FolderPath endswith "\\pssuspend.exe" or FolderPath endswith "\\pssuspend64.exe" or FolderPath endswith "\\RAMMap.exe" or FolderPath endswith "\\RAMMap64.exe" or FolderPath endswith "\\RDCMan.exe" or FolderPath endswith "\\RegDelNull.exe" or FolderPath endswith "\\RegDelNull64.exe" or FolderPath endswith "\\regjump.exe" or FolderPath endswith "\\ru.exe" or FolderPath endswith "\\ru64.exe" or FolderPath endswith "\\sdelete.exe" or FolderPath endswith "\\sdelete64.exe" or FolderPath endswith "\\ShareEnum.exe" or FolderPath endswith "\\ShareEnum64.exe" or FolderPath endswith "\\shellRunas.exe" or FolderPath endswith "\\sigcheck.exe" or FolderPath endswith "\\sigcheck64.exe" or FolderPath endswith "\\streams.exe" or FolderPath endswith "\\streams64.exe" or FolderPath endswith "\\strings.exe" or FolderPath endswith "\\strings64.exe" or FolderPath endswith "\\sync.exe" or FolderPath endswith "\\sync64.exe" or FolderPath endswith "\\Sysmon.exe" or FolderPath endswith "\\Sysmon64.exe" or FolderPath endswith "\\tcpvcon.exe" or FolderPath endswith "\\tcpvcon64.exe" or FolderPath endswith "\\tcpview.exe" or FolderPath endswith "\\tcpview64.exe" or FolderPath endswith "\\Testlimit.exe" or FolderPath endswith "\\Testlimit64.exe" or FolderPath endswith "\\vmmap.exe" or FolderPath endswith "\\vmmap64.exe" or FolderPath endswith "\\Volumeid.exe" or FolderPath endswith "\\Volumeid64.exe" or FolderPath endswith "\\whois.exe" or FolderPath endswith "\\whois64.exe" or FolderPath endswith "\\Winobj.exe" or FolderPath endswith "\\Winobj64.exe" or FolderPath endswith "\\ZoomIt.exe" or FolderPath endswith "\\ZoomIt64.exe")) and (not(((isnull(ProcessVersionInfoCompanyName) or isnull(ProcessVersionInfoProductName)) or ((ProcessVersionInfoCompanyName in~ ("Sysinternals - www.sysinternals.com", "Sysinternals")) or ProcessVersionInfoProductName startswith "Sysinternals"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_xordump.yml
HackTool - XORDump Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\xordump.exe" or (ProcessCommandLine contains " -process lsass.exe " or ProcessCommandLine contains " -m comsvcs " or ProcessCommandLine contains " -m dbghelp " or ProcessCommandLine contains " -m dbgcore ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_rurat.yml
Renamed Remote Utilities RAT (RURAT) Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoProductName =~ "Remote Utilities" and (not((FolderPath endswith "\\rutserv.exe" or FolderPath endswith "\\rfusclient.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_susp_pattern.yml
Suspicious Command Patterns In Scheduled Task Creation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/Create " and FolderPath endswith "\\schtasks.exe") and (((ProcessCommandLine contains "/sc minute " or ProcessCommandLine contains "/ru system ") and (ProcessCommandLine contains "cmd /c" or ProcessCommandLine contains "cmd /k" or ProcessCommandLine contains "cmd /r" or ProcessCommandLine contains "cmd.exe /c " or ProcessCommandLine contains "cmd.exe /k " or ProcessCommandLine contains "cmd.exe /r ")) or (ProcessCommandLine contains " -decode " or ProcessCommandLine contains " -enc " or ProcessCommandLine contains " -w hidden " or ProcessCommandLine contains " bypass " or ProcessCommandLine contains " IEX" or ProcessCommandLine contains ".DownloadData" or ProcessCommandLine contains ".DownloadFile" or ProcessCommandLine contains ".DownloadString" or ProcessCommandLine contains "/c start /min " or ProcessCommandLine contains "FromBase64String" or ProcessCommandLine contains "mshta http" or ProcessCommandLine contains "mshta.exe http") or ((ProcessCommandLine contains ":\\ProgramData\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Tmp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\" or ProcessCommandLine contains "%AppData%" or ProcessCommandLine contains "%Temp%" or ProcessCommandLine contains "%tmp%") and (ProcessCommandLine contains "cscript" or ProcessCommandLine contains "curl" or ProcessCommandLine contains "wscript")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml
Script Interpreter Execution From Suspicious Folder ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -ep bypass " or ProcessCommandLine contains " -ExecutionPolicy bypass " or ProcessCommandLine contains " -w hidden " or ProcessCommandLine contains "/e:javascript " or ProcessCommandLine contains "/e:Jscript " or ProcessCommandLine contains "/e:vbscript ") or (FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\wscript.exe") or (ProcessVersionInfoOriginalFileName in~ ("cscript.exe", "mshta.exe", "wscript.exe"))) and ((ProcessCommandLine contains ":\\Perflogs\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp" or ProcessCommandLine contains "\\AppData\\Roaming\\Temp" or ProcessCommandLine contains "\\Temporary Internet" or ProcessCommandLine contains "\\Windows\\Temp") or ((ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favorites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favourites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Contacts\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_cli.yml
Use Short Name Path in Command Line ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "~1\\" or ProcessCommandLine contains "~2\\") and (not(((InitiatingProcessFolderPath in~ ("C:\\Windows\\System32\\Dism.exe", "C:\\Windows\\System32\\cleanmgr.exe", "C:\\Program Files\\GPSoftware\\Directory Opus\\dopus.exe")) or (InitiatingProcessFolderPath endswith "\\WebEx\\WebexHost.exe" or InitiatingProcessFolderPath endswith "\\thor\\thor64.exe" or InitiatingProcessFolderPath endswith "\\veam.backup.shell.exe" or InitiatingProcessFolderPath endswith "\\winget.exe" or InitiatingProcessFolderPath endswith "\\Everything\\Everything.exe") or InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\WinGet\\" or (ProcessCommandLine contains "\\appdata\\local\\webex\\webex64\\meetings\\wbxreport.exe" or ProcessCommandLine contains "C:\\Program Files\\Git\\post-install.bat" or ProcessCommandLine contains "C:\\Program Files\\Git\\cmd\\scalar.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mpcmdrun_download_arbitrary_file.yml
File Download Via Windows Defender MpCmpRun.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "DownloadFile" and ProcessCommandLine contains "url") and (ProcessVersionInfoOriginalFileName =~ "MpCmdRun.exe" or FolderPath endswith "\\MpCmdRun.exe" or ProcessCommandLine contains "MpCmdRun.exe" or ProcessVersionInfoFileDescription =~ "Microsoft Malware Protection Command Line Utility")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_progname.yml
Suspicious Program Names ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "inject.ps1" or ProcessCommandLine contains "Invoke-CVE" or ProcessCommandLine contains "pupy.ps1" or ProcessCommandLine contains "payload.ps1" or ProcessCommandLine contains "beacon.ps1" or ProcessCommandLine contains "PowerView.ps1" or ProcessCommandLine contains "bypass.ps1" or ProcessCommandLine contains "obfuscated.ps1" or ProcessCommandLine contains "obfusc.ps1" or ProcessCommandLine contains "obfus.ps1" or ProcessCommandLine contains "obfs.ps1" or ProcessCommandLine contains "evil.ps1" or ProcessCommandLine contains "MiniDogz.ps1" or ProcessCommandLine contains "_enc.ps1" or ProcessCommandLine contains "\\shell.ps1" or ProcessCommandLine contains "\\rshell.ps1" or ProcessCommandLine contains "revshell.ps1" or ProcessCommandLine contains "\\av.ps1" or ProcessCommandLine contains "\\av_test.ps1" or ProcessCommandLine contains "adrecon.ps1" or ProcessCommandLine contains "mimikatz.ps1" or ProcessCommandLine contains "\\PowerUp_" or ProcessCommandLine contains "powerup.ps1" or ProcessCommandLine contains "\\Temp\\a.ps1" or ProcessCommandLine contains "\\Temp\\p.ps1" or ProcessCommandLine contains "\\Temp\\1.ps1" or ProcessCommandLine contains "Hound.ps1" or ProcessCommandLine contains "encode.ps1" or ProcessCommandLine contains "powercat.ps1") or ((FolderPath contains "\\CVE-202" or FolderPath contains "\\CVE202") or (FolderPath endswith "\\poc.exe" or FolderPath endswith "\\artifact.exe" or FolderPath endswith "\\artifact64.exe" or FolderPath endswith "\\artifact_protected.exe" or FolderPath endswith "\\artifact32.exe" or FolderPath endswith "\\artifact32big.exe" or FolderPath endswith "obfuscated.exe" or FolderPath endswith "obfusc.exe" or FolderPath endswith "\\meterpreter"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regedit_export_keys.yml
Exports Registry Key To a File ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -E " or ProcessCommandLine contains " /E " or ProcessCommandLine contains " E " or ProcessCommandLine contains " E " or ProcessCommandLine contains " E ") and (FolderPath endswith "\\regedit.exe" or ProcessVersionInfoOriginalFileName =~ "REGEDIT.EXE")) and (not(((ProcessCommandLine contains "hklm" or ProcessCommandLine contains "hkey_local_machine") and (ProcessCommandLine endswith "\\system" or ProcessCommandLine endswith "\\sam" or ProcessCommandLine endswith "\\security"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_rundll32_dllregisterserver.yml
Potential Renamed Rundll32 Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "DllRegisterServer" and (not(FolderPath endswith "\\rundll32.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_alternate_data_streams.yml
Execute From Alternate Data Streams ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "txt:" and ((ProcessCommandLine contains "esentutl " and ProcessCommandLine contains " /y " and ProcessCommandLine contains " /d " and ProcessCommandLine contains " /o ") or (ProcessCommandLine contains "makecab " and ProcessCommandLine contains ".cab") or (ProcessCommandLine contains "reg " and ProcessCommandLine contains " export ") or (ProcessCommandLine contains "regedit " and ProcessCommandLine contains " /E ") or (ProcessCommandLine contains "type " and ProcessCommandLine contains " > "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_cl_loadassembly.yml
Assembly Loading Via CL_LoadAssembly.ps1 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "LoadAssemblyFromPath " or ProcessCommandLine contains "LoadAssemblyFromNS "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_impersonate.yml
HackTool - Impersonate Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "impersonate.exe" and (ProcessCommandLine contains " list " or ProcessCommandLine contains " exec " or ProcessCommandLine contains " adduser ")) or (MD5 startswith "9520714AB576B0ED01D1513691377D01" or SHA256 startswith "E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmdkey_adding_generic_creds.yml
New Generic Credentials Added Via Cmdkey.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -g" or ProcessCommandLine contains " /g" or ProcessCommandLine contains " g" or ProcessCommandLine contains " g" or ProcessCommandLine contains " g") and (ProcessCommandLine contains " -p" or ProcessCommandLine contains " /p" or ProcessCommandLine contains " p" or ProcessCommandLine contains " p" or ProcessCommandLine contains " p") and (ProcessCommandLine contains " -u" or ProcessCommandLine contains " /u" or ProcessCommandLine contains " u" or ProcessCommandLine contains " u" or ProcessCommandLine contains " u") and (FolderPath endswith "\\cmdkey.exe" or ProcessVersionInfoOriginalFileName =~ "cmdkey.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_sdelete.yml
Renamed Sysinternals Sdelete Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "sdelete.exe" and (not((FolderPath endswith "\\sdelete.exe" or FolderPath endswith "\\sdelete64.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wermgr_susp_exec_location.yml
Suspicious Execution Location Of Wermgr.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\wermgr.exe" and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sdbinst_susp_extension.yml
Uncommon Extension Shim Database Installation Via Sdbinst.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\sdbinst.exe" or ProcessVersionInfoOriginalFileName =~ "sdbinst.exe") and (not((ProcessCommandLine =~ "" or ProcessCommandLine contains ".sdb" or ((ProcessCommandLine endswith " -c" or ProcessCommandLine endswith " -f" or ProcessCommandLine endswith " -mm" or ProcessCommandLine endswith " -t") or ProcessCommandLine contains " -m -bg") or isnull(ProcessCommandLine))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nircmd.yml
PUA - NirCmd Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " execmd " or ProcessCommandLine contains ".exe script " or ProcessCommandLine contains ".exe shexec " or ProcessCommandLine contains " runinteractive ") or (FolderPath endswith "\\NirCmd.exe" or ProcessVersionInfoOriginalFileName =~ "NirCmd.exe")) or ((ProcessCommandLine contains " exec " or ProcessCommandLine contains " exec2 ") and (ProcessCommandLine contains " show " or ProcessCommandLine contains " hide "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_web_install.yml
MsiExec Web Install ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " msiexec" and ProcessCommandLine contains "://"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pktmon_execution.yml
PktMon.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\pktmon.exe" or ProcessVersionInfoOriginalFileName =~ "PktMon.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_hidden_dir_index_allocation.yml
Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "::$index_allocation"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_openwith.yml
OpenWith.exe Executes Specified Binary ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/c" and FolderPath endswith "\\OpenWith.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_disable.yml
Disable Important Scheduled Task ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\Windows\\BitLocker" or ProcessCommandLine contains "\\Windows\\ExploitGuard" or ProcessCommandLine contains "\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh" or ProcessCommandLine contains "\\Windows\\SystemRestore\\SR" or ProcessCommandLine contains "\\Windows\\UpdateOrchestrator\\" or ProcessCommandLine contains "\\Windows\\Windows Defender\\" or ProcessCommandLine contains "\\Windows\\WindowsBackup\\" or ProcessCommandLine contains "\\Windows\\WindowsUpdate\\") and (ProcessCommandLine contains "/Change" and ProcessCommandLine contains "/TN" and ProcessCommandLine contains "/disable") and FolderPath endswith "\\schtasks.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_kavremover_uncommon_execution.yml
Kavremover Dropped Binary LOLBIN Usage ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " run run-cmd " and (not((InitiatingProcessFolderPath endswith "\\cleanapi.exe" or InitiatingProcessFolderPath endswith "\\kavremover.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_download_direct_ip_susp_extensions.yml
Suspicious File Download From IP Via Curl.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".bat" or ProcessCommandLine endswith ".bat\"" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".dat\"" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".dll\"" or ProcessCommandLine endswith ".exe" or ProcessCommandLine endswith ".exe\"" or ProcessCommandLine endswith ".gif" or ProcessCommandLine endswith ".gif\"" or ProcessCommandLine endswith ".hta" or ProcessCommandLine endswith ".hta\"" or ProcessCommandLine endswith ".jpeg" or ProcessCommandLine endswith ".jpeg\"" or ProcessCommandLine endswith ".log" or ProcessCommandLine endswith ".log\"" or ProcessCommandLine endswith ".msi" or ProcessCommandLine endswith ".msi\"" or ProcessCommandLine endswith ".png" or ProcessCommandLine endswith ".png\"" or ProcessCommandLine endswith ".ps1" or ProcessCommandLine endswith ".ps1\"" or ProcessCommandLine endswith ".psm1" or ProcessCommandLine endswith ".psm1\"" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbe\"" or ProcessCommandLine endswith ".vbs" or ProcessCommandLine endswith ".vbs\"" or ProcessCommandLine endswith ".bat'" or ProcessCommandLine endswith ".dat'" or ProcessCommandLine endswith ".dll'" or ProcessCommandLine endswith ".exe'" or ProcessCommandLine endswith ".gif'" or ProcessCommandLine endswith ".hta'" or ProcessCommandLine endswith ".jpeg'" or ProcessCommandLine endswith ".log'" or ProcessCommandLine endswith ".msi'" or ProcessCommandLine endswith ".png'" or ProcessCommandLine endswith ".ps1'" or ProcessCommandLine endswith ".psm1'" or ProcessCommandLine endswith ".vbe'" or ProcessCommandLine endswith ".vbs'") and (ProcessCommandLine contains " -O" or ProcessCommandLine contains "--remote-name" or ProcessCommandLine contains "--output") and ProcessCommandLine contains "http" and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe") and ProcessCommandLine matches regex "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_kd_execution.yml
Windows Kernel Debugger Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\kd.exe" or ProcessVersionInfoOriginalFileName =~ "kd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_java_susp_child_process.yml
Suspicious Processes Spawned by Java.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\AppVLP.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\hh.exe" or FolderPath endswith "\\mftrace.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\query.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\scrcons.exe" or FolderPath endswith "\\scriptrunner.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\java.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_atbroker_uncommon_ats_execution.yml
Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "start" and (FolderPath endswith "\\AtBroker.exe" or ProcessVersionInfoOriginalFileName =~ "AtBroker.exe")) and (not((ProcessCommandLine contains "animations" or ProcessCommandLine contains "audiodescription" or ProcessCommandLine contains "caretbrowsing" or ProcessCommandLine contains "caretwidth" or ProcessCommandLine contains "colorfiltering" or ProcessCommandLine contains "cursorindicator" or ProcessCommandLine contains "cursorscheme" or ProcessCommandLine contains "filterkeys" or ProcessCommandLine contains "focusborderheight" or ProcessCommandLine contains "focusborderwidth" or ProcessCommandLine contains "highcontrast" or ProcessCommandLine contains "keyboardcues" or ProcessCommandLine contains "keyboardpref" or ProcessCommandLine contains "livecaptions" or ProcessCommandLine contains "magnifierpane" or ProcessCommandLine contains "messageduration" or ProcessCommandLine contains "minimumhitradius" or ProcessCommandLine contains "mousekeys" or ProcessCommandLine contains "Narrator" or ProcessCommandLine contains "osk" or ProcessCommandLine contains "overlappedcontent" or ProcessCommandLine contains "showsounds" or ProcessCommandLine contains "soundsentry" or ProcessCommandLine contains "speechreco" or ProcessCommandLine contains "stickykeys" or ProcessCommandLine contains "togglekeys" or ProcessCommandLine contains "voiceaccess" or ProcessCommandLine contains "windowarranging" or ProcessCommandLine contains "windowtracking" or ProcessCommandLine contains "windowtrackingtimeout" or ProcessCommandLine contains "windowtrackingzorder"))) and (not(ProcessCommandLine contains "Oracle_JavaAccessBridge"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_group.yml
Local Groups Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " group" and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_ldap_monitor.yml
HackTool - SharpLDAPmonitor Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/user:" and ProcessCommandLine contains "/pass:" and ProcessCommandLine contains "/dcip:") or (FolderPath endswith "\\SharpLDAPmonitor.exe" or ProcessVersionInfoOriginalFileName =~ "SharpLDAPmonitor.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_advancedrun.yml
PUA - AdvancedRun Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "AdvancedRun.exe" or (ProcessCommandLine contains " /EXEFilename " and ProcessCommandLine contains " /Run") or (ProcessCommandLine contains " /WindowState 0" and ProcessCommandLine contains " /RunAs " and ProcessCommandLine contains " /CommandLine ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dotnetdump_memory_dump.yml
Process Memory Dump Via Dotnet-Dump ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "collect" and (FolderPath endswith "\\dotnet-dump.exe" or ProcessVersionInfoOriginalFileName =~ "dotnet-dump.dll")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml
Suspicious Script Execution From Temp Folder ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "\\Windows\\Temp" or ProcessCommandLine contains "\\Temporary Internet" or ProcessCommandLine contains "\\AppData\\Local\\Temp" or ProcessCommandLine contains "\\AppData\\Roaming\\Temp" or ProcessCommandLine contains "%TEMP%" or ProcessCommandLine contains "%TMP%" or ProcessCommandLine contains "%LocalAppData%\\Temp") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe")) and (not((ProcessCommandLine contains " >" or ProcessCommandLine contains "Out-File" or ProcessCommandLine contains "ConvertTo-Json" or ProcessCommandLine contains "-WindowStyle hidden -Verb runAs" or ProcessCommandLine contains "\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpwsus_wsuspendu_execution.yml
HackTool - SharpWSUS/WSUSpendu Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -Inject " and (ProcessCommandLine contains " -PayloadArgs " or ProcessCommandLine contains " -PayloadFile ")) or ((ProcessCommandLine contains " approve " or ProcessCommandLine contains " create " or ProcessCommandLine contains " check " or ProcessCommandLine contains " delete ") and (ProcessCommandLine contains " /payload:" or ProcessCommandLine contains " /payload=" or ProcessCommandLine contains " /updateid:" or ProcessCommandLine contains " /updateid="))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_svchost_uncommon_parent_process.yml
Uncommon Svchost Parent Process ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\svchost.exe" and (not(((InitiatingProcessFolderPath endswith "\\Mrt.exe" or InitiatingProcessFolderPath endswith "\\MsMpEng.exe" or InitiatingProcessFolderPath endswith "\\ngen.exe" or InitiatingProcessFolderPath endswith "\\rpcnet.exe" or InitiatingProcessFolderPath endswith "\\services.exe" or InitiatingProcessFolderPath endswith "\\TiWorker.exe") or (InitiatingProcessFolderPath in~ ("-", "")) or isnull(InitiatingProcessFolderPath))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_var.yml
Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "{0}" or ProcessCommandLine contains "{1}" or ProcessCommandLine contains "{2}" or ProcessCommandLine contains "{3}" or ProcessCommandLine contains "{4}" or ProcessCommandLine contains "{5}") and (ProcessCommandLine contains "&&set" and ProcessCommandLine contains "cmd" and ProcessCommandLine contains "/c" and ProcessCommandLine contains "-f")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_webshell_chopper.yml
Chopper Webshell Process Pattern ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "&ipconfig&echo" or ProcessCommandLine contains "&quser&echo" or ProcessCommandLine contains "&whoami&echo" or ProcessCommandLine contains "&c:&echo" or ProcessCommandLine contains "&cd&echo" or ProcessCommandLine contains "&dir&echo" or ProcessCommandLine contains "&echo [E]" or ProcessCommandLine contains "&echo [S]") and (FolderPath endswith "\\w3wp.exe" or InitiatingProcessFolderPath endswith "\\w3wp.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_webshell.yml
Remote Access Tool - ScreenConnect Server Web Shell Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\csc.exe") and InitiatingProcessFolderPath endswith "\\ScreenConnect.Service.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rpcping_credential_capture.yml
Capture Credentials with Rpcping.exe ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\rpcping.exe" and (ProcessCommandLine contains "-s" or ProcessCommandLine contains "/s" or ProcessCommandLine contains "s" or ProcessCommandLine contains "s" or ProcessCommandLine contains "s") and (((ProcessCommandLine contains "-u" or ProcessCommandLine contains "/u" or ProcessCommandLine contains "u" or ProcessCommandLine contains "u" or ProcessCommandLine contains "u") and (ProcessCommandLine contains "NTLM")) or ((ProcessCommandLine contains "-t" or ProcessCommandLine contains "/t" or ProcessCommandLine contains "t" or ProcessCommandLine contains "t" or ProcessCommandLine contains "t") and (ProcessCommandLine contains "ncacn_np")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_shimcache_flush.yml
ShimCache Flush ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "rundll32" and ProcessCommandLine contains "apphelp.dll") and (ProcessCommandLine contains "ShimFlushCache" or ProcessCommandLine contains "#250")) or ((ProcessCommandLine contains "rundll32" and ProcessCommandLine contains "kernel32.dll") and (ProcessCommandLine contains "BaseFlushAppcompatCache" or ProcessCommandLine contains "#46"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load.yml
PowerShell Base64 Encoded Reflective Assembly Load ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA" or ProcessCommandLine contains "sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA" or ProcessCommandLine contains "bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA" or ProcessCommandLine contains "AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC" or ProcessCommandLine contains "BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp" or ProcessCommandLine contains "AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK" or ProcessCommandLine contains "WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ" or ProcessCommandLine contains "sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA" or ProcessCommandLine contains "bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA" or ProcessCommandLine contains "WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA" or ProcessCommandLine contains "sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA" or ProcessCommandLine contains "bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml
WmiPrvSE Spawned A Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\WmiPrvSe.exe" and (not(((LogonId in~ ("0x3e7", "null")) or isnull(LogonId) or (AccountName contains "AUTHORI" or AccountName contains "AUTORI") or FolderPath endswith "\\WerFault.exe" or FolderPath endswith "\\WmiPrvSE.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_purplesharp_indicators.yml
HackTool - PurpleSharp Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "xyz123456.exe" or ProcessCommandLine contains "PurpleSharp") or (FolderPath contains "\\purplesharp" or ProcessVersionInfoOriginalFileName =~ "PurpleSharp.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_sticky_keys_replace.yml
Persistence Via Sticky Key Backdoor ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "copy " and ProcessCommandLine contains "/y " and ProcessCommandLine contains "C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_defendercheck.yml
PUA - DefenderCheck Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\DefenderCheck.exe" or ProcessVersionInfoFileDescription =~ "DefenderCheck"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rasdial_execution.yml
Suspicious RASdial Activity ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "rasdial.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_aspnet_compiler_susp_paths.yml
Potentially Suspicious ASP.NET Compilation Via AspNetCompiler ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\Roaming\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains ":\\Windows\\System32\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Tasks\\") and (FolderPath contains "C:\\Windows\\Microsoft.NET\\Framework\\" or FolderPath contains "C:\\Windows\\Microsoft.NET\\Framework64\\") and FolderPath endswith "\\aspnet_compiler.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powercfg_execution.yml
Suspicious Powercfg Execution To Change Lock Screen Timeout ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\powercfg.exe" or ProcessVersionInfoOriginalFileName =~ "PowerCfg.exe") and ((ProcessCommandLine contains "/setacvalueindex " and ProcessCommandLine contains "SCHEME_CURRENT" and ProcessCommandLine contains "SUB_VIDEO" and ProcessCommandLine contains "VIDEOCONLOCK") or (ProcessCommandLine contains "-change " and ProcessCommandLine contains "-standby-timeout-"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dsacls_password_spray.yml
Potential Password Spraying Attempt Using Dsacls.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/user:" and ProcessCommandLine contains "/passwd:") and (FolderPath endswith "\\dsacls.exe" or ProcessVersionInfoOriginalFileName =~ "DSACLS.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_driver_install.yml
Driver/DLL Installation Via Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "INSTALLDRIVER " and ProcessCommandLine contains ".dll") and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_7zip_exfil_dmp_files.yml
7Zip Compressing Dump Files ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".dmp" or ProcessCommandLine contains ".dump" or ProcessCommandLine contains ".hdmp") and (ProcessVersionInfoFileDescription contains "7-Zip" or (FolderPath endswith "\\7z.exe" or FolderPath endswith "\\7zr.exe" or FolderPath endswith "\\7za.exe") or (ProcessVersionInfoOriginalFileName in~ ("7z.exe", "7za.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcwrun.yml
Indirect Command Execution By Program Compatibility Wizard ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\pcwrun.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_install_remote.yml
Suspicious Msiexec Quiet Install From Remote Location ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-i" or ProcessCommandLine contains "/i" or ProcessCommandLine contains "i" or ProcessCommandLine contains "i" or ProcessCommandLine contains "i" or ProcessCommandLine contains "-package" or ProcessCommandLine contains "/package" or ProcessCommandLine contains "package" or ProcessCommandLine contains "package" or ProcessCommandLine contains "package" or ProcessCommandLine contains "-a" or ProcessCommandLine contains "/a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "-j" or ProcessCommandLine contains "/j" or ProcessCommandLine contains "j" or ProcessCommandLine contains "j" or ProcessCommandLine contains "j") and (FolderPath endswith "\\msiexec.exe" or ProcessVersionInfoOriginalFileName =~ "msiexec.exe") and (ProcessCommandLine contains "-q" or ProcessCommandLine contains "/q" or ProcessCommandLine contains "q" or ProcessCommandLine contains "q" or ProcessCommandLine contains "q") and (ProcessCommandLine contains "http" or ProcessCommandLine contains "\\\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_3proxy_execution.yml
PUA - 3Proxy Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\3proxy.exe" or ProcessCommandLine contains ".exe -i127.0.0.1 -p" or ProcessVersionInfoFileDescription =~ "3proxy - tiny proxy server"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmdl32_arbitrary_file_download.yml
Potential Arbitrary File Download Via Cmdl32.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/vpn" and ProcessCommandLine contains "/lan") and (FolderPath endswith "\\cmdl32.exe" or ProcessVersionInfoOriginalFileName =~ "CMDL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gpg4win_portable_execution.yml
Portable Gpg.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\gpg.exe" or FolderPath endswith "\\gpg2.exe") or ProcessVersionInfoOriginalFileName =~ "gpg.exe" or ProcessVersionInfoFileDescription =~ "GnuPGs OpenPGP tool") and (not((FolderPath contains ":\\Program Files (x86)\\GNU\\GnuPG\\bin\\" or FolderPath contains ":\\Program Files (x86)\\GnuPG VS-Desktop\\" or FolderPath contains ":\\Program Files (x86)\\GnuPG\\bin\\" or FolderPath contains ":\\Program Files (x86)\\Gpg4win\\bin\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_powertool.yml
HackTool - PowerTool Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\PowerTool.exe" or FolderPath endswith "\\PowerTool64.exe") or ProcessVersionInfoOriginalFileName =~ "PowerTool.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dllhost_no_cli_execution.yml
Dllhost.EXE Execution Anomaly ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine in~ ("dllhost.exe", "dllhost")) and FolderPath endswith "\\dllhost.exe") and (not(isnull(ProcessCommandLine)))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_lnk.yml
Findstr Launching .lnk File ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".lnk" or ProcessCommandLine endswith ".lnk\"" or ProcessCommandLine endswith ".lnk'") and ((FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe") or (ProcessVersionInfoOriginalFileName in~ ("FIND.EXE", "FINDSTR.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_execute_psh.yml
SyncAppvPublishingServer Execute Arbitrary PowerShell Code ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\"n; " and (FolderPath endswith "\\SyncAppvPublishingServer.exe" or ProcessVersionInfoOriginalFileName =~ "syncappvpublishingserver.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_susp_child_processes.yml
Suspicious Microsoft Office Child Process ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\EQNEDT32.EXE" or InitiatingProcessFolderPath endswith "\\EXCEL.EXE" or InitiatingProcessFolderPath endswith "\\MSACCESS.EXE" or InitiatingProcessFolderPath endswith "\\MSPUB.exe" or InitiatingProcessFolderPath endswith "\\ONENOTE.EXE" or InitiatingProcessFolderPath endswith "\\POWERPNT.exe" or InitiatingProcessFolderPath endswith "\\VISIO.exe" or InitiatingProcessFolderPath endswith "\\WINWORD.EXE" or InitiatingProcessFolderPath endswith "\\wordpad.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe") and (((ProcessVersionInfoOriginalFileName in~ ("bitsadmin.exe", "CertOC.exe", "CertUtil.exe", "Cmd.Exe", "CMSTP.EXE", "cscript.exe", "curl.exe", "HH.exe", "IEExec.exe", "InstallUtil.exe", "javaw.exe", "Microsoft.Workflow.Compiler.exe", "msdt.exe", "MSHTA.EXE", "msiexec.exe", "Msxsl.exe", "odbcconf.exe", "pcalua.exe", "PowerShell.EXE", "RegAsm.exe", "RegSvcs.exe", "REGSVR32.exe", "RUNDLL32.exe", "schtasks.exe", "ScriptRunner.exe", "wmic.exe", "WorkFolders.exe", "wscript.exe")) or (FolderPath endswith "\\AppVLP.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\certoc.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cmstp.exe" or FolderPath endswith "\\control.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\hh.exe" or FolderPath endswith "\\ieexec.exe" or FolderPath endswith "\\installutil.exe" or FolderPath endswith "\\javaw.exe" or FolderPath endswith "\\mftrace.exe" or FolderPath endswith "\\Microsoft.Workflow.Compiler.exe" or FolderPath endswith "\\msbuild.exe" or FolderPath endswith "\\msdt.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msidb.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\msxsl.exe" or FolderPath endswith "\\odbcconf.exe" or FolderPath endswith "\\pcalua.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regasm.exe" or FolderPath endswith "\\regsvcs.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\scrcons.exe" or FolderPath endswith "\\scriptrunner.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\verclsid.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\workfolders.exe" or FolderPath endswith "\\wscript.exe")) or (FolderPath contains "\\AppData\\" or FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\ProgramData\\" or FolderPath contains "\\Windows\\Tasks\\" or FolderPath contains "\\Windows\\Temp\\" or FolderPath contains "\\Windows\\System32\\Tasks\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_file_download.yml
File Download with Headless Browser ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--headless" and ProcessCommandLine contains "dump-dom" and ProcessCommandLine contains "http") and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\vivaldi.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_covenant.yml
HackTool - Covenant PowerShell Launcher ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-Command" or ProcessCommandLine contains "-EncodedCommand") and (ProcessCommandLine contains "-Sta" and ProcessCommandLine contains "-Nop" and ProcessCommandLine contains "-Window" and ProcessCommandLine contains "Hidden")) or (ProcessCommandLine contains "sv o (New-Object IO.MemorySteam);sv d " or ProcessCommandLine contains "mshta file.hta" or ProcessCommandLine contains "GruntHTTP" or ProcessCommandLine contains "-EncodedCommand cwB2ACAAbwAgA")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_svchost_execution_with_no_cli_flags.yml
Suspect Svchost Activity ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "svchost.exe" and FolderPath endswith "\\svchost.exe") and (not(((InitiatingProcessFolderPath endswith "\\rpcnet.exe" or InitiatingProcessFolderPath endswith "\\rpcnetp.exe") or isnull(ProcessCommandLine))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_iox.yml
PUA- IOX Tunneling Tool Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\iox.exe" or (ProcessCommandLine contains ".exe fwd -l " or ProcessCommandLine contains ".exe fwd -r " or ProcessCommandLine contains ".exe proxy -l " or ProcessCommandLine contains ".exe proxy -r ") or (MD5 startswith "9DB2D314DD3F704A02051EF5EA210993" or SHA1 startswith "039130337E28A6623ECF9A0A3DA7D92C5964D8DD" or SHA256 startswith "C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_conhost_legacy_option.yml
Suspicious High IntegrityLevel Conhost Legacy Option ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "conhost.exe" and ProcessCommandLine contains "0xffffffff" and ProcessCommandLine contains "-ForceV1") and (ProcessIntegrityLevel in~ ("High", "S-1-16-12288"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_audio_capture.yml
Audio Capture via PowerShell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "WindowsAudioDevice-Powershell-Cmdlet" or ProcessCommandLine contains "Toggle-AudioDevice" or ProcessCommandLine contains "Get-AudioDevice " or ProcessCommandLine contains "Set-AudioDevice " or ProcessCommandLine contains "Write-AudioDevice "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cloudflared_tunnel_cleanup.yml
Cloudflared Tunnel Connections Cleanup ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-config " or ProcessCommandLine contains "-connector-id ") and (ProcessCommandLine contains " tunnel " and ProcessCommandLine contains "cleanup ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_advanced_port_scanner.yml
PUA - Advanced Port Scanner Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/portable" and ProcessCommandLine contains "/lng") or (FolderPath contains "\\advanced_port_scanner" or ProcessVersionInfoOriginalFileName contains "advanced_port_scanner" or ProcessVersionInfoFileDescription contains "Advanced Port Scanner")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lodctr_performance_counter_tampering.yml
Rebuild Performance Counter Values Via Lodctr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -r" or ProcessCommandLine contains " /r" or ProcessCommandLine contains " r" or ProcessCommandLine contains " r" or ProcessCommandLine contains " r") and (FolderPath endswith "\\lodctr.exe" and ProcessVersionInfoOriginalFileName =~ "LODCTR.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_clip.yml
Invoke-Obfuscation Via Use Clip ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "(?i)echo.*clip.*&&.*(Clipboard|i`?n`?v`?o`?k`?e`?)"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_execution.yml
Active Directory Database Snapshot Via ADExplorer ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "snapshot" and (FolderPath endswith "\\ADExplorer.exe" or ProcessVersionInfoOriginalFileName =~ "AdExp")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution.yml
Remote Access Tool - ScreenConnect Remote Command Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\TEMP\\ScreenConnect\\" and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe") and InitiatingProcessFolderPath endswith "\\ScreenConnect.ClientService.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_autoit.yml
Unexpected Error processing 'Renamed AutoIt Execution' (sigma/rules/windows/process_creation/proc_creation_win_renamed_autoit.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dsacls_abuse_permissions.yml
Potentially Over Permissive Permissions Granted Using Dsacls.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /G " and (FolderPath endswith "\\dsacls.exe" or ProcessVersionInfoOriginalFileName =~ "DSACLS.EXE") and (ProcessCommandLine contains "GR" or ProcessCommandLine contains "GE" or ProcessCommandLine contains "GW" or ProcessCommandLine contains "GA" or ProcessCommandLine contains "WP" or ProcessCommandLine contains "WD")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_wfc.yml
Use of Wfc.exe ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\wfc.exe" or ProcessVersionInfoOriginalFileName =~ "wfc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrm_execution_via_scripting_api_winrm_vbs.yml
Remote Code Execute via Winrm.vbs ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "winrm" and ProcessCommandLine contains "invoke Create wmicimv2/Win32_" and ProcessCommandLine contains "-r:http") and (FolderPath endswith "\\cscript.exe" or ProcessVersionInfoOriginalFileName =~ "cscript.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_execution.yml
Whoami Utility Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\whoami.exe" or ProcessVersionInfoOriginalFileName =~ "whoami.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_rurat_non_default_location.yml
Remote Access Tool - RURAT Execution From Unusual Location ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\rutserv.exe" or FolderPath endswith "\\rfusclient.exe") or ProcessVersionInfoProductName =~ "Remote Utilities") and (not((FolderPath startswith "C:\\Program Files\\Remote Utilities" or FolderPath startswith "C:\\Program Files (x86)\\Remote Utilities")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_rules_discovery.yml
Firewall Configuration Discovery Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "config " or ProcessCommandLine contains "state " or ProcessCommandLine contains "rule " or ProcessCommandLine contains "name=all") and (ProcessCommandLine contains "netsh " and ProcessCommandLine contains "show " and ProcessCommandLine contains "firewall ")) and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_susp_execution.yml
Sysinternals PsSuspend Suspicious Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "msmpeng.exe" and (ProcessVersionInfoOriginalFileName =~ "pssuspend.exe" or (FolderPath endswith "\\pssuspend.exe" or FolderPath endswith "\\pssuspend64.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_debugging.yml
Potential Data Stealing Via Chromium Headless Debugging ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--remote-debugging-" and ProcessCommandLine contains "--user-data-dir" and ProcessCommandLine contains "--headless"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sqlite_firefox_gecko_profile_data.yml
SQLite Firefox Profile Data DB Access ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "cookies.sqlite" or ProcessCommandLine contains "places.sqlite") and (ProcessVersionInfoProductName =~ "SQLite" or (FolderPath endswith "\\sqlite.exe" or FolderPath endswith "\\sqlite3.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_attrib_hiding_files.yml
Hiding Files with Attrib.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " +h " and (FolderPath endswith "\\attrib.exe" or ProcessVersionInfoOriginalFileName =~ "ATTRIB.EXE")) and (not(ProcessCommandLine contains "\\desktop.ini ")) and (not((ProcessCommandLine =~ "+R +H +S +A \\*.cui" and InitiatingProcessCommandLine =~ "C:\\WINDOWS\\system32\\*.bat" and InitiatingProcessFolderPath endswith "\\cmd.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mstsc_remote_connection.yml
New Remote Desktop Connection Initiated Via Mstsc.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -v:" or ProcessCommandLine contains " /v:" or ProcessCommandLine contains " v:" or ProcessCommandLine contains " v:" or ProcessCommandLine contains " v:") and (FolderPath endswith "\\mstsc.exe" or ProcessVersionInfoOriginalFileName =~ "mstsc.exe")) and (not((ProcessCommandLine contains "C:\\ProgramData\\Microsoft\\WSL\\wslg.rdp" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\lxss\\wslhost.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ultravnc_susp_execution.yml
Suspicious UltraVNC Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-autoreconnect " and ProcessCommandLine contains "-connect " and ProcessCommandLine contains "-id:"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_network_scan_loop.yml
Suspicious Scan Loop Network ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "for " or ProcessCommandLine contains "foreach ") and (ProcessCommandLine contains "nslookup" or ProcessCommandLine contains "ping")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_msdt_answer_file.yml
Execute MSDT Via Answer File ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -af " or ProcessCommandLine contains " /af ") and (ProcessCommandLine contains "\\WINDOWS\\diagnostics\\index\\PCWDiagnostic.xml" and FolderPath endswith "\\msdt.exe")) and (not(InitiatingProcessFolderPath endswith "\\pcwrun.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_impacket_tools.yml
HackTool - Impacket Tools Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "\\goldenPac" or FolderPath contains "\\karmaSMB" or FolderPath contains "\\kintercept" or FolderPath contains "\\ntlmrelayx" or FolderPath contains "\\rpcdump" or FolderPath contains "\\samrdump" or FolderPath contains "\\secretsdump" or FolderPath contains "\\smbexec" or FolderPath contains "\\smbrelayx" or FolderPath contains "\\wmiexec" or FolderPath contains "\\wmipersist") or (FolderPath endswith "\\atexec_windows.exe" or FolderPath endswith "\\dcomexec_windows.exe" or FolderPath endswith "\\dpapi_windows.exe" or FolderPath endswith "\\findDelegation_windows.exe" or FolderPath endswith "\\GetADUsers_windows.exe" or FolderPath endswith "\\GetNPUsers_windows.exe" or FolderPath endswith "\\getPac_windows.exe" or FolderPath endswith "\\getST_windows.exe" or FolderPath endswith "\\getTGT_windows.exe" or FolderPath endswith "\\GetUserSPNs_windows.exe" or FolderPath endswith "\\ifmap_windows.exe" or FolderPath endswith "\\mimikatz_windows.exe" or FolderPath endswith "\\netview_windows.exe" or FolderPath endswith "\\nmapAnswerMachine_windows.exe" or FolderPath endswith "\\opdump_windows.exe" or FolderPath endswith "\\psexec_windows.exe" or FolderPath endswith "\\rdp_check_windows.exe" or FolderPath endswith "\\sambaPipe_windows.exe" or FolderPath endswith "\\smbclient_windows.exe" or FolderPath endswith "\\smbserver_windows.exe" or FolderPath endswith "\\sniff_windows.exe" or FolderPath endswith "\\sniffer_windows.exe" or FolderPath endswith "\\split_windows.exe" or FolderPath endswith "\\ticketer_windows.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_plink_port_forwarding.yml
Suspicious Plink Port Forwarding ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -R " and ProcessVersionInfoFileDescription =~ "Command-line SSH, Telnet, and Rlogin client"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ftp_arbitrary_command_execution.yml
Potential Arbitrary Command Execution Via FTP.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\ftp.exe" or ((ProcessCommandLine contains "-s:" or ProcessCommandLine contains "/s:" or ProcessCommandLine contains "s:" or ProcessCommandLine contains "s:" or ProcessCommandLine contains "s:") and (FolderPath endswith "\\ftp.exe" or ProcessVersionInfoOriginalFileName =~ "ftp.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_forfiles_proxy_execution_.yml
Forfiles Command Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c " or ProcessCommandLine contains " /c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c ") and (FolderPath endswith "\\forfiles.exe" or ProcessVersionInfoOriginalFileName =~ "forfiles.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_jwt_token_search.yml
Potentially Suspicious JWT Token Search Via CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "eyJ0eXAiOi" or ProcessCommandLine contains "eyJhbGciOi" or ProcessCommandLine contains " eyJ0eX" or ProcessCommandLine contains " \"eyJ0eX\"" or ProcessCommandLine contains " 'eyJ0eX'" or ProcessCommandLine contains " eyJhbG" or ProcessCommandLine contains " \"eyJhbG\"" or ProcessCommandLine contains " 'eyJhbG'"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml
UAC Bypass Using Disk Cleanup ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith "\"\\system32\\cleanmgr.exe /autoclean /d C:" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessCommandLine =~ "C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_desktop_background_change.yml
Potentially Suspicious Desktop Background Change Using Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "add" and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")) and (ProcessCommandLine contains "Control Panel\\Desktop" or ProcessCommandLine contains "CurrentVersion\\Policies\\ActiveDesktop" or ProcessCommandLine contains "CurrentVersion\\Policies\\System") and ((ProcessCommandLine contains "/v NoChangingWallpaper" and ProcessCommandLine contains "/d 1") or (ProcessCommandLine contains "/v Wallpaper" and ProcessCommandLine contains "/t REG_SZ") or (ProcessCommandLine contains "/v WallpaperStyle" and ProcessCommandLine contains "/d 2"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_parent_explorer.yml
Rundll32 Spawned Via Explorer.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE") and InitiatingProcessFolderPath endswith "\\explorer.exe") and (not((ProcessCommandLine contains " C:\\Windows\\System32\\" or ProcessCommandLine endswith " -localserver 22d8c27b-47a1-48d1-ad08-7da7abd79617")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_lsa_disable_restricted_admin.yml
RestrictedAdminMode Registry Value Tampering - ProcCreation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\System\\CurrentControlSet\\Control\\Lsa\\" and ProcessCommandLine contains "DisableRestrictedAdmin"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_query_session_exfil.yml
Query Usage To Exfil Data ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "session >" or ProcessCommandLine contains "process >") and FolderPath endswith ":\\Windows\\System32\\query.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_new_kernel_driver.yml
New Kernel Driver Via SC.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "create" or ProcessCommandLine contains "config") and (ProcessCommandLine contains "binPath" and ProcessCommandLine contains "type" and ProcessCommandLine contains "kernel") and FolderPath endswith "\\sc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_download_susp_file_sharing_domains.yml
Suspicious File Download From File Sharing Domain Via Curl.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".ps1" or ProcessCommandLine endswith ".ps1'" or ProcessCommandLine endswith ".ps1\"" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".dat'" or ProcessCommandLine endswith ".dat\"" or ProcessCommandLine endswith ".msi" or ProcessCommandLine endswith ".msi'" or ProcessCommandLine endswith ".msi\"" or ProcessCommandLine endswith ".bat" or ProcessCommandLine endswith ".bat'" or ProcessCommandLine endswith ".bat\"" or ProcessCommandLine endswith ".exe" or ProcessCommandLine endswith ".exe'" or ProcessCommandLine endswith ".exe\"" or ProcessCommandLine endswith ".vbs" or ProcessCommandLine endswith ".vbs'" or ProcessCommandLine endswith ".vbs\"" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbe'" or ProcessCommandLine endswith ".vbe\"" or ProcessCommandLine endswith ".hta" or ProcessCommandLine endswith ".hta'" or ProcessCommandLine endswith ".hta\"" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".dll'" or ProcessCommandLine endswith ".dll\"" or ProcessCommandLine endswith ".psm1" or ProcessCommandLine endswith ".psm1'" or ProcessCommandLine endswith ".psm1\"") and (ProcessCommandLine contains " -O" or ProcessCommandLine contains "--remote-name" or ProcessCommandLine contains "--output") and ProcessCommandLine contains "http" and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe") and (ProcessCommandLine contains ".githubusercontent.com" or ProcessCommandLine contains "anonfiles.com" or ProcessCommandLine contains "cdn.discordapp.com" or ProcessCommandLine contains "ddns.net" or ProcessCommandLine contains "dl.dropboxusercontent.com" or ProcessCommandLine contains "ghostbin.co" or ProcessCommandLine contains "glitch.me" or ProcessCommandLine contains "gofile.io" or ProcessCommandLine contains "hastebin.com" or ProcessCommandLine contains "mediafire.com" or ProcessCommandLine contains "mega.nz" or ProcessCommandLine contains "onrender.com" or ProcessCommandLine contains "pages.dev" or ProcessCommandLine contains "paste.ee" or ProcessCommandLine contains "pastebin.com" or ProcessCommandLine contains "pastebin.pl" or ProcessCommandLine contains "pastetext.net" or ProcessCommandLine contains "pixeldrain.com" or ProcessCommandLine contains "privatlab.com" or ProcessCommandLine contains "privatlab.net" or ProcessCommandLine contains "send.exploit.in" or ProcessCommandLine contains "sendspace.com" or ProcessCommandLine contains "storage.googleapis.com" or ProcessCommandLine contains "storjshare.io" or ProcessCommandLine contains "supabase.co" or ProcessCommandLine contains "temp.sh" or ProcessCommandLine contains "transfer.sh" or ProcessCommandLine contains "trycloudflare.com" or ProcessCommandLine contains "ufile.io" or ProcessCommandLine contains "w3spaces.com" or ProcessCommandLine contains "workers.dev")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_set_acl.yml
PowerShell Script Change Permission Via Set-Acl ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Set-Acl " and ProcessCommandLine contains "-AclObject " and ProcessCommandLine contains "-Path ") and ((ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")) or (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_dsinternals_cmdlets.yml
DSInternals Suspicious PowerShell Cmdlets ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Add-ADDBSidHistory" or ProcessCommandLine contains "Add-ADNgcKey" or ProcessCommandLine contains "Add-ADReplNgcKey" or ProcessCommandLine contains "ConvertFrom-ADManagedPasswordBlob" or ProcessCommandLine contains "ConvertFrom-GPPrefPassword" or ProcessCommandLine contains "ConvertFrom-ManagedPasswordBlob" or ProcessCommandLine contains "ConvertFrom-UnattendXmlPassword" or ProcessCommandLine contains "ConvertFrom-UnicodePassword" or ProcessCommandLine contains "ConvertTo-AADHash" or ProcessCommandLine contains "ConvertTo-GPPrefPassword" or ProcessCommandLine contains "ConvertTo-KerberosKey" or ProcessCommandLine contains "ConvertTo-LMHash" or ProcessCommandLine contains "ConvertTo-MsoPasswordHash" or ProcessCommandLine contains "ConvertTo-NTHash" or ProcessCommandLine contains "ConvertTo-OrgIdHash" or ProcessCommandLine contains "ConvertTo-UnicodePassword" or ProcessCommandLine contains "Disable-ADDBAccount" or ProcessCommandLine contains "Enable-ADDBAccount" or ProcessCommandLine contains "Get-ADDBAccount" or ProcessCommandLine contains "Get-ADDBBackupKey" or ProcessCommandLine contains "Get-ADDBDomainController" or ProcessCommandLine contains "Get-ADDBGroupManagedServiceAccount" or ProcessCommandLine contains "Get-ADDBKdsRootKey" or ProcessCommandLine contains "Get-ADDBSchemaAttribute" or ProcessCommandLine contains "Get-ADDBServiceAccount" or ProcessCommandLine contains "Get-ADDefaultPasswordPolicy" or ProcessCommandLine contains "Get-ADKeyCredential" or ProcessCommandLine contains "Get-ADPasswordPolicy" or ProcessCommandLine contains "Get-ADReplAccount" or ProcessCommandLine contains "Get-ADReplBackupKey" or ProcessCommandLine contains "Get-ADReplicationAccount" or ProcessCommandLine contains "Get-ADSIAccount" or ProcessCommandLine contains "Get-AzureADUserEx" or ProcessCommandLine contains "Get-BootKey" or ProcessCommandLine contains "Get-KeyCredential" or ProcessCommandLine contains "Get-LsaBackupKey" or ProcessCommandLine contains "Get-LsaPolicy" or ProcessCommandLine contains "Get-SamPasswordPolicy" or ProcessCommandLine contains "Get-SysKey" or ProcessCommandLine contains "Get-SystemKey" or ProcessCommandLine contains "New-ADDBRestoreFromMediaScript" or ProcessCommandLine contains "New-ADKeyCredential" or ProcessCommandLine contains "New-ADNgcKey" or ProcessCommandLine contains "New-NTHashSet" or ProcessCommandLine contains "Remove-ADDBObject" or ProcessCommandLine contains "Save-DPAPIBlob" or ProcessCommandLine contains "Set-ADAccountPasswordHash" or ProcessCommandLine contains "Set-ADDBAccountPassword" or ProcessCommandLine contains "Set-ADDBBootKey" or ProcessCommandLine contains "Set-ADDBDomainController" or ProcessCommandLine contains "Set-ADDBPrimaryGroup" or ProcessCommandLine contains "Set-ADDBSysKey" or ProcessCommandLine contains "Set-AzureADUserEx" or ProcessCommandLine contains "Set-LsaPolicy" or ProcessCommandLine contains "Set-SamAccountPasswordHash" or ProcessCommandLine contains "Set-WinUserPasswordHash" or ProcessCommandLine contains "Test-ADDBPasswordQuality" or ProcessCommandLine contains "Test-ADPasswordQuality" or ProcessCommandLine contains "Test-ADReplPasswordQuality" or ProcessCommandLine contains "Test-PasswordQuality" or ProcessCommandLine contains "Unlock-ADDBAccount" or ProcessCommandLine contains "Write-ADNgcKey" or ProcessCommandLine contains "Write-ADReplNgcKey"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gpg4win_decryption.yml
File Decryption Using Gpg4win ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -d " and ProcessCommandLine contains "passphrase") and ((FolderPath endswith "\\gpg.exe" or FolderPath endswith "\\gpg2.exe") or ProcessVersionInfoFileDescription =~ "GnuPGs OpenPGP tool")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_gather_network_info.yml
Potential Reconnaissance Activity Via GatherNetworkInfo.VBS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "gatherNetworkInfo.vbs" and ((FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\wscript.exe") or (ProcessVersionInfoOriginalFileName in~ ("cscript.exe", "wscript.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_chisel.yml
PUA - Chisel Tunneling Tool Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\chisel.exe" or ((ProcessCommandLine contains "exe client " or ProcessCommandLine contains "exe server ") and (ProcessCommandLine contains "-socks5" or ProcessCommandLine contains "-reverse" or ProcessCommandLine contains " r:" or ProcessCommandLine contains ":127.0.0.1:" or ProcessCommandLine contains "-tls-skip-verify " or ProcessCommandLine contains ":socks"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_chcp_codepage_switch.yml
Suspicious CodePage Switch Via CHCP ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith " 936" or ProcessCommandLine endswith " 1258") and FolderPath endswith "\\chcp.com"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_addinutil_suspicious_cmdline.yml
Sigma Transformation Error for 'Suspicious AddinUtil.EXE CommandLine Execution': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_inveigh.yml
HackTool - Inveigh Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\Inveigh.exe" or (ProcessVersionInfoOriginalFileName in~ ("\\Inveigh.exe", "\\Inveigh.dll")) or ProcessVersionInfoFileDescription =~ "Inveigh" or (ProcessCommandLine contains " -SpooferIP" or ProcessCommandLine contains " -ReplyToIPs " or ProcessCommandLine contains " -ReplyToDomains " or ProcessCommandLine contains " -ReplyToMACs " or ProcessCommandLine contains " -SnifferIP")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_pingcastle.yml
Renamed PingCastle Binary Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessVersionInfoOriginalFileName in~ ("PingCastleReporting.exe", "PingCastleCloud.exe", "PingCastle.exe")) or (ProcessCommandLine contains "--scanner aclcheck" or ProcessCommandLine contains "--scanner antivirus" or ProcessCommandLine contains "--scanner computerversion" or ProcessCommandLine contains "--scanner foreignusers" or ProcessCommandLine contains "--scanner laps_bitlocker" or ProcessCommandLine contains "--scanner localadmin" or ProcessCommandLine contains "--scanner nullsession" or ProcessCommandLine contains "--scanner nullsession-trust" or ProcessCommandLine contains "--scanner oxidbindings" or ProcessCommandLine contains "--scanner remote" or ProcessCommandLine contains "--scanner share" or ProcessCommandLine contains "--scanner smb" or ProcessCommandLine contains "--scanner smb3querynetwork" or ProcessCommandLine contains "--scanner spooler" or ProcessCommandLine contains "--scanner startup" or ProcessCommandLine contains "--scanner zerologon") or ProcessCommandLine contains "--no-enum-limit" or (ProcessCommandLine contains "--healthcheck" and ProcessCommandLine contains "--level Full") or (ProcessCommandLine contains "--healthcheck" and ProcessCommandLine contains "--server ")) and (not((FolderPath endswith "\\PingCastleReporting.exe" or FolderPath endswith "\\PingCastleCloud.exe" or FolderPath endswith "\\PingCastle.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_shadowcopy_access.yml
Copy From VolumeShadowCopy Via Cmd.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "copy " and ProcessCommandLine contains "\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_mshtml_runhtmlapplication.yml
Mshtml.DLL RunHTMLApplication Suspicious Usage ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "#135" or ProcessCommandLine contains "RunHTMLApplication") and (ProcessCommandLine contains "\\..\\" and ProcessCommandLine contains "mshtml")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp.yml
Bypass UAC via CMSTP ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/s" or ProcessCommandLine contains "-s" or ProcessCommandLine contains "/au" or ProcessCommandLine contains "-au" or ProcessCommandLine contains "/ni" or ProcessCommandLine contains "-ni") and (FolderPath endswith "\\cmstp.exe" or ProcessVersionInfoOriginalFileName =~ "CMSTP.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msxsl_remote_execution.yml
Remote XSL Execution Via Msxsl.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "http" and FolderPath endswith "\\msxsl.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_java_susp_child_process_2.yml
Shell Process Spawned by Java.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\bash.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") and InitiatingProcessFolderPath endswith "\\java.exe") and (not((ProcessCommandLine contains "build" and InitiatingProcessFolderPath contains "build")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_boinc.yml
Renamed BOINC Client Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "BOINC.exe" and (not(FolderPath endswith "\\BOINC.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_obfuscated_iex_commandline.yml
Invoke-Obfuscation Obfuscated IEX Invocation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[" or ProcessCommandLine matches regex "\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[" or ProcessCommandLine matches regex "\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[" or ProcessCommandLine matches regex "\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}" or ProcessCommandLine matches regex "\\*mdr\\*\\W\\s*\\)\\.Name" or ProcessCommandLine matches regex "\\$VerbosePreference\\.ToString\\(" or ProcessCommandLine matches regex "\\[String\\]\\s*\\$VerbosePreference"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_gather_network_info_execution.yml
Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "gatherNetworkInfo.vbs" and (not((FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\wscript.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_control_panel_item.yml
Control Panel Items ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "add" and ProcessCommandLine contains "CurrentVersion\\Control Panel\\CPLs") and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")) or (ProcessCommandLine endswith ".cpl" and (not(((ProcessCommandLine contains "regsvr32 " and ProcessCommandLine contains " /s " and ProcessCommandLine contains "igfxCPL.cpl") or (ProcessCommandLine contains "\\System32\\" or ProcessCommandLine contains "%System%" or ProcessCommandLine contains "|C:\\Windows\\system32|")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_trufflesnout.yml
HackTool - TruffleSnout Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "TruffleSnout.exe" or FolderPath endswith "\\TruffleSnout.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_elevated_system_shell_uncommon_parent.yml
Sigma Transformation Error for 'Elevated System Shell Spawned From Uncommon Parent Location': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cdb_arbitrary_command_execution.yml
Potential Binary Proxy Execution Via Cdb.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c " or ProcessCommandLine contains " -cf ") and (FolderPath endswith "\\cdb.exe" or ProcessVersionInfoOriginalFileName =~ "CDB.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tar_extraction.yml
Compressed File Extraction Via Tar.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-x" and (FolderPath endswith "\\tar.exe" or ProcessVersionInfoOriginalFileName =~ "bsdtar")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dll_sideload_vmware_xfer.yml
DLL Sideloading by VMware Xfer Utility ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\VMwareXferlogs.exe" and (not(FolderPath startswith "C:\\Program Files\\VMware\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mode_codepage_russian.yml
CodePage Modification Via MODE.COM To Russian Language ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " con " and ProcessCommandLine contains " cp " and ProcessCommandLine contains " select=") and (ProcessCommandLine endswith "=1251" or ProcessCommandLine endswith "=866")) and (FolderPath endswith "\\mode.com" or ProcessVersionInfoOriginalFileName =~ "MODE.COM")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hwp_exploits.yml
Suspicious HWP Sub Processes ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\gbb.exe" and InitiatingProcessFolderPath endswith "\\Hwp.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_hidden_flag.yml
Malicious Base64 Encoded PowerShell Keywords in Command Lines ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA" or ProcessCommandLine contains "aXRzYWRtaW4gL3RyYW5zZmVy" or ProcessCommandLine contains "IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA" or ProcessCommandLine contains "JpdHNhZG1pbiAvdHJhbnNmZX" or ProcessCommandLine contains "YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg" or ProcessCommandLine contains "Yml0c2FkbWluIC90cmFuc2Zlc" or ProcessCommandLine contains "AGMAaAB1AG4AawBfAHMAaQB6AGUA" or ProcessCommandLine contains "JABjAGgAdQBuAGsAXwBzAGkAegBlA" or ProcessCommandLine contains "JGNodW5rX3Npem" or ProcessCommandLine contains "QAYwBoAHUAbgBrAF8AcwBpAHoAZQ" or ProcessCommandLine contains "RjaHVua19zaXpl" or ProcessCommandLine contains "Y2h1bmtfc2l6Z" or ProcessCommandLine contains "AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A" or ProcessCommandLine contains "kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg" or ProcessCommandLine contains "lPLkNvbXByZXNzaW9u" or ProcessCommandLine contains "SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA" or ProcessCommandLine contains "SU8uQ29tcHJlc3Npb2" or ProcessCommandLine contains "Ty5Db21wcmVzc2lvb" or ProcessCommandLine contains "AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ" or ProcessCommandLine contains "kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA" or ProcessCommandLine contains "lPLk1lbW9yeVN0cmVhb" or ProcessCommandLine contains "SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A" or ProcessCommandLine contains "SU8uTWVtb3J5U3RyZWFt" or ProcessCommandLine contains "Ty5NZW1vcnlTdHJlYW" or ProcessCommandLine contains "4ARwBlAHQAQwBoAHUAbgBrA" or ProcessCommandLine contains "5HZXRDaHVua" or ProcessCommandLine contains "AEcAZQB0AEMAaAB1AG4Aaw" or ProcessCommandLine contains "LgBHAGUAdABDAGgAdQBuAGsA" or ProcessCommandLine contains "LkdldENodW5r" or ProcessCommandLine contains "R2V0Q2h1bm" or ProcessCommandLine contains "AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A" or ProcessCommandLine contains "QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA" or ProcessCommandLine contains "RIUkVBRF9JTkZPNj" or ProcessCommandLine contains "SFJFQURfSU5GTzY0" or ProcessCommandLine contains "VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA" or ProcessCommandLine contains "VEhSRUFEX0lORk82N" or ProcessCommandLine contains "AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA" or ProcessCommandLine contains "cmVhdGVSZW1vdGVUaHJlYW" or ProcessCommandLine contains "MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA" or ProcessCommandLine contains "NyZWF0ZVJlbW90ZVRocmVhZ" or ProcessCommandLine contains "Q3JlYXRlUmVtb3RlVGhyZWFk" or ProcessCommandLine contains "QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA" or ProcessCommandLine contains "0AZQBtAG0AbwB2AGUA" or ProcessCommandLine contains "1lbW1vdm" or ProcessCommandLine contains "AGUAbQBtAG8AdgBlA" or ProcessCommandLine contains "bQBlAG0AbQBvAHYAZQ" or ProcessCommandLine contains "bWVtbW92Z" or ProcessCommandLine contains "ZW1tb3Zl") and ProcessCommandLine contains " hidden " and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_new_network_provider.yml
Potential Credential Dumping Attempt Using New NetworkProvider - CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\System\\CurrentControlSet\\Services\\" and ProcessCommandLine contains "\\NetworkProvider"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_at_interactive_execution.yml
Interactive AT Job ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "interactive" and FolderPath endswith "\\at.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certmgr_certificate_installation.yml
New Root Certificate Installed Via CertMgr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/add" and ProcessCommandLine contains "root") and (FolderPath endswith "\\CertMgr.exe" or ProcessVersionInfoOriginalFileName =~ "CERTMGT.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_folder_combos.yml
Schtasks From Suspicious Folders ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "C:\\ProgramData\\" or ProcessCommandLine contains "%ProgramData%") and (ProcessCommandLine contains "powershell" or ProcessCommandLine contains "pwsh" or ProcessCommandLine contains "cmd /c " or ProcessCommandLine contains "cmd /k " or ProcessCommandLine contains "cmd /r " or ProcessCommandLine contains "cmd.exe /c " or ProcessCommandLine contains "cmd.exe /k " or ProcessCommandLine contains "cmd.exe /r ") and ProcessCommandLine contains " /create " and (FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_pchunter.yml
HackTool - PCHunter Execution ---> KQL Query:
DeviceProcessEvents
| where ((SHA1 startswith "5F1CBC3D99558307BC1250D084FA968521482025" or SHA1 startswith "3FB89787CB97D902780DA080545584D97FB1C2EB") or (MD5 startswith "987B65CD9B9F4E9A1AFD8F8B48CF64A7" or MD5 startswith "228DD0C2E6287547E26FFBD973A40F14") or (SHA256 startswith "2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32" or SHA256 startswith "55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C")) or (FolderPath endswith "\\PCHunter64.exe" or FolderPath endswith "\\PCHunter32.exe") or (ProcessVersionInfoOriginalFileName =~ "PCHunter.exe" or ProcessVersionInfoFileDescription =~ "Epoolsoft Windows Information View Tools")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_lazagne.yml
HackTool - LaZagne Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\lazagne.exe" or ((ProcessCommandLine endswith ".exe all" or ProcessCommandLine endswith ".exe browsers" or ProcessCommandLine endswith ".exe chats" or ProcessCommandLine endswith ".exe databases" or ProcessCommandLine endswith ".exe games" or ProcessCommandLine endswith ".exe git" or ProcessCommandLine endswith ".exe mails" or ProcessCommandLine endswith ".exe maven" or ProcessCommandLine endswith ".exe memory" or ProcessCommandLine endswith ".exe multimedia" or ProcessCommandLine endswith ".exe sysadmin" or ProcessCommandLine endswith ".exe unused" or ProcessCommandLine endswith ".exe wifi" or ProcessCommandLine endswith ".exe windows") and (FolderPath contains ":\\PerfLogs\\" or FolderPath contains ":\\ProgramData\\" or FolderPath contains ":\\Temp\\" or FolderPath contains ":\\Tmp\\" or FolderPath contains ":\\Windows\\Temp\\" or FolderPath contains "\\AppData\\" or FolderPath contains "\\Downloads\\" or FolderPath contains "\\Users\\Public\\")) or ((ProcessCommandLine contains "all " or ProcessCommandLine contains "browsers " or ProcessCommandLine contains "chats " or ProcessCommandLine contains "databases " or ProcessCommandLine contains "games " or ProcessCommandLine contains "git " or ProcessCommandLine contains "mails " or ProcessCommandLine contains "maven " or ProcessCommandLine contains "memory " or ProcessCommandLine contains "multimedia " or ProcessCommandLine contains "php " or ProcessCommandLine contains "svn " or ProcessCommandLine contains "sysadmin " or ProcessCommandLine contains "unused " or ProcessCommandLine contains "wifi " or ProcessCommandLine contains "windows ") and (ProcessCommandLine contains "-oA" or ProcessCommandLine contains "-oJ" or ProcessCommandLine contains "-oN" or ProcessCommandLine contains "-output" or ProcessCommandLine contains "-password" or ProcessCommandLine contains "-1Password" or ProcessCommandLine contains "-apachedirectorystudio" or ProcessCommandLine contains "-autologon" or ProcessCommandLine contains "-ChromiumBased" or ProcessCommandLine contains "-composer" or ProcessCommandLine contains "-coreftp" or ProcessCommandLine contains "-credfiles" or ProcessCommandLine contains "-credman" or ProcessCommandLine contains "-cyberduck" or ProcessCommandLine contains "-dbvis" or ProcessCommandLine contains "-EyeCon" or ProcessCommandLine contains "-filezilla" or ProcessCommandLine contains "-filezillaserver" or ProcessCommandLine contains "-ftpnavigator" or ProcessCommandLine contains "-galconfusion" or ProcessCommandLine contains "-gitforwindows" or ProcessCommandLine contains "-hashdump" or ProcessCommandLine contains "-iisapppool" or ProcessCommandLine contains "-IISCentralCertP" or ProcessCommandLine contains "-kalypsomedia" or ProcessCommandLine contains "-keepass" or ProcessCommandLine contains "-keepassconfig" or ProcessCommandLine contains "-lsa_secrets" or ProcessCommandLine contains "-mavenrepositories" or ProcessCommandLine contains "-memory_dump" or ProcessCommandLine contains "-Mozilla" or ProcessCommandLine contains "-mRemoteNG" or ProcessCommandLine contains "-mscache" or ProcessCommandLine contains "-opensshforwindows" or ProcessCommandLine contains "-openvpn" or ProcessCommandLine contains "-outlook" or ProcessCommandLine contains "-pidgin" or ProcessCommandLine contains "-postgresql" or ProcessCommandLine contains "-psi-im" or ProcessCommandLine contains "-puttycm" or ProcessCommandLine contains "-pypykatz" or ProcessCommandLine contains "-Rclone" or ProcessCommandLine contains "-rdpmanager" or ProcessCommandLine contains "-robomongo" or ProcessCommandLine contains "-roguestale" or ProcessCommandLine contains "-skype" or ProcessCommandLine contains "-SQLDeveloper" or ProcessCommandLine contains "-squirrel" or ProcessCommandLine contains "-tortoise" or ProcessCommandLine contains "-turba" or ProcessCommandLine contains "-UCBrowser" or ProcessCommandLine contains "-unattended" or ProcessCommandLine contains "-vault" or ProcessCommandLine contains "-vaultfiles" or ProcessCommandLine contains "-vnc" or ProcessCommandLine contains "-windows" or ProcessCommandLine contains "-winscp" or ProcessCommandLine contains "-wsl"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_agentexecutor_susp_usage.yml
Suspicious AgentExecutor PowerShell Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -powershell" or ProcessCommandLine contains " -remediationScript") and (FolderPath endswith "\\AgentExecutor.exe" or ProcessVersionInfoOriginalFileName =~ "AgentExecutor.exe")) and (not((InitiatingProcessFolderPath endswith "\\Microsoft.Management.Services.IntuneWindowsAgent.exe" or (ProcessCommandLine contains "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\" or ProcessCommandLine contains "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_lethalhta_technique.yml
Potential LethalHTA Technique Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\mshta.exe" and InitiatingProcessFolderPath endswith "\\svchost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_delete.yml
Delete Important Scheduled Task ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\Windows\\BitLocker" or ProcessCommandLine contains "\\Windows\\ExploitGuard" or ProcessCommandLine contains "\\Windows\\SystemRestore\\SR" or ProcessCommandLine contains "\\Windows\\UpdateOrchestrator\\" or ProcessCommandLine contains "\\Windows\\Windows Defender\\" or ProcessCommandLine contains "\\Windows\\WindowsBackup\\" or ProcessCommandLine contains "\\Windows\\WindowsUpdate\\") and (ProcessCommandLine contains "/delete" and ProcessCommandLine contains "/tn") and FolderPath endswith "\\schtasks.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wscript_cscript_uncommon_extension_exec.yml
Cscript/Wscript Uncommon Script Extension Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".csv" or ProcessCommandLine contains ".dat" or ProcessCommandLine contains ".doc" or ProcessCommandLine contains ".gif" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".ppt" or ProcessCommandLine contains ".txt" or ProcessCommandLine contains ".xls" or ProcessCommandLine contains ".xml") and ((ProcessVersionInfoOriginalFileName in~ ("wscript.exe", "cscript.exe")) or (FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_iex_patterns.yml
Suspicious PowerShell IEX Execution Patterns ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " | iex;" or ProcessCommandLine contains " | iex " or ProcessCommandLine contains " | iex}" or ProcessCommandLine contains " | IEX ;" or ProcessCommandLine contains " | IEX -Error" or ProcessCommandLine contains " | IEX (new" or ProcessCommandLine contains ");IEX ") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) and (ProcessCommandLine contains "::FromBase64String" or ProcessCommandLine contains ".GetString([System.Convert]::")) or (ProcessCommandLine contains ")|iex;$" or ProcessCommandLine contains ");iex($" or ProcessCommandLine contains ");iex $" or ProcessCommandLine contains " | IEX | " or ProcessCommandLine contains " | iex\\\"")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_webshell_tool_recon.yml
Webshell Tool Reconnaissance Activity ---> KQL Query:
DeviceProcessEvents
| where (((InitiatingProcessFolderPath contains "-tomcat-" or InitiatingProcessFolderPath contains "\\tomcat") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or ((ProcessCommandLine contains "CATALINA_HOME" or ProcessCommandLine contains "catalina.jar") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or (InitiatingProcessFolderPath endswith "\\caddy.exe" or InitiatingProcessFolderPath endswith "\\httpd.exe" or InitiatingProcessFolderPath endswith "\\nginx.exe" or InitiatingProcessFolderPath endswith "\\php-cgi.exe" or InitiatingProcessFolderPath endswith "\\w3wp.exe" or InitiatingProcessFolderPath endswith "\\ws_tomcatservice.exe")) and (ProcessCommandLine contains "perl --help" or ProcessCommandLine contains "perl -h" or ProcessCommandLine contains "python --help" or ProcessCommandLine contains "python -h" or ProcessCommandLine contains "python3 --help" or ProcessCommandLine contains "python3 -h" or ProcessCommandLine contains "wget --help")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_powershell_persistence.yml
Potential Persistence Via Powershell Search Order Hijacking - Task ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith " -windowstyle hidden" or ProcessCommandLine endswith " -w hidden" or ProcessCommandLine endswith " -ep bypass" or ProcessCommandLine endswith " -noni") and (InitiatingProcessCommandLine contains "-k netsvcs" and InitiatingProcessCommandLine contains "-s Schedule") and InitiatingProcessFolderPath =~ "C:\\WINDOWS\\System32\\svchost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wab_execution_from_non_default_location.yml
Wab Execution From Non Default Location ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\wab.exe" or FolderPath endswith "\\wabmig.exe") and (not((FolderPath startswith "C:\\Windows\\WinSxS\\" or FolderPath startswith "C:\\Program Files\\Windows Mail\\" or FolderPath startswith "C:\\Program Files (x86)\\Windows Mail\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_defender_av_security_monitoring.yml
Disable Windows Defender AV Security Monitoring ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine contains "-DisableBehaviorMonitoring $true" or ProcessCommandLine contains "-DisableRuntimeMonitoring $true")) or ((FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe") and ((ProcessCommandLine contains "delete" and ProcessCommandLine contains "WinDefend") or (ProcessCommandLine contains "config" and ProcessCommandLine contains "WinDefend" and ProcessCommandLine contains "start=disabled") or (ProcessCommandLine contains "stop" and ProcessCommandLine contains "WinDefend")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_exec_path_2.yml
Regsvr32 Execution From Highly Suspicious Location ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "REGSVR32.EXE") and ((ProcessCommandLine contains ":\\PerfLogs\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains "\\Windows\\Registration\\CRMLog" or ProcessCommandLine contains "\\Windows\\System32\\com\\dmp\\" or ProcessCommandLine contains "\\Windows\\System32\\FxsTmp\\" or ProcessCommandLine contains "\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\" or ProcessCommandLine contains "\\Windows\\System32\\spool\\drivers\\color\\" or ProcessCommandLine contains "\\Windows\\System32\\spool\\PRINTERS\\" or ProcessCommandLine contains "\\Windows\\System32\\spool\\SERVERS\\" or ProcessCommandLine contains "\\Windows\\System32\\Tasks_Migrated\\" or ProcessCommandLine contains "\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\" or ProcessCommandLine contains "\\Windows\\SysWOW64\\com\\dmp\\" or ProcessCommandLine contains "\\Windows\\SysWOW64\\FxsTmp\\" or ProcessCommandLine contains "\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\" or ProcessCommandLine contains "\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\" or ProcessCommandLine contains "\\Windows\\Tasks\\" or ProcessCommandLine contains "\\Windows\\Tracing\\") or ((ProcessCommandLine contains " \"C:\\" or ProcessCommandLine contains " C:\\" or ProcessCommandLine contains " 'C:\\" or ProcessCommandLine contains "D:\\") and (not((ProcessCommandLine contains "C:\\Program Files (x86)\\" or ProcessCommandLine contains "C:\\Program Files\\" or ProcessCommandLine contains "C:\\ProgramData\\" or ProcessCommandLine contains "C:\\Users\\" or ProcessCommandLine contains " C:\\Windows\\" or ProcessCommandLine contains " \"C:\\Windows\\" or ProcessCommandLine contains " 'C:\\Windows\\"))))) and (not((ProcessCommandLine =~ "" or isnull(ProcessCommandLine))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_susp_pattern.yml
Suspicious Mshta.EXE Execution Patterns ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\mshta.exe" or ProcessVersionInfoOriginalFileName =~ "MSHTA.EXE") and ((ProcessCommandLine contains "\\AppData\\Local\\" or ProcessCommandLine contains "C:\\ProgramData\\" or ProcessCommandLine contains "C:\\Users\\Public\\" or ProcessCommandLine contains "C:\\Windows\\Temp\\") and (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe"))) or ((FolderPath endswith "\\mshta.exe" or ProcessVersionInfoOriginalFileName =~ "MSHTA.EXE") and (not(((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\") or (ProcessCommandLine contains ".htm" or ProcessCommandLine contains ".hta") or (ProcessCommandLine endswith "mshta.exe" or ProcessCommandLine endswith "mshta")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_process_patterns.yml
Potential CobaltStrike Process Patterns ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "conhost.exe 0xffffffff -ForceV1" and (InitiatingProcessCommandLine contains "cmd.exe /C echo" and InitiatingProcessCommandLine contains " > \\\\.\\pipe")) or (ProcessCommandLine endswith "conhost.exe 0xffffffff -ForceV1" and InitiatingProcessCommandLine endswith "/C whoami") or (ProcessCommandLine endswith "cmd.exe /C whoami" and InitiatingProcessFolderPath startswith "C:\\Temp\\") or ((ProcessCommandLine contains "cmd.exe /c echo" and ProcessCommandLine contains "> \\\\.\\pipe") and (InitiatingProcessFolderPath endswith "\\runonce.exe" or InitiatingProcessFolderPath endswith "\\dllhost.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_systeminfo_execution.yml
Suspicious Execution of Systeminfo ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\systeminfo.exe" or ProcessVersionInfoOriginalFileName =~ "sysinfo.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_encoding_patterns.yml
Potential Encoded PowerShell Patterns In CommandLine ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (((ProcessCommandLine contains "ToInt" or ProcessCommandLine contains "ToDecimal" or ProcessCommandLine contains "ToByte" or ProcessCommandLine contains "ToUint" or ProcessCommandLine contains "ToSingle" or ProcessCommandLine contains "ToSByte") and (ProcessCommandLine contains "ToChar" or ProcessCommandLine contains "ToString" or ProcessCommandLine contains "String")) or ((ProcessCommandLine contains "char" and ProcessCommandLine contains "join") or (ProcessCommandLine contains "split" and ProcessCommandLine contains "join")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_aspnet_compiler_susp_child_process.yml
Suspicious Child Process of AspNetCompiler ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\notepad.exe") or (FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "\\AppData\\Local\\Roaming\\" or FolderPath contains ":\\Temp\\" or FolderPath contains ":\\Windows\\Temp\\" or FolderPath contains ":\\Windows\\System32\\Tasks\\" or FolderPath contains ":\\Windows\\Tasks\\")) and InitiatingProcessFolderPath endswith "\\aspnet_compiler.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd.yml
Suspicious Encoded PowerShell Command Line ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (((ProcessCommandLine contains " JAB" or ProcessCommandLine contains " SUVYI" or ProcessCommandLine contains " SQBFAFgA" or ProcessCommandLine contains " aQBlAHgA" or ProcessCommandLine contains " aWV4I" or ProcessCommandLine contains " IAA" or ProcessCommandLine contains " IAB" or ProcessCommandLine contains " UwB" or ProcessCommandLine contains " cwB") and ProcessCommandLine contains " -e") or (ProcessCommandLine contains ".exe -ENCOD " or ProcessCommandLine contains " BA^J e-")) and (not(ProcessCommandLine contains " -ExecutionPolicy remotesigned "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_flags_anomaly.yml
Potential Regsvr32 Commandline Flag Anomaly ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -i:" or ProcessCommandLine contains " /i:" or ProcessCommandLine contains " i:" or ProcessCommandLine contains " i:" or ProcessCommandLine contains " i:") and FolderPath endswith "\\regsvr32.exe") and (not(ProcessCommandLine contains " -n " or ProcessCommandLine contains " /n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_local_admin_group.yml
User Added to Local Administrators Group ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " administrators " or ProcessCommandLine contains " administrateur") and ((ProcessCommandLine contains "localgroup " and ProcessCommandLine contains " /add") or (ProcessCommandLine contains "Add-LocalGroupMember " and ProcessCommandLine contains " -Group "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_cl_mutexverifiers.yml
Potential Script Proxy Execution Via CL_Mutexverifiers.ps1 ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -nologo -windowstyle minimized -file " and FolderPath endswith "\\powershell.exe" and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe")) and (ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\Windows\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_print_remote_file_copy.yml
Abusing Print Executable ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "/D" and ProcessCommandLine contains ".exe") and ProcessCommandLine startswith "print" and FolderPath endswith "\\print.exe") and (not(ProcessCommandLine contains "print.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_aadinternals_cmdlets_execution.yml
AADInternals PowerShell Cmdlets Execution - ProccessCreation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Add-AADInt" or ProcessCommandLine contains "ConvertTo-AADInt" or ProcessCommandLine contains "Disable-AADInt" or ProcessCommandLine contains "Enable-AADInt" or ProcessCommandLine contains "Export-AADInt" or ProcessCommandLine contains "Find-AADInt" or ProcessCommandLine contains "Get-AADInt" or ProcessCommandLine contains "Grant-AADInt" or ProcessCommandLine contains "Initialize-AADInt" or ProcessCommandLine contains "Install-AADInt" or ProcessCommandLine contains "Invoke-AADInt" or ProcessCommandLine contains "Join-AADInt" or ProcessCommandLine contains "New-AADInt" or ProcessCommandLine contains "Open-AADInt" or ProcessCommandLine contains "Read-AADInt" or ProcessCommandLine contains "Register-AADInt" or ProcessCommandLine contains "Remove-AADInt" or ProcessCommandLine contains "Reset-AADInt" or ProcessCommandLine contains "Resolve-AADInt" or ProcessCommandLine contains "Restore-AADInt" or ProcessCommandLine contains "Save-AADInt" or ProcessCommandLine contains "Search-AADInt" or ProcessCommandLine contains "Send-AADInt" or ProcessCommandLine contains "Set-AADInt" or ProcessCommandLine contains "Start-AADInt" or ProcessCommandLine contains "Unprotect-AADInt" or ProcessCommandLine contains "Update-AADInt") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.Exe", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_ie_security_zone_protocol_defaults_downgrade.yml
IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults" and ProcessCommandLine contains "http" and ProcessCommandLine contains " 0"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop_group.yml
User Added to Remote Desktop Users Group ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Remote Desktop Users" or ProcessCommandLine contains "Utilisateurs du Bureau  distance" or ProcessCommandLine contains "Usuarios de escritorio remoto") and ((ProcessCommandLine contains "localgroup " and ProcessCommandLine contains " /add") or (ProcessCommandLine contains "Add-LocalGroupMember " and ProcessCommandLine contains " -Group "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_schedule_via_masqueraded_xml_file.yml
Suspicious Scheduled Task Creation via Masqueraded XML File ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "/create" or ProcessCommandLine contains "-create") and (ProcessCommandLine contains "/xml" or ProcessCommandLine contains "-xml") and (FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe")) and (not((ProcessCommandLine contains ".xml" or ((InitiatingProcessCommandLine contains ":\\WINDOWS\\Installer\\MSI" and InitiatingProcessCommandLine contains ".tmp,zzzzInvokeManagedCustomActionOutOfProc") and InitiatingProcessFolderPath endswith "\\rundll32.exe") or (ProcessIntegrityLevel in~ ("System", "S-1-16-16384"))))) and (not(((InitiatingProcessFolderPath contains ":\\ProgramData\\OEM\\UpgradeTool\\CareCenter_" and InitiatingProcessFolderPath contains "\\BUnzip\\Setup_msi.exe") or InitiatingProcessFolderPath endswith ":\\Program Files\\Axis Communications\\AXIS Camera Station\\SetupActions.exe" or InitiatingProcessFolderPath endswith ":\\Program Files\\Axis Communications\\AXIS Device Manager\\AdmSetupActions.exe" or InitiatingProcessFolderPath endswith ":\\Program Files (x86)\\Zemana\\AntiMalware\\AntiMalware.exe" or InitiatingProcessFolderPath endswith ":\\Program Files\\Dell\\SupportAssist\\pcdrcui.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ksetup_password_change_user.yml
Logged-On User Password Change Via Ksetup.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /ChangePassword " and (FolderPath endswith "\\ksetup.exe" or ProcessVersionInfoOriginalFileName =~ "ksetup.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regini_ads.yml
Suspicious Registry Modification From ADS Via Regini.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\regini.exe" or ProcessVersionInfoOriginalFileName =~ "REGINI.EXE") and ProcessCommandLine matches regex ":[^ \\\\]"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_expand_cabinet_files.yml
Potentially Suspicious Cabinet File Expansion ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-F:" or ProcessCommandLine contains "/F:" or ProcessCommandLine contains "F:" or ProcessCommandLine contains "F:" or ProcessCommandLine contains "F:") and FolderPath endswith "\\expand.exe") and ((ProcessCommandLine contains ":\\Perflogs\\" or ProcessCommandLine contains ":\\ProgramData" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\Admin$\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\AppData\\Roaming\\" or ProcessCommandLine contains "\\C$\\" or ProcessCommandLine contains "\\Temporary Internet") or ((ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favorites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favourites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Contacts\\"))) and (not((ProcessCommandLine contains "C:\\ProgramData\\Dell\\UpdateService\\Temp\\" and InitiatingProcessFolderPath =~ "C:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmstp_execution_by_creation.yml
CMSTP Execution Process Creation ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\cmstp.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml
Suspicious Copy From or To System Directory ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "copy " and FolderPath endswith "\\cmd.exe") or ((FolderPath endswith "\\robocopy.exe" or FolderPath endswith "\\xcopy.exe") or (ProcessVersionInfoOriginalFileName in~ ("robocopy.exe", "XCOPY.EXE"))) or ((ProcessCommandLine contains "copy-item" or ProcessCommandLine contains " copy " or ProcessCommandLine contains "cpi " or ProcessCommandLine contains " cp ") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe"))) and (ProcessCommandLine contains "\\System32" or ProcessCommandLine contains "\\SysWOW64" or ProcessCommandLine contains "\\WinSxS")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_copy_browser_data.yml
Potential Browser Data Stealing ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "copy-item" or ProcessCommandLine contains "copy " or ProcessCommandLine contains "cpi " or ProcessCommandLine contains " cp " or ProcessCommandLine contains "move " or ProcessCommandLine contains "move-item" or ProcessCommandLine contains " mi " or ProcessCommandLine contains " mv ") or (FolderPath endswith "\\esentutl.exe" or FolderPath endswith "\\xcopy.exe" or FolderPath endswith "\\robocopy.exe") or (ProcessVersionInfoOriginalFileName in~ ("esentutl.exe", "XCOPY.EXE", "robocopy.exe"))) and (ProcessCommandLine contains "\\Amigo\\User Data" or ProcessCommandLine contains "\\BraveSoftware\\Brave-Browser\\User Data" or ProcessCommandLine contains "\\CentBrowser\\User Data" or ProcessCommandLine contains "\\Chromium\\User Data" or ProcessCommandLine contains "\\CocCoc\\Browser\\User Data" or ProcessCommandLine contains "\\Comodo\\Dragon\\User Data" or ProcessCommandLine contains "\\Elements Browser\\User Data" or ProcessCommandLine contains "\\Epic Privacy Browser\\User Data" or ProcessCommandLine contains "\\Google\\Chrome Beta\\User Data" or ProcessCommandLine contains "\\Google\\Chrome SxS\\User Data" or ProcessCommandLine contains "\\Google\\Chrome\\User Data\\" or ProcessCommandLine contains "\\Kometa\\User Data" or ProcessCommandLine contains "\\Maxthon5\\Users" or ProcessCommandLine contains "\\Microsoft\\Edge\\User Data" or ProcessCommandLine contains "\\Mozilla\\Firefox\\Profiles" or ProcessCommandLine contains "\\Nichrome\\User Data" or ProcessCommandLine contains "\\Opera Software\\Opera GX Stable\\" or ProcessCommandLine contains "\\Opera Software\\Opera Neon\\User Data" or ProcessCommandLine contains "\\Opera Software\\Opera Stable\\" or ProcessCommandLine contains "\\Orbitum\\User Data" or ProcessCommandLine contains "\\QIP Surf\\User Data" or ProcessCommandLine contains "\\Sputnik\\User Data" or ProcessCommandLine contains "\\Torch\\User Data" or ProcessCommandLine contains "\\uCozMedia\\Uran\\User Data" or ProcessCommandLine contains "\\Vivaldi\\User Data")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_ping_del_combined_execution.yml
Suspicious Ping/Del Command Combination ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ping" and ProcessCommandLine contains "del ") and (ProcessCommandLine contains " -n " or ProcessCommandLine contains " /n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n " or ProcessCommandLine contains " n ") and (ProcessCommandLine contains " -f " or ProcessCommandLine contains " /f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " f " or ProcessCommandLine contains " -q " or ProcessCommandLine contains " /q " or ProcessCommandLine contains " q " or ProcessCommandLine contains " q " or ProcessCommandLine contains " q ") and ProcessCommandLine contains "Nul"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml
Base64 Encoded PowerShell Command Detected ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "::FromBase64String("

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_sensitive_file_access_shadowcopy.yml
Sensitive File Access Via Volume Shadow Copy Backup ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy" and (ProcessCommandLine contains "\\NTDS.dit" or ProcessCommandLine contains "\\SYSTEM" or ProcessCommandLine contains "\\SECURITY")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_service_tamper_for_persistence.yml
Potential Persistence Attempt Via Existing Service Tampering ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "sc " and ProcessCommandLine contains "config " and ProcessCommandLine contains "binpath=") or (ProcessCommandLine contains "sc " and ProcessCommandLine contains "failure" and ProcessCommandLine contains "command=")) or ((ProcessCommandLine contains ".sh" or ProcessCommandLine contains ".exe" or ProcessCommandLine contains ".dll" or ProcessCommandLine contains ".bin$" or ProcessCommandLine contains ".bat" or ProcessCommandLine contains ".cmd" or ProcessCommandLine contains ".js" or ProcessCommandLine contains ".msh$" or ProcessCommandLine contains ".reg$" or ProcessCommandLine contains ".scr" or ProcessCommandLine contains ".ps" or ProcessCommandLine contains ".vb" or ProcessCommandLine contains ".jar" or ProcessCommandLine contains ".pl") and ((ProcessCommandLine contains "reg " and ProcessCommandLine contains "add " and ProcessCommandLine contains "FailureCommand") or (ProcessCommandLine contains "reg " and ProcessCommandLine contains "add " and ProcessCommandLine contains "ImagePath")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_use_mount_admin_share.yml
Windows Admin Share Mount Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " use " and (ProcessCommandLine contains " \\" and ProcessCommandLine contains "\\" and ProcessCommandLine contains "$")) and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iis_susp_module_registration.yml
Suspicious IIS Module Registration ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\w3wp.exe" and (ProcessCommandLine contains "appcmd.exe add module" or (ProcessCommandLine contains " system.enterpriseservices.internal.publish" and FolderPath endswith "\\powershell.exe") or (ProcessCommandLine contains "gacutil" and ProcessCommandLine contains " /I"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_uncommon_targetfolder.yml
File Download Via Bitsadmin To An Uncommon Target Folder ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /transfer " or ProcessCommandLine contains " /create " or ProcessCommandLine contains " /addfile ") and (ProcessCommandLine contains "%AppData%" or ProcessCommandLine contains "%temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains "\\AppData\\Local\\" or ProcessCommandLine contains "C:\\Windows\\Temp\\") and (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_radmin.yml
PUA - Radmin Viewer Utility Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "Radmin Viewer" or ProcessVersionInfoProductName =~ "Radmin Viewer" or ProcessVersionInfoOriginalFileName =~ "Radmin.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_desktopimgdownldr_remote_file_download.yml
Remote File Download Via Desktopimgdownldr Utility ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/lockscreenurl:http" and FolderPath endswith "\\desktopimgdownldr.exe" and InitiatingProcessFolderPath endswith "\\desktopimgdownldr.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_invoke.yml
PowerShell Base64 Encoded Invoke Keyword ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -e" and (ProcessCommandLine contains "SQBuAHYAbwBrAGUALQ" or ProcessCommandLine contains "kAbgB2AG8AawBlAC0A" or ProcessCommandLine contains "JAG4AdgBvAGsAZQAtA" or ProcessCommandLine contains "SW52b2tlL" or ProcessCommandLine contains "ludm9rZS" or ProcessCommandLine contains "JbnZva2Ut") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_child_process.yml
Potentially Suspicious Child Process Of Regsvr32 ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\explorer.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\notepad.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\werfault.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\regsvr32.exe") and (not((ProcessCommandLine contains " -u -p " and FolderPath endswith "\\werfault.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_uac_bypass.yml
HackTool - Empire PowerShell UAC Bypass ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update)" or ProcessCommandLine contains " -NoP -NonI -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update);"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_outlook_execution_from_temp.yml
Suspicious Execution From Outlook Temporary Folder ---> KQL Query:
DeviceProcessEvents
| where FolderPath contains "\\Temporary Internet Files\\Content.Outlook\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_meshagent_exec.yml
Remote Access Tool - MeshAgent Command Execution via MeshCentral ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") and InitiatingProcessFolderPath endswith "\\meshagent.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_http_appdata.yml
Command Line Execution with Suspicious URL and AppData Strings ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http" and ProcessCommandLine contains "://" and ProcessCommandLine contains "%AppData%") and FolderPath endswith "\\cmd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_machineguid.yml
Suspicious Query of MachineGUID ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "SOFTWARE\\Microsoft\\Cryptography" and ProcessCommandLine contains "/v " and ProcessCommandLine contains "MachineGuid") and FolderPath endswith "\\reg.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wab_unusual_parents.yml
Wab/Wabmig Unusual Parent Or Child Processes ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\wab.exe" or InitiatingProcessFolderPath endswith "\\wabmig.exe") or ((FolderPath endswith "\\wab.exe" or FolderPath endswith "\\wabmig.exe") and (InitiatingProcessFolderPath endswith "\\WmiPrvSE.exe" or InitiatingProcessFolderPath endswith "\\svchost.exe" or InitiatingProcessFolderPath endswith "\\dllhost.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_susp_exec.yml
Remote Access Tool - Anydesk Execution From Suspicious Folder ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\AnyDesk.exe" or FolderPath endswith "\\AnyDeskMSI.exe") or ProcessVersionInfoFileDescription =~ "AnyDesk" or ProcessVersionInfoProductName =~ "AnyDesk" or ProcessVersionInfoCompanyName =~ "AnyDesk Software GmbH") and (not((FolderPath contains "\\AppData\\" or FolderPath contains "Program Files (x86)\\AnyDesk" or FolderPath contains "Program Files\\AnyDesk")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_shutdown_logoff.yml
Suspicious Execution of Shutdown to Log Out ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/l" and FolderPath endswith "\\shutdown.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_vsiisexelauncher.yml
Use of VSIISExeLauncher.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -p " or ProcessCommandLine contains " -a ") and (FolderPath endswith "\\VSIISExeLauncher.exe" or ProcessVersionInfoOriginalFileName =~ "VSIISExeLauncher.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tscon_localsystem.yml
Suspicious TSCON Start as SYSTEM ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\tscon.exe" and (AccountName contains "AUTHORI" or AccountName contains "AUTORI")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dctask64_arbitrary_command_and_dll_execution.yml
Unexpected Error processing 'ManageEngine Endpoint Central Dctask64.EXE Potential Abuse' (sigma/rules/windows/process_creation/proc_creation_win_dctask64_arbitrary_command_and_dll_execution.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_groups_discovery.yml
Group Membership Reconnaissance Via Whoami.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /groups" or ProcessCommandLine contains " -groups") and (FolderPath endswith "\\whoami.exe" or ProcessVersionInfoOriginalFileName =~ "whoami.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_user32_dll.yml
Suspicious Workstation Locking via Rundll32 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "user32.dll," and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE") and InitiatingProcessFolderPath endswith "\\cmd.exe" and ProcessCommandLine contains "LockWorkStation"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_excel_dcom_lateral_movement.yml
Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp ---> KQL Query:
DeviceProcessEvents
| where ((ProcessVersionInfoOriginalFileName in~ ("foxprow.exe", "schdplus.exe", "winproj.exe")) or (FolderPath endswith "\\foxprow.exe" or FolderPath endswith "\\schdplus.exe" or FolderPath endswith "\\winproj.exe")) and InitiatingProcessFolderPath endswith "\\excel.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_gmer.yml
HackTool - GMER Rootkit Detector and Remover Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\gmer.exe" or (MD5 startswith "E9DC058440D321AA17D0600B3CA0AB04" or SHA1 startswith "539C228B6B332F5AA523E5CE358C16647D8BBE57" or SHA256 startswith "E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certoc_download_direct_ip.yml
File Download From IP Based URL Via CertOC.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-GetCACAPS" and (FolderPath endswith "\\certoc.exe" or ProcessVersionInfoOriginalFileName =~ "CertOC.exe") and ProcessCommandLine matches regex "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_exec_data_file.yml
Powershell Inline Execution From A File ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "iex " or ProcessCommandLine contains "Invoke-Expression " or ProcessCommandLine contains "Invoke-Command " or ProcessCommandLine contains "icm ") and ProcessCommandLine contains " -raw" and (ProcessCommandLine contains "cat " or ProcessCommandLine contains "get-content " or ProcessCommandLine contains "type ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution_patterns.yml
HackTool - CrackMapExec Execution Patterns ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "cmd.exe /Q /c " and ProcessCommandLine contains " 1> \\" and ProcessCommandLine contains "\\" and ProcessCommandLine contains "\\" and ProcessCommandLine contains " 2>&1") or (ProcessCommandLine contains "cmd.exe /C " and ProcessCommandLine contains " > \\" and ProcessCommandLine contains "\\" and ProcessCommandLine contains "\\" and ProcessCommandLine contains " 2>&1") or (ProcessCommandLine contains "cmd.exe /C " and ProcessCommandLine contains " > " and ProcessCommandLine contains "\\Temp\\" and ProcessCommandLine contains " 2>&1") or ProcessCommandLine contains "powershell.exe -exec bypass -noni -nop -w 1 -C \"" or ProcessCommandLine contains "powershell.exe -noni -nop -w 1 -enc "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_download_patterns.yml
Suspicious PowerShell Download and Execute Pattern ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "IEX ((New-Object Net.WebClient).DownloadString" or ProcessCommandLine contains "IEX (New-Object Net.WebClient).DownloadString" or ProcessCommandLine contains "IEX((New-Object Net.WebClient).DownloadString" or ProcessCommandLine contains "IEX(New-Object Net.WebClient).DownloadString" or ProcessCommandLine contains " -command (New-Object System.Net.WebClient).DownloadFile(" or ProcessCommandLine contains " -c (New-Object System.Net.WebClient).DownloadFile("

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_createdump_lolbin_execution.yml
CreateDump Process Dump ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -u " or ProcessCommandLine contains " --full " or ProcessCommandLine contains " -f " or ProcessCommandLine contains " --name " or ProcessCommandLine contains ".dmp ") and (FolderPath endswith "\\createdump.exe" or ProcessVersionInfoOriginalFileName =~ "FX_VER_INTERNALNAME_STR")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mssql_veaam_susp_child_processes.yml
Suspicious Child Process Of Veeam Dabatase ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains "VEEAMSQL" and InitiatingProcessFolderPath endswith "\\sqlservr.exe") and (((ProcessCommandLine contains "-ex " or ProcessCommandLine contains "bypass" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "DownloadString" or ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "copy ") and (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wsl.exe" or FolderPath endswith "\\wt.exe")) or (FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\netstat.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\ping.exe" or FolderPath endswith "\\tasklist.exe" or FolderPath endswith "\\whoami.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes_remote.yml
Suspicious Remote Child Process From Outlook ---> KQL Query:
DeviceProcessEvents
| where FolderPath startswith "\\\\" and InitiatingProcessFolderPath endswith "\\outlook.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_xsl_script_processing.yml
XSL Script Execution Via WMIC.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-format" or ProcessCommandLine contains "/format" or ProcessCommandLine contains "format" or ProcessCommandLine contains "format" or ProcessCommandLine contains "format") and FolderPath endswith "\\wmic.exe") and (not((ProcessCommandLine contains "Format:List" or ProcessCommandLine contains "Format:htable" or ProcessCommandLine contains "Format:hform" or ProcessCommandLine contains "Format:table" or ProcessCommandLine contains "Format:mof" or ProcessCommandLine contains "Format:value" or ProcessCommandLine contains "Format:rawxml" or ProcessCommandLine contains "Format:xml" or ProcessCommandLine contains "Format:csv")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_electron_app_children.yml
Suspicious Electron Application Child Processes ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\chrome.exe" or InitiatingProcessFolderPath endswith "\\discord.exe" or InitiatingProcessFolderPath endswith "\\GitHubDesktop.exe" or InitiatingProcessFolderPath endswith "\\keybase.exe" or InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe" or InitiatingProcessFolderPath endswith "\\msteams.exe" or InitiatingProcessFolderPath endswith "\\slack.exe" or InitiatingProcessFolderPath endswith "\\teams.exe") and ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\wscript.exe") or (FolderPath contains ":\\ProgramData\\" or FolderPath contains ":\\Temp\\" or FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\Windows\\Temp\\")) and (not((ProcessCommandLine contains "\\NVSMI\\nvidia-smi.exe" and FolderPath endswith "\\cmd.exe" and InitiatingProcessFolderPath endswith "\\Discord.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml
Bypass UAC via WSReset.exe ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\wsreset.exe" and (not((FolderPath endswith "\\conhost.exe" or ProcessVersionInfoOriginalFileName =~ "CONHOST.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_del_greedy_deletion.yml
Greedy File Deletion Using Del ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "del " or ProcessCommandLine contains "erase ") and (ProcessCommandLine contains "\\*.au3" or ProcessCommandLine contains "\\*.dll" or ProcessCommandLine contains "\\*.exe" or ProcessCommandLine contains "\\*.js") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_double_extension.yml
Suspicious Double Extension File Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".doc.exe" or ProcessCommandLine contains ".docx.exe" or ProcessCommandLine contains ".xls.exe" or ProcessCommandLine contains ".xlsx.exe" or ProcessCommandLine contains ".ppt.exe" or ProcessCommandLine contains ".pptx.exe" or ProcessCommandLine contains ".rtf.exe" or ProcessCommandLine contains ".pdf.exe" or ProcessCommandLine contains ".txt.exe" or ProcessCommandLine contains "      .exe" or ProcessCommandLine contains "______.exe" or ProcessCommandLine contains ".doc.js" or ProcessCommandLine contains ".docx.js" or ProcessCommandLine contains ".xls.js" or ProcessCommandLine contains ".xlsx.js" or ProcessCommandLine contains ".ppt.js" or ProcessCommandLine contains ".pptx.js" or ProcessCommandLine contains ".rtf.js" or ProcessCommandLine contains ".pdf.js" or ProcessCommandLine contains ".txt.js") and (FolderPath endswith ".doc.exe" or FolderPath endswith ".docx.exe" or FolderPath endswith ".xls.exe" or FolderPath endswith ".xlsx.exe" or FolderPath endswith ".ppt.exe" or FolderPath endswith ".pptx.exe" or FolderPath endswith ".rtf.exe" or FolderPath endswith ".pdf.exe" or FolderPath endswith ".txt.exe" or FolderPath endswith "      .exe" or FolderPath endswith "______.exe" or FolderPath endswith ".doc.js" or FolderPath endswith ".docx.js" or FolderPath endswith ".xls.js" or FolderPath endswith ".xlsx.js" or FolderPath endswith ".ppt.js" or FolderPath endswith ".pptx.js" or FolderPath endswith ".rtf.js" or FolderPath endswith ".pdf.js" or FolderPath endswith ".txt.js")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_nolmhash.yml
Enable LM Hash Storage - ProcCreation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\System\\CurrentControlSet\\Control\\Lsa" and ProcessCommandLine contains "NoLMHash" and ProcessCommandLine contains " 0"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cloudflared_tunnel_run.yml
Cloudflared Tunnel Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-config " or ProcessCommandLine contains "-credentials-contents " or ProcessCommandLine contains "-credentials-file " or ProcessCommandLine contains "-token ") and (ProcessCommandLine contains " tunnel " and ProcessCommandLine contains " run ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml
UAC Bypass Using PkgMgr and DISM ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\dism.exe" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessFolderPath endswith "\\pkgmgr.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_right_to_left_override.yml
Potential Defense Evasion Via Right-to-Left Override ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_conhost_susp_child_process.yml
Sigma Transformation Error for 'Uncommon Child Process Of Conhost.EXE': Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_mailboxexport_share.yml
Suspicious PowerShell Mailbox Export to Share ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "New-MailboxExportRequest" and ProcessCommandLine contains " -Mailbox " and ProcessCommandLine contains " -FilePath \\\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_network_pattern.yml
Potentially Suspicious Regsvr32 HTTP/FTP Pattern ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /i" or ProcessCommandLine contains " -i") and (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "REGSVR32.EXE") and (ProcessCommandLine contains "ftp" or ProcessCommandLine contains "http")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mpcmdrun_remove_windows_defender_definition.yml
Windows Defender Definition Files Removed ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -RemoveDefinitions" and ProcessCommandLine contains " -All") and (FolderPath endswith "\\MpCmdRun.exe" or ProcessVersionInfoOriginalFileName =~ "MpCmdRun.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ilasm_il_code_compilation.yml
C# IL Code Compilation Via Ilasm.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /dll" or ProcessCommandLine contains " /exe") and (FolderPath endswith "\\ilasm.exe" or ProcessVersionInfoOriginalFileName =~ "ilasm.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_start_service.yml
Start Windows Service Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " start " and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_odbcconf_register_dll_regsvr_susp.yml
Potentially Suspicious DLL Registered Via Odbcconf.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "REGSVR " and (FolderPath endswith "\\odbcconf.exe" or ProcessVersionInfoOriginalFileName =~ "odbcconf.exe")) and (not(ProcessCommandLine contains ".dll"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml
Suspicious Schtasks Execution AppData Folder ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "NT AUT" or ProcessCommandLine contains " SYSTEM ") and (ProcessCommandLine contains "/Create" and ProcessCommandLine contains "/RU" and ProcessCommandLine contains "/TR" and ProcessCommandLine contains "C:\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\") and FolderPath endswith "\\schtasks.exe") and (not((ProcessCommandLine contains "/TN TVInstallRestore" and FolderPath endswith "\\schtasks.exe" and (InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\" and InitiatingProcessFolderPath contains "TeamViewer_.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_exec_path_1.yml
Regsvr32 Execution From Potential Suspicious Location ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ":\\ProgramData\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\AppData\\Roaming\\") and (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "REGSVR32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_lolbin_exec_from_non_c_drive.yml
Sigma Transformation Error for 'LOLBIN Execution From Abnormal Drive': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_attrib_system_susp_paths.yml
Set Suspicious Files as System Files Using Attrib.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " +s" and (ProcessCommandLine contains ".bat" or ProcessCommandLine contains ".dll" or ProcessCommandLine contains ".exe" or ProcessCommandLine contains ".hta" or ProcessCommandLine contains ".ps1" or ProcessCommandLine contains ".vbe" or ProcessCommandLine contains ".vbs") and (FolderPath endswith "\\attrib.exe" or ProcessVersionInfoOriginalFileName =~ "ATTRIB.EXE") and (ProcessCommandLine contains " %" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\AppData\\Local\\" or ProcessCommandLine contains "\\ProgramData\\" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Windows\\Temp\\")) and (not((ProcessCommandLine contains "\\Windows\\TEMP\\" and ProcessCommandLine contains ".exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_diskshadow_script_mode_susp_ext.yml
Diskshadow Script Mode - Uncommon Script Extension Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-s " or ProcessCommandLine contains "/s " or ProcessCommandLine contains "s " or ProcessCommandLine contains "s " or ProcessCommandLine contains "s ") and (ProcessVersionInfoOriginalFileName =~ "diskshadow.exe" or FolderPath endswith "\\diskshadow.exe")) and (not(ProcessCommandLine contains ".txt"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_imewbdld_download.yml
Arbitrary File Download Via IMEWDBLD.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\IMEWDBLD.exe" or ProcessVersionInfoOriginalFileName =~ "imewdbld.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_susp_file_sharing_domains.yml
Potentially Suspicious File Download From File Sharing Domain Via PowerShell.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".DownloadString(" or ProcessCommandLine contains ".DownloadFile(" or ProcessCommandLine contains "Invoke-WebRequest " or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "wget ") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine contains "anonfiles.com" or ProcessCommandLine contains "cdn.discordapp.com" or ProcessCommandLine contains "ddns.net" or ProcessCommandLine contains "dl.dropboxusercontent.com" or ProcessCommandLine contains "ghostbin.co" or ProcessCommandLine contains "glitch.me" or ProcessCommandLine contains "gofile.io" or ProcessCommandLine contains "hastebin.com" or ProcessCommandLine contains "mediafire.com" or ProcessCommandLine contains "mega.nz" or ProcessCommandLine contains "onrender.com" or ProcessCommandLine contains "pages.dev" or ProcessCommandLine contains "paste.ee" or ProcessCommandLine contains "pastebin.com" or ProcessCommandLine contains "pastebin.pl" or ProcessCommandLine contains "pastetext.net" or ProcessCommandLine contains "pixeldrain.com" or ProcessCommandLine contains "privatlab.com" or ProcessCommandLine contains "privatlab.net" or ProcessCommandLine contains "send.exploit.in" or ProcessCommandLine contains "sendspace.com" or ProcessCommandLine contains "storage.googleapis.com" or ProcessCommandLine contains "storjshare.io" or ProcessCommandLine contains "supabase.co" or ProcessCommandLine contains "temp.sh" or ProcessCommandLine contains "transfer.sh" or ProcessCommandLine contains "trycloudflare.com" or ProcessCommandLine contains "ufile.io" or ProcessCommandLine contains "w3spaces.com" or ProcessCommandLine contains "workers.dev")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_python_inline_command_execution.yml
Python Inline Command Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c" and (ProcessVersionInfoOriginalFileName =~ "python.exe" or (FolderPath endswith "python.exe" or FolderPath endswith "python3.exe" or FolderPath endswith "python2.exe"))) and (not((InitiatingProcessCommandLine contains "-E -s -m ensurepip -U --default-pip" and InitiatingProcessFolderPath endswith "\\python.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\Python"))) and (not(((ProcessCommandLine contains "<pip-setuptools-caller>" and ProcessCommandLine contains "exec(compile(") or InitiatingProcessFolderPath endswith "\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_embed_exe_lnk.yml
Hidden Powershell in Link File Pattern ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "powershell" and ProcessCommandLine contains ".lnk") and FolderPath =~ "C:\\Windows\\System32\\cmd.exe" and InitiatingProcessFolderPath =~ "C:\\Windows\\explorer.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_diskshadow_script_mode_susp_location.yml
Diskshadow Script Mode - Execution From Potential Suspicious Location ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-s " or ProcessCommandLine contains "/s " or ProcessCommandLine contains "s " or ProcessCommandLine contains "s " or ProcessCommandLine contains "s ") and (ProcessVersionInfoOriginalFileName =~ "diskshadow.exe" or FolderPath endswith "\\diskshadow.exe") and (ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\" or ProcessCommandLine contains "\\AppData\\Roaming\\" or ProcessCommandLine contains "\\ProgramData\\" or ProcessCommandLine contains "\\Users\\Public\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_ntlm_coercion.yml
Potential NTLM Coercion Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -syncwithWU " and ProcessCommandLine contains " \\\\") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_nltest_recon.yml
Potential Recon Activity Via Nltest.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\nltest.exe" or ProcessVersionInfoOriginalFileName =~ "nltestrk.exe") and ((ProcessCommandLine contains "server" and ProcessCommandLine contains "query") or (ProcessCommandLine contains "/user" or ProcessCommandLine contains "all_trusts" or ProcessCommandLine contains "dclist:" or ProcessCommandLine contains "dnsgetdc:" or ProcessCommandLine contains "domain_trusts" or ProcessCommandLine contains "dsgetdc:" or ProcessCommandLine contains "parentdomain" or ProcessCommandLine contains "trusted_domains"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_setspn_spn_enumeration.yml
Potential SPN Enumeration Via Setspn.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -q " or ProcessCommandLine contains " /q ") and (FolderPath endswith "\\setspn.exe" or ProcessVersionInfoOriginalFileName =~ "setspn.exe" or (ProcessVersionInfoFileDescription contains "Query or reset the computer" and ProcessVersionInfoFileDescription contains "SPN attribute"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_computer_discovery_get_adcomputer.yml
Computer Discovery And Export Via Get-ADComputer Cmdlet ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " > " or ProcessCommandLine contains " | Select " or ProcessCommandLine contains "Out-File" or ProcessCommandLine contains "Set-Content" or ProcessCommandLine contains "Add-Content") and (ProcessCommandLine contains "Get-ADComputer " and ProcessCommandLine contains " -Filter *")) and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hh_chm_execution.yml
HH.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".chm" and (ProcessVersionInfoOriginalFileName =~ "HH.exe" or FolderPath endswith "\\hh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_arbitrary_cli_download.yml
Potential Arbitrary File Download Using Office Application ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and ((FolderPath endswith "\\EXCEL.EXE" or FolderPath endswith "\\POWERPNT.EXE" or FolderPath endswith "\\WINWORD.exe") or (ProcessVersionInfoOriginalFileName in~ ("Excel.exe", "POWERPNT.EXE", "WinWord.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_service_creation.yml
Suspicious New Service Creation ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "New-Service" and ProcessCommandLine contains "-BinaryPathName") or ((ProcessCommandLine contains "create" and ProcessCommandLine contains "binPath=") and FolderPath endswith "\\sc.exe")) and (ProcessCommandLine contains "powershell" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "svchost" or ProcessCommandLine contains "dllhost" or ProcessCommandLine contains "cmd " or ProcessCommandLine contains "cmd.exe /c" or ProcessCommandLine contains "cmd.exe /k" or ProcessCommandLine contains "cmd.exe /r" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "C:\\Users\\Public" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\" or ProcessCommandLine contains "C:\\Windows\\TEMP\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_service_path_modification.yml
Suspicious Service Path Modification ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "powershell" or ProcessCommandLine contains "cmd " or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "svchost" or ProcessCommandLine contains "dllhost" or ProcessCommandLine contains "cmd.exe /c" or ProcessCommandLine contains "cmd.exe /k" or ProcessCommandLine contains "cmd.exe /r" or ProcessCommandLine contains "cmd /c" or ProcessCommandLine contains "cmd /k" or ProcessCommandLine contains "cmd /r" or ProcessCommandLine contains "C:\\Users\\Public" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\" or ProcessCommandLine contains "C:\\Windows\\TEMP\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp") and (ProcessCommandLine contains "config" and ProcessCommandLine contains "binPath") and FolderPath endswith "\\sc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_fsi_fsharp_code_execution.yml
Use of FSharp Interpreters ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\fsi.exe" or FolderPath endswith "\\fsianycpu.exe") or (ProcessVersionInfoOriginalFileName in~ ("fsi.exe", "fsianycpu.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_set_rule.yml
Firewall Rule Update Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " firewall " and ProcessCommandLine contains " set ") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_scrcons_susp_child_process.yml
Script Event Consumer Spawning Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\dllhost.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\msbuild.exe") and InitiatingProcessFolderPath endswith "\\scrcons.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hh_html_help_susp_child_process.yml
HTML Help HH.EXE Suspicious Child Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\CertReq.exe" or FolderPath endswith "\\CertUtil.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\installutil.exe" or FolderPath endswith "\\MSbuild.exe" or FolderPath endswith "\\MSHTA.EXE" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\hh.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_csexec.yml
PUA - CsExec Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\csexec.exe" or ProcessVersionInfoFileDescription =~ "csexec"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_file_characteristics.yml
Suspicious File Characteristics Due to Missing Fields ---> KQL Query:
DeviceProcessEvents
| where ((ProcessVersionInfoFileDescription =~ "?" and ProcessVersionInfoProductVersion =~ "?") or (ProcessVersionInfoFileDescription =~ "?" and ProcessVersionInfoProductName =~ "?") or (ProcessVersionInfoCompanyName =~ "?" and ProcessVersionInfoFileDescription =~ "?")) and FolderPath contains "\\Downloads\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ksetup_password_change_computer.yml
Computer Password Change Via Ksetup.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /setcomputerpassword " and (FolderPath endswith "\\ksetup.exe" or ProcessVersionInfoOriginalFileName =~ "ksetup.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_format_uncommon_filesystem_load.yml
Uncommon FileSystem Load Attempt By Format.com ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/fs:" and FolderPath endswith "\\format.com") and (not((ProcessCommandLine contains "/fs:exFAT" or ProcessCommandLine contains "/fs:FAT" or ProcessCommandLine contains "/fs:NTFS" or ProcessCommandLine contains "/fs:ReFS" or ProcessCommandLine contains "/fs:UDF")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_download_office_domain.yml
Suspicious Download from Office Domain ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "https://attachment.outlook.live.net/owa/" or ProcessCommandLine contains "https://onenoteonlinesync.onenote.com/onenoteonlinesync/") and ((FolderPath endswith "\\curl.exe" or FolderPath endswith "\\wget.exe") or (ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "curl " or ProcessCommandLine contains "wget " or ProcessCommandLine contains "Start-BitsTransfer" or ProcessCommandLine contains ".DownloadFile(" or ProcessCommandLine contains ".DownloadString("))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_esentutl_params.yml
Esentutl Gather Credentials ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "esentutl" and ProcessCommandLine contains " /p"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd_patterns.yml
Suspicious PowerShell Encoded Command Patterns ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " JAB" or ProcessCommandLine contains " SUVYI" or ProcessCommandLine contains " SQBFAFgA" or ProcessCommandLine contains " aWV4I" or ProcessCommandLine contains " IAB" or ProcessCommandLine contains " PAA" or ProcessCommandLine contains " aQBlAHgA") and (ProcessCommandLine contains " -e " or ProcessCommandLine contains " -en " or ProcessCommandLine contains " -enc " or ProcessCommandLine contains " -enco") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.Exe", "pwsh.dll")))) and (not((InitiatingProcessFolderPath contains "C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\" or InitiatingProcessFolderPath contains "\\gc_worker.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_soundrecorder_audio_capture.yml
Audio Capture via SoundRecorder ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/FILE" and FolderPath endswith "\\SoundRecorder.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_via_cli.yml
Obfuscated IP Via CLI ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\ping.exe" or FolderPath endswith "\\arp.exe") and ((ProcessCommandLine contains " 0x" or ProcessCommandLine contains "//0x" or ProcessCommandLine contains ".0x" or ProcessCommandLine contains ".00x") or (ProcessCommandLine contains "http://%" and ProcessCommandLine contains "%2e") or (ProcessCommandLine matches regex "https?://[0-9]{1,3}\\.[0-9]{1,3}\\.0[0-9]{3,4}" or ProcessCommandLine matches regex "https?://[0-9]{1,3}\\.0[0-9]{3,7}" or ProcessCommandLine matches regex "https?://0[0-9]{3,11}" or ProcessCommandLine matches regex "https?://(0[0-9]{1,11}\\.){3}0[0-9]{1,11}" or ProcessCommandLine matches regex "https?://0[0-9]{1,11}" or ProcessCommandLine matches regex " [0-7]{7,13}")) and (not(ProcessCommandLine matches regex "https?://((25[0-5]|(2[0-4]|1\\d|[1-9])?\\d)(\\.|\\b)){4}"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_setup16_custom_lst_execution.yml
Setup16.EXE Execution With Custom .Lst File ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains " -m " and InitiatingProcessFolderPath =~ "C:\\Windows\\SysWOW64\\setup16.exe") and (not(FolderPath startswith "C:\\~MSSETUP.T\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regedit_trustedinstaller.yml
Regedit as Trusted Installer ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\regedit.exe" and (InitiatingProcessFolderPath endswith "\\TrustedInstaller.exe" or InitiatingProcessFolderPath endswith "\\ProcessHacker.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_java_manageengine_susp_child_process.yml
Suspicious Child Process Of Manage Engine ServiceDesk ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\AppVLP.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\calc.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\mftrace.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\notepad.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\query.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\scrcons.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe") and (InitiatingProcessFolderPath contains "\\ManageEngine\\ServiceDesk\\" and InitiatingProcessFolderPath contains "\\java.exe")) and (not((ProcessCommandLine contains " stop" and (FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_adfind_enumeration.yml
PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-sc admincountdmp" or ProcessCommandLine contains "-sc exchaddresses" or (ProcessCommandLine contains "lockoutduration" or ProcessCommandLine contains "lockoutthreshold" or ProcessCommandLine contains "lockoutobservationwindow" or ProcessCommandLine contains "maxpwdage" or ProcessCommandLine contains "minpwdage" or ProcessCommandLine contains "minpwdlength" or ProcessCommandLine contains "pwdhistorylength" or ProcessCommandLine contains "pwdproperties")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_taskmgr_susp_child_process.yml
New Process Created Via Taskmgr.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\taskmgr.exe" and (not((FolderPath endswith ":\\Windows\\System32\\mmc.exe" or FolderPath endswith ":\\Windows\\System32\\resmon.exe" or FolderPath endswith ":\\Windows\\System32\\Taskmgr.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_gpscript.yml
Gpscript Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " /logon" or ProcessCommandLine contains " /startup") and (FolderPath endswith "\\gpscript.exe" or ProcessVersionInfoOriginalFileName =~ "GPSCRIPT.EXE")) and (not(InitiatingProcessCommandLine =~ "C:\\windows\\system32\\svchost.exe -k netsvcs -p -s gpsvc"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_replace.yml
Replace.exe Usage ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\replace.exe" and (ProcessCommandLine contains "-a" or ProcessCommandLine contains "/a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "a" or ProcessCommandLine contains "a")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml
Sdclt Child Processes ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\sdclt.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_rubeus.yml
HackTool - Rubeus Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\Rubeus.exe" or ProcessVersionInfoOriginalFileName =~ "Rubeus.exe" or ProcessVersionInfoFileDescription =~ "Rubeus" or (ProcessCommandLine contains "asreproast " or ProcessCommandLine contains "dump /service:krbtgt " or ProcessCommandLine contains "dump /luid:0x" or ProcessCommandLine contains "kerberoast " or ProcessCommandLine contains "createnetonly /program:" or ProcessCommandLine contains "ptt /ticket:" or ProcessCommandLine contains "/impersonateuser:" or ProcessCommandLine contains "renew /ticket:" or ProcessCommandLine contains "asktgt /user:" or ProcessCommandLine contains "harvest /interval:" or ProcessCommandLine contains "s4u /user:" or ProcessCommandLine contains "s4u /ticket:" or ProcessCommandLine contains "hash /password:" or ProcessCommandLine contains "golden /aes256:" or ProcessCommandLine contains "silver /user:")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_icmluautil.yml
UAC Bypass via ICMLuaUtil ---> KQL Query:
DeviceProcessEvents
| where ((InitiatingProcessCommandLine contains "/Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}" or InitiatingProcessCommandLine contains "/Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}") and InitiatingProcessFolderPath endswith "\\dllhost.exe") and (not((FolderPath endswith "\\WerFault.exe" or ProcessVersionInfoOriginalFileName =~ "WerFault.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrm_awl_bypass.yml
AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "winrm" and ((ProcessCommandLine contains "format:pretty" or ProcessCommandLine contains "format:\"pretty\"" or ProcessCommandLine contains "format:\"text\"" or ProcessCommandLine contains "format:text") and (not((FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_exec.yml
Browser Execution In Headless Mode ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--headless" and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\vivaldi.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_susp_load_extension.yml
Suspicious Chromium Browser Instance Executed With Custom Extension ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--load-extension=" and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\vivaldi.exe") and (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_install_reg_debugger_backdoor.yml
Suspicious Debugger Registration Cmdline ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\CurrentVersion\\Image File Execution Options\\" and (ProcessCommandLine contains "sethc.exe" or ProcessCommandLine contains "utilman.exe" or ProcessCommandLine contains "osk.exe" or ProcessCommandLine contains "magnify.exe" or ProcessCommandLine contains "narrator.exe" or ProcessCommandLine contains "displayswitch.exe" or ProcessCommandLine contains "atbroker.exe" or ProcessCommandLine contains "HelpPane.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_redirect_local_admin_share.yml
Suspicious Redirection to Local Admin Share ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ">" and (ProcessCommandLine contains "\\\\127.0.0.1\\admin$\\" or ProcessCommandLine contains "\\\\localhost\\admin$\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_add_rule.yml
New Firewall Rule Added Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " firewall " and ProcessCommandLine contains " add ") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")) and (not(((ProcessCommandLine contains "advfirewall firewall add rule name=Dropbox dir=in action=allow \"program=" and ProcessCommandLine contains ":\\Program Files (x86)\\Dropbox\\Client\\Dropbox.exe\" enable=yes profile=Any") or (ProcessCommandLine contains "advfirewall firewall add rule name=Dropbox dir=in action=allow \"program=" and ProcessCommandLine contains ":\\Program Files\\Dropbox\\Client\\Dropbox.exe\" enable=yes profile=Any"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_data_exfiltration_via_cli.yml
Potential Data Exfiltration Activity Via CommandLine Tools ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "wget " or ProcessCommandLine contains "curl ") and (ProcessCommandLine contains " -ur" and ProcessCommandLine contains " -me" and ProcessCommandLine contains " -b" and ProcessCommandLine contains " POST ") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\cmd.exe")) or ((ProcessCommandLine contains "--ur" and FolderPath endswith "\\curl.exe") and (ProcessCommandLine contains " -d " or ProcessCommandLine contains " --data ")) or ((ProcessCommandLine contains "--post-data" or ProcessCommandLine contains "--post-file") and FolderPath endswith "\\wget.exe")) and ((ProcessCommandLine contains "Get-Content" or ProcessCommandLine contains "GetBytes" or ProcessCommandLine contains "hostname" or ProcessCommandLine contains "ifconfig" or ProcessCommandLine contains "ipconfig" or ProcessCommandLine contains "net view" or ProcessCommandLine contains "netstat" or ProcessCommandLine contains "nltest" or ProcessCommandLine contains "qprocess" or ProcessCommandLine contains "sc query" or ProcessCommandLine contains "systeminfo" or ProcessCommandLine contains "tasklist" or ProcessCommandLine contains "ToBase64String" or ProcessCommandLine contains "whoami") or (ProcessCommandLine contains "type " and ProcessCommandLine contains " > " and ProcessCommandLine contains " C:\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_instalutil_no_log_execution.yml
Suspicious Execution of InstallUtil Without Log ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/logfile= " and ProcessCommandLine contains "/LogToConsole=false") and FolderPath contains "Microsoft.NET\\Framework" and FolderPath endswith "\\InstallUtil.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_remote_debugging.yml
Browser Started with Remote Debugging ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " --remote-debugging-" or (ProcessCommandLine contains " -start-debugger-server" and FolderPath endswith "\\firefox.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_weak_or_abused_passwords.yml
Weak or Abused Passwords In CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "123456789" or ProcessCommandLine contains "123123qwE" or ProcessCommandLine contains "Asd123.aaaa" or ProcessCommandLine contains "Decryptme" or ProcessCommandLine contains "P@ssw0rd!" or ProcessCommandLine contains "Pass8080" or ProcessCommandLine contains "password123" or ProcessCommandLine contains "test@202"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml
Potential Persistence Attempt Via Run Keys Using Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "reg" and ProcessCommandLine contains " ADD " and ProcessCommandLine contains "Software\\Microsoft\\Windows\\CurrentVersion\\Run"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mssql_sqlps_susp_execution.yml
Detection of PowerShell Execution via Sqlps.exe ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\sqlps.exe" or ((FolderPath endswith "\\sqlps.exe" or ProcessVersionInfoOriginalFileName =~ "sqlps.exe") and (not(InitiatingProcessFolderPath endswith "\\sqlagent.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_sdelete.yml
Potential File Overwrite Via Sysinternals SDelete ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "sdelete.exe" and (not((ProcessCommandLine contains " -h" or ProcessCommandLine contains " -c" or ProcessCommandLine contains " -z" or ProcessCommandLine contains " /?")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_browsercore.yml
Renamed BrowserCore.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "BrowserCore.exe" and (not(FolderPath endswith "\\BrowserCore.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_volume.yml
System Disk And Volume Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "volume" or ProcessCommandLine contains "path win32_logicaldisk") and (FolderPath endswith "\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_priv_escalation_via_named_pipe.yml
Privilege Escalation via Named Pipe Impersonation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "echo" and ProcessCommandLine contains ">" and ProcessCommandLine contains "\\\\.\\pipe\\") and ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe") or (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "PowerShell.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_pressanykey.yml
Visual Studio NodejsTools PressAnyKey Renamed Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "Microsoft.NodejsTools.PressAnyKey.exe" and (not(FolderPath endswith "\\Microsoft.NodejsTools.PressAnyKey.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certoc_load_dll.yml
DLL Loaded via CertOC.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -LoadDLL " or ProcessCommandLine contains " /LoadDLL " or ProcessCommandLine contains " LoadDLL " or ProcessCommandLine contains " LoadDLL " or ProcessCommandLine contains " LoadDLL ") and (FolderPath endswith "\\certoc.exe" or ProcessVersionInfoOriginalFileName =~ "CertOC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysprep_appdata.yml
Sysprep on AppData Folder ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\AppData\\" and FolderPath endswith "\\sysprep.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_quarks_pwdump.yml
HackTool - Quarks PwDump Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine in~ (" -dhl", " --dump-hash-local", " -dhdc", " --dump-hash-domain-cached", " --dump-bitlocker", " -dhd ", " --dump-hash-domain ", "--ntds-file")) or FolderPath endswith "\\QuarksPwDump.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_direct_asep_registry_keys_modification.yml
Direct Autorun Keys Modification ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "add" and FolderPath endswith "\\reg.exe") and (ProcessCommandLine contains "\\software\\Microsoft\\Windows\\CurrentVersion\\Run" or ProcessCommandLine contains "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit" or ProcessCommandLine contains "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell" or ProcessCommandLine contains "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows" or ProcessCommandLine contains "\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders" or ProcessCommandLine contains "\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_com_cradles.yml
Potential COM Objects Download Cradles Usage - Process Creation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "[Type]::GetTypeFromCLSID(" and (ProcessCommandLine contains "0002DF01-0000-0000-C000-000000000046" or ProcessCommandLine contains "F6D90F16-9C73-11D3-B32E-00C04F990BB4" or ProcessCommandLine contains "F5078F35-C551-11D3-89B9-0000F81FE221" or ProcessCommandLine contains "88d96a0a-f192-11d4-a65f-0040963251e5" or ProcessCommandLine contains "AFBA6B42-5692-48EA-8141-DC517DCF0EF1" or ProcessCommandLine contains "AFB40FFD-B609-40A3-9828-F88BBE11E4E3" or ProcessCommandLine contains "88d96a0b-f192-11d4-a65f-0040963251e5" or ProcessCommandLine contains "2087c2f4-2cef-4953-a8ab-66779b670495" or ProcessCommandLine contains "000209FF-0000-0000-C000-000000000046" or ProcessCommandLine contains "00024500-0000-0000-C000-000000000046")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_obfuscation_via_utf8.yml
Potential PowerShell Obfuscation Via WCHAR ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "(WCHAR)0x"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_extrac32.yml
Suspicious Extrac32 Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".cab" and (ProcessCommandLine contains "extrac32.exe" or FolderPath endswith "\\extrac32.exe" or ProcessVersionInfoOriginalFileName =~ "extrac32.exe") and (ProcessCommandLine contains "/C" or ProcessCommandLine contains "/Y" or ProcessCommandLine contains " \\\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_net_use_and_exec_combo.yml
Suspicious File Execution From Internet Hosted WebDav Share ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " net use http" and ProcessCommandLine contains "& start /b " and ProcessCommandLine contains "\\DavWWWRoot\\") and (ProcessCommandLine contains ".exe " or ProcessCommandLine contains ".dll " or ProcessCommandLine contains ".bat " or ProcessCommandLine contains ".vbs " or ProcessCommandLine contains ".ps1 ") and (FolderPath contains "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_dumping_sensitive_hives.yml
Dumping of Sensitive Hives Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " save " or ProcessCommandLine contains " export " or ProcessCommandLine contains " ave " or ProcessCommandLine contains " eport ") and (ProcessCommandLine contains "\\system" or ProcessCommandLine contains "\\sam" or ProcessCommandLine contains "\\security" or ProcessCommandLine contains "\\ystem" or ProcessCommandLine contains "\\sytem" or ProcessCommandLine contains "\\ytem" or ProcessCommandLine contains "\\am" or ProcessCommandLine contains "\\ecurity") and (ProcessCommandLine contains "hklm" or ProcessCommandLine contains "hkm" or ProcessCommandLine contains "hkey_local_machine" or ProcessCommandLine contains "hkey_ocal_machine" or ProcessCommandLine contains "hkey_loca_machine" or ProcessCommandLine contains "hkey_oca_machine") and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_unicode_img.yml
Potential CommandLine Obfuscation Using Unicode Characters From Suspicious Image ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe") and (ProcessVersionInfoOriginalFileName in~ ("Cmd.EXE", "cscript.exe", "PowerShell.EXE", "pwsh.dll", "wscript.exe"))) and (ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_cloudflared.yml
Renamed Cloudflared.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-url" and ProcessCommandLine contains "tunnel") or ((ProcessCommandLine contains "-config " or ProcessCommandLine contains "-connector-id ") and (ProcessCommandLine contains " tunnel " and ProcessCommandLine contains "cleanup ")) or (SHA256 startswith "2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29" or SHA256 startswith "b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8" or SHA256 startswith "1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039" or SHA256 startswith "0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28" or SHA256 startswith "7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7" or SHA256 startswith "5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373" or SHA256 startswith "ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670" or SHA256 startswith "1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a" or SHA256 startswith "af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0" or SHA256 startswith "39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1" or SHA256 startswith "ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2" or SHA256 startswith "b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac" or SHA256 startswith "f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f" or SHA256 startswith "fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d" or SHA256 startswith "083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499" or SHA256 startswith "44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b" or SHA256 startswith "5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f" or SHA256 startswith "e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032" or SHA256 startswith "c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234" or SHA256 startswith "b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f" or SHA256 startswith "cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058" or SHA256 startswith "9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c" or SHA256 startswith "c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f" or SHA256 startswith "53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5" or SHA256 startswith "648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3" or SHA256 startswith "ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4" or SHA256 startswith "3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c" or SHA256 startswith "f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4" or SHA256 startswith "d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f" or SHA256 startswith "bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad" or SHA256 startswith "b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7" or SHA256 startswith "f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75" or SHA256 startswith "b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6" or SHA256 startswith "f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688" or SHA256 startswith "d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f" or SHA256 startswith "d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663" or SHA256 startswith "2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77" or SHA256 startswith "19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078") or ((ProcessCommandLine contains "-config " or ProcessCommandLine contains "-credentials-contents " or ProcessCommandLine contains "-credentials-file " or ProcessCommandLine contains "-token ") and (ProcessCommandLine contains " tunnel " and ProcessCommandLine contains " run "))) and (not((FolderPath endswith "\\cloudflared.exe" or FolderPath endswith "\\cloudflared-windows-386.exe" or FolderPath endswith "\\cloudflared-windows-amd64.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_svchost_termserv_proc_spawn.yml
Terminal Service Process Spawn ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains "\\svchost.exe" and InitiatingProcessCommandLine contains "termsvcs") and (not(((FolderPath endswith "\\rdpclip.exe" or FolderPath endswith ":\\Windows\\System32\\csrss.exe" or FolderPath endswith ":\\Windows\\System32\\wininit.exe" or FolderPath endswith ":\\Windows\\System32\\winlogon.exe") or isnull(FolderPath))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winget_add_susp_custom_source.yml
Add Potential Suspicious New Download Source To Winget ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "source " and ProcessCommandLine contains "add ") and (FolderPath endswith "\\winget.exe" or ProcessVersionInfoOriginalFileName =~ "winget.exe") and ProcessCommandLine matches regex "://\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_execution.yml
Visual Studio Code Tunnel Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".exe tunnel" and isnull(ProcessVersionInfoOriginalFileName)) or ((ProcessCommandLine contains "/d /c " and ProcessCommandLine contains "\\servers\\Stable-" and ProcessCommandLine contains "code-server.cmd") and FolderPath endswith "\\cmd.exe" and InitiatingProcessCommandLine endswith " tunnel") or (ProcessCommandLine contains ".exe tunnel" and ProcessCommandLine contains "--name " and ProcessCommandLine contains "--accept-server-license-terms")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_all_execution.yml
Enumerate All Information With Whoami.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -all" or ProcessCommandLine contains " /all" or ProcessCommandLine contains " all" or ProcessCommandLine contains " all" or ProcessCommandLine contains " all") and (FolderPath endswith "\\whoami.exe" or ProcessVersionInfoOriginalFileName =~ "whoami.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_trustedpath.yml
TrustedPath UAC Bypass Pattern ---> KQL Query:
DeviceProcessEvents
| where FolderPath contains "C:\\Windows \\System32\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_service.yml
Service Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "service" and (FolderPath endswith "\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml
Uninstall Crowdstrike Falcon Sensor ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\WindowsSensor.exe" and ProcessCommandLine contains " /uninstall" and ProcessCommandLine contains " /quiet"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cloudflared_quicktunnel_execution.yml
Cloudflared Quick Tunnel Execution ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\cloudflared.exe" or FolderPath endswith "\\cloudflared-windows-386.exe" or FolderPath endswith "\\cloudflared-windows-amd64.exe") or (SHA256 startswith "2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29" or SHA256 startswith "b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8" or SHA256 startswith "1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039" or SHA256 startswith "0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28" or SHA256 startswith "7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7" or SHA256 startswith "5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373" or SHA256 startswith "ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670" or SHA256 startswith "1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a" or SHA256 startswith "af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0" or SHA256 startswith "39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1" or SHA256 startswith "ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2" or SHA256 startswith "b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac" or SHA256 startswith "f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f" or SHA256 startswith "fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d" or SHA256 startswith "083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499" or SHA256 startswith "44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b" or SHA256 startswith "5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f" or SHA256 startswith "e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032" or SHA256 startswith "c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234" or SHA256 startswith "b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f" or SHA256 startswith "cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058" or SHA256 startswith "9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c" or SHA256 startswith "c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f" or SHA256 startswith "53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5" or SHA256 startswith "648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3" or SHA256 startswith "ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4" or SHA256 startswith "3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c" or SHA256 startswith "f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4" or SHA256 startswith "d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f" or SHA256 startswith "bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad" or SHA256 startswith "b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7" or SHA256 startswith "f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75" or SHA256 startswith "b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6" or SHA256 startswith "f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688" or SHA256 startswith "d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f" or SHA256 startswith "d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663" or SHA256 startswith "2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77" or SHA256 startswith "19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078")) and ((ProcessCommandLine contains "-url" and ProcessCommandLine contains "tunnel") or (ProcessCommandLine contains ".exe -url" or ProcessCommandLine contains ".exe --url"))) or (ProcessCommandLine contains "-url" and ProcessCommandLine contains "-no-autoupdate")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_office_processes.yml
Renamed Office Binary Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessVersionInfoOriginalFileName in~ ("Excel.exe", "MSACCESS.EXE", "MSPUB.EXE", "OneNote.exe", "OneNoteM.exe", "OUTLOOK.EXE", "POWERPNT.EXE", "WinWord.exe")) or (ProcessVersionInfoFileDescription in~ ("Microsoft Access", "Microsoft Excel", "Microsoft OneNote", "Microsoft Outlook", "Microsoft PowerPoint", "Microsoft Publisher", "Microsoft Word", "Sent to OneNote Tool"))) and (not((FolderPath endswith "\\EXCEL.exe" or FolderPath endswith "\\excelcnv.exe" or FolderPath endswith "\\MSACCESS.exe" or FolderPath endswith "\\MSPUB.EXE" or FolderPath endswith "\\ONENOTE.EXE" or FolderPath endswith "\\ONENOTEM.EXE" or FolderPath endswith "\\OUTLOOK.EXE" or FolderPath endswith "\\POWERPNT.EXE" or FolderPath endswith "\\WINWORD.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wbadmin_delete_backups.yml
Windows Backup Deleted Via Wbadmin.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "delete " and ProcessCommandLine contains "backup") and (FolderPath endswith "\\wbadmin.exe" or ProcessVersionInfoOriginalFileName =~ "WBADMIN.EXE")) and (not(ProcessCommandLine contains "keepVersions:0"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml
Reg Add Suspicious Paths ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\AppDataLow\\Software\\Microsoft\\" or ProcessCommandLine contains "\\Policies\\Microsoft\\Windows\\OOBE" or ProcessCommandLine contains "\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon" or ProcessCommandLine contains "\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon" or ProcessCommandLine contains "\\CurrentControlSet\\Control\\SecurityProviders\\WDigest" or ProcessCommandLine contains "\\Microsoft\\Windows Defender\\") and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_guid_task_name.yml
Suspicious Scheduled Task Name As GUID ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "}\"" or ProcessCommandLine contains "}'" or ProcessCommandLine contains "} ") and (ProcessCommandLine contains "/Create " and FolderPath endswith "\\schtasks.exe") and (ProcessCommandLine contains "/TN \"{" or ProcessCommandLine contains "/TN '{" or ProcessCommandLine contains "/TN {")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iis_connection_strings_decryption.yml
Microsoft IIS Connection Strings Decryption ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "connectionStrings" and ProcessCommandLine contains " -pdf") and (FolderPath endswith "\\aspnet_regiis.exe" or ProcessVersionInfoOriginalFileName =~ "aspnet_regiis.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_invocation_specific.yml
Suspicious PowerShell Invocations - Specific - ProcessCreation ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-nop" and ProcessCommandLine contains " -w " and ProcessCommandLine contains "hidden" and ProcessCommandLine contains " -c " and ProcessCommandLine contains "[Convert]::FromBase64String") or (ProcessCommandLine contains " -w " and ProcessCommandLine contains "hidden" and ProcessCommandLine contains "-ep" and ProcessCommandLine contains "bypass" and ProcessCommandLine contains "-Enc") or (ProcessCommandLine contains " -w " and ProcessCommandLine contains "hidden" and ProcessCommandLine contains "-noni" and ProcessCommandLine contains "-nop" and ProcessCommandLine contains " -c " and ProcessCommandLine contains "iex" and ProcessCommandLine contains "New-Object") or (ProcessCommandLine contains "iex" and ProcessCommandLine contains "New-Object" and ProcessCommandLine contains "Net.WebClient" and ProcessCommandLine contains ".Download") or (ProcessCommandLine contains "powershell" and ProcessCommandLine contains "reg" and ProcessCommandLine contains "add" and ProcessCommandLine contains "\\software\\") or (ProcessCommandLine contains "bypass" and ProcessCommandLine contains "-noprofile" and ProcessCommandLine contains "-windowstyle" and ProcessCommandLine contains "hidden" and ProcessCommandLine contains "new-object" and ProcessCommandLine contains "system.net.webclient" and ProcessCommandLine contains ".download")) and (not((ProcessCommandLine contains "(New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1" or ProcessCommandLine contains "Write-ChocolateyWarning")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_createminidump.yml
Unexpected Error processing 'HackTool - CreateMiniDump Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_createminidump.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_tttracer_mod_load.yml
Time Travel Debugging Utility Usage ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\tttracer.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regedit_import_keys.yml
Imports Registry Key From a File ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " /i " or ProcessCommandLine contains " /s " or ProcessCommandLine contains ".reg") and (FolderPath endswith "\\regedit.exe" or ProcessVersionInfoOriginalFileName =~ "REGEDIT.EXE")) and (not(((ProcessCommandLine contains " -e " or ProcessCommandLine contains " /e " or ProcessCommandLine contains " e " or ProcessCommandLine contains " e " or ProcessCommandLine contains " e " or ProcessCommandLine contains " -a " or ProcessCommandLine contains " /a " or ProcessCommandLine contains " a " or ProcessCommandLine contains " a " or ProcessCommandLine contains " a " or ProcessCommandLine contains " -c " or ProcessCommandLine contains " /c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c " or ProcessCommandLine contains " c ") and ProcessCommandLine matches regex ":[^ \\\\]")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_inline_vbs.yml
Suspicious Rundll32 Invoking Inline VBScript ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "rundll32.exe" and ProcessCommandLine contains "Execute" and ProcessCommandLine contains "RegRead" and ProcessCommandLine contains "window.close"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_spoolsv_susp_child_processes.yml
Suspicious Spool Service Child Process ---> KQL Query:
DeviceProcessEvents
| where ((ProcessIntegrityLevel in~ ("System", "S-1-16-16384")) and InitiatingProcessFolderPath endswith "\\spoolsv.exe") and ((FolderPath endswith "\\gpupdate.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\taskkill.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\taskmgr.exe" or FolderPath endswith "\\sc.exe" or FolderPath endswith "\\findstr.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\wget.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\accesschk.exe" or FolderPath endswith "\\wevtutil.exe" or FolderPath endswith "\\bcdedit.exe" or FolderPath endswith "\\fsutil.exe" or FolderPath endswith "\\cipher.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\write.exe" or FolderPath endswith "\\wuauclt.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\query.exe") or ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") and (not(ProcessCommandLine contains "start"))) or (FolderPath endswith "\\cmd.exe" and (not((ProcessCommandLine contains ".spl" or ProcessCommandLine contains "route add" or ProcessCommandLine contains "program files")))) or (FolderPath endswith "\\netsh.exe" and (not((ProcessCommandLine contains "add portopening" or ProcessCommandLine contains "rule name")))) or ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") and (not(ProcessCommandLine contains ".spl"))) or (ProcessCommandLine endswith "rundll32.exe" and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_shadowcopy_deletion.yml
Deletion of Volume Shadow Copies via WMI with PowerShell ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".Delete()" or ProcessCommandLine contains "Remove-WmiObject" or ProcessCommandLine contains "rwmi" or ProcessCommandLine contains "Remove-CimInstance" or ProcessCommandLine contains "rcim") and (ProcessCommandLine contains "Get-WmiObject" or ProcessCommandLine contains "gwmi" or ProcessCommandLine contains "Get-CimInstance" or ProcessCommandLine contains "gcim") and ProcessCommandLine contains "Win32_ShadowCopy"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_schedule_type_system.yml
Suspicious Schtasks Schedule Type With High Privileges ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe") and (ProcessCommandLine contains "NT AUT" or ProcessCommandLine contains " SYSTEM" or ProcessCommandLine contains "HIGHEST") and (ProcessCommandLine contains " ONLOGON " or ProcessCommandLine contains " ONSTART " or ProcessCommandLine contains " ONCE " or ProcessCommandLine contains " ONIDLE ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_http_logging.yml
Disable Windows IIS HTTP Logging ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "set" and ProcessCommandLine contains "config" and ProcessCommandLine contains "section:httplogging" and ProcessCommandLine contains "dontLog:true") and (FolderPath endswith "\\appcmd.exe" or ProcessVersionInfoOriginalFileName =~ "appcmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_fsutil_drive_enumeration.yml
Fsutil Drive Enumeration ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "drives" and (FolderPath endswith "\\fsutil.exe" or ProcessVersionInfoOriginalFileName =~ "fsutil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_remote_shell_.yml
Visual Studio Code Tunnel Shell Execution ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains ".vscode-server" and InitiatingProcessFolderPath contains "\\servers\\Stable-" and InitiatingProcessFolderPath endswith "\\server\\node.exe") and ((ProcessCommandLine contains "\\terminal\\browser\\media\\shellIntegration.ps1" and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) or (FolderPath endswith "\\wsl.exe" or FolderPath endswith "\\bash.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_user_discovery_get_aduser.yml
User Discovery And Export Via Get-ADUser Cmdlet ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " > " or ProcessCommandLine contains " | Select " or ProcessCommandLine contains "Out-File" or ProcessCommandLine contains "Set-Content" or ProcessCommandLine contains "Add-Content") and (ProcessCommandLine contains "Get-ADUser " and ProcessCommandLine contains " -Filter *")) and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_service_manipulation.yml
Service Started/Stopped Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "stopservice" or ProcessCommandLine contains "startservice") and (ProcessCommandLine contains " service " and ProcessCommandLine contains " call ")) and (ProcessVersionInfoOriginalFileName =~ "wmic.exe" or FolderPath endswith "\\WMIC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download_direct_ip.yml
Suspicious Download From Direct IP Via Bitsadmin ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "://1" or ProcessCommandLine contains "://2" or ProcessCommandLine contains "://3" or ProcessCommandLine contains "://4" or ProcessCommandLine contains "://5" or ProcessCommandLine contains "://6" or ProcessCommandLine contains "://7" or ProcessCommandLine contains "://8" or ProcessCommandLine contains "://9") and (ProcessCommandLine contains " /transfer " or ProcessCommandLine contains " /create " or ProcessCommandLine contains " /addfile ") and (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe")) and (not(ProcessCommandLine contains "://7-"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_accesschk_check_permissions.yml
Permission Check Via Accesschk.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "uwcqv " or ProcessCommandLine contains "kwsu " or ProcessCommandLine contains "qwsu " or ProcessCommandLine contains "uwdqs ") and (ProcessVersionInfoProductName endswith "AccessChk" or ProcessVersionInfoFileDescription contains "Reports effective permissions" or (FolderPath endswith "\\accesschk.exe" or FolderPath endswith "\\accesschk64.exe") or ProcessVersionInfoOriginalFileName =~ "accesschk.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_calc_uncommon_exec.yml
Suspicious Calculator Usage ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\calc.exe " or (FolderPath endswith "\\calc.exe" and (not((FolderPath contains ":\\Windows\\System32\\" or FolderPath contains ":\\Windows\\SysWOW64\\" or FolderPath contains ":\\Windows\\WinSxS\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_ads_stored_dll_execution.yml
Potential Rundll32 Execution With DLL Stored In ADS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "[Rr][Uu][Nn][Dd][Ll][Ll]32(\\.[Ee][Xx][Ee])? \\S+?\\w:\\S+?:" and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_rmdir_execution.yml
Directory Removal Via Rmdir ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/s" or ProcessCommandLine contains "/q") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe") and ProcessCommandLine contains "rmdir"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_plink.yml
Renamed Plink Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName =~ "Plink" or (ProcessCommandLine contains " -l forward" and ProcessCommandLine contains " -P " and ProcessCommandLine contains " -R ")) and (not(FolderPath endswith "\\plink.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml
File Download Via Bitsadmin ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe") and (ProcessCommandLine contains " /transfer " or ((ProcessCommandLine contains " /create " or ProcessCommandLine contains " /addfile ") and ProcessCommandLine contains "http"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_inline_win_api_access.yml
Potential WinAPI Calls Via CommandLine ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "AddSecurityPackage" or ProcessCommandLine contains "AdjustTokenPrivileges" or ProcessCommandLine contains "Advapi32" or ProcessCommandLine contains "CloseHandle" or ProcessCommandLine contains "CreateProcessWithToken" or ProcessCommandLine contains "CreatePseudoConsole" or ProcessCommandLine contains "CreateRemoteThread" or ProcessCommandLine contains "CreateThread" or ProcessCommandLine contains "CreateUserThread" or ProcessCommandLine contains "DangerousGetHandle" or ProcessCommandLine contains "DuplicateTokenEx" or ProcessCommandLine contains "EnumerateSecurityPackages" or ProcessCommandLine contains "FreeHGlobal" or ProcessCommandLine contains "FreeLibrary" or ProcessCommandLine contains "GetDelegateForFunctionPointer" or ProcessCommandLine contains "GetLogonSessionData" or ProcessCommandLine contains "GetModuleHandle" or ProcessCommandLine contains "GetProcAddress" or ProcessCommandLine contains "GetProcessHandle" or ProcessCommandLine contains "GetTokenInformation" or ProcessCommandLine contains "ImpersonateLoggedOnUser" or ProcessCommandLine contains "kernel32" or ProcessCommandLine contains "LoadLibrary" or ProcessCommandLine contains "memcpy" or ProcessCommandLine contains "MiniDumpWriteDump" or ProcessCommandLine contains "ntdll" or ProcessCommandLine contains "OpenDesktop" or ProcessCommandLine contains "OpenProcess" or ProcessCommandLine contains "OpenProcessToken" or ProcessCommandLine contains "OpenThreadToken" or ProcessCommandLine contains "OpenWindowStation" or ProcessCommandLine contains "PtrToString" or ProcessCommandLine contains "QueueUserApc" or ProcessCommandLine contains "ReadProcessMemory" or ProcessCommandLine contains "RevertToSelf" or ProcessCommandLine contains "RtlCreateUserThread" or ProcessCommandLine contains "secur32" or ProcessCommandLine contains "SetThreadToken" or ProcessCommandLine contains "VirtualAlloc" or ProcessCommandLine contains "VirtualFree" or ProcessCommandLine contains "VirtualProtect" or ProcessCommandLine contains "WaitForSingleObject" or ProcessCommandLine contains "WriteInt32" or ProcessCommandLine contains "WriteProcessMemory" or ProcessCommandLine contains "ZeroFreeGlobalAllocUnicode") and (not((((ProcessCommandLine contains "FreeHGlobal" or ProcessCommandLine contains "PtrToString" or ProcessCommandLine contains "kernel32" or ProcessCommandLine contains "CloseHandle") and InitiatingProcessFolderPath endswith "\\CompatTelRunner.exe") or (ProcessCommandLine contains "GetLoadLibraryWAddress32" and FolderPath endswith "\\MpCmdRun.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_enable_windows_recall.yml
Windows Recall Feature Enabled Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe") and (ProcessCommandLine contains "Microsoft\\Windows\\WindowsAI" and ProcessCommandLine contains "DisableAIDataAnalysis") and ((ProcessCommandLine contains "add" or ProcessCommandLine contains "0") or ProcessCommandLine contains "delete")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ultravnc.yml
Use of UltraVNC Remote Access Software ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "VNCViewer" or ProcessVersionInfoProductName =~ "UltraVNC VNCViewer" or ProcessVersionInfoCompanyName =~ "UltraVNC" or ProcessVersionInfoOriginalFileName =~ "VNCViewer.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_webdav_lnk_execution.yml
Potentially Suspicious WebDAV LNK Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\DavWWWRoot\\" and (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\explorer.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_ftp.yml
Renamed FTP.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "ftp.exe" and (not(FolderPath endswith "\\ftp.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_svchost_masqueraded_execution.yml
Suspicious Process Masquerading As SvcHost.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\svchost.exe" and (not(((FolderPath in~ ("C:\\Windows\\System32\\svchost.exe", "C:\\Windows\\SysWOW64\\svchost.exe")) or ProcessVersionInfoOriginalFileName =~ "svchost.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_archiver_iso_phishing.yml
Phishing Pattern ISO in Archive ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\isoburn.exe" or FolderPath endswith "\\PowerISO.exe" or FolderPath endswith "\\ImgBurn.exe") and (InitiatingProcessFolderPath endswith "\\Winrar.exe" or InitiatingProcessFolderPath endswith "\\7zFM.exe" or InitiatingProcessFolderPath endswith "\\peazip.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_psr_capture_screenshots.yml
Screen Capture Activity Via Psr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/start" or ProcessCommandLine contains "-start") and FolderPath endswith "\\Psr.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dfsvc_suspicious_child_processes.yml
Potentially Suspicious Child Process Of ClickOnce Application ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\explorer.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\notepad.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\werfault.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath contains "\\AppData\\Local\\Apps\\2.0\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winget_local_install_via_manifest.yml
Install New Package Via Winget Local Manifest ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\winget.exe" or ProcessVersionInfoOriginalFileName =~ "winget.exe") and (ProcessCommandLine contains "install" or ProcessCommandLine contains " add ") and (ProcessCommandLine contains "-m " or ProcessCommandLine contains "--manifest")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_csc_susp_dynamic_compilation.yml
Dynamic .NET Compilation Via Csc.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\csc.exe" and ((ProcessCommandLine contains ":\\Perflogs\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\Temporary Internet" or ProcessCommandLine contains "\\Windows\\Temp\\") or ((ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favorites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favourites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Contacts\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Pictures\\")) or ProcessCommandLine matches regex "([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\\\[Aa]pp[Dd]ata\\\\([Ll]ocal([Ll]ow)?|[Rr]oaming))\\\\[^\\\\]{1,256}$") and (not(((InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\") or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\sdiagnhost.exe" or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\inetsrv\\w3wp.exe"))) and (not(((InitiatingProcessCommandLine contains "JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw" or InitiatingProcessCommandLine contains "cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA" or InitiatingProcessCommandLine contains "nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA") or (InitiatingProcessFolderPath in~ ("C:\\ProgramData\\chocolatey\\choco.exe", "C:\\ProgramData\\chocolatey\\tools\\shimgen.exe")) or InitiatingProcessCommandLine contains "\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cloudflared_portable_execution.yml
Cloudflared Portable Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\cloudflared.exe" and (not((FolderPath contains ":\\Program Files (x86)\\cloudflared\\" or FolderPath contains ":\\Program Files\\cloudflared\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes.yml
Suspicious Outlook Child Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\AppVLP.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\hh.exe" or FolderPath endswith "\\mftrace.exe" or FolderPath endswith "\\msbuild.exe" or FolderPath endswith "\\msdt.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\scrcons.exe" or FolderPath endswith "\\scriptrunner.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\OUTLOOK.EXE"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_certreq_download.yml
Suspicious Certreq Command to Download ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -Post " and ProcessCommandLine contains " -config " and ProcessCommandLine contains " http" and ProcessCommandLine contains " C:\\windows\\win.ini ") and (FolderPath endswith "\\certreq.exe" or ProcessVersionInfoOriginalFileName =~ "CertReq.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_susp_execution.yml
Suspicious WebDav Client Execution Via Rundll32.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "C:\\windows\\system32\\davclnt.dll,DavSetCookie" and ProcessCommandLine matches regex "://\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}" and FolderPath endswith "\\rundll32.exe" and InitiatingProcessCommandLine contains "-s WebClient" and InitiatingProcessFolderPath endswith "\\svchost.exe") and (not((ProcessCommandLine contains "://10." or ProcessCommandLine contains "://192.168." or ProcessCommandLine contains "://172.16." or ProcessCommandLine contains "://172.17." or ProcessCommandLine contains "://172.18." or ProcessCommandLine contains "://172.19." or ProcessCommandLine contains "://172.20." or ProcessCommandLine contains "://172.21." or ProcessCommandLine contains "://172.22." or ProcessCommandLine contains "://172.23." or ProcessCommandLine contains "://172.24." or ProcessCommandLine contains "://172.25." or ProcessCommandLine contains "://172.26." or ProcessCommandLine contains "://172.27." or ProcessCommandLine contains "://172.28." or ProcessCommandLine contains "://172.29." or ProcessCommandLine contains "://172.30." or ProcessCommandLine contains "://172.31." or ProcessCommandLine contains "://127." or ProcessCommandLine contains "://169.254.")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_werfault_lsass_shtinkering.yml
Potential Credential Dumping Via WER ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " -u -p " and ProcessCommandLine contains " -ip " and ProcessCommandLine contains " -s ") and (InitiatingProcessAccountName contains "AUTHORI" or InitiatingProcessAccountName contains "AUTORI") and (AccountName contains "AUTHORI" or AccountName contains "AUTORI")) and (FolderPath endswith "\\Werfault.exe" or ProcessVersionInfoOriginalFileName =~ "WerFault.exe")) and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\lsass.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_adfind.yml
Unexpected Error processing 'Renamed AdFind Execution' (sigma/rules/windows/process_creation/proc_creation_win_renamed_adfind.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_automated_collection.yml
Automated Collection Command Prompt ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".doc" or ProcessCommandLine contains ".docx" or ProcessCommandLine contains ".xls" or ProcessCommandLine contains ".xlsx" or ProcessCommandLine contains ".ppt" or ProcessCommandLine contains ".pptx" or ProcessCommandLine contains ".rtf" or ProcessCommandLine contains ".pdf" or ProcessCommandLine contains ".txt") and ((ProcessCommandLine contains "dir " and ProcessCommandLine contains " /b " and ProcessCommandLine contains " /s ") or ((ProcessCommandLine contains " /e " or ProcessCommandLine contains " /si ") and ProcessVersionInfoOriginalFileName =~ "FINDSTR.EXE"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_export_certificate.yml
Certificate Exported Via PowerShell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Export-PfxCertificate " or ProcessCommandLine contains "Export-Certificate "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vscode_tunnel_renamed_execution.yml
Renamed Visual Studio Code Tunnel Execution ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine endswith ".exe tunnel" and isnull(ProcessVersionInfoOriginalFileName)) or (ProcessCommandLine contains ".exe tunnel" and ProcessCommandLine contains "--name " and ProcessCommandLine contains "--accept-server-license-terms") or (ProcessCommandLine contains "tunnel " and ProcessCommandLine contains "service" and ProcessCommandLine contains "internal-run" and ProcessCommandLine contains "tunnel-service.log")) and (not((FolderPath endswith "\\code-tunnel.exe" or FolderPath endswith "\\code.exe")))) or (((ProcessCommandLine contains "/d /c " and ProcessCommandLine contains "\\servers\\Stable-" and ProcessCommandLine contains "code-server.cmd") and FolderPath endswith "\\cmd.exe" and InitiatingProcessCommandLine endswith " tunnel") and (not((InitiatingProcessFolderPath endswith "\\code-tunnel.exe" or InitiatingProcessFolderPath endswith "\\code.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gpg4win_encryption.yml
File Encryption Using Gpg4win ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c " and ProcessCommandLine contains "passphrase") and ((FolderPath endswith "\\gpg.exe" or FolderPath endswith "\\gpg2.exe") or ProcessVersionInfoFileDescription =~ "GnuPGs OpenPGP tool")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_software_discovery.yml
Detected Windows Software Discovery ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "query" and ProcessCommandLine contains "\\software\\" and ProcessCommandLine contains "/v" and ProcessCommandLine contains "svcversion") and FolderPath endswith "\\reg.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_insecure_porxy_or_doh.yml
Insecure Proxy/DOH Transfer Via Curl.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--doh-insecure" or ProcessCommandLine contains "--proxy-insecure") and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_secedit_execution.yml
Potential Suspicious Activity Using SeCEdit ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\secedit.exe" or ProcessVersionInfoOriginalFileName =~ "SeCEdit") and ((ProcessCommandLine contains "/configure" and ProcessCommandLine contains "/db") or (ProcessCommandLine contains "/export" and ProcessCommandLine contains "/cfg"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_delete_services.yml
Service Registry Key Deleted Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " delete " and (FolderPath endswith "reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe") and ProcessCommandLine contains "\\SYSTEM\\CurrentControlSet\\services\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_wsudo_susp_execution.yml
PUA - Wsudo Suspicious Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-u System" or ProcessCommandLine contains "-uSystem" or ProcessCommandLine contains "-u TrustedInstaller" or ProcessCommandLine contains "-uTrustedInstaller" or ProcessCommandLine contains " --ti ") or (FolderPath endswith "\\wsudo.exe" or ProcessVersionInfoOriginalFileName =~ "wsudo.exe" or ProcessVersionInfoFileDescription =~ "Windows sudo utility" or InitiatingProcessFolderPath endswith "\\wsudo-bridge.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wscript_cscript_dropper.yml
Potential Dropper Script Execution Via WScript/CScript ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe") and (ProcessCommandLine contains ".js" or ProcessCommandLine contains ".jse" or ProcessCommandLine contains ".vba" or ProcessCommandLine contains ".vbe" or ProcessCommandLine contains ".vbs" or ProcessCommandLine contains ".wsf") and (ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Tmp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_schedule_type.yml
Suspicious Schtasks Schedule Types ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe") and (ProcessCommandLine contains " ONLOGON " or ProcessCommandLine contains " ONSTART " or ProcessCommandLine contains " ONCE " or ProcessCommandLine contains " ONIDLE ")) and (not((ProcessCommandLine contains "NT AUT" or ProcessCommandLine contains " SYSTEM" or ProcessCommandLine contains "HIGHEST")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_localpotato.yml
Unexpected Error processing 'HackTool - LocalPotato Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_localpotato.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_homoglyph_cyrillic_lookalikes.yml
Potential Homoglyph Attack Using Lookalike Characters ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "") or (ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "" or ProcessCommandLine contains "")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ssh_proxy_execution.yml
Program Executed Using Proxy/Local Command Via SSH.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\OpenSSH\\sshd.exe" or ((ProcessCommandLine contains "ProxyCommand=" or (ProcessCommandLine contains "PermitLocalCommand" and ProcessCommandLine contains "LocalCommand")) and FolderPath endswith "\\ssh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wlrmdr_uncommon_child_process.yml
Wlrmdr.EXE Uncommon Argument Or Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\wlrmdr.exe" or ((((ProcessCommandLine contains "-s " or ProcessCommandLine contains "/s " or ProcessCommandLine contains "s " or ProcessCommandLine contains "s " or ProcessCommandLine contains "s ") and (ProcessCommandLine contains "-f " or ProcessCommandLine contains "/f " or ProcessCommandLine contains "f " or ProcessCommandLine contains "f " or ProcessCommandLine contains "f ") and (ProcessCommandLine contains "-t " or ProcessCommandLine contains "/t " or ProcessCommandLine contains "t " or ProcessCommandLine contains "t " or ProcessCommandLine contains "t ") and (ProcessCommandLine contains "-m " or ProcessCommandLine contains "/m " or ProcessCommandLine contains "m " or ProcessCommandLine contains "m " or ProcessCommandLine contains "m ") and (ProcessCommandLine contains "-a " or ProcessCommandLine contains "/a " or ProcessCommandLine contains "a " or ProcessCommandLine contains "a " or ProcessCommandLine contains "a ") and (ProcessCommandLine contains "-u " or ProcessCommandLine contains "/u " or ProcessCommandLine contains "u " or ProcessCommandLine contains "u " or ProcessCommandLine contains "u ")) and (FolderPath endswith "\\wlrmdr.exe" or ProcessVersionInfoOriginalFileName =~ "WLRMNDR.EXE")) and (not(((InitiatingProcessFolderPath in~ ("", "-")) or isnull(InitiatingProcessFolderPath) or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\winlogon.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dsquery_domain_trust_discovery.yml
Domain Trust Discovery Via Dsquery ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "trustedDomain" and (FolderPath endswith "\\dsquery.exe" or ProcessVersionInfoOriginalFileName =~ "dsquery.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_change.yml
Suspicious Modification Of Scheduled Tasks ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " /Change " and ProcessCommandLine contains " /TN ") and FolderPath endswith "\\schtasks.exe") and (ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "cmd /c " or ProcessCommandLine contains "cmd /k " or ProcessCommandLine contains "cmd /r " or ProcessCommandLine contains "cmd.exe /c " or ProcessCommandLine contains "cmd.exe /k " or ProcessCommandLine contains "cmd.exe /r " or ProcessCommandLine contains "powershell" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "certutil" or ProcessCommandLine contains "bitsadmin" or ProcessCommandLine contains "bash.exe" or ProcessCommandLine contains "bash " or ProcessCommandLine contains "scrcons" or ProcessCommandLine contains "wmic " or ProcessCommandLine contains "wmic.exe" or ProcessCommandLine contains "forfiles" or ProcessCommandLine contains "scriptrunner" or ProcessCommandLine contains "hh.exe" or ProcessCommandLine contains "hh ") and (ProcessCommandLine contains "\\AppData\\Local\\Temp" or ProcessCommandLine contains "\\AppData\\Roaming\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\WINDOWS\\Temp\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Temporary Internet" or ProcessCommandLine contains "C:\\ProgramData\\" or ProcessCommandLine contains "C:\\Perflogs\\" or ProcessCommandLine contains "%ProgramData%" or ProcessCommandLine contains "%appdata%" or ProcessCommandLine contains "%comspec%" or ProcessCommandLine contains "%localappdata%")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_privileged_group.yml
User Added To Highly Privileged Group ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Group Policy Creator Owners" or ProcessCommandLine contains "Schema Admins") and ((ProcessCommandLine contains "localgroup " and ProcessCommandLine contains " /add") or (ProcessCommandLine contains "Add-LocalGroupMember " and ProcessCommandLine contains " -Group "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nimgrab.yml
PUA - Nimgrab Execution ---> KQL Query:
DeviceProcessEvents
| where (MD5 startswith "2DD44C3C29D667F5C0EF5F9D7C7FFB8B" or SHA256 startswith "F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559") or FolderPath endswith "\\nimgrab.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_execution.yml
Psexec Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\psexec.exe" or ProcessVersionInfoOriginalFileName =~ "psexec.c"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_ntdllpipe_redirect.yml
NtdllPipe Like Activity Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "type %windir%\\system32\\ntdll.dll" or ProcessCommandLine contains "type %systemroot%\\system32\\ntdll.dll" or ProcessCommandLine contains "type c:\\windows\\system32\\ntdll.dll" or ProcessCommandLine contains "\\ntdll.dll > \\\\.\\pipe\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_notepad_local_passwd_discovery.yml
Notepad Password Files Discovery ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "password" and ProcessCommandLine contains ".txt") or (ProcessCommandLine contains "password" and ProcessCommandLine contains ".csv") or (ProcessCommandLine contains "password" and ProcessCommandLine contains ".doc") or (ProcessCommandLine contains "password" and ProcessCommandLine contains ".xls")) and FolderPath endswith "\\notepad.exe" and InitiatingProcessFolderPath endswith "\\explorer.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk.yml
Remote Access Tool - AnyDesk Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\AnyDesk.exe" or FolderPath endswith "\\AnyDeskMSI.exe") or ProcessVersionInfoFileDescription =~ "AnyDesk" or ProcessVersionInfoProductName =~ "AnyDesk" or ProcessVersionInfoCompanyName =~ "AnyDesk Software GmbH"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_clip.yml
Invoke-Obfuscation CLIP+ Launcher ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/c" or ProcessCommandLine contains "/r") and (ProcessCommandLine contains "cmd" and ProcessCommandLine contains "&&" and ProcessCommandLine contains "clipboard]::" and ProcessCommandLine contains "-f")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_use_of_vsjitdebugger_bin.yml
Malicious PE Execution by Microsoft Visual Studio Debugger ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\vsjitdebugger.exe" and (not(((FolderPath contains "\\vsimmersiveactivatehelper" and FolderPath contains ".exe") or FolderPath endswith "\\devenv.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_java_keytool_susp_child_process.yml
Suspicious Shells Spawn by Java Utility Keytool ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\scrcons.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\hh.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\scriptrunner.exe" or FolderPath endswith "\\mftrace.exe" or FolderPath endswith "\\AppVLP.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\query.exe") and InitiatingProcessFolderPath endswith "\\keytool.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrar_susp_child_process.yml
Potentially Suspicious Child Process Of WinRAR.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "cscript.exe", "mshta.exe", "PowerShell.EXE", "pwsh.dll", "regsvr32.exe", "RUNDLL32.EXE", "wscript.exe"))) and InitiatingProcessFolderPath endswith "\\WinRAR.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_inline_vbscript.yml
Wscript Shell Run In CommandLine ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Wscript." and ProcessCommandLine contains ".Shell" and ProcessCommandLine contains ".Run"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_amsi_init_failed_bypass.yml
Potential AMSI Bypass Via .NET Reflection ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "System.Management.Automation.AmsiUtils" and ProcessCommandLine contains "amsiInitFailed") or (ProcessCommandLine contains "[Ref].Assembly.GetType" and ProcessCommandLine contains "SetValue($null,$true)" and ProcessCommandLine contains "NonPublic,Static")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_no_params.yml
Rundll32 Execution Without CommandLine Parameters ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "\\rundll32.exe" or ProcessCommandLine endswith "\\rundll32.exe\"" or ProcessCommandLine endswith "\\rundll32") and (not((InitiatingProcessFolderPath contains "\\AppData\\Local\\" or InitiatingProcessFolderPath contains "\\Microsoft\\Edge\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_hydra.yml
HackTool - Hydra Password Bruteforce Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "^USER^" or ProcessCommandLine contains "^PASS^") and (ProcessCommandLine contains "-u " and ProcessCommandLine contains "-p ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_script_engine_parent.yml
Sigma Transformation Error for 'Suspicious PowerShell Invocation From Script Engines': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_path_traversal.yml
Potential CommandLine Path Traversal Via Cmd.EXE ---> KQL Query:
DeviceProcessEvents
| where (((InitiatingProcessCommandLine contains "/c" or InitiatingProcessCommandLine contains "/k" or InitiatingProcessCommandLine contains "/r") or (ProcessCommandLine contains "/c" or ProcessCommandLine contains "/k" or ProcessCommandLine contains "/r")) and (InitiatingProcessFolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "cmd.exe") and (InitiatingProcessCommandLine =~ "/../../" or ProcessCommandLine contains "/../../")) and (not(ProcessCommandLine contains "\\Tasktop\\keycloak\\bin\\/../../jre\\bin\\java"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_edrsilencer.yml
HackTool - EDRSilencer Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\EDRSilencer.exe" or ProcessVersionInfoOriginalFileName =~ "EDRSilencer.exe" or ProcessVersionInfoFileDescription contains "EDRSilencer"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_desktopimgdownldr_susp_execution.yml
Suspicious Desktopimgdownldr Command ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /lockscreenurl:" and (not((ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".png")))) or (ProcessCommandLine contains "reg delete" and ProcessCommandLine contains "\\PersonalizationCSP")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_execution_from_public_folder_as_parent.yml
Potentially Suspicious Execution From Parent Process In Public Folder ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (ProcessCommandLine contains "bitsadmin" or ProcessCommandLine contains "certutil" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "powershell" or ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "wscript")) and InitiatingProcessFolderPath contains ":\\Users\\Public\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_execute_dll.yml
Suspicious Msiexec Execute Arbitrary DLL ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -y" or ProcessCommandLine contains " /y" or ProcessCommandLine contains " y" or ProcessCommandLine contains " y" or ProcessCommandLine contains " y") and FolderPath endswith "\\msiexec.exe") and (not((ProcessCommandLine contains "\\MsiExec.exe\" /Y \"C:\\Program Files\\Bonjour\\mdnsNSP.dll" or ProcessCommandLine contains "\\MsiExec.exe\" /Y \"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll" or ProcessCommandLine contains "\\MsiExec.exe\" /Y \"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll" or ProcessCommandLine contains "\\MsiExec.exe\" /Y \"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll" or ProcessCommandLine contains "\\MsiExec.exe\" /Y \"C:\\Windows\\CCM\\" or ProcessCommandLine contains "\\MsiExec.exe\" /Y C:\\Windows\\CCM\\" or ProcessCommandLine contains "\\MsiExec.exe\" -Y \"C:\\Program Files\\Bonjour\\mdnsNSP.dll" or ProcessCommandLine contains "\\MsiExec.exe\" -Y \"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll" or ProcessCommandLine contains "\\MsiExec.exe\" -Y \"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll" or ProcessCommandLine contains "\\MsiExec.exe\" -Y \"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll" or ProcessCommandLine contains "\\MsiExec.exe\" -Y \"C:\\Windows\\CCM\\" or ProcessCommandLine contains "\\MsiExec.exe\" -Y C:\\Windows\\CCM\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml
UAC Bypass Using NTFS Reparse Point - Process ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "\\AppData\\Local\\Temp\\update.msu" and ProcessCommandLine startswith "\"C:\\Windows\\system32\\wusa.exe\"  /quiet C:\\Users\\" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288"))) or ((ProcessCommandLine contains "C:\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\Temp\\" and ProcessCommandLine contains "\\dismhost.exe {") and FolderPath endswith "\\DismHost.exe" and (ProcessIntegrityLevel in~ ("High", "System")) and InitiatingProcessCommandLine =~ "\"C:\\Windows\\system32\\dism.exe\" /online /quiet /norestart /add-package /packagepath:\"C:\\Windows\\system32\\pe386\" /ignorecheck")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vmware_vmtoolsd_susp_child_process.yml
VMToolsd Suspicious Child Process ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "cscript.exe", "MSHTA.EXE", "PowerShell.EXE", "pwsh.dll", "REGSVR32.EXE", "RUNDLL32.EXE", "wscript.exe"))) and InitiatingProcessFolderPath endswith "\\vmtoolsd.exe") and (not(((ProcessCommandLine =~ "" and FolderPath endswith "\\cmd.exe") or (isnull(ProcessCommandLine) and FolderPath endswith "\\cmd.exe") or ((ProcessCommandLine contains "\\VMware\\VMware Tools\\poweron-vm-default.bat" or ProcessCommandLine contains "\\VMware\\VMware Tools\\poweroff-vm-default.bat" or ProcessCommandLine contains "\\VMware\\VMware Tools\\resume-vm-default.bat" or ProcessCommandLine contains "\\VMware\\VMware Tools\\suspend-vm-default.bat") and FolderPath endswith "\\cmd.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_set_service_disabled.yml
Service StartupType Change Via PowerShell Set-Service ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "Disabled" or ProcessCommandLine contains "Manual") and (ProcessCommandLine contains "Set-Service" and ProcessCommandLine contains "-StartupType")) and (FolderPath endswith "\\powershell.exe" or ProcessVersionInfoOriginalFileName =~ "PowerShell.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_logon_script.yml
Potential Persistence Via Logon Scripts - CommandLine ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "UserInitMprLogonScript"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_nircmd.yml
Renamed NirCmd.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "NirCmd.exe" and (not((FolderPath endswith "\\nircmd.exe" or FolderPath endswith "\\nircmdc.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mpcmdrun_dll_sideload_defender.yml
Potential Mpclient.DLL Sideloading Via Defender Binaries ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\MpCmdRun.exe" or FolderPath endswith "\\NisSrv.exe") and (not((FolderPath startswith "C:\\Program Files (x86)\\Windows Defender\\" or FolderPath startswith "C:\\Program Files\\Microsoft Security Client\\" or FolderPath startswith "C:\\Program Files\\Windows Defender\\" or FolderPath startswith "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\" or FolderPath startswith "C:\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_set_unsecure_powershell_policy.yml
Potential PowerShell Execution Policy Tampering - ProcCreation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy" or ProcessCommandLine contains "\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy") and (ProcessCommandLine contains "Bypass" or ProcessCommandLine contains "RemoteSigned" or ProcessCommandLine contains "Unrestricted")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ssm_agent_abuse.yml
Potential Amazon SSM Agent Hijacking ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-register " and ProcessCommandLine contains "-code " and ProcessCommandLine contains "-id " and ProcessCommandLine contains "-region ") and FolderPath endswith "\\amazon-ssm-agent.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_local_file_read.yml
Local File Read Using Curl.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "file:///" and (FolderPath endswith "\\curl.exe" or ProcessVersionInfoOriginalFileName =~ "curl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_chisel.yml
HackTool - SharpChisel Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\SharpChisel.exe" or ProcessVersionInfoProductName =~ "SharpChisel"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_network_sniffing.yml
Potential Network Sniffing Activity Using Network Tools ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-i" and FolderPath endswith "\\tshark.exe") or FolderPath endswith "\\windump.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_reverse_shell_connection.yml
Potential Powershell ReverseShell Connection ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " Net.Sockets.TCPClient" and ProcessCommandLine contains ".GetStream(" and ProcessCommandLine contains ".Write(") and ((ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")) or (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_enable_susp_windows_optional_feature.yml
Potential Suspicious Windows Feature Enabled - ProcCreation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Enable-WindowsOptionalFeature" and ProcessCommandLine contains "-Online" and ProcessCommandLine contains "-FeatureName") and (ProcessCommandLine contains "TelnetServer" or ProcessCommandLine contains "Internet-Explorer-Optional-amd64" or ProcessCommandLine contains "TFTP" or ProcessCommandLine contains "SMB1Protocol" or ProcessCommandLine contains "Client-ProjFS" or ProcessCommandLine contains "Microsoft-Windows-Subsystem-Linux")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_curl_susp_download.yml
Suspicious Curl.EXE Download ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\curl.exe" or ProcessVersionInfoProductName =~ "The curl executable") and ((ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".gif" or ProcessCommandLine endswith ".jpeg" or ProcessCommandLine endswith ".jpg" or ProcessCommandLine endswith ".png" or ProcessCommandLine endswith ".temp" or ProcessCommandLine endswith ".tmp" or ProcessCommandLine endswith ".txt" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbs") or (ProcessCommandLine contains "%AppData%" or ProcessCommandLine contains "%Public%" or ProcessCommandLine contains "%Temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains "\\AppData\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Temp\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "C:\\PerfLogs\\" or ProcessCommandLine contains "C:\\ProgramData\\" or ProcessCommandLine contains "C:\\Windows\\Temp\\")) and (not(((ProcessCommandLine contains "--silent --show-error --output " and ProcessCommandLine contains "gfw-httpget-" and ProcessCommandLine contains "AppData") and FolderPath =~ "C:\\Program Files\\Git\\mingw64\\bin\\curl.exe" and InitiatingProcessFolderPath =~ "C:\\Program Files\\Git\\usr\\bin\\sh.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_recon_pipe_output.yml
Recon Command Output Piped To Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ipconfig" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find") or (ProcessCommandLine contains "net" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find") or (ProcessCommandLine contains "netstat" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find") or (ProcessCommandLine contains "ping" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find") or (ProcessCommandLine contains "systeminfo" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find") or (ProcessCommandLine contains "tasklist" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find") or (ProcessCommandLine contains "whoami" and ProcessCommandLine contains "|" and ProcessCommandLine contains "find")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_ps_appdata.yml
PowerShell Script Run in AppData ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "powershell.exe" or ProcessCommandLine contains "\\powershell" or ProcessCommandLine contains "\\pwsh" or ProcessCommandLine contains "pwsh.exe") and ((ProcessCommandLine contains "Local\\" or ProcessCommandLine contains "Roaming\\") and (ProcessCommandLine contains "/c " and ProcessCommandLine contains "\\AppData\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_no_image_name.yml
Process Launched Without Image Name ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_patterns.yml
HackTool - CrackMapExec Process Patterns ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "cmd.exe /c " or ProcessCommandLine contains "cmd.exe /r " or ProcessCommandLine contains "cmd.exe /k " or ProcessCommandLine contains "cmd /c " or ProcessCommandLine contains "cmd /r " or ProcessCommandLine contains "cmd /k ") and (ProcessCommandLine contains "tasklist /fi " and ProcessCommandLine contains "Imagename eq lsass.exe") and (AccountName contains "AUTHORI" or AccountName contains "AUTORI")) or (ProcessCommandLine contains "do rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump" and ProcessCommandLine contains "\\Windows\\Temp\\" and ProcessCommandLine contains " full" and ProcessCommandLine contains "%%B") or (ProcessCommandLine contains "tasklist /v /fo csv" and ProcessCommandLine contains "findstr /i \"lsass\"")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_use_password_plaintext.yml
Password Provided In Command Line Of Net.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " use " and (ProcessCommandLine contains ":" and ProcessCommandLine contains "\\") and (ProcessCommandLine contains "/USER:" and ProcessCommandLine contains " ")) and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))) and (not(ProcessCommandLine endswith " "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_logman_disable_eventlog.yml
Suspicious Windows Trace ETW Session Tamper Via Logman.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "stop " or ProcessCommandLine contains "delete ") and (FolderPath endswith "\\logman.exe" or ProcessVersionInfoOriginalFileName =~ "Logman.exe") and (ProcessCommandLine contains "Circular Kernel Context Logger" or ProcessCommandLine contains "EventLog-" or ProcessCommandLine contains "SYSMON TRACE" or ProcessCommandLine contains "SysmonDnsEtwSession")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_mavinject.yml
Renamed Mavinject.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName in~ ("mavinject32.exe", "mavinject64.exe")) and (not((FolderPath endswith "\\mavinject32.exe" or FolderPath endswith "\\mavinject64.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_download_file_sharing_domains.yml
Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "urlcache " or ProcessCommandLine contains "verifyctl ") and (ProcessCommandLine contains ".githubusercontent.com" or ProcessCommandLine contains "anonfiles.com" or ProcessCommandLine contains "cdn.discordapp.com" or ProcessCommandLine contains "ddns.net" or ProcessCommandLine contains "dl.dropboxusercontent.com" or ProcessCommandLine contains "ghostbin.co" or ProcessCommandLine contains "glitch.me" or ProcessCommandLine contains "gofile.io" or ProcessCommandLine contains "hastebin.com" or ProcessCommandLine contains "mediafire.com" or ProcessCommandLine contains "mega.nz" or ProcessCommandLine contains "onrender.com" or ProcessCommandLine contains "pages.dev" or ProcessCommandLine contains "paste.ee" or ProcessCommandLine contains "pastebin.com" or ProcessCommandLine contains "pastebin.pl" or ProcessCommandLine contains "pastetext.net" or ProcessCommandLine contains "privatlab.com" or ProcessCommandLine contains "privatlab.net" or ProcessCommandLine contains "send.exploit.in" or ProcessCommandLine contains "sendspace.com" or ProcessCommandLine contains "storage.googleapis.com" or ProcessCommandLine contains "storjshare.io" or ProcessCommandLine contains "supabase.co" or ProcessCommandLine contains "temp.sh" or ProcessCommandLine contains "transfer.sh" or ProcessCommandLine contains "trycloudflare.com" or ProcessCommandLine contains "ufile.io" or ProcessCommandLine contains "w3spaces.com" or ProcessCommandLine contains "workers.dev") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_spawn_exe_from_users_directory.yml
Suspicious Binary In User Directory Spawned From Office Application ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith ".exe" and FolderPath startswith "C:\\users\\" and (InitiatingProcessFolderPath endswith "\\WINWORD.EXE" or InitiatingProcessFolderPath endswith "\\EXCEL.EXE" or InitiatingProcessFolderPath endswith "\\POWERPNT.exe" or InitiatingProcessFolderPath endswith "\\MSPUB.exe" or InitiatingProcessFolderPath endswith "\\VISIO.exe" or InitiatingProcessFolderPath endswith "\\MSACCESS.exe" or InitiatingProcessFolderPath endswith "\\EQNEDT32.exe")) and (not(FolderPath endswith "\\Teams.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_selectmyparent.yml
Unexpected Error processing 'HackTool - PPID Spoofing SelectMyParent Tool Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_selectmyparent.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_impersonation.yml
HackTool - SharpImpersonation Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " user:" and ProcessCommandLine contains " binary:") or (ProcessCommandLine contains " user:" and ProcessCommandLine contains " shellcode:") or (ProcessCommandLine contains " technique:CreateProcessAsUserW" or ProcessCommandLine contains " technique:ImpersonateLoggedOnuser")) or (FolderPath endswith "\\SharpImpersonation.exe" or ProcessVersionInfoOriginalFileName =~ "SharpImpersonation.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bcp_export_data.yml
Data Export From MSSQL Table Via BCP.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " out " or ProcessCommandLine contains " queryout ") and (FolderPath endswith "\\bcp.exe" or ProcessVersionInfoOriginalFileName =~ "BCP.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml
Esentutl Steals Browser Information ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-r" or ProcessCommandLine contains "/r" or ProcessCommandLine contains "r" or ProcessCommandLine contains "r" or ProcessCommandLine contains "r") and (FolderPath endswith "\\esentutl.exe" or ProcessVersionInfoOriginalFileName =~ "esentutl.exe") and ProcessCommandLine contains "\\Windows\\WebCache"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_frp.yml
PUA - Fast Reverse Proxy (FRP) Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\frpc.ini" or (MD5 startswith "7D9C233B8C9E3F0EA290D2B84593C842" or SHA1 startswith "06DDC9280E1F1810677935A2477012960905942F" or SHA256 startswith "57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C") or (FolderPath endswith "\\frpc.exe" or FolderPath endswith "\\frps.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_agentexecutor_potential_abuse.yml
AgentExecutor PowerShell Execution ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " -powershell" or ProcessCommandLine contains " -remediationScript") and (FolderPath =~ "\\AgentExecutor.exe" or ProcessVersionInfoOriginalFileName =~ "AgentExecutor.exe")) and (not(InitiatingProcessFolderPath endswith "\\Microsoft.Management.Services.IntuneWindowsAgent.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_deny_service_access.yml
Deny Service Access Using Security Descriptor Tampering Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe") and (ProcessCommandLine contains "sdset" and ProcessCommandLine contains "D;") and (ProcessCommandLine contains ";IU" or ProcessCommandLine contains ";SU" or ProcessCommandLine contains ";BA" or ProcessCommandLine contains ";SY" or ProcessCommandLine contains ";WD")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hh_susp_execution.yml
Suspicious HH.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName =~ "HH.exe" or FolderPath endswith "\\hh.exe") and (ProcessCommandLine contains ".application" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\Content.Outlook\\" or ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\Windows\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_port_forwarding_3389.yml
RDP Port Forwarding Rule Added Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " i" and ProcessCommandLine contains " p" and ProcessCommandLine contains "=3389" and ProcessCommandLine contains " c") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_mpiexec.yml
Unexpected Error processing 'MpiExec Lolbin' (sigma/rules/windows/process_creation/proc_creation_win_lolbin_mpiexec.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ntdsutil_susp_usage.yml
Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe) ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "snapshot" and ProcessCommandLine contains "mount ") or (ProcessCommandLine contains "ac" and ProcessCommandLine contains " i" and ProcessCommandLine contains " ntds")) and (FolderPath endswith "\\ntdsutil.exe" or ProcessVersionInfoOriginalFileName =~ "ntdsutil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_soaphound_execution.yml
HackTool - SOAPHound Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " --buildcache " or ProcessCommandLine contains " --bhdump " or ProcessCommandLine contains " --certdump " or ProcessCommandLine contains " --dnsdump ") and (ProcessCommandLine contains " -c " or ProcessCommandLine contains " --cachefilename " or ProcessCommandLine contains " -o " or ProcessCommandLine contains " --outputdirectory")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_gpp_passwords.yml
Findstr GPP Passwords ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "cpassword" and ProcessCommandLine contains "\\sysvol\\" and ProcessCommandLine contains ".xml") and ((FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe") or (ProcessVersionInfoOriginalFileName in~ ("FIND.EXE", "FINDSTR.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_eula_accepted.yml
Potential Execution of Sysinternals Tools ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -accepteula" or ProcessCommandLine contains " /accepteula" or ProcessCommandLine contains " accepteula" or ProcessCommandLine contains " accepteula" or ProcessCommandLine contains " accepteula"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_run_locations.yml
Suspicious Process Start Locations ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains ":\\RECYCLER\\" or FolderPath contains ":\\SystemVolumeInformation\\") or (FolderPath startswith "C:\\Windows\\Tasks\\" or FolderPath startswith "C:\\Windows\\debug\\" or FolderPath startswith "C:\\Windows\\fonts\\" or FolderPath startswith "C:\\Windows\\help\\" or FolderPath startswith "C:\\Windows\\drivers\\" or FolderPath startswith "C:\\Windows\\addins\\" or FolderPath startswith "C:\\Windows\\cursors\\" or FolderPath startswith "C:\\Windows\\system32\\tasks\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_obfusc.yml
Suspicious Obfuscated PowerShell Code ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "IAAtAGIAeABvAHIAIAAwAHgA" or ProcessCommandLine contains "AALQBiAHgAbwByACAAMAB4A" or ProcessCommandLine contains "gAC0AYgB4AG8AcgAgADAAeA" or ProcessCommandLine contains "AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg" or ProcessCommandLine contains "AuAEkAbgB2AG8AawBlACgAKQAgAHwAI" or ProcessCommandLine contains "ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC" or ProcessCommandLine contains "AHsAMQB9AHsAMAB9ACIAIAAtAGYAI" or ProcessCommandLine contains "B7ADEAfQB7ADAAfQAiACAALQBmAC" or ProcessCommandLine contains "AewAxAH0AewAwAH0AIgAgAC0AZgAg" or ProcessCommandLine contains "AHsAMAB9AHsAMwB9ACIAIAAtAGYAI" or ProcessCommandLine contains "B7ADAAfQB7ADMAfQAiACAALQBmAC" or ProcessCommandLine contains "AewAwAH0AewAzAH0AIgAgAC0AZgAg" or ProcessCommandLine contains "AHsAMgB9AHsAMAB9ACIAIAAtAGYAI" or ProcessCommandLine contains "B7ADIAfQB7ADAAfQAiACAALQBmAC" or ProcessCommandLine contains "AewAyAH0AewAwAH0AIgAgAC0AZgAg" or ProcessCommandLine contains "AHsAMQB9AHsAMAB9ACcAIAAtAGYAI" or ProcessCommandLine contains "B7ADEAfQB7ADAAfQAnACAALQBmAC" or ProcessCommandLine contains "AewAxAH0AewAwAH0AJwAgAC0AZgAg" or ProcessCommandLine contains "AHsAMAB9AHsAMwB9ACcAIAAtAGYAI" or ProcessCommandLine contains "B7ADAAfQB7ADMAfQAnACAALQBmAC" or ProcessCommandLine contains "AewAwAH0AewAzAH0AJwAgAC0AZgAg" or ProcessCommandLine contains "AHsAMgB9AHsAMAB9ACcAIAAtAGYAI" or ProcessCommandLine contains "B7ADIAfQB7ADAAfQAnACAALQBmAC" or ProcessCommandLine contains "AewAyAH0AewAwAH0AJwAgAC0AZgAg"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_clip_execution.yml
Data Copied To Clipboard Via Clip.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\clip.exe" or ProcessVersionInfoOriginalFileName =~ "clip.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_rewrite_rule.yml
Suspicious IIS URL GlobalRules Rewrite Via AppCmd ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "set" and ProcessCommandLine contains "config" and ProcessCommandLine contains "section:system.webServer/rewrite/globalRules" and ProcessCommandLine contains "commit:") and (FolderPath endswith "\\appcmd.exe" or ProcessVersionInfoOriginalFileName =~ "appcmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mmc_susp_child_process.yml
MMC Spawning Windows Shell ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\mmc.exe" and ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\regsvr32.exe") or FolderPath contains "\\BITSADMIN")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msohtmed_download.yml
Arbitrary File Download Via MSOHTMED.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ftp://" or ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\MSOHTMED.exe" or ProcessVersionInfoOriginalFileName =~ "MsoHtmEd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tar_compression.yml
Compressed File Creation Via Tar.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-c" or ProcessCommandLine contains "-r" or ProcessCommandLine contains "-u") and (FolderPath endswith "\\tar.exe" or ProcessVersionInfoOriginalFileName =~ "bsdtar")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dns_exfiltration_tools_execution.yml
DNS Exfiltration and Tunneling Tools Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\iodine.exe" or FolderPath contains "\\dnscat2"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_conhost_path_traversal.yml
Conhost.exe CommandLine Path Traversal ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/../../" and InitiatingProcessCommandLine contains "conhost"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bcdedit_susp_execution.yml
Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "delete" or ProcessCommandLine contains "deletevalue" or ProcessCommandLine contains "import" or ProcessCommandLine contains "safeboot" or ProcessCommandLine contains "network") and (FolderPath endswith "\\bcdedit.exe" or ProcessVersionInfoOriginalFileName =~ "bcdedit.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml
HackTool - Mimikatz Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "::aadcookie" or ProcessCommandLine contains "::detours" or ProcessCommandLine contains "::memssp" or ProcessCommandLine contains "::mflt" or ProcessCommandLine contains "::ncroutemon" or ProcessCommandLine contains "::ngcsign" or ProcessCommandLine contains "::printnightmare" or ProcessCommandLine contains "::skeleton" or ProcessCommandLine contains "::preshutdown" or ProcessCommandLine contains "::mstsc" or ProcessCommandLine contains "::multirdp") or (ProcessCommandLine contains "rpc::" or ProcessCommandLine contains "token::" or ProcessCommandLine contains "crypto::" or ProcessCommandLine contains "dpapi::" or ProcessCommandLine contains "sekurlsa::" or ProcessCommandLine contains "kerberos::" or ProcessCommandLine contains "lsadump::" or ProcessCommandLine contains "privilege::" or ProcessCommandLine contains "process::" or ProcessCommandLine contains "vault::") or (ProcessCommandLine contains "DumpCreds" or ProcessCommandLine contains "mimikatz")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_launch_vsdevshell.yml
Launch-VsDevShell.PS1 Proxy Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "VsWherePath " or ProcessCommandLine contains "VsInstallationPath ") and ProcessCommandLine contains "Launch-VsDevShell.ps1"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_remote_desktop_tunneling.yml
Potential Remote Desktop Tunneling ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ":3389" and (ProcessCommandLine contains " -L " or ProcessCommandLine contains " -P " or ProcessCommandLine contains " -R " or ProcessCommandLine contains " -pw " or ProcessCommandLine contains " -ssh ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_one_time_only_midnight_task.yml
Uncommon One Time Only Scheduled Task At 00:00 ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "wscript" or ProcessCommandLine contains "vbscript" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "wmic " or ProcessCommandLine contains "wmic.exe" or ProcessCommandLine contains "regsvr32.exe" or ProcessCommandLine contains "powershell" or ProcessCommandLine contains "\\AppData\\") and (FolderPath contains "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe") and (ProcessCommandLine contains "once" and ProcessCommandLine contains "00:00")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_system.yml
Schtasks Creation Or Modification With SYSTEM Privileges ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " /change " or ProcessCommandLine contains " /create ") and FolderPath endswith "\\schtasks.exe") and ProcessCommandLine contains "/ru " and (ProcessCommandLine contains "NT AUT" or ProcessCommandLine contains " SYSTEM ")) and (not(((ProcessCommandLine contains "/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR " or ProcessCommandLine contains ":\\Program Files (x86)\\Avira\\System Speedup\\setup\\avira_speedup_setup.exe" or ProcessCommandLine contains "/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART\" /RL HIGHEST") or (ProcessCommandLine contains "Subscription Heartbeat" and ProcessCommandLine contains "\\HeartbeatConfig.xml" and ProcessCommandLine contains "\\Microsoft Shared\\OFFICE") or ((ProcessCommandLine contains "/TN TVInstallRestore" and ProcessCommandLine contains "\\TeamViewer_.exe") and FolderPath endswith "\\schtasks.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_driver_installed_by_pnputil.yml
Suspicious Driver Install by pnputil.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-i" or ProcessCommandLine contains "/install" or ProcessCommandLine contains "-a" or ProcessCommandLine contains "/add-driver" or ProcessCommandLine contains ".inf") and FolderPath endswith "\\pnputil.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_register_app.yml
REGISTER_APP.VBS Proxy Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\register_app.vbs" and ProcessCommandLine contains "-register"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_ie4uinit.yml
Sigma Transformation Error for 'Ie4uinit Lolbin Use From Invalid Path': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_addinutil_uncommon_dir_exec.yml
AddinUtil.EXE Execution From Uncommon Directory ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\addinutil.exe" or ProcessVersionInfoOriginalFileName =~ "AddInUtil.exe") and (not((FolderPath contains ":\\Windows\\Microsoft.NET\\Framework\\" or FolderPath contains ":\\Windows\\Microsoft.NET\\Framework64\\" or FolderPath contains ":\\Windows\\WinSxS\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml
Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -l" or ProcessCommandLine contains " /l" or ProcessCommandLine contains " l" or ProcessCommandLine contains " l" or ProcessCommandLine contains " l") and (FolderPath endswith "\\cmdkey.exe" or ProcessVersionInfoOriginalFileName =~ "cmdkey.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_dumpert.yml
HackTool - Dumpert Process Dumper Execution ---> KQL Query:
DeviceProcessEvents
| where MD5 startswith "09D278F9DE118EF09163C6140255C690" or ProcessCommandLine contains "Dumpert.dll"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_idiagnostic_profile.yml
UAC Bypass Using IDiagnostic Profile ---> KQL Query:
DeviceProcessEvents
| where (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and InitiatingProcessCommandLine contains " /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}" and InitiatingProcessFolderPath endswith "\\DllHost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_downgrade_attack.yml
Potential PowerShell Downgrade Attack ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -version 2 " or ProcessCommandLine contains " -versio 2 " or ProcessCommandLine contains " -versi 2 " or ProcessCommandLine contains " -vers 2 " or ProcessCommandLine contains " -ver 2 " or ProcessCommandLine contains " -ve 2 " or ProcessCommandLine contains " -v 2 ") and FolderPath endswith "\\powershell.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certoc_download.yml
File Download via CertOC.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-GetCACAPS" and ProcessCommandLine contains "http") and (FolderPath endswith "\\certoc.exe" or ProcessVersionInfoOriginalFileName =~ "CertOC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml
Netsh Allow Group Policy on Microsoft Defender Firewall ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "advfirewall" and ProcessCommandLine contains "firewall" and ProcessCommandLine contains "set" and ProcessCommandLine contains "rule" and ProcessCommandLine contains "group=" and ProcessCommandLine contains "new" and ProcessCommandLine contains "enable=Yes") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_web_request_cmd_and_cmdlets.yml
Usage Of Web Request Commands And Cmdlets ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "[System.Net.WebRequest]::create" or ProcessCommandLine contains "curl " or ProcessCommandLine contains "Invoke-RestMethod" or ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "Net.WebClient" or ProcessCommandLine contains "Resume-BitsTransfer" or ProcessCommandLine contains "Start-BitsTransfer" or ProcessCommandLine contains "wget " or ProcessCommandLine contains "WinHttp.WinHttpRequest"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml
Potential Defense Evasion Via Rename Of Highly Relevant Binaries ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoFileDescription =~ "Execute processes remotely" or ProcessVersionInfoProductName =~ "Sysinternals PsExec" or (ProcessVersionInfoFileDescription startswith "Windows PowerShell" or ProcessVersionInfoFileDescription startswith "pwsh") or (ProcessVersionInfoOriginalFileName in~ ("certutil.exe", "cmstp.exe", "cscript.exe", "IE4UINIT.EXE", "mshta.exe", "msiexec.exe", "msxsl.exe", "powershell_ise.exe", "powershell.exe", "psexec.c", "psexec.exe", "psexesvc.exe", "pwsh.dll", "reg.exe", "regsvr32.exe", "rundll32.exe", "WerMgr", "wmic.exe", "wscript.exe"))) and (not((FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmstp.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\ie4uinit.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\msxsl.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\psexec.exe" or FolderPath endswith "\\psexec64.exe" or FolderPath endswith "\\PSEXESVC.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wermgr.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_simple_help.yml
Remote Access Tool - Simple Help Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "\\JWrapper-Remote Access\\" or FolderPath contains "\\JWrapper-Remote Support\\") and FolderPath endswith "\\SimpleService.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml
Potential Tampering With RDP Related Registry Keys Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " add " and ProcessCommandLine contains "\\CurrentControlSet\\Control\\Terminal Server" and ProcessCommandLine contains "REG_DWORD" and ProcessCommandLine contains " /f") and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")) and ((ProcessCommandLine contains "Licensing Core" and ProcessCommandLine contains "EnableConcurrentSessions") or (ProcessCommandLine contains "WinStations\\RDP-Tcp" or ProcessCommandLine contains "MaxInstanceCount" or ProcessCommandLine contains "fEnableWinStation" or ProcessCommandLine contains "TSUserEnabled" or ProcessCommandLine contains "TSEnabled" or ProcessCommandLine contains "TSAppCompat" or ProcessCommandLine contains "IdleWinStationPoolCount" or ProcessCommandLine contains "TSAdvertise" or ProcessCommandLine contains "AllowTSConnections" or ProcessCommandLine contains "fSingleSessionPerUser" or ProcessCommandLine contains "fDenyTSConnections"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader_encoded.yml
Scheduled Task Executing Encoded Payload from Registry ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/Create" and (ProcessCommandLine contains "FromBase64String" or ProcessCommandLine contains "encodedcommand") and (ProcessCommandLine contains "Get-ItemProperty" or ProcessCommandLine contains " gp ") and (ProcessCommandLine contains "HKCU:" or ProcessCommandLine contains "HKLM:" or ProcessCommandLine contains "registry::" or ProcessCommandLine contains "HKEY_") and (FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_sdset_modification.yml
Service Security Descriptor Tampering Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "sdset" and (FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_virtualbox_execution.yml
Detect Virtualbox Driver Installation OR Starting Of VMs ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "VBoxRT.dll,RTR3Init" or ProcessCommandLine contains "VBoxC.dll" or ProcessCommandLine contains "VBoxDrv.sys") or (ProcessCommandLine contains "startvm" or ProcessCommandLine contains "controlvm")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_teams_suspicious_command_line_cred_access.yml
Potentially Suspicious Command Targeting Teams Sensitive Files ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\Microsoft\\Teams\\Cookies" or ProcessCommandLine contains "\\Microsoft\\Teams\\Local Storage\\leveldb") and (not(FolderPath endswith "\\Microsoft\\Teams\\current\\Teams.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_process_dump_via_comsvcs.yml
Process Memory Dump Via Comsvcs.DLL ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE" or ProcessCommandLine contains "rundll32") and ((ProcessCommandLine contains "#-" or ProcessCommandLine contains "#+" or ProcessCommandLine contains "#24" or ProcessCommandLine contains "24 " or ProcessCommandLine contains "MiniDump" or ProcessCommandLine contains "#65560") and (ProcessCommandLine contains "comsvcs" and ProcessCommandLine contains "full"))) or ((ProcessCommandLine contains " #" or ProcessCommandLine contains ",#" or ProcessCommandLine contains ", #" or ProcessCommandLine contains "\"#") and (ProcessCommandLine contains "24" and ProcessCommandLine contains "comsvcs" and ProcessCommandLine contains "full"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_htran_or_natbypass.yml
HackTool - Htran/NATBypass Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".exe -tran " or ProcessCommandLine contains ".exe -slave ") or (FolderPath endswith "\\htran.exe" or FolderPath endswith "\\lcx.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_uacme.yml
Unexpected Error processing 'HackTool - UACMe Akagi Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_uacme.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_delete_rule.yml
Firewall Rule Deleted Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "firewall" and ProcessCommandLine contains "delete ") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")) and (not((ProcessCommandLine contains "name=Dropbox" and InitiatingProcessFolderPath endswith "\\Dropbox.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_sam_access.yml
PowerShell SAM Copy ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\HarddiskVolumeShadowCopy" and ProcessCommandLine contains "System32\\config\\sam") and (ProcessCommandLine contains "Copy-Item" or ProcessCommandLine contains "cp $_." or ProcessCommandLine contains "cpi $_." or ProcessCommandLine contains "copy $_." or ProcessCommandLine contains ".File]::Copy(")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_bad_opsec_sacrificial_processes.yml
Bad Opsec Defaults Sacrificial Processes With Improper Arguments ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine endswith "regasm.exe" and FolderPath endswith "\\regasm.exe") or (ProcessCommandLine endswith "regsvcs.exe" and FolderPath endswith "\\regsvcs.exe") or (ProcessCommandLine endswith "regsvr32.exe" and FolderPath endswith "\\regsvr32.exe") or (ProcessCommandLine endswith "rundll32.exe" and FolderPath endswith "\\rundll32.exe") or (ProcessCommandLine endswith "WerFault.exe" and FolderPath endswith "\\WerFault.exe")) and (not(((ProcessCommandLine endswith "rundll32.exe" and FolderPath endswith "\\rundll32.exe" and InitiatingProcessCommandLine contains "--uninstall " and (InitiatingProcessFolderPath contains "\\AppData\\Local\\BraveSoftware\\Brave-Browser\\Application\\" or InitiatingProcessFolderPath contains "\\AppData\\Local\\Google\\Chrome\\Application\\") and InitiatingProcessFolderPath endswith "\\Installer\\setup.exe") or (ProcessCommandLine endswith "rundll32.exe" and FolderPath endswith "\\rundll32.exe" and InitiatingProcessFolderPath contains "\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_ntlmrelay.yml
Suspicious NTLM Authentication on the Printer Spooler Service ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "spoolss" or ProcessCommandLine contains "srvsvc" or ProcessCommandLine contains "/print/pipe/") and (ProcessCommandLine contains "C:\\windows\\system32\\davclnt.dll,DavSetCookie" and ProcessCommandLine contains "http")) and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_privilege_escalation_cli_patterns.yml
Suspicious RunAs-Like Flag Combination ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -c cmd" or ProcessCommandLine contains " -c \"cmd" or ProcessCommandLine contains " -c powershell" or ProcessCommandLine contains " -c \"powershell" or ProcessCommandLine contains " --command cmd" or ProcessCommandLine contains " --command powershell" or ProcessCommandLine contains " -c whoami" or ProcessCommandLine contains " -c wscript" or ProcessCommandLine contains " -c cscript") and (ProcessCommandLine contains " -u system " or ProcessCommandLine contains " --user system " or ProcessCommandLine contains " -u NT" or ProcessCommandLine contains " -u \"NT" or ProcessCommandLine contains " -u 'NT" or ProcessCommandLine contains " --system " or ProcessCommandLine contains " -u administrator ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_persistence_windows_telemetry.yml
Potential Persistence Via Microsoft Compatibility Appraiser ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "run " and ProcessCommandLine contains "\\Application Experience\\Microsoft Compatibility Appraiser") and (FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml
Suspicious Windows Defender Registry Key Tampering Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe") and (ProcessCommandLine contains "SOFTWARE\\Microsoft\\Windows Defender\\" or ProcessCommandLine contains "SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center" or ProcessCommandLine contains "SOFTWARE\\Policies\\Microsoft\\Windows Defender\\")) and (((ProcessCommandLine contains "DisallowExploitProtectionOverride" or ProcessCommandLine contains "EnableControlledFolderAccess" or ProcessCommandLine contains "MpEnablePus" or ProcessCommandLine contains "PUAProtection" or ProcessCommandLine contains "SpynetReporting" or ProcessCommandLine contains "SubmitSamplesConsent" or ProcessCommandLine contains "TamperProtection") and (ProcessCommandLine contains " add " and ProcessCommandLine contains "d 0")) or ((ProcessCommandLine contains "DisableAntiSpyware" or ProcessCommandLine contains "DisableAntiSpywareRealtimeProtection" or ProcessCommandLine contains "DisableAntiVirus" or ProcessCommandLine contains "DisableArchiveScanning" or ProcessCommandLine contains "DisableBehaviorMonitoring" or ProcessCommandLine contains "DisableBlockAtFirstSeen" or ProcessCommandLine contains "DisableConfig" or ProcessCommandLine contains "DisableEnhancedNotifications" or ProcessCommandLine contains "DisableIntrusionPreventionSystem" or ProcessCommandLine contains "DisableIOAVProtection" or ProcessCommandLine contains "DisableOnAccessProtection" or ProcessCommandLine contains "DisablePrivacyMode" or ProcessCommandLine contains "DisableRealtimeMonitoring" or ProcessCommandLine contains "DisableRoutinelyTakingAction" or ProcessCommandLine contains "DisableScanOnRealtimeEnable" or ProcessCommandLine contains "DisableScriptScanning" or ProcessCommandLine contains "Notification_Suppress" or ProcessCommandLine contains "SignatureDisableUpdateOnStartupWithoutEngine") and (ProcessCommandLine contains " add " and ProcessCommandLine contains "d 1")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_elavated_msi_spawned_shell.yml
Always Install Elevated MSI Spawned Cmd And Powershell ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "PowerShell.EXE", "pwsh.dll"))) and ((InitiatingProcessFolderPath contains "\\Windows\\Installer\\" and InitiatingProcessFolderPath contains "msi") and InitiatingProcessFolderPath endswith "tmp")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_explorer_folder_shortcut_via_shell_binary.yml
File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "shell:mycomputerfolder" and FolderPath endswith "\\explorer.exe" and (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_recycle_bin_fake_execution.yml
Suspicious Process Execution From Fake Recycle.Bin Folder ---> KQL Query:
DeviceProcessEvents
| where FolderPath contains "RECYCLERS.BIN\\" or FolderPath contains "RECYCLER.BIN\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_spawn_explorer.yml
RunDLL32 Spawning Explorer ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\explorer.exe" and InitiatingProcessFolderPath endswith "\\rundll32.exe") and (not(InitiatingProcessCommandLine contains "\\shell32.dll,Control_RunDLL"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_hiding_malware_in_fonts_folder.yml
Writing Of Malicious Files To The Fonts Folder ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "echo" or ProcessCommandLine contains "copy" or ProcessCommandLine contains "type" or ProcessCommandLine contains "file createnew" or ProcessCommandLine contains "cacls") and ProcessCommandLine contains "C:\\Windows\\Fonts\\" and (ProcessCommandLine contains ".sh" or ProcessCommandLine contains ".exe" or ProcessCommandLine contains ".dll" or ProcessCommandLine contains ".bin" or ProcessCommandLine contains ".bat" or ProcessCommandLine contains ".cmd" or ProcessCommandLine contains ".js" or ProcessCommandLine contains ".msh" or ProcessCommandLine contains ".reg" or ProcessCommandLine contains ".scr" or ProcessCommandLine contains ".ps" or ProcessCommandLine contains ".vb" or ProcessCommandLine contains ".jar" or ProcessCommandLine contains ".pl" or ProcessCommandLine contains ".inf" or ProcessCommandLine contains ".cpl" or ProcessCommandLine contains ".hta" or ProcessCommandLine contains ".msi" or ProcessCommandLine contains ".vbs")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_citrix_trolleyexpress_procdump.yml
Process Access via TrolleyExpress Exclusion ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\TrolleyExpress 7" or ProcessCommandLine contains "\\TrolleyExpress 8" or ProcessCommandLine contains "\\TrolleyExpress 9" or ProcessCommandLine contains "\\TrolleyExpress.exe 7" or ProcessCommandLine contains "\\TrolleyExpress.exe 8" or ProcessCommandLine contains "\\TrolleyExpress.exe 9" or ProcessCommandLine contains "\\TrolleyExpress.exe -ma ") or (FolderPath endswith "\\TrolleyExpress.exe" and (not((isnull(ProcessVersionInfoOriginalFileName) or ProcessVersionInfoOriginalFileName contains "CtxInstall"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file_susp_location.yml
Suspicious Mstsc.EXE Execution With Local RDP File ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".rdp" or ProcessCommandLine endswith ".rdp\"") and (FolderPath endswith "\\mstsc.exe" or ProcessVersionInfoOriginalFileName =~ "mstsc.exe") and (ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\System32\\spool\\drivers\\color" or ProcessCommandLine contains ":\\Windows\\System32\\Tasks_Migrated " or ProcessCommandLine contains ":\\Windows\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains ":\\Windows\\Tracing\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "\\Downloads\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_remote.yml
Use of Remote.exe ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\remote.exe" or ProcessVersionInfoOriginalFileName =~ "remote.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc.yml
PsExec Service Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath =~ "C:\\Windows\\PSEXESVC.exe" or ProcessVersionInfoOriginalFileName =~ "psexesvc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_packet_capture.yml
New Network Trace Capture Started Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "trace" and ProcessCommandLine contains "start") and (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_open_command.yml
Suspicious Reg Add Open Command ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "reg" and ProcessCommandLine contains "add" and ProcessCommandLine contains "hkcu\\software\\classes\\ms-settings\\shell\\open\\command" and ProcessCommandLine contains "/ve " and ProcessCommandLine contains "/d") or (ProcessCommandLine contains "reg" and ProcessCommandLine contains "add" and ProcessCommandLine contains "hkcu\\software\\classes\\ms-settings\\shell\\open\\command" and ProcessCommandLine contains "/v" and ProcessCommandLine contains "DelegateExecute") or (ProcessCommandLine contains "reg" and ProcessCommandLine contains "delete" and ProcessCommandLine contains "hkcu\\software\\classes\\ms-settings")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexec_paexec_escalate_system.yml
PsExec/PAExec Escalation to LOCAL SYSTEM ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "psexec" or ProcessCommandLine contains "paexec" or ProcessCommandLine contains "accepteula") and (ProcessCommandLine contains " -s cmd" or ProcessCommandLine contains " /s cmd" or ProcessCommandLine contains " s cmd" or ProcessCommandLine contains " s cmd" or ProcessCommandLine contains " s cmd" or ProcessCommandLine contains " -s -i cmd" or ProcessCommandLine contains " -s /i cmd" or ProcessCommandLine contains " -s i cmd" or ProcessCommandLine contains " -s i cmd" or ProcessCommandLine contains " -s i cmd" or ProcessCommandLine contains " /s -i cmd" or ProcessCommandLine contains " /s /i cmd" or ProcessCommandLine contains " /s i cmd" or ProcessCommandLine contains " /s i cmd" or ProcessCommandLine contains " /s i cmd" or ProcessCommandLine contains " s -i cmd" or ProcessCommandLine contains " s /i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s -i cmd" or ProcessCommandLine contains " s /i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s -i cmd" or ProcessCommandLine contains " s /i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " -i -s cmd" or ProcessCommandLine contains " -i /s cmd" or ProcessCommandLine contains " -i s cmd" or ProcessCommandLine contains " -i s cmd" or ProcessCommandLine contains " -i s cmd" or ProcessCommandLine contains " /i -s cmd" or ProcessCommandLine contains " /i /s cmd" or ProcessCommandLine contains " /i s cmd" or ProcessCommandLine contains " /i s cmd" or ProcessCommandLine contains " /i s cmd" or ProcessCommandLine contains " i -s cmd" or ProcessCommandLine contains " i /s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i -s cmd" or ProcessCommandLine contains " i /s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i -s cmd" or ProcessCommandLine contains " i /s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " -s pwsh" or ProcessCommandLine contains " /s pwsh" or ProcessCommandLine contains " s pwsh" or ProcessCommandLine contains " s pwsh" or ProcessCommandLine contains " s pwsh" or ProcessCommandLine contains " -s -i pwsh" or ProcessCommandLine contains " -s /i pwsh" or ProcessCommandLine contains " -s i pwsh" or ProcessCommandLine contains " -s i pwsh" or ProcessCommandLine contains " -s i pwsh" or ProcessCommandLine contains " /s -i pwsh" or ProcessCommandLine contains " /s /i pwsh" or ProcessCommandLine contains " /s i pwsh" or ProcessCommandLine contains " /s i pwsh" or ProcessCommandLine contains " /s i pwsh" or ProcessCommandLine contains " s -i pwsh" or ProcessCommandLine contains " s /i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s -i pwsh" or ProcessCommandLine contains " s /i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s -i pwsh" or ProcessCommandLine contains " s /i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " -i -s pwsh" or ProcessCommandLine contains " -i /s pwsh" or ProcessCommandLine contains " -i s pwsh" or ProcessCommandLine contains " -i s pwsh" or ProcessCommandLine contains " -i s pwsh" or ProcessCommandLine contains " /i -s pwsh" or ProcessCommandLine contains " /i /s pwsh" or ProcessCommandLine contains " /i s pwsh" or ProcessCommandLine contains " /i s pwsh" or ProcessCommandLine contains " /i s pwsh" or ProcessCommandLine contains " i -s pwsh" or ProcessCommandLine contains " i /s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i -s pwsh" or ProcessCommandLine contains " i /s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i -s pwsh" or ProcessCommandLine contains " i /s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " -s powershell" or ProcessCommandLine contains " /s powershell" or ProcessCommandLine contains " s powershell" or ProcessCommandLine contains " s powershell" or ProcessCommandLine contains " s powershell" or ProcessCommandLine contains " -s -i powershell" or ProcessCommandLine contains " -s /i powershell" or ProcessCommandLine contains " -s i powershell" or ProcessCommandLine contains " -s i powershell" or ProcessCommandLine contains " -s i powershell" or ProcessCommandLine contains " /s -i powershell" or ProcessCommandLine contains " /s /i powershell" or ProcessCommandLine contains " /s i powershell" or ProcessCommandLine contains " /s i powershell" or ProcessCommandLine contains " /s i powershell" or ProcessCommandLine contains " s -i powershell" or ProcessCommandLine contains " s /i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s -i powershell" or ProcessCommandLine contains " s /i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s -i powershell" or ProcessCommandLine contains " s /i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " -i -s powershell" or ProcessCommandLine contains " -i /s powershell" or ProcessCommandLine contains " -i s powershell" or ProcessCommandLine contains " -i s powershell" or ProcessCommandLine contains " -i s powershell" or ProcessCommandLine contains " /i -s powershell" or ProcessCommandLine contains " /i /s powershell" or ProcessCommandLine contains " /i s powershell" or ProcessCommandLine contains " /i s powershell" or ProcessCommandLine contains " /i s powershell" or ProcessCommandLine contains " i -s powershell" or ProcessCommandLine contains " i /s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i -s powershell" or ProcessCommandLine contains " i /s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i -s powershell" or ProcessCommandLine contains " i /s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_webclient_casing.yml
Net WebClient Casing Anomalies ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "TgBlAFQALgB3AEUAQg" or ProcessCommandLine contains "4AZQBUAC4AdwBFAEIA" or ProcessCommandLine contains "OAGUAVAAuAHcARQBCA" or ProcessCommandLine contains "bgBFAHQALgB3AGUAYg" or ProcessCommandLine contains "4ARQB0AC4AdwBlAGIA" or ProcessCommandLine contains "uAEUAdAAuAHcAZQBiA" or ProcessCommandLine contains "TgBFAHQALgB3AGUAYg" or ProcessCommandLine contains "OAEUAdAAuAHcAZQBiA" or ProcessCommandLine contains "bgBlAFQALgB3AGUAYg" or ProcessCommandLine contains "4AZQBUAC4AdwBlAGIA" or ProcessCommandLine contains "uAGUAVAAuAHcAZQBiA" or ProcessCommandLine contains "TgBlAFQALgB3AGUAYg" or ProcessCommandLine contains "OAGUAVAAuAHcAZQBiA" or ProcessCommandLine contains "bgBFAFQALgB3AGUAYg" or ProcessCommandLine contains "4ARQBUAC4AdwBlAGIA" or ProcessCommandLine contains "uAEUAVAAuAHcAZQBiA" or ProcessCommandLine contains "bgBlAHQALgBXAGUAYg" or ProcessCommandLine contains "4AZQB0AC4AVwBlAGIA" or ProcessCommandLine contains "uAGUAdAAuAFcAZQBiA" or ProcessCommandLine contains "bgBFAHQALgBXAGUAYg" or ProcessCommandLine contains "4ARQB0AC4AVwBlAGIA" or ProcessCommandLine contains "uAEUAdAAuAFcAZQBiA" or ProcessCommandLine contains "TgBFAHQALgBXAGUAYg" or ProcessCommandLine contains "OAEUAdAAuAFcAZQBiA" or ProcessCommandLine contains "bgBlAFQALgBXAGUAYg" or ProcessCommandLine contains "4AZQBUAC4AVwBlAGIA" or ProcessCommandLine contains "uAGUAVAAuAFcAZQBiA" or ProcessCommandLine contains "TgBlAFQALgBXAGUAYg" or ProcessCommandLine contains "OAGUAVAAuAFcAZQBiA" or ProcessCommandLine contains "bgBFAFQALgBXAGUAYg" or ProcessCommandLine contains "4ARQBUAC4AVwBlAGIA" or ProcessCommandLine contains "uAEUAVAAuAFcAZQBiA" or ProcessCommandLine contains "bgBlAHQALgB3AEUAYg" or ProcessCommandLine contains "4AZQB0AC4AdwBFAGIA" or ProcessCommandLine contains "uAGUAdAAuAHcARQBiA" or ProcessCommandLine contains "TgBlAHQALgB3AEUAYg" or ProcessCommandLine contains "OAGUAdAAuAHcARQBiA" or ProcessCommandLine contains "bgBFAHQALgB3AEUAYg" or ProcessCommandLine contains "4ARQB0AC4AdwBFAGIA" or ProcessCommandLine contains "uAEUAdAAuAHcARQBiA" or ProcessCommandLine contains "TgBFAHQALgB3AEUAYg" or ProcessCommandLine contains "OAEUAdAAuAHcARQBiA" or ProcessCommandLine contains "bgBlAFQALgB3AEUAYg" or ProcessCommandLine contains "4AZQBUAC4AdwBFAGIA" or ProcessCommandLine contains "uAGUAVAAuAHcARQBiA" or ProcessCommandLine contains "TgBlAFQALgB3AEUAYg" or ProcessCommandLine contains "OAGUAVAAuAHcARQBiA" or ProcessCommandLine contains "bgBFAFQALgB3AEUAYg" or ProcessCommandLine contains "4ARQBUAC4AdwBFAGIA" or ProcessCommandLine contains "uAEUAVAAuAHcARQBiA" or ProcessCommandLine contains "TgBFAFQALgB3AEUAYg" or ProcessCommandLine contains "OAEUAVAAuAHcARQBiA" or ProcessCommandLine contains "bgBlAHQALgBXAEUAYg" or ProcessCommandLine contains "4AZQB0AC4AVwBFAGIA" or ProcessCommandLine contains "uAGUAdAAuAFcARQBiA" or ProcessCommandLine contains "TgBlAHQALgBXAEUAYg" or ProcessCommandLine contains "OAGUAdAAuAFcARQBiA" or ProcessCommandLine contains "bgBFAHQALgBXAEUAYg" or ProcessCommandLine contains "4ARQB0AC4AVwBFAGIA" or ProcessCommandLine contains "uAEUAdAAuAFcARQBiA" or ProcessCommandLine contains "TgBFAHQALgBXAEUAYg" or ProcessCommandLine contains "OAEUAdAAuAFcARQBiA" or ProcessCommandLine contains "bgBlAFQALgBXAEUAYg" or ProcessCommandLine contains "4AZQBUAC4AVwBFAGIA" or ProcessCommandLine contains "uAGUAVAAuAFcARQBiA" or ProcessCommandLine contains "TgBlAFQALgBXAEUAYg" or ProcessCommandLine contains "OAGUAVAAuAFcARQBiA" or ProcessCommandLine contains "bgBFAFQALgBXAEUAYg" or ProcessCommandLine contains "4ARQBUAC4AVwBFAGIA" or ProcessCommandLine contains "uAEUAVAAuAFcARQBiA" or ProcessCommandLine contains "TgBFAFQALgBXAEUAYg" or ProcessCommandLine contains "OAEUAVAAuAFcARQBiA" or ProcessCommandLine contains "bgBlAHQALgB3AGUAQg" or ProcessCommandLine contains "4AZQB0AC4AdwBlAEIA" or ProcessCommandLine contains "uAGUAdAAuAHcAZQBCA" or ProcessCommandLine contains "TgBlAHQALgB3AGUAQg" or ProcessCommandLine contains "OAGUAdAAuAHcAZQBCA" or ProcessCommandLine contains "bgBFAHQALgB3AGUAQg" or ProcessCommandLine contains "4ARQB0AC4AdwBlAEIA" or ProcessCommandLine contains "uAEUAdAAuAHcAZQBCA" or ProcessCommandLine contains "TgBFAHQALgB3AGUAQg" or ProcessCommandLine contains "OAEUAdAAuAHcAZQBCA" or ProcessCommandLine contains "bgBlAFQALgB3AGUAQg" or ProcessCommandLine contains "4AZQBUAC4AdwBlAEIA" or ProcessCommandLine contains "uAGUAVAAuAHcAZQBCA" or ProcessCommandLine contains "TgBlAFQALgB3AGUAQg" or ProcessCommandLine contains "OAGUAVAAuAHcAZQBCA" or ProcessCommandLine contains "bgBFAFQALgB3AGUAQg" or ProcessCommandLine contains "4ARQBUAC4AdwBlAEIA" or ProcessCommandLine contains "uAEUAVAAuAHcAZQBCA" or ProcessCommandLine contains "TgBFAFQALgB3AGUAQg" or ProcessCommandLine contains "OAEUAVAAuAHcAZQBCA" or ProcessCommandLine contains "bgBlAHQALgBXAGUAQg" or ProcessCommandLine contains "4AZQB0AC4AVwBlAEIA" or ProcessCommandLine contains "uAGUAdAAuAFcAZQBCA" or ProcessCommandLine contains "TgBlAHQALgBXAGUAQg" or ProcessCommandLine contains "OAGUAdAAuAFcAZQBCA" or ProcessCommandLine contains "bgBFAHQALgBXAGUAQg" or ProcessCommandLine contains "4ARQB0AC4AVwBlAEIA" or ProcessCommandLine contains "uAEUAdAAuAFcAZQBCA" or ProcessCommandLine contains "TgBFAHQALgBXAGUAQg" or ProcessCommandLine contains "OAEUAdAAuAFcAZQBCA" or ProcessCommandLine contains "bgBlAFQALgBXAGUAQg" or ProcessCommandLine contains "4AZQBUAC4AVwBlAEIA" or ProcessCommandLine contains "uAGUAVAAuAFcAZQBCA" or ProcessCommandLine contains "TgBlAFQALgBXAGUAQg" or ProcessCommandLine contains "OAGUAVAAuAFcAZQBCA" or ProcessCommandLine contains "bgBFAFQALgBXAGUAQg" or ProcessCommandLine contains "4ARQBUAC4AVwBlAEIA" or ProcessCommandLine contains "uAEUAVAAuAFcAZQBCA" or ProcessCommandLine contains "TgBFAFQALgBXAGUAQg" or ProcessCommandLine contains "OAEUAVAAuAFcAZQBCA" or ProcessCommandLine contains "bgBlAHQALgB3AEUAQg" or ProcessCommandLine contains "4AZQB0AC4AdwBFAEIA" or ProcessCommandLine contains "uAGUAdAAuAHcARQBCA" or ProcessCommandLine contains "TgBlAHQALgB3AEUAQg" or ProcessCommandLine contains "OAGUAdAAuAHcARQBCA" or ProcessCommandLine contains "bgBFAHQALgB3AEUAQg" or ProcessCommandLine contains "4ARQB0AC4AdwBFAEIA" or ProcessCommandLine contains "uAEUAdAAuAHcARQBCA" or ProcessCommandLine contains "TgBFAHQALgB3AEUAQg" or ProcessCommandLine contains "OAEUAdAAuAHcARQBCA" or ProcessCommandLine contains "bgBlAFQALgB3AEUAQg" or ProcessCommandLine contains "uAGUAVAAuAHcARQBCA" or ProcessCommandLine contains "bgBFAFQALgB3AEUAQg" or ProcessCommandLine contains "4ARQBUAC4AdwBFAEIA" or ProcessCommandLine contains "uAEUAVAAuAHcARQBCA" or ProcessCommandLine contains "TgBFAFQALgB3AEUAQg" or ProcessCommandLine contains "OAEUAVAAuAHcARQBCA" or ProcessCommandLine contains "TgBlAHQALgBXAEUAQg" or ProcessCommandLine contains "4AZQB0AC4AVwBFAEIA" or ProcessCommandLine contains "OAGUAdAAuAFcARQBCA" or ProcessCommandLine contains "bgBFAHQALgBXAEUAQg" or ProcessCommandLine contains "4ARQB0AC4AVwBFAEIA" or ProcessCommandLine contains "uAEUAdAAuAFcARQBCA" or ProcessCommandLine contains "TgBFAHQALgBXAEUAQg" or ProcessCommandLine contains "OAEUAdAAuAFcARQBCA" or ProcessCommandLine contains "bgBlAFQALgBXAEUAQg" or ProcessCommandLine contains "4AZQBUAC4AVwBFAEIA" or ProcessCommandLine contains "uAGUAVAAuAFcARQBCA" or ProcessCommandLine contains "TgBlAFQALgBXAEUAQg" or ProcessCommandLine contains "OAGUAVAAuAFcARQBCA" or ProcessCommandLine contains "bgBFAFQALgBXAEUAQg" or ProcessCommandLine contains "4ARQBUAC4AVwBFAEIA" or ProcessCommandLine contains "uAEUAVAAuAFcARQBCA") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_cmdline_special_characters.yml
Potential PowerShell Command Line Obfuscation ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine matches regex "\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+" or ProcessCommandLine matches regex "\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{" or ProcessCommandLine matches regex "\\^.*\\^.*\\^.*\\^.*\\^" or ProcessCommandLine matches regex "`.*`.*`.*`.*`")) and (not((InitiatingProcessFolderPath =~ "C:\\Program Files\\Amazon\\SSM\\ssm-document-worker.exe" or (ProcessCommandLine contains "new EventSource(\"Microsoft.Windows.Sense.Client.Management\"" or ProcessCommandLine contains "public static extern bool InstallELAMCertificateInfo(SafeFileHandle handle);"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_userinit_uncommon_child_processes.yml
Uncommon Userinit Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\userinit.exe" and (not(FolderPath endswith ":\\WINDOWS\\explorer.exe")) and (not(((FolderPath endswith ":\\Program Files (x86)\\Citrix\\HDX\\bin\\cmstart.exe" or FolderPath endswith ":\\Program Files (x86)\\Citrix\\HDX\\bin\\icast.exe" or FolderPath endswith ":\\Program Files (x86)\\Citrix\\System32\\icast.exe" or FolderPath endswith ":\\Program Files\\Citrix\\HDX\\bin\\cmstart.exe" or FolderPath endswith ":\\Program Files\\Citrix\\HDX\\bin\\icast.exe" or FolderPath endswith ":\\Program Files\\Citrix\\System32\\icast.exe") or isnull(FolderPath) or (ProcessCommandLine contains "netlogon.bat" or ProcessCommandLine contains "UsrLogon.cmd") or (FolderPath endswith ":\\Windows\\System32\\proquota.exe" or FolderPath endswith ":\\Windows\\SysWOW64\\proquota.exe") or ProcessCommandLine =~ "PowerShell.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_whoami_priv_discovery.yml
Security Privileges Enumeration Via Whoami.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /priv" or ProcessCommandLine contains " -priv") and (FolderPath endswith "\\whoami.exe" or ProcessVersionInfoOriginalFileName =~ "whoami.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_redirection_susp_folder.yml
Potentially Suspicious CMD Shell Output Redirect ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe") and (((ProcessCommandLine contains ">" and ProcessCommandLine contains "%APPDATA%\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "%TEMP%\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "%TMP%\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "%USERPROFILE%\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "C:\\ProgramData\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "C:\\Temp\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "C:\\Users\\Public\\") or (ProcessCommandLine contains ">" and ProcessCommandLine contains "C:\\Windows\\Temp\\")) or ((ProcessCommandLine contains " >" or ProcessCommandLine contains "\">" or ProcessCommandLine contains "'>") and (ProcessCommandLine contains "C:\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_execution.yml
Sysinternals PsSuspend Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "pssuspend.exe" or (FolderPath endswith "\\pssuspend.exe" or FolderPath endswith "\\pssuspend64.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_csproduct.yml
Hardware Model Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "csproduct" and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hxtsr_masquerading.yml
Potential Fake Instance Of Hxtsr.EXE Executed ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\hxtsr.exe" and (not((FolderPath contains ":\\program files\\windowsapps\\microsoft.windowscommunicationsapps_" and FolderPath endswith "\\hxtsr.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_fsutil_usage.yml
Fsutil Suspicious Invocation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "deletejournal" or ProcessCommandLine contains "createjournal" or ProcessCommandLine contains "setZeroData") and (FolderPath endswith "\\fsutil.exe" or ProcessVersionInfoOriginalFileName =~ "fsutil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ldifde_export.yml
Active Directory Structure Export Via Ldifde.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-f" and (FolderPath endswith "\\ldifde.exe" or ProcessVersionInfoOriginalFileName =~ "ldifde.exe")) and (not(ProcessCommandLine contains " -i"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_python_adidnsdump.yml
PUA - Adidnsdump Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "adidnsdump" and FolderPath endswith "\\python.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_susp_process_creation.yml
Suspicious Process Created Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "bitsadmin" or ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "cmd.exe /c " or ProcessCommandLine contains "cmd.exe /k " or ProcessCommandLine contains "cmd.exe /r " or ProcessCommandLine contains "cmd /c " or ProcessCommandLine contains "cmd /k " or ProcessCommandLine contains "cmd /r " or ProcessCommandLine contains "powershell" or ProcessCommandLine contains "pwsh" or ProcessCommandLine contains "certutil" or ProcessCommandLine contains "cscript" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\" or ProcessCommandLine contains "%temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains "%ProgramData%" or ProcessCommandLine contains "%appdata%" or ProcessCommandLine contains "%comspec%" or ProcessCommandLine contains "%localappdata%") and (ProcessCommandLine contains "process " and ProcessCommandLine contains "call " and ProcessCommandLine contains "create ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml
Unexpected Error processing 'Renamed PAExec Execution' (sigma/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrar_exfil_dmp_files.yml
Winrar Compressing Dump Files ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".dmp" or ProcessCommandLine contains ".dump" or ProcessCommandLine contains ".hdmp") and ((FolderPath endswith "\\rar.exe" or FolderPath endswith "\\winrar.exe") or ProcessVersionInfoFileDescription =~ "Command line RAR")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dump64_defender_av_bypass_rename.yml
Potential Windows Defender AV Bypass Via Dump64.EXE Rename ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "\\Microsoft Visual Studio\\" and FolderPath endswith "\\dump64.exe" and FolderPath startswith ":\\Program Files") and (ProcessVersionInfoOriginalFileName =~ "procdump" or (ProcessCommandLine contains " -ma " or ProcessCommandLine contains " -mp "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nimscan.yml
Unexpected Error processing 'PUA - NimScan Execution' (sigma/rules/windows/process_creation/proc_creation_win_pua_nimscan.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vaultcmd_list_creds.yml
Windows Credential Manager Access via VaultCmd ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/listcreds:" and (FolderPath endswith "\\VaultCmd.exe" or ProcessVersionInfoOriginalFileName =~ "VAULTCMD.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ruby_inline_command_execution.yml
Ruby Inline Command Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -e" and (FolderPath endswith "\\ruby.exe" or ProcessVersionInfoOriginalFileName =~ "ruby.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml
Add SafeBoot Keys Via Reg Utility ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " copy " or ProcessCommandLine contains " add ") and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe") and ProcessCommandLine contains "\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir_lolbin.yml
LOL-Binary Copied From System Directory ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "copy " and FolderPath endswith "\\cmd.exe") or ((FolderPath endswith "\\robocopy.exe" or FolderPath endswith "\\xcopy.exe") or (ProcessVersionInfoOriginalFileName in~ ("robocopy.exe", "XCOPY.EXE"))) or ((ProcessCommandLine contains "copy-item" or ProcessCommandLine contains " copy " or ProcessCommandLine contains "cpi " or ProcessCommandLine contains " cp ") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe"))) and ((ProcessCommandLine contains "\\bitsadmin.exe" or ProcessCommandLine contains "\\calc.exe" or ProcessCommandLine contains "\\certutil.exe" or ProcessCommandLine contains "\\cmdl32.exe" or ProcessCommandLine contains "\\cscript.exe" or ProcessCommandLine contains "\\mshta.exe" or ProcessCommandLine contains "\\rundll32.exe" or ProcessCommandLine contains "\\wscript.exe") and (ProcessCommandLine contains "\\System32" or ProcessCommandLine contains "\\SysWOW64" or ProcessCommandLine contains "\\WinSxS"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset_integrity_level.yml
UAC Bypass WSReset ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\wsreset.exe" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_udl_exec.yml
Potentially Suspicious Rundll32.EXE Execution of UDL File ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "oledb32.dll" and ProcessCommandLine contains ",OpenDSLFile " and (ProcessCommandLine contains "\\Users\\" and ProcessCommandLine contains "\\Downloads\\")) and ProcessCommandLine endswith ".udl") and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE") and InitiatingProcessFolderPath endswith "\\explorer.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_network_command.yml
Suspicious Network Command ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "ipconfig /all" or ProcessCommandLine contains "netsh interface show interface" or ProcessCommandLine contains "arp -a" or ProcessCommandLine contains "nbtstat -n" or ProcessCommandLine contains "net config" or ProcessCommandLine contains "route print"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_systemsettingsadminflows_turn_on_dev_features.yml
Potential Signing Bypass Via Windows Developer Features ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "TurnOnDeveloperFeatures" and (FolderPath endswith "\\SystemSettingsAdminFlows.exe" or ProcessVersionInfoOriginalFileName =~ "SystemSettingsAdminFlows.EXE") and (ProcessCommandLine contains "DeveloperUnlock" or ProcessCommandLine contains "EnableSideloading")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_use_network_connections_discovery.yml
System Network Connections Discovery Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine endswith " use" or ProcessCommandLine endswith " sessions") or (ProcessCommandLine contains " use " or ProcessCommandLine contains " sessions ")) and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_msexchange_transport_agent.yml
MSExchange Transport Agent Installation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Install-TransportAgent"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_sysvol_access.yml
Suspicious SYSVOL Domain Group Policy Access ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\SYSVOL\\" and ProcessCommandLine contains "\\policies\\"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dnscmd_install_new_server_level_plugin_dll.yml
New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/config" and ProcessCommandLine contains "/serverlevelplugindll") and FolderPath endswith "\\dnscmd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_config_update.yml
Sysmon Configuration Update ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-c" or ProcessCommandLine contains "/c" or ProcessCommandLine contains "c" or ProcessCommandLine contains "c" or ProcessCommandLine contains "c") and ((FolderPath endswith "\\Sysmon64.exe" or FolderPath endswith "\\Sysmon.exe") or ProcessVersionInfoFileDescription =~ "System activity monitor")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dtrace_kernel_dump.yml
Suspicious Kernel Dump Using Dtrace ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "syscall:::return" and ProcessCommandLine contains "lkd(") or (ProcessCommandLine contains "lkd(0)" and FolderPath endswith "\\dtrace.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sqlite_chromium_profile_data.yml
SQLite Chromium Profile Data DB Access ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\User Data\\" or ProcessCommandLine contains "\\Opera Software\\" or ProcessCommandLine contains "\\ChromiumViewer\\") and (ProcessCommandLine contains "Login Data" or ProcessCommandLine contains "Cookies" or ProcessCommandLine contains "Web Data" or ProcessCommandLine contains "History" or ProcessCommandLine contains "Bookmarks") and (ProcessVersionInfoProductName =~ "SQLite" or (FolderPath endswith "\\sqlite.exe" or FolderPath endswith "\\sqlite3.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_winpwn.yml
HackTool - WinPwn Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Offline_Winpwn" or ProcessCommandLine contains "WinPwn " or ProcessCommandLine contains "WinPwn.exe" or ProcessCommandLine contains "WinPwn.ps1"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_compress.yml
Invoke-Obfuscation COMPRESS OBFUSCATION ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "system.io.compression.deflatestream" or ProcessCommandLine contains "system.io.streamreader" or ProcessCommandLine contains "readtoend(") and (ProcessCommandLine contains "new-object" and ProcessCommandLine contains "text.encoding]::ascii")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_inline_file_download.yml
File Download From Browser Process Via Inline URL ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".7z" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".exe" or ProcessCommandLine endswith ".hta" or ProcessCommandLine endswith ".ps1" or ProcessCommandLine endswith ".psm1" or ProcessCommandLine endswith ".txt" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbs" or ProcessCommandLine endswith ".zip") and ProcessCommandLine contains "http" and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\vivaldi.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_shelldispatch_potential_abuse.yml
Potential ShellDispatch.DLL Functionality Abuse ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "RunDll_ShellExecuteW" and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcwrun_follina.yml
Execute Pcwrun.EXE To Leverage Follina ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "../" and FolderPath endswith "\\pcwrun.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_qemu_suspicious_execution.yml
Potentially Suspicious Usage Of Qemu ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-m 1M" or ProcessCommandLine contains "-m 2M" or ProcessCommandLine contains "-m 3M") and (ProcessCommandLine contains "restrict=off" and ProcessCommandLine contains "-netdev " and ProcessCommandLine contains "connect=" and ProcessCommandLine contains "-nographic")) and (not((ProcessCommandLine contains " -cdrom " or ProcessCommandLine contains " type=virt " or ProcessCommandLine contains " -blockdev ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vmware_toolbox_cmd_persistence_susp.yml
Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " script " and ProcessCommandLine contains " set ") and (FolderPath endswith "\\VMwareToolBoxCmd.exe" or ProcessVersionInfoOriginalFileName =~ "toolbox-cmd.exe") and (ProcessCommandLine contains ":\\PerfLogs\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Windows\\System32\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Tasks\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\AppData\\Local\\Temp")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_stop_service.yml
Stop Windows Service Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " stop " and (ProcessVersionInfoOriginalFileName =~ "sc.exe" or FolderPath endswith "\\sc.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_iex.yml
PowerShell Base64 Encoded IEX Cmdlet ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "SUVYIChb" or ProcessCommandLine contains "lFWCAoW" or ProcessCommandLine contains "JRVggKF" or ProcessCommandLine contains "aWV4IChb" or ProcessCommandLine contains "lleCAoW" or ProcessCommandLine contains "pZXggKF" or ProcessCommandLine contains "aWV4IChOZX" or ProcessCommandLine contains "lleCAoTmV3" or ProcessCommandLine contains "pZXggKE5ld" or ProcessCommandLine contains "SUVYIChOZX" or ProcessCommandLine contains "lFWCAoTmV3" or ProcessCommandLine contains "JRVggKE5ld" or ProcessCommandLine contains "SUVYKF" or ProcessCommandLine contains "lFWChb" or ProcessCommandLine contains "JRVgoW" or ProcessCommandLine contains "aWV4KF" or ProcessCommandLine contains "lleChb" or ProcessCommandLine contains "pZXgoW" or ProcessCommandLine contains "aWV4KE5ld" or ProcessCommandLine contains "lleChOZX" or ProcessCommandLine contains "pZXgoTmV3" or ProcessCommandLine contains "SUVYKE5ld" or ProcessCommandLine contains "lFWChOZX" or ProcessCommandLine contains "JRVgoTmV3" or ProcessCommandLine contains "SUVYKCgn" or ProcessCommandLine contains "lFWCgoJ" or ProcessCommandLine contains "JRVgoKC" or ProcessCommandLine contains "aWV4KCgn" or ProcessCommandLine contains "lleCgoJ" or ProcessCommandLine contains "pZXgoKC") or (ProcessCommandLine contains "SQBFAFgAIAAoAFsA" or ProcessCommandLine contains "kARQBYACAAKABbA" or ProcessCommandLine contains "JAEUAWAAgACgAWw" or ProcessCommandLine contains "aQBlAHgAIAAoAFsA" or ProcessCommandLine contains "kAZQB4ACAAKABbA" or ProcessCommandLine contains "pAGUAeAAgACgAWw" or ProcessCommandLine contains "aQBlAHgAIAAoAE4AZQB3A" or ProcessCommandLine contains "kAZQB4ACAAKABOAGUAdw" or ProcessCommandLine contains "pAGUAeAAgACgATgBlAHcA" or ProcessCommandLine contains "SQBFAFgAIAAoAE4AZQB3A" or ProcessCommandLine contains "kARQBYACAAKABOAGUAdw" or ProcessCommandLine contains "JAEUAWAAgACgATgBlAHcA")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_krbrelay.yml
HackTool - KrbRelay Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -spn " and ProcessCommandLine contains " -clsid " and ProcessCommandLine contains " -rbcd ") or (ProcessCommandLine contains "shadowcred" and ProcessCommandLine contains "clsid" and ProcessCommandLine contains "spn") or (ProcessCommandLine contains "spn " and ProcessCommandLine contains "session " and ProcessCommandLine contains "clsid ") or (FolderPath endswith "\\KrbRelay.exe" or ProcessVersionInfoOriginalFileName =~ "KrbRelay.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_control_dll_load.yml
Suspicious Control Panel DLL Load ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE") and InitiatingProcessFolderPath endswith "\\System32\\control.exe") and (not(ProcessCommandLine contains "Shell32.dll"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_presentationhost_uncommon_location_exec.yml
XBAP Execution From Uncommon Locations Via PresentationHost.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".xbap" and (FolderPath endswith "\\presentationhost.exe" or ProcessVersionInfoOriginalFileName =~ "PresentationHost.exe")) and (not((ProcessCommandLine contains " C:\\Windows\\" or ProcessCommandLine contains " C:\\Program Files")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nps.yml
PUA - NPS Tunneling Tool Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -server=" and ProcessCommandLine contains " -vkey=" and ProcessCommandLine contains " -password=") or ProcessCommandLine contains " -config=npc" or (MD5 startswith "AE8ACF66BFE3A44148964048B826D005" or SHA1 startswith "CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181" or SHA256 startswith "5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856") or FolderPath endswith "\\npc.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_terminate_application.yml
Application Terminated Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "call" and ProcessCommandLine contains "terminate") and (FolderPath endswith "\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_ultraviewer.yml
Remote Access Tool - UltraViewer Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoProductName =~ "UltraViewer" or ProcessVersionInfoCompanyName =~ "DucFabulous Co,ltd" or ProcessVersionInfoOriginalFileName =~ "UltraViewer_Desktop.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_7zip_password_compression.yml
Compress Data and Lock With Password for Exfiltration With 7-ZIP ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " a " or ProcessCommandLine contains " u ") and (ProcessVersionInfoFileDescription contains "7-Zip" or (FolderPath endswith "\\7z.exe" or FolderPath endswith "\\7zr.exe" or FolderPath endswith "\\7za.exe") or (ProcessVersionInfoOriginalFileName in~ ("7z.exe", "7za.exe"))) and ProcessCommandLine contains " -p"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_dinjector.yml
HackTool - DInjector PowerShell Cradle Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /am51" and ProcessCommandLine contains " /password"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_sys.yml
Suspicious Rundll32 Activity Invoking Sys File ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "rundll32.exe" and (ProcessCommandLine contains ".sys," or ProcessCommandLine contains ".sys ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pester.yml
Execute Code with Pester.bat as Parent ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine contains "{ Invoke-Pester -EnableExit ;" or InitiatingProcessCommandLine contains "{ Get-Help \"") and (InitiatingProcessCommandLine contains "\\WindowsPowerShell\\Modules\\Pester\\" and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_piped_password_via_cli.yml
Remote Access Tool - AnyDesk Piped Password Via CLI ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/c " and ProcessCommandLine contains "echo " and ProcessCommandLine contains ".exe --set-password"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_credential_access_via_password_filter.yml
Dropping Of Password Filter DLL ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa" and ProcessCommandLine contains "scecli\\0" and ProcessCommandLine contains "reg add"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_crassus.yml
PUA - Crassus Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\Crassus.exe" or ProcessVersionInfoOriginalFileName =~ "Crassus.exe" or ProcessVersionInfoFileDescription contains "Crassus"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_unc_path.yml
Rundll32 UNC Path Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " \\\\" and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE" or ProcessCommandLine contains "rundll32")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_modify_group_policy_settings.yml
Modify Group Policy Settings ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "GroupPolicyRefreshTimeDC" or ProcessCommandLine contains "GroupPolicyRefreshTimeOffsetDC" or ProcessCommandLine contains "GroupPolicyRefreshTime" or ProcessCommandLine contains "GroupPolicyRefreshTimeOffset" or ProcessCommandLine contains "EnableSmartScreen" or ProcessCommandLine contains "ShellSmartScreenLevel") and ProcessCommandLine contains "\\SOFTWARE\\Policies\\Microsoft\\Windows\\System" and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_configsecuritypolicy_download_file.yml
Arbitrary File Download Via ConfigSecurityPolicy.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ConfigSecurityPolicy.exe" or FolderPath endswith "\\ConfigSecurityPolicy.exe" or ProcessVersionInfoOriginalFileName =~ "ConfigSecurityPolicy.exe") and (ProcessCommandLine contains "ftp://" or ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_copy_dmp_from_share.yml
Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains ".dmp" or ProcessCommandLine contains ".dump" or ProcessCommandLine contains ".hdmp") and (ProcessCommandLine contains "copy " and ProcessCommandLine contains " \\\\")) and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_bloodhound_sharphound.yml
HackTool - Bloodhound/Sharphound Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -CollectionMethod All " or ProcessCommandLine contains " --CollectionMethods Session " or ProcessCommandLine contains " --Loop --Loopduration " or ProcessCommandLine contains " --PortScanTimeout " or ProcessCommandLine contains ".exe -c All -d " or ProcessCommandLine contains "Invoke-Bloodhound" or ProcessCommandLine contains "Get-BloodHoundData") or (ProcessCommandLine contains " -JsonFolder " and ProcessCommandLine contains " -ZipFileName ") or (ProcessCommandLine contains " DCOnly " and ProcessCommandLine contains " --NoSaveCache ") or (ProcessVersionInfoProductName contains "SharpHound" or ProcessVersionInfoFileDescription contains "SharpHound" or (ProcessVersionInfoCompanyName contains "SpecterOps" or ProcessVersionInfoCompanyName contains "evil corp") or (FolderPath contains "\\Bloodhound.exe" or FolderPath contains "\\SharpHound.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml
Scheduled Task Executing Payload from Registry ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/Create" and (ProcessCommandLine contains "Get-ItemProperty" or ProcessCommandLine contains " gp ") and (ProcessCommandLine contains "HKCU:" or ProcessCommandLine contains "HKLM:" or ProcessCommandLine contains "registry::" or ProcessCommandLine contains "HKEY_") and (FolderPath endswith "\\schtasks.exe" or ProcessVersionInfoOriginalFileName =~ "schtasks.exe")) and (not((ProcessCommandLine contains "FromBase64String" or ProcessCommandLine contains "encodedcommand")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vmware_toolbox_cmd_persistence.yml
Potential Persistence Via VMwareToolBoxCmd.EXE VM State Change Script ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " script " and ProcessCommandLine contains " set ") and (FolderPath endswith "\\VMwareToolBoxCmd.exe" or ProcessVersionInfoOriginalFileName =~ "toolbox-cmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_download_cradles.yml
PowerShell Web Download ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains ".DownloadString(" or ProcessCommandLine contains ".DownloadFile(" or ProcessCommandLine contains "Invoke-WebRequest " or ProcessCommandLine contains "iwr "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_nslookup_domain_discovery.yml
Network Reconnaissance Activity ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "nslookup" and ProcessCommandLine contains "_ldap._tcp.dc._msdcs."

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_outlook_enable_unsafe_client_mail_rules.yml
Outlook EnableUnsafeClientMailRules Setting Enabled ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\Outlook\\Security\\EnableUnsafeClientMailRules"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_gpg4win.yml
Renamed Gpg.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "gpg.exe" and (not((FolderPath endswith "\\gpg.exe" or FolderPath endswith "\\gpg2.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msiexec_embedding.yml
Suspicious MsiExec Embedding Parent ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\cmd.exe") and (InitiatingProcessCommandLine contains "MsiExec.exe" and InitiatingProcessCommandLine contains "-Embedding ")) and (not(((ProcessCommandLine contains "C:\\Program Files\\SplunkUniversalForwarder\\bin\\" and FolderPath endswith ":\\Windows\\System32\\cmd.exe") or (ProcessCommandLine contains "\\DismFoDInstall.cmd" or (InitiatingProcessCommandLine contains "\\MsiExec.exe -Embedding " and InitiatingProcessCommandLine contains "Global\\MSI0000")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpview.yml
HackTool - SharpView Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "SharpView.exe" or FolderPath endswith "\\SharpView.exe" or (ProcessCommandLine contains "Add-RemoteConnection" or ProcessCommandLine contains "Convert-ADName" or ProcessCommandLine contains "ConvertFrom-SID" or ProcessCommandLine contains "ConvertFrom-UACValue" or ProcessCommandLine contains "Convert-SidToName" or ProcessCommandLine contains "Export-PowerViewCSV" or ProcessCommandLine contains "Find-DomainObjectPropertyOutlier" or ProcessCommandLine contains "Find-DomainProcess" or ProcessCommandLine contains "Find-DomainShare" or ProcessCommandLine contains "Find-DomainUserEvent" or ProcessCommandLine contains "Find-DomainUserLocation" or ProcessCommandLine contains "Find-ForeignGroup" or ProcessCommandLine contains "Find-ForeignUser" or ProcessCommandLine contains "Find-GPOComputerAdmin" or ProcessCommandLine contains "Find-GPOLocation" or ProcessCommandLine contains "Find-Interesting" or ProcessCommandLine contains "Find-LocalAdminAccess" or ProcessCommandLine contains "Find-ManagedSecurityGroups" or ProcessCommandLine contains "Get-CachedRDPConnection" or ProcessCommandLine contains "Get-DFSshare" or ProcessCommandLine contains "Get-DomainComputer" or ProcessCommandLine contains "Get-DomainController" or ProcessCommandLine contains "Get-DomainDFSShare" or ProcessCommandLine contains "Get-DomainDNSRecord" or ProcessCommandLine contains "Get-DomainFileServer" or ProcessCommandLine contains "Get-DomainForeign" or ProcessCommandLine contains "Get-DomainGPO" or ProcessCommandLine contains "Get-DomainGroup" or ProcessCommandLine contains "Get-DomainGUIDMap" or ProcessCommandLine contains "Get-DomainManagedSecurityGroup" or ProcessCommandLine contains "Get-DomainObject" or ProcessCommandLine contains "Get-DomainOU" or ProcessCommandLine contains "Get-DomainPolicy" or ProcessCommandLine contains "Get-DomainSID" or ProcessCommandLine contains "Get-DomainSite" or ProcessCommandLine contains "Get-DomainSPNTicket" or ProcessCommandLine contains "Get-DomainSubnet" or ProcessCommandLine contains "Get-DomainTrust" or ProcessCommandLine contains "Get-DomainUserEvent" or ProcessCommandLine contains "Get-ForestDomain" or ProcessCommandLine contains "Get-ForestGlobalCatalog" or ProcessCommandLine contains "Get-ForestTrust" or ProcessCommandLine contains "Get-GptTmpl" or ProcessCommandLine contains "Get-GroupsXML" or ProcessCommandLine contains "Get-LastLoggedOn" or ProcessCommandLine contains "Get-LoggedOnLocal" or ProcessCommandLine contains "Get-NetComputer" or ProcessCommandLine contains "Get-NetDomain" or ProcessCommandLine contains "Get-NetFileServer" or ProcessCommandLine contains "Get-NetForest" or ProcessCommandLine contains "Get-NetGPO" or ProcessCommandLine contains "Get-NetGroupMember" or ProcessCommandLine contains "Get-NetLocalGroup" or ProcessCommandLine contains "Get-NetLoggedon" or ProcessCommandLine contains "Get-NetOU" or ProcessCommandLine contains "Get-NetProcess" or ProcessCommandLine contains "Get-NetRDPSession" or ProcessCommandLine contains "Get-NetSession" or ProcessCommandLine contains "Get-NetShare" or ProcessCommandLine contains "Get-NetSite" or ProcessCommandLine contains "Get-NetSubnet" or ProcessCommandLine contains "Get-NetUser" or ProcessCommandLine contains "Get-PathAcl" or ProcessCommandLine contains "Get-PrincipalContext" or ProcessCommandLine contains "Get-RegistryMountedDrive" or ProcessCommandLine contains "Get-RegLoggedOn" or ProcessCommandLine contains "Get-WMIRegCachedRDPConnection" or ProcessCommandLine contains "Get-WMIRegLastLoggedOn" or ProcessCommandLine contains "Get-WMIRegMountedDrive" or ProcessCommandLine contains "Get-WMIRegProxy" or ProcessCommandLine contains "Invoke-ACLScanner" or ProcessCommandLine contains "Invoke-CheckLocalAdminAccess" or ProcessCommandLine contains "Invoke-Kerberoast" or ProcessCommandLine contains "Invoke-MapDomainTrust" or ProcessCommandLine contains "Invoke-RevertToSelf" or ProcessCommandLine contains "Invoke-Sharefinder" or ProcessCommandLine contains "Invoke-UserImpersonation" or ProcessCommandLine contains "Remove-DomainObjectAcl" or ProcessCommandLine contains "Remove-RemoteConnection" or ProcessCommandLine contains "Request-SPNTicket" or ProcessCommandLine contains "Set-DomainObject" or ProcessCommandLine contains "Test-AdminAccess")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_mklink_osk_cmd.yml
Potential Privilege Escalation Using Symlink Between Osk and Cmd ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "mklink" and ProcessCommandLine contains "\\osk.exe" and ProcessCommandLine contains "\\cmd.exe") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_rasautou_dll_execution.yml
DLL Execution via Rasautou.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -d " and ProcessCommandLine contains " -p ") and (FolderPath endswith "\\rasautou.exe" or ProcessVersionInfoOriginalFileName =~ "rasdlui.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharp_dpapi_execution.yml
HackTool - SharpDPAPI Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\SharpDPAPI.exe" or ProcessVersionInfoOriginalFileName =~ "SharpDPAPI.exe") or ((ProcessCommandLine contains " backupkey " or ProcessCommandLine contains " blob " or ProcessCommandLine contains " certificates " or ProcessCommandLine contains " credentials " or ProcessCommandLine contains " keepass " or ProcessCommandLine contains " masterkeys " or ProcessCommandLine contains " rdg " or ProcessCommandLine contains " vaults ") and ((ProcessCommandLine contains " /file:" or ProcessCommandLine contains " /machine" or ProcessCommandLine contains " /mkfile:" or ProcessCommandLine contains " /password:" or ProcessCommandLine contains " /pvk:" or ProcessCommandLine contains " /server:" or ProcessCommandLine contains " /target:" or ProcessCommandLine contains " /unprotect") or (ProcessCommandLine contains " {" and ProcessCommandLine contains "}:")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_execution_path.yml
Process Execution From A Potentially Suspicious Folder ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains ":\\Perflogs\\" or FolderPath contains ":\\Users\\All Users\\" or FolderPath contains ":\\Users\\Default\\" or FolderPath contains ":\\Users\\NetworkService\\" or FolderPath contains ":\\Windows\\addins\\" or FolderPath contains ":\\Windows\\debug\\" or FolderPath contains ":\\Windows\\Fonts\\" or FolderPath contains ":\\Windows\\Help\\" or FolderPath contains ":\\Windows\\IME\\" or FolderPath contains ":\\Windows\\Media\\" or FolderPath contains ":\\Windows\\repair\\" or FolderPath contains ":\\Windows\\security\\" or FolderPath contains ":\\Windows\\System32\\Tasks\\" or FolderPath contains ":\\Windows\\Tasks\\" or FolderPath contains "$Recycle.bin" or FolderPath contains "\\config\\systemprofile\\" or FolderPath contains "\\Intel\\Logs\\" or FolderPath contains "\\RSA\\MachineKeys\\") and (not(((FolderPath endswith "\\CitrixReceiverUpdater.exe" and FolderPath startswith "C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\") or FolderPath startswith "C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_ntds.yml
Suspicious Process Patterns NTDS.DIT Exfil ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "ac i ntds" and ProcessCommandLine contains "create full") or (ProcessCommandLine contains "/c copy " and ProcessCommandLine contains "\\windows\\ntds\\ntds.dit") or (ProcessCommandLine contains "activate instance ntds" and ProcessCommandLine contains "create full") or (ProcessCommandLine contains "powershell" and ProcessCommandLine contains "ntds.dit") or ((FolderPath endswith "\\NTDSDump.exe" or FolderPath endswith "\\NTDSDumpEx.exe") or (ProcessCommandLine contains "ntds.dit" and ProcessCommandLine contains "system.hiv") or ProcessCommandLine contains "NTDSgrab.ps1")) or (((InitiatingProcessFolderPath contains "\\apache" or InitiatingProcessFolderPath contains "\\tomcat" or InitiatingProcessFolderPath contains "\\AppData\\" or InitiatingProcessFolderPath contains "\\Temp\\" or InitiatingProcessFolderPath contains "\\Public\\" or InitiatingProcessFolderPath contains "\\PerfLogs\\") or (FolderPath contains "\\apache" or FolderPath contains "\\tomcat" or FolderPath contains "\\AppData\\" or FolderPath contains "\\Temp\\" or FolderPath contains "\\Public\\" or FolderPath contains "\\PerfLogs\\")) and ProcessCommandLine contains "ntds.dit")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_aspnet_compiler_exectuion.yml
AspNetCompiler Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "C:\\Windows\\Microsoft.NET\\Framework\\" or FolderPath contains "C:\\Windows\\Microsoft.NET\\Framework64\\") and FolderPath endswith "\\aspnet_compiler.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_netcat.yml
PUA - Netcat Suspicious Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -lvp " or ProcessCommandLine contains " -lvnp" or ProcessCommandLine contains " -l -v -p " or ProcessCommandLine contains " -lv -p " or ProcessCommandLine contains " -l --proxy-type http " or ProcessCommandLine contains " -vnl --exec " or ProcessCommandLine contains " -vnl -e " or ProcessCommandLine contains " --lua-exec " or ProcessCommandLine contains " --sh-exec ") or (FolderPath endswith "\\nc.exe" or FolderPath endswith "\\ncat.exe" or FolderPath endswith "\\netcat.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_createdump.yml
Renamed CreateDump Utility Execution ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains " -u " and ProcessCommandLine contains " -f " and ProcessCommandLine contains ".dmp") or (ProcessCommandLine contains " --full " and ProcessCommandLine contains " --name " and ProcessCommandLine contains ".dmp")) or ProcessVersionInfoOriginalFileName =~ "FX_VER_INTERNALNAME_STR") and (not(FolderPath endswith "\\createdump.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_devinit_lolbin_usage.yml
Arbitrary MSI Download Via Devinit.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -t msi-install " and ProcessCommandLine contains " -i http"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_dctask64.yml
Unexpected Error processing 'Renamed ZOHO Dctask64 Execution' (sigma/rules/windows/process_creation/proc_creation_win_renamed_dctask64.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_office_disable_python_security_warnings.yml
Python Function Execution Security Warning Disabled In Excel ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " 0" and (ProcessCommandLine contains "\\Microsoft\\Office\\" and ProcessCommandLine contains "\\Excel\\Security" and ProcessCommandLine contains "PythonFunctionWarnings")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_service_dir.yml
Suspicious Service Binary Directory ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\$Recycle.bin" or FolderPath contains "\\Users\\All Users\\" or FolderPath contains "\\Users\\Default\\" or FolderPath contains "\\Users\\Contacts\\" or FolderPath contains "\\Users\\Searches\\" or FolderPath contains "C:\\Perflogs\\" or FolderPath contains "\\config\\systemprofile\\" or FolderPath contains "\\Windows\\Fonts\\" or FolderPath contains "\\Windows\\IME\\" or FolderPath contains "\\Windows\\addins\\") and (InitiatingProcessFolderPath endswith "\\services.exe" or InitiatingProcessFolderPath endswith "\\svchost.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_disable_sec_services.yml
Security Service Disabled Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "\\AppIDSvc" or ProcessCommandLine contains "\\MsMpSvc" or ProcessCommandLine contains "\\NisSrv" or ProcessCommandLine contains "\\SecurityHealthService" or ProcessCommandLine contains "\\Sense" or ProcessCommandLine contains "\\UsoSvc" or ProcessCommandLine contains "\\WdBoot" or ProcessCommandLine contains "\\WdFilter" or ProcessCommandLine contains "\\WdNisDrv" or ProcessCommandLine contains "\\WdNisSvc" or ProcessCommandLine contains "\\WinDefend" or ProcessCommandLine contains "\\wscsvc" or ProcessCommandLine contains "\\wuauserv") and (ProcessCommandLine contains "d 4" and ProcessCommandLine contains "v Start")) and (ProcessCommandLine contains "reg" and ProcessCommandLine contains "add")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rar_compression_with_password.yml
Rar Usage with Password and Compression Level ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -hp" and (ProcessCommandLine contains " -m" or ProcessCommandLine contains " a ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrm_susp_child_process.yml
Suspicious Processes Spawned by WinRM ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wsl.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\bitsadmin.exe") and InitiatingProcessFolderPath endswith "\\wsmprovhost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_non_priv_reg_or_ps.yml
Non-privileged Usage of Reg or Powershell ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "reg " and ProcessCommandLine contains "add") or (ProcessCommandLine contains "powershell" or ProcessCommandLine contains "set-itemproperty" or ProcessCommandLine contains " sp " or ProcessCommandLine contains "new-itemproperty")) and ((ProcessCommandLine contains "ImagePath" or ProcessCommandLine contains "FailureCommand" or ProcessCommandLine contains "ServiceDLL") and (ProcessCommandLine contains "ControlSet" and ProcessCommandLine contains "Services") and (ProcessIntegrityLevel in~ ("Medium", "S-1-16-8192")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_susp_child_processes.yml
Suspicious MSHTA Child Process ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\bitsadmin.exe") or (ProcessVersionInfoOriginalFileName in~ ("Cmd.Exe", "PowerShell.EXE", "pwsh.dll", "wscript.exe", "cscript.exe", "Bash.exe", "reg.exe", "REGSVR32.EXE", "bitsadmin.exe"))) and InitiatingProcessFolderPath endswith "\\mshta.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_susp_psexec_paexec_flags.yml
Potential Privilege Escalation To LOCAL SYSTEM ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -s cmd" or ProcessCommandLine contains " /s cmd" or ProcessCommandLine contains " s cmd" or ProcessCommandLine contains " s cmd" or ProcessCommandLine contains " s cmd" or ProcessCommandLine contains " -s -i cmd" or ProcessCommandLine contains " -s /i cmd" or ProcessCommandLine contains " -s i cmd" or ProcessCommandLine contains " -s i cmd" or ProcessCommandLine contains " -s i cmd" or ProcessCommandLine contains " /s -i cmd" or ProcessCommandLine contains " /s /i cmd" or ProcessCommandLine contains " /s i cmd" or ProcessCommandLine contains " /s i cmd" or ProcessCommandLine contains " /s i cmd" or ProcessCommandLine contains " s -i cmd" or ProcessCommandLine contains " s /i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s -i cmd" or ProcessCommandLine contains " s /i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s -i cmd" or ProcessCommandLine contains " s /i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " s i cmd" or ProcessCommandLine contains " -i -s cmd" or ProcessCommandLine contains " -i /s cmd" or ProcessCommandLine contains " -i s cmd" or ProcessCommandLine contains " -i s cmd" or ProcessCommandLine contains " -i s cmd" or ProcessCommandLine contains " /i -s cmd" or ProcessCommandLine contains " /i /s cmd" or ProcessCommandLine contains " /i s cmd" or ProcessCommandLine contains " /i s cmd" or ProcessCommandLine contains " /i s cmd" or ProcessCommandLine contains " i -s cmd" or ProcessCommandLine contains " i /s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i -s cmd" or ProcessCommandLine contains " i /s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i -s cmd" or ProcessCommandLine contains " i /s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " i s cmd" or ProcessCommandLine contains " -s pwsh" or ProcessCommandLine contains " /s pwsh" or ProcessCommandLine contains " s pwsh" or ProcessCommandLine contains " s pwsh" or ProcessCommandLine contains " s pwsh" or ProcessCommandLine contains " -s -i pwsh" or ProcessCommandLine contains " -s /i pwsh" or ProcessCommandLine contains " -s i pwsh" or ProcessCommandLine contains " -s i pwsh" or ProcessCommandLine contains " -s i pwsh" or ProcessCommandLine contains " /s -i pwsh" or ProcessCommandLine contains " /s /i pwsh" or ProcessCommandLine contains " /s i pwsh" or ProcessCommandLine contains " /s i pwsh" or ProcessCommandLine contains " /s i pwsh" or ProcessCommandLine contains " s -i pwsh" or ProcessCommandLine contains " s /i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s -i pwsh" or ProcessCommandLine contains " s /i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s -i pwsh" or ProcessCommandLine contains " s /i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " s i pwsh" or ProcessCommandLine contains " -i -s pwsh" or ProcessCommandLine contains " -i /s pwsh" or ProcessCommandLine contains " -i s pwsh" or ProcessCommandLine contains " -i s pwsh" or ProcessCommandLine contains " -i s pwsh" or ProcessCommandLine contains " /i -s pwsh" or ProcessCommandLine contains " /i /s pwsh" or ProcessCommandLine contains " /i s pwsh" or ProcessCommandLine contains " /i s pwsh" or ProcessCommandLine contains " /i s pwsh" or ProcessCommandLine contains " i -s pwsh" or ProcessCommandLine contains " i /s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i -s pwsh" or ProcessCommandLine contains " i /s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i -s pwsh" or ProcessCommandLine contains " i /s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " i s pwsh" or ProcessCommandLine contains " -s powershell" or ProcessCommandLine contains " /s powershell" or ProcessCommandLine contains " s powershell" or ProcessCommandLine contains " s powershell" or ProcessCommandLine contains " s powershell" or ProcessCommandLine contains " -s -i powershell" or ProcessCommandLine contains " -s /i powershell" or ProcessCommandLine contains " -s i powershell" or ProcessCommandLine contains " -s i powershell" or ProcessCommandLine contains " -s i powershell" or ProcessCommandLine contains " /s -i powershell" or ProcessCommandLine contains " /s /i powershell" or ProcessCommandLine contains " /s i powershell" or ProcessCommandLine contains " /s i powershell" or ProcessCommandLine contains " /s i powershell" or ProcessCommandLine contains " s -i powershell" or ProcessCommandLine contains " s /i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s -i powershell" or ProcessCommandLine contains " s /i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s -i powershell" or ProcessCommandLine contains " s /i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " s i powershell" or ProcessCommandLine contains " -i -s powershell" or ProcessCommandLine contains " -i /s powershell" or ProcessCommandLine contains " -i s powershell" or ProcessCommandLine contains " -i s powershell" or ProcessCommandLine contains " -i s powershell" or ProcessCommandLine contains " /i -s powershell" or ProcessCommandLine contains " /i /s powershell" or ProcessCommandLine contains " /i s powershell" or ProcessCommandLine contains " /i s powershell" or ProcessCommandLine contains " /i s powershell" or ProcessCommandLine contains " i -s powershell" or ProcessCommandLine contains " i /s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i -s powershell" or ProcessCommandLine contains " i /s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i -s powershell" or ProcessCommandLine contains " i /s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell" or ProcessCommandLine contains " i s powershell") and (not((ProcessCommandLine contains "paexec" or ProcessCommandLine contains "PsExec" or ProcessCommandLine contains "accepteula")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_acccheckconsole_execution.yml
Potential DLL Injection Via AccCheckConsole ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -hwnd" or ProcessCommandLine contains " -process " or ProcessCommandLine contains " -window ") and (FolderPath endswith "\\AccCheckConsole.exe" or ProcessVersionInfoOriginalFileName =~ "AccCheckConsole.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_remote_share.yml
Suspicious Regsvr32 Execution From Remote Share ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " \\\\" and (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "\\REGSVR32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_uncommon_extension.yml
Regsvr32 DLL Execution With Uncommon Extension ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\regsvr32.exe" or ProcessVersionInfoOriginalFileName =~ "REGSVR32.EXE") and (not((ProcessCommandLine =~ "" or (ProcessCommandLine contains ".ax" or ProcessCommandLine contains ".cpl" or ProcessCommandLine contains ".dll" or ProcessCommandLine contains ".ocx") or isnull(ProcessCommandLine)))) and (not((ProcessCommandLine contains ".bav" or ProcessCommandLine contains ".ppl")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_mavinject_process_injection.yml
Mavinject Inject DLL Into Running Process ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " /INJECTRUNNING " and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\AppVClient.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_installutil_download.yml
File Download Via InstallUtil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ftp://" or ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\InstallUtil.exe" or ProcessVersionInfoOriginalFileName =~ "InstallUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_susp_program.yml
Sigma Transformation Error for 'Windows Shell/Scripting Processes Spawning Suspicious Programs': Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_webbrowserpassview.yml
PUA - WebBrowserPassView Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "Web Browser Password Viewer" or FolderPath endswith "\\WebBrowserPassView.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_esentutl_sensitive_file_copy.yml
Copying Sensitive Files with Credential Data ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "vss" or ProcessCommandLine contains " -m " or ProcessCommandLine contains " /m " or ProcessCommandLine contains " m " or ProcessCommandLine contains " m " or ProcessCommandLine contains " m " or ProcessCommandLine contains " -y " or ProcessCommandLine contains " /y " or ProcessCommandLine contains " y " or ProcessCommandLine contains " y " or ProcessCommandLine contains " y ") and (FolderPath endswith "\\esentutl.exe" or ProcessVersionInfoOriginalFileName =~ "\\esentutl.exe")) or (ProcessCommandLine contains "\\config\\RegBack\\sam" or ProcessCommandLine contains "\\config\\RegBack\\security" or ProcessCommandLine contains "\\config\\RegBack\\system" or ProcessCommandLine contains "\\config\\sam" or ProcessCommandLine contains "\\config\\security" or ProcessCommandLine contains "\\config\\system " or ProcessCommandLine contains "\\repair\\sam" or ProcessCommandLine contains "\\repair\\security" or ProcessCommandLine contains "\\repair\\system" or ProcessCommandLine contains "\\windows\\ntds\\ntds.dit")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_delete_all.yml
Delete All Scheduled Tasks ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /delete " and ProcessCommandLine contains "/tn *" and ProcessCommandLine contains " /f") and FolderPath endswith "\\schtasks.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sndvol_susp_child_processes.yml
Uncommon Child Processes Of SndVol.exe ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\SndVol.exe" and (not((ProcessCommandLine contains " shell32.dll,Control_RunDLL " and FolderPath endswith "\\rundll32.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpup.yml
HackTool - SharpUp PrivEsc Tool Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\SharpUp.exe" or ProcessVersionInfoFileDescription =~ "SharpUp" or (ProcessCommandLine contains "HijackablePaths" or ProcessCommandLine contains "UnquotedServicePath" or ProcessCommandLine contains "ProcessDLLHijack" or ProcessCommandLine contains "ModifiableServiceBinaries" or ProcessCommandLine contains "ModifiableScheduledTask" or ProcessCommandLine contains "DomainGPPPassword" or ProcessCommandLine contains "CachedGPPPassword")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mshta_susp_execution.yml
MSHTA Suspicious Execution 01 ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "vbscript" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".lnk" or ProcessCommandLine contains ".xls" or ProcessCommandLine contains ".doc" or ProcessCommandLine contains ".zip" or ProcessCommandLine contains ".dll") and FolderPath endswith "\\mshta.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpevtmute.yml
HackTool - SharpEvtMute Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\SharpEvtMute.exe" or ProcessVersionInfoFileDescription =~ "SharpEvtMute" or (ProcessCommandLine contains "--Filter \"rule " or ProcessCommandLine contains "--Encoded --Filter \\\"")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_driverquery_recon.yml
Potential Recon Activity Using DriverQuery.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "driverquery.exe" or ProcessVersionInfoOriginalFileName =~ "drvqry.exe") and ((InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\" or InitiatingProcessFolderPath contains "\\Users\\Public\\" or InitiatingProcessFolderPath contains "\\Windows\\Temp\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_runexehelper.yml
Lolbin Runexehelper Use As Proxy ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\runexehelper.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_potential_persistence.yml
Monitoring For Persistence Via BITS ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\bitsadmin.exe" or ProcessVersionInfoOriginalFileName =~ "bitsadmin.exe") and ((ProcessCommandLine contains "/SetNotifyCmdLine" and (ProcessCommandLine contains "%COMSPEC%" or ProcessCommandLine contains "cmd.exe" or ProcessCommandLine contains "regsvr32.exe")) or (ProcessCommandLine contains "/Addfile" and (ProcessCommandLine contains "http:" or ProcessCommandLine contains "https:" or ProcessCommandLine contains "ftp:" or ProcessCommandLine contains "ftps:")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_xor_commandline.yml
Suspicious XOR Encoded PowerShell Command ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ForEach" or ProcessCommandLine contains "for(" or ProcessCommandLine contains "for " or ProcessCommandLine contains "-join " or ProcessCommandLine contains "-join'" or ProcessCommandLine contains "-join\"" or ProcessCommandLine contains "-join`" or ProcessCommandLine contains "::Join" or ProcessCommandLine contains "[char]") and ProcessCommandLine contains "bxor" and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")) or ProcessVersionInfoFileDescription =~ "Windows PowerShell" or ProcessVersionInfoProductName =~ "PowerShell Core 6")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_frombase64string_archive.yml
Suspicious FromBase64String Usage On Gzip Archive - Process Creation ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "FromBase64String" and ProcessCommandLine contains "MemoryStream" and ProcessCommandLine contains "H4sI"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_pingcastle_script_parent.yml
PUA - PingCastle Execution From Potentially Suspicious Parent ---> KQL Query:
DeviceProcessEvents
| where ((InitiatingProcessCommandLine contains ".bat" or InitiatingProcessCommandLine contains ".chm" or InitiatingProcessCommandLine contains ".cmd" or InitiatingProcessCommandLine contains ".hta" or InitiatingProcessCommandLine contains ".htm" or InitiatingProcessCommandLine contains ".html" or InitiatingProcessCommandLine contains ".js" or InitiatingProcessCommandLine contains ".lnk" or InitiatingProcessCommandLine contains ".ps1" or InitiatingProcessCommandLine contains ".vbe" or InitiatingProcessCommandLine contains ".vbs" or InitiatingProcessCommandLine contains ".wsf") or (InitiatingProcessCommandLine contains ":\\Perflogs\\" or InitiatingProcessCommandLine contains ":\\Temp\\" or InitiatingProcessCommandLine contains ":\\Users\\Public\\" or InitiatingProcessCommandLine contains ":\\Windows\\Temp\\" or InitiatingProcessCommandLine contains "\\AppData\\Local\\Temp" or InitiatingProcessCommandLine contains "\\AppData\\Roaming\\" or InitiatingProcessCommandLine contains "\\Temporary Internet") or ((InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Favorites\\") or (InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Favourites\\") or (InitiatingProcessCommandLine contains ":\\Users\\" and InitiatingProcessCommandLine contains "\\Contacts\\"))) and (InitiatingProcessCommandLine contains ".bat" or InitiatingProcessCommandLine contains ".chm" or InitiatingProcessCommandLine contains ".cmd" or InitiatingProcessCommandLine contains ".hta" or InitiatingProcessCommandLine contains ".htm" or InitiatingProcessCommandLine contains ".html" or InitiatingProcessCommandLine contains ".js" or InitiatingProcessCommandLine contains ".lnk" or InitiatingProcessCommandLine contains ".ps1" or InitiatingProcessCommandLine contains ".vbe" or InitiatingProcessCommandLine contains ".vbs" or InitiatingProcessCommandLine contains ".wsf") and (FolderPath endswith "\\PingCastle.exe" or ProcessVersionInfoOriginalFileName =~ "PingCastle.exe" or ProcessVersionInfoProductName =~ "Ping Castle" or (ProcessCommandLine contains "--scanner aclcheck" or ProcessCommandLine contains "--scanner antivirus" or ProcessCommandLine contains "--scanner computerversion" or ProcessCommandLine contains "--scanner foreignusers" or ProcessCommandLine contains "--scanner laps_bitlocker" or ProcessCommandLine contains "--scanner localadmin" or ProcessCommandLine contains "--scanner nullsession" or ProcessCommandLine contains "--scanner nullsession-trust" or ProcessCommandLine contains "--scanner oxidbindings" or ProcessCommandLine contains "--scanner remote" or ProcessCommandLine contains "--scanner share" or ProcessCommandLine contains "--scanner smb" or ProcessCommandLine contains "--scanner smb3querynetwork" or ProcessCommandLine contains "--scanner spooler" or ProcessCommandLine contains "--scanner startup" or ProcessCommandLine contains "--scanner zerologon") or ProcessCommandLine contains "--no-enum-limit" or (ProcessCommandLine contains "--healthcheck" and ProcessCommandLine contains "--level Full") or (ProcessCommandLine contains "--healthcheck" and ProcessCommandLine contains "--server "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_system_exe_anomaly.yml
System File Execution Location Anomaly ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\atbroker.exe" or FolderPath endswith "\\audiodg.exe" or FolderPath endswith "\\bcdedit.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\certreq.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmstp.exe" or FolderPath endswith "\\conhost.exe" or FolderPath endswith "\\consent.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\csrss.exe" or FolderPath endswith "\\dashost.exe" or FolderPath endswith "\\defrag.exe" or FolderPath endswith "\\dfrgui.exe" or FolderPath endswith "\\dism.exe" or FolderPath endswith "\\dllhost.exe" or FolderPath endswith "\\dllhst3g.exe" or FolderPath endswith "\\dwm.exe" or FolderPath endswith "\\eventvwr.exe" or FolderPath endswith "\\logonui.exe" or FolderPath endswith "\\LsaIso.exe" or FolderPath endswith "\\lsass.exe" or FolderPath endswith "\\lsm.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\ntoskrnl.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\runonce.exe" or FolderPath endswith "\\RuntimeBroker.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\services.exe" or FolderPath endswith "\\sihost.exe" or FolderPath endswith "\\smartscreen.exe" or FolderPath endswith "\\smss.exe" or FolderPath endswith "\\spoolsv.exe" or FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\taskhost.exe" or FolderPath endswith "\\Taskmgr.exe" or FolderPath endswith "\\userinit.exe" or FolderPath endswith "\\wininit.exe" or FolderPath endswith "\\winlogon.exe" or FolderPath endswith "\\winver.exe" or FolderPath endswith "\\wlanext.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\wsl.exe" or FolderPath endswith "\\wsmprovhost.exe") and (not(((FolderPath startswith "C:\\$WINDOWS.~BT\\" or FolderPath startswith "C:\\$WinREAgent\\" or FolderPath startswith "C:\\Windows\\SoftwareDistribution\\" or FolderPath startswith "C:\\Windows\\System32\\" or FolderPath startswith "C:\\Windows\\SystemTemp\\" or FolderPath startswith "C:\\Windows\\SysWOW64\\" or FolderPath startswith "C:\\Windows\\uus\\" or FolderPath startswith "C:\\Windows\\WinSxS\\") or (FolderPath in~ ("C:\\Program Files\\PowerShell\\7\\pwsh.exe", "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe")) or (FolderPath endswith "\\wsl.exe" and FolderPath startswith "C:\\Program Files\\WindowsApps\\MicrosoftCorporationII.WindowsSubsystemForLinux")))) and (not(FolderPath contains "\\SystemRoot\\System32\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_diantz_remote_cab.yml
Suspicious Diantz Download and Compress Into a CAB File ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "diantz.exe" and ProcessCommandLine contains " \\\\" and ProcessCommandLine contains ".cab"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_psexec_service.yml
Renamed PsExec Service Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "psexesvc.exe" and (not(FolderPath =~ "C:\\Windows\\PSEXESVC.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gup_arbitrary_binary_execution.yml
Arbitrary Binary Execution Using GUP Utility ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\explorer.exe" and InitiatingProcessFolderPath endswith "\\gup.exe") and (not(((ProcessCommandLine contains "\\Notepad++\\notepad++.exe" and FolderPath endswith "\\explorer.exe") or isnull(ProcessCommandLine) or InitiatingProcessFolderPath contains "\\Notepad++\\updater\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_procdump_evasion.yml
Potential SysInternals ProcDump Evasion ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "copy procdump" or ProcessCommandLine contains "move procdump") or ((ProcessCommandLine contains "2.dmp" or ProcessCommandLine contains "lsass" or ProcessCommandLine contains "out.dmp") and (ProcessCommandLine contains "copy " and ProcessCommandLine contains ".dmp ")) or (ProcessCommandLine contains "copy lsass.exe_" or ProcessCommandLine contains "move lsass.exe_")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tapinstall_execution.yml
Tap Installer Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\tapinstall.exe" and (not(((FolderPath contains ":\\Program Files\\Avast Software\\SecureLine VPN\\" or FolderPath contains ":\\Program Files (x86)\\Avast Software\\SecureLine VPN\\") or FolderPath contains ":\\Program Files\\OpenVPN Connect\\drivers\\tap\\" or FolderPath contains ":\\Program Files (x86)\\Proton Technologies\\ProtonVPNTap\\installer\\")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_sticky_key_like_backdoor_execution.yml
Sticky Key Like Backdoor Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "sethc.exe" or ProcessCommandLine contains "utilman.exe" or ProcessCommandLine contains "osk.exe" or ProcessCommandLine contains "Magnify.exe" or ProcessCommandLine contains "Narrator.exe" or ProcessCommandLine contains "DisplaySwitch.exe") and (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\wt.exe") and InitiatingProcessFolderPath endswith "\\winlogon.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_run_script_from_ads.yml
Run PowerShell Script from ADS ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Get-Content" and ProcessCommandLine contains "-Stream") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") and (InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_takeown_recursive_own.yml
Suspicious Recursive Takeown ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/f " and ProcessCommandLine contains "/r") and FolderPath endswith "\\takeown.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_vbs_execute_psh.yml
SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\SyncAppvPublishingServer.vbs" and ProcessCommandLine contains ";"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_splwow64_cli_anomaly.yml
Suspicious Splwow64 Without Params ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith "splwow64.exe" and FolderPath endswith "\\splwow64.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_forfiles_child_process_masquerading.yml
Forfiles.EXE Child Process Masquerading ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine startswith "/c echo \"" and FolderPath endswith "\\cmd.exe" and (InitiatingProcessCommandLine endswith ".exe" or InitiatingProcessCommandLine endswith ".exe\"")) and (not(((FolderPath contains ":\\Windows\\System32\\" or FolderPath contains ":\\Windows\\SysWOW64\\") and FolderPath endswith "\\cmd.exe" and (InitiatingProcessFolderPath contains ":\\Windows\\System32\\" or InitiatingProcessFolderPath contains ":\\Windows\\SysWOW64\\") and InitiatingProcessFolderPath endswith "\\forfiles.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wbadmin_restore_file.yml
File Recovery From Backup Via Wbadmin.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " recovery" and ProcessCommandLine contains "recoveryTarget" and ProcessCommandLine contains "itemtype:File") and (FolderPath endswith "\\wbadmin.exe" or ProcessVersionInfoOriginalFileName =~ "WBADMIN.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_whoami.yml
Renamed Whoami Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "whoami.exe" and (not(FolderPath endswith "\\whoami.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_tor_execution.yml
Tor Client/Browser Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\tor.exe" or FolderPath endswith "\\Tor Browser\\Browser\\firefox.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_autohotkey.yml
Renamed AutoHotkey.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoProductName contains "AutoHotkey" or ProcessVersionInfoFileDescription contains "AutoHotkey" or (ProcessVersionInfoOriginalFileName in~ ("AutoHotkey.exe", "AutoHotkey.rc"))) and (not(((FolderPath endswith "\\AutoHotkey.exe" or FolderPath endswith "\\AutoHotkey32.exe" or FolderPath endswith "\\AutoHotkey32_UIA.exe" or FolderPath endswith "\\AutoHotkey64.exe" or FolderPath endswith "\\AutoHotkey64_UIA.exe" or FolderPath endswith "\\AutoHotkeyA32.exe" or FolderPath endswith "\\AutoHotkeyA32_UIA.exe" or FolderPath endswith "\\AutoHotkeyU32.exe" or FolderPath endswith "\\AutoHotkeyU32_UIA.exe" or FolderPath endswith "\\AutoHotkeyU64.exe" or FolderPath endswith "\\AutoHotkeyU64_UIA.exe") or FolderPath contains "\\AutoHotkey")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dotnet_trace_lolbin_execution.yml
Binary Proxy Execution Via Dotnet-Trace.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-- " and ProcessCommandLine contains "collect") and (FolderPath endswith "\\dotnet-trace.exe" or ProcessVersionInfoOriginalFileName =~ "dotnet-trace.dll")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_direct_ip.yml
Suspicious Invoke-WebRequest Execution With DirectIP ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "curl " or ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "wget ") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine contains "://1" or ProcessCommandLine contains "://2" or ProcessCommandLine contains "://3" or ProcessCommandLine contains "://4" or ProcessCommandLine contains "://5" or ProcessCommandLine contains "://6" or ProcessCommandLine contains "://7" or ProcessCommandLine contains "://8" or ProcessCommandLine contains "://9")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_disable.yml
Firewall Disabled via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe") and ((ProcessCommandLine contains "firewall" and ProcessCommandLine contains "set" and ProcessCommandLine contains "opmode" and ProcessCommandLine contains "disable") or (ProcessCommandLine contains "advfirewall" and ProcessCommandLine contains "set" and ProcessCommandLine contains "state" and ProcessCommandLine contains "off"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wmp.yml
UAC Bypass Using Windows Media Player - Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath =~ "C:\\Program Files\\Windows Media Player\\osk.exe" or (FolderPath =~ "C:\\Windows\\System32\\cmd.exe" and InitiatingProcessCommandLine =~ "\"C:\\Windows\\system32\\mmc.exe\" \"C:\\Windows\\system32\\eventvwr.msc\" /s")) and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_fltmc_unload_driver_sysmon.yml
Sysmon Driver Unloaded Via Fltmc.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "unload" and ProcessCommandLine contains "sysmon") and (FolderPath endswith "\\fltMC.exe" or ProcessVersionInfoOriginalFileName =~ "fltMC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dirlister_execution.yml
DirLister Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "DirLister.exe" or FolderPath endswith "\\dirlister.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wuauclt_no_cli_flags_execution.yml
Suspicious Windows Update Agent Empty Cmdline ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "Wuauclt" or ProcessCommandLine endswith "Wuauclt.exe") and (FolderPath endswith "\\Wuauclt.exe" or ProcessVersionInfoOriginalFileName =~ "Wuauclt.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_import_from_suspicious_paths.yml
Potential Suspicious Registry File Imported Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " import " and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe") and (ProcessCommandLine contains "C:\\Users\\" or ProcessCommandLine contains "%temp%" or ProcessCommandLine contains "%tmp%" or ProcessCommandLine contains "%appdata%" or ProcessCommandLine contains "\\AppData\\Local\\Temp\\" or ProcessCommandLine contains "C:\\Windows\\Temp\\" or ProcessCommandLine contains "C:\\ProgramData\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dotnet_arbitrary_dll_csproj_execution.yml
Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".csproj" or ProcessCommandLine endswith ".csproj\"" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".dll\"" or ProcessCommandLine endswith ".csproj'" or ProcessCommandLine endswith ".dll'") and (FolderPath endswith "\\dotnet.exe" or ProcessVersionInfoOriginalFileName =~ ".NET Host")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_sysinternals_debugview.yml
Renamed SysInternals DebugView Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoProductName =~ "Sysinternals DebugView" and (not((FolderPath endswith "\\Dbgview.exe" and ProcessVersionInfoOriginalFileName =~ "Dbgview.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_eventconsumer_creation.yml
New ActiveScriptEventConsumer Created Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "ActiveScriptEventConsumer" and ProcessCommandLine contains " CREATE "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_proc_wrong_parent.yml
Windows Processes Suspicious Parent Directory ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\taskhost.exe" or FolderPath endswith "\\lsm.exe" or FolderPath endswith "\\lsass.exe" or FolderPath endswith "\\services.exe" or FolderPath endswith "\\lsaiso.exe" or FolderPath endswith "\\csrss.exe" or FolderPath endswith "\\wininit.exe" or FolderPath endswith "\\winlogon.exe") and (not((((InitiatingProcessFolderPath contains "\\Windows Defender\\" or InitiatingProcessFolderPath contains "\\Microsoft Security Client\\") and InitiatingProcessFolderPath endswith "\\MsMpEng.exe") or (isnull(InitiatingProcessFolderPath) or (InitiatingProcessFolderPath in~ ("", "-"))) or ((InitiatingProcessFolderPath endswith "\\SavService.exe" or InitiatingProcessFolderPath endswith "\\ngen.exe") or (InitiatingProcessFolderPath contains "\\System32\\" or InitiatingProcessFolderPath contains "\\SysWOW64\\")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msdt_susp_parent.yml
Suspicious MSDT Parent Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\msdt.exe" or ProcessVersionInfoOriginalFileName =~ "msdt.exe") and (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\schtasks.exe" or InitiatingProcessFolderPath endswith "\\wmic.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\wsl.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_logmein.yml
Remote Access Tool - LogMeIn Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "LMIGuardianSvc" or ProcessVersionInfoProductName =~ "LMIGuardianSvc" or ProcessVersionInfoCompanyName =~ "LogMeIn, Inc."

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_onenote_susp_child_processes.yml
Suspicious Microsoft OneNote Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\onenote.exe" and (((ProcessCommandLine contains ".hta" or ProcessCommandLine contains ".vb" or ProcessCommandLine contains ".wsh" or ProcessCommandLine contains ".js" or ProcessCommandLine contains ".ps" or ProcessCommandLine contains ".scr" or ProcessCommandLine contains ".pif" or ProcessCommandLine contains ".bat" or ProcessCommandLine contains ".cmd") and FolderPath endswith "\\explorer.exe") or ((ProcessVersionInfoOriginalFileName in~ ("bitsadmin.exe", "CertOC.exe", "CertUtil.exe", "Cmd.Exe", "CMSTP.EXE", "cscript.exe", "curl.exe", "HH.exe", "IEExec.exe", "InstallUtil.exe", "javaw.exe", "Microsoft.Workflow.Compiler.exe", "msdt.exe", "MSHTA.EXE", "msiexec.exe", "Msxsl.exe", "odbcconf.exe", "pcalua.exe", "PowerShell.EXE", "RegAsm.exe", "RegSvcs.exe", "REGSVR32.exe", "RUNDLL32.exe", "schtasks.exe", "ScriptRunner.exe", "wmic.exe", "WorkFolders.exe", "wscript.exe")) or (FolderPath endswith "\\AppVLP.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\certoc.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cmstp.exe" or FolderPath endswith "\\control.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\forfiles.exe" or FolderPath endswith "\\hh.exe" or FolderPath endswith "\\ieexec.exe" or FolderPath endswith "\\installutil.exe" or FolderPath endswith "\\javaw.exe" or FolderPath endswith "\\mftrace.exe" or FolderPath endswith "\\Microsoft.Workflow.Compiler.exe" or FolderPath endswith "\\msbuild.exe" or FolderPath endswith "\\msdt.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msidb.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\msxsl.exe" or FolderPath endswith "\\odbcconf.exe" or FolderPath endswith "\\pcalua.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regasm.exe" or FolderPath endswith "\\regsvcs.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\scrcons.exe" or FolderPath endswith "\\scriptrunner.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\svchost.exe" or FolderPath endswith "\\verclsid.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\workfolders.exe" or FolderPath endswith "\\wscript.exe")) or (FolderPath contains "\\AppData\\" or FolderPath contains "\\Users\\Public\\" or FolderPath contains "\\ProgramData\\" or FolderPath contains "\\Windows\\Tasks\\" or FolderPath contains "\\Windows\\Temp\\" or FolderPath contains "\\Windows\\System32\\Tasks\\")) and (not(((ProcessCommandLine endswith "-Embedding" and FolderPath contains "\\AppData\\Local\\Microsoft\\OneDrive\\" and FolderPath endswith "\\FileCoAuth.exe") or (ProcessCommandLine endswith "-Embedding" and FolderPath endswith "\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msedge_proxy_download.yml
Arbitrary File Download Via MSEDGE_PROXY.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\msedge_proxy.exe" or ProcessVersionInfoOriginalFileName =~ "msedge_proxy.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_java_sysaidserver_susp_child_process.yml
Suspicious SysAidServer Child ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessCommandLine contains "SysAidServer" and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wscript_cscript_susp_child_processes.yml
Cscript/Wscript Potentially Suspicious Child Process ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe") and (FolderPath endswith "\\rundll32.exe" or ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") and ((ProcessCommandLine contains "mshta" and ProcessCommandLine contains "http") or (ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "msiexec")))) and (not(((ProcessCommandLine contains "UpdatePerUserSystemParameters" or ProcessCommandLine contains "PrintUIEntry" or ProcessCommandLine contains "ClearMyTracksByProcess") and FolderPath endswith "\\rundll32.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_escape_char.yml
Potential Commandline Obfuscation Using Escape Characters ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "h^t^t^p" or ProcessCommandLine contains "h\"t\"t\"p"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ieexec_download.yml
File Download And Execution Via IEExec.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\IEExec.exe" or ProcessVersionInfoOriginalFileName =~ "IEExec.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_pingcastle.yml
PUA - PingCastle Execution ---> KQL Query:
DeviceProcessEvents
| where ((MD5 startswith "f741f25ac909ee434e50812d436c73ff" or MD5 startswith "d40acbfc29ee24388262e3d8be16f622" or MD5 startswith "01bb2c16fadb992fa66228cd02d45c60" or MD5 startswith "9e1b18e62e42b5444fc55b51e640355b" or MD5 startswith "b7f8fe33ac471b074ca9e630ba0c7e79" or MD5 startswith "324579d717c9b9b8e71d0269d13f811f" or MD5 startswith "63257a1ddaf83cfa43fe24a3bc06c207" or MD5 startswith "049e85963826b059c9bac273bb9c82ab" or MD5 startswith "ecb98b7b4d4427eb8221381154ff4cb2" or MD5 startswith "faf87749ac790ec3a10dd069d10f9d63" or MD5 startswith "f296dba5d21ad18e6990b1992aea8f83" or MD5 startswith "93ba94355e794b6c6f98204cf39f7a11" or MD5 startswith "a258ef593ac63155523a461ecc73bdba" or MD5 startswith "97000eb5d1653f1140ee3f47186463c4" or MD5 startswith "95eb317fbbe14a82bd9fdf31c48b8d93" or MD5 startswith "32fe9f0d2630ac40ea29023920f20f49" or MD5 startswith "a05930dde939cfd02677fc18bb2b7df5" or MD5 startswith "124283924e86933ff9054a549d3a268b" or MD5 startswith "ceda6909b8573fdeb0351c6920225686" or MD5 startswith "60ce120040f2cd311c810ae6f6bbc182" or MD5 startswith "2f10cdc5b09100a260703a28eadd0ceb" or MD5 startswith "011d967028e797a4c16d547f7ba1463f" or MD5 startswith "2da9152c0970500c697c1c9b4a9e0360" or MD5 startswith "b5ba72034b8f44d431f55275bace9f8b" or MD5 startswith "d6ed9101df0f24e27ff92ddab42dacca" or MD5 startswith "3ed3cdb6d12aa1ac562ad185cdbf2d1d" or MD5 startswith "5e083cd0143ae95a6cb79b68c07ca573" or MD5 startswith "28caff93748cb84be70486e79f04c2df" or MD5 startswith "9d4f12c30f9b500f896efd1800e4dd11" or MD5 startswith "4586f7dd14271ad65a5fb696b393f4c0" or MD5 startswith "86ba9dddbdf49215145b5bcd081d4011" or MD5 startswith "9dce0a481343874ef9a36c9a825ef991" or MD5 startswith "85890f62e231ad964b1fda7a674747ec" or MD5 startswith "599be548da6441d7fe3e9a1bb8cb0833" or MD5 startswith "9b0c7fd5763f66e9b8c7b457fce53f96" or MD5 startswith "32d45718164205aec3e98e0223717d1d" or MD5 startswith "6ff5f373ee7f794cd17db50704d00ddb" or MD5 startswith "88efbdf41f0650f8f58a3053b0ca0459" or MD5 startswith "ef915f61f861d1fb7cbde9afd2e7bd93" or MD5 startswith "781fa16511a595757154b4304d2dd350" or MD5 startswith "5018ec39be0e296f4fc8c8575bfa8486" or MD5 startswith "f4a84d6f1caf0875b50135423d04139f") or (SHA1 startswith "9c1431801fa6342ed68f047842b9a11778fc669b" or SHA1 startswith "c36c862f40dad78cb065197aad15fef690c262f2" or SHA1 startswith "bc8e23faea8b3c537f268b3e81d05b937012272d" or SHA1 startswith "12e0357658614ff60d480d1a6709be68a2e40c5f" or SHA1 startswith "18b33ab5719966393d424a3edbfa8dec225d98fa" or SHA1 startswith "f14c9633040897d375e3069fddc71e859f283778" or SHA1 startswith "08041b426c9f112ad2061bf3c8c718e34739d4fc" or SHA1 startswith "7be77c885d0c9a4af4cecc64d512987cf93ba937" or SHA1 startswith "72dbb719b05f89d9d2dbdf186714caf7639daa36" or SHA1 startswith "5b1498beb2cfb4d971e377801e7abce62c0e315b" or SHA1 startswith "292629c6ab33bddf123d26328025e2d157d9e8fc" or SHA1 startswith "be59e621e83a2d4c87b0e6c69a2d22f175408b11" or SHA1 startswith "0250ce9a716ab8cca1c70a9de4cbc49a51934995" or SHA1 startswith "607e1fa810c799735221a609af3bfc405728c02d" or SHA1 startswith "ab1c547f6d1c07a9e0a01e46adea3aae1cac12e3" or SHA1 startswith "044cf5698a8e6b0aeba5acb56567f06366a9a70a" or SHA1 startswith "ef2dea8c736d49607832986c6c2d6fdd68ba6491" or SHA1 startswith "efffc2bfb8af2e3242233db9a7109b903fc3f178" or SHA1 startswith "5a05d4320de9afbc84de8469dd02b3a109efb2d4" or SHA1 startswith "a785d88cf8b862a420b9be793ee6a9616aa94c84" or SHA1 startswith "5688d56cbaf0d934c4e37b112ba257e8fb63f4ea" or SHA1 startswith "5cd2ada1c26815fbfd6a0cd746d5d429c0d83a17" or SHA1 startswith "81d67b3d70c4e855cb11a453cc32997517708362" or SHA1 startswith "9cffce9de95e0109f4dfecce0ab2cb0a59cc58ad" or SHA1 startswith "09c6930d057f49c1c1e11cf9241fffc8c12df3a2" or SHA1 startswith "e27bf7db8d96db9d4c8a06ee5e9b8e9fcb86ac92" or SHA1 startswith "9e3c992415e390f9ada4d15c693b687f38a492d1" or SHA1 startswith "3f34a5ee303d37916584c888c4928e1c1164f92a" or SHA1 startswith "ea4c8c56a8f5c90a4c08366933e5fb2de611d0db" or SHA1 startswith "3150f14508ee4cae19cf09083499d1cda8426540" or SHA1 startswith "036ad9876fa552b1298c040e233d620ea44689c6" or SHA1 startswith "3a3c1dcb146bb4616904157344ce1a82cd173bf5" or SHA1 startswith "6230d6fca973fa26188dfbadede57afb4c15f75c" or SHA1 startswith "8f7b2a9b8842f339b1e33602b7f926ab65de1a4d" or SHA1 startswith "a586bb06b59a4736a47abff8423a54fe8e2c05c4" or SHA1 startswith "c82152cddf9e5df49094686531872ecd545976db" or SHA1 startswith "04c39ffc18533100aaa4f9c06baf2c719ac94a61" or SHA1 startswith "e082affa5cdb2d46452c6601a9e85acb8446b836" or SHA1 startswith "a075bfb6cf5c6451ce682197a87277c8bc188719" or SHA1 startswith "34c0c5839af1c92bce7562b91418443a2044c90d" or SHA1 startswith "74e10a9989e0ec8fe075537ac802bd3031ae7e08" or SHA1 startswith "3a515551814775df0ccbe09f219bc972eae45a10") or (SHA256 startswith "90fd5b855b5107e7abaaefb6e658f50d5d6e08ac28e35f31d8b03dcabf77872b" or SHA256 startswith "5836c24f233f77342fee825f3cad73caab7ab4fb65ec2aec309fd12bc1317e85" or SHA256 startswith "e850e54b12331249c357a20604281b9abf8a91e6f3d957463fc625e6b126ef03" or SHA256 startswith "9e752f29edcd0db9931c20b173eee8d4d8196f87382c68a6e7eb4c8a44d58795" or SHA256 startswith "7a8c127d6c41f80d178d2315ed2f751ac91b1cd54d008af13680e04f068f426f" or SHA256 startswith "9f65e1c142c4f814e056a197a2241fd09e09acf245c62897109871137321a72a" or SHA256 startswith "c9b52d03c66d54d6391c643b3559184b1425c84a372081ec2bfed07ebf6af275" or SHA256 startswith "1b96f6218498aa6baf6f6c15b8f99e542077e33feb1ab5472bbbf7d4de43eb6b" or SHA256 startswith "768021fc242054decc280675750dec0a9e74e764b8646864c58756fa2386d2a2" or SHA256 startswith "1e1b32bef31be040f0f038fcb5a2d68fb192daaef23c6167f91793d21e06ebae" or SHA256 startswith "606bd75ed9d2d6107ea7ee67063d1761a99f2fb5e932c8344d11395d24587dd6" or SHA256 startswith "b489d3cdd158f040322ae5c8d0139ad28eff743c738a10f2d0255c7e149bd92a" or SHA256 startswith "ca7ecf04a8ad63aff330492c15270d56760cb223a607cdb1431fb00e1b9985d1" or SHA256 startswith "9dc4fca72463078b70f6516559a179c78400b06534e63ee12fb38adbe2632559" or SHA256 startswith "c00d2aee59bac087d769e09b5b7f832176f7714fefdc6af2502e6031e3eb37c2" or SHA256 startswith "a8e96d564687064190eaf865774f773def05fdbf651aa5bbf66216c077b863ef" or SHA256 startswith "84ed328cee2a0505e87662faf6fc57915e3a831c97ee88ad691f5c63522e139d" or SHA256 startswith "c143de99c57965d3a44c1fce6a97c2773b050609c1ea7f45688a4ca2422a5524" or SHA256 startswith "01d1efd5e552c59baa70c0778902233c05fde7de6e5cc156c62607df0804d36b" or SHA256 startswith "9a8dfeb7e3174f3510691e2b32d0f9088e0ed67d9ed1b2afbe450d70dec2016b" or SHA256 startswith "63b92a114075d855f706979d50ed3460fe39f8a2f5498b7657f0d14865117629" or SHA256 startswith "2eb014130ff837b6481c26f0d0152f84de22ca7370b15a4f51921e0054a2a358" or SHA256 startswith "7d5bb4271bf8ca2b63a59e731f3ec831dbda53adb8e28665e956afb4941f32ca" or SHA256 startswith "e57098a75bf32e127c214b61bfba492d6b209e211f065fcc84ff10637a2143ea" or SHA256 startswith "dd14dbcdbcfcf4bc108a926b9667af4944a3b6faf808cf1bb9a3a2554722e172" or SHA256 startswith "dca2b1b824cb28bd15577eace45bde7ff8f8f44705b17085524659de31761de4" or SHA256 startswith "8b95f339a07d59a8c8d8580283dffb9e8dfabdeb9171e42c948ab68c71afe7f2" or SHA256 startswith "5428a840fab6ac4a0ecb2fc20dbc5f928432b00b9297dd1cb6e69336f44eba66" or SHA256 startswith "e2517ae0fccaa4aefe039026a4fc855964f0c2a5f84177140200b0e58ddbfd27" or SHA256 startswith "75d05880de2593480254181215dd9a0075373876f2f4a2a4a9a654b2e0729a41" or SHA256 startswith "56490e14ce3817c3a1ddc0d97b96e90d6351bcd29914e7c9282f6a998cca84b1" or SHA256 startswith "f25d0a5e77e4ed9e7c4204a33cfc8e46281b43adbee550b15701dd00f41bdbe0" or SHA256 startswith "845a5fdcbb08e7efa7e0eabfcd881c9eebc0eec0a3a2f8689194e6b91b6eeaf8" or SHA256 startswith "9a89e6652e563d26a3f328ba23d91f464c9549da734557c5a02559df24b2700d" or SHA256 startswith "5614f2bc9b2ed414aab2c5c7997bdcbe8236e67ced8f91a63d1b6cfbe6e08726" or SHA256 startswith "37bf92dcedb47a90d8d38ebda8d8dd168ef5803dcb01161f8cf6d68b70d49d90" or SHA256 startswith "ec8590f91f5cc21e931c57345425f0625a6e37dfba026b222260450de40459f5" or SHA256 startswith "3994eb72b1c227c593e14b8cad7001de11d1c247d4fbf84d0714bb8a17853140" or SHA256 startswith "d654f870436d63c9d8e4390d9d4d898abdf0456736c7654d71cdf81a299c3f87" or SHA256 startswith "63fbfabd4d8afb497dee47d112eb9d683671b75a8bf6407c4bd5027fd211b892" or SHA256 startswith "47028053f05188e6a366fff19bedbcad2bc4daba8ff9e4df724b77d0181b7054" or SHA256 startswith "7c1b1e8c880a30c43b3a52ee245f963a977e1f40284f4b83f4b9afe3821753dd")) or FolderPath endswith "\\PingCastle.exe" or ProcessVersionInfoOriginalFileName =~ "PingCastle.exe" or ProcessVersionInfoProductName =~ "Ping Castle" or (ProcessCommandLine contains "--scanner aclcheck" or ProcessCommandLine contains "--scanner antivirus" or ProcessCommandLine contains "--scanner computerversion" or ProcessCommandLine contains "--scanner foreignusers" or ProcessCommandLine contains "--scanner laps_bitlocker" or ProcessCommandLine contains "--scanner localadmin" or ProcessCommandLine contains "--scanner nullsession" or ProcessCommandLine contains "--scanner nullsession-trust" or ProcessCommandLine contains "--scanner oxidbindings" or ProcessCommandLine contains "--scanner remote" or ProcessCommandLine contains "--scanner share" or ProcessCommandLine contains "--scanner smb" or ProcessCommandLine contains "--scanner smb3querynetwork" or ProcessCommandLine contains "--scanner spooler" or ProcessCommandLine contains "--scanner startup" or ProcessCommandLine contains "--scanner zerologon") or ProcessCommandLine contains "--no-enum-limit" or (ProcessCommandLine contains "--healthcheck" and ProcessCommandLine contains "--level Full") or (ProcessCommandLine contains "--healthcheck" and ProcessCommandLine contains "--server ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_icacls_deny.yml
Use Icacls to Hide File to Everyone ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/deny" and ProcessCommandLine contains "S-1-1-0:") and (ProcessVersionInfoOriginalFileName =~ "iCACLS.EXE" or FolderPath endswith "\\icacls.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_hashcat.yml
HackTool - Hashcat Password Cracker Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-a " and ProcessCommandLine contains "-m 1000 " and ProcessCommandLine contains "-r ") or FolderPath endswith "\\hashcat.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_jlaive_batch_execution.yml
HackTool - Jlaive In-Memory Assembly Execution ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessCommandLine endswith ".bat" and InitiatingProcessFolderPath endswith "\\cmd.exe") and (((ProcessCommandLine contains "powershell.exe" and ProcessCommandLine contains ".bat.exe") and FolderPath endswith "\\xcopy.exe") or ((ProcessCommandLine contains "pwsh.exe" and ProcessCommandLine contains ".bat.exe") and FolderPath endswith "\\xcopy.exe") or ((ProcessCommandLine contains "+s" and ProcessCommandLine contains "+h" and ProcessCommandLine contains ".bat.exe") and FolderPath endswith "\\attrib.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_susp_execution_via_office_process.yml
Suspicious WMIC Execution Via Office Process ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\WINWORD.EXE" or InitiatingProcessFolderPath endswith "\\EXCEL.EXE" or InitiatingProcessFolderPath endswith "\\POWERPNT.exe" or InitiatingProcessFolderPath endswith "\\MSPUB.exe" or InitiatingProcessFolderPath endswith "\\VISIO.exe" or InitiatingProcessFolderPath endswith "\\MSACCESS.EXE" or InitiatingProcessFolderPath endswith "\\EQNEDT32.EXE" or InitiatingProcessFolderPath endswith "\\ONENOTE.EXE" or InitiatingProcessFolderPath endswith "\\wordpad.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe") and ((ProcessCommandLine contains "regsvr32" or ProcessCommandLine contains "rundll32" or ProcessCommandLine contains "msiexec" or ProcessCommandLine contains "mshta" or ProcessCommandLine contains "verclsid" or ProcessCommandLine contains "wscript" or ProcessCommandLine contains "cscript") and (ProcessCommandLine contains "process" and ProcessCommandLine contains "create" and ProcessCommandLine contains "call")) and (FolderPath endswith "\\wbem\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_service_account_password_dumped.yml
Microsoft IIS Service Account Password Dumped ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "list " and (FolderPath endswith "\\appcmd.exe" or ProcessVersionInfoOriginalFileName =~ "appcmd.exe")) and ((ProcessCommandLine contains " /config" or ProcessCommandLine contains " /xml" or ProcessCommandLine contains " -config" or ProcessCommandLine contains " -xml") or ((ProcessCommandLine contains " /@t" or ProcessCommandLine contains " /text" or ProcessCommandLine contains " /show" or ProcessCommandLine contains " -@t" or ProcessCommandLine contains " -text" or ProcessCommandLine contains " -show") and (ProcessCommandLine contains ":*" or ProcessCommandLine contains "password")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml
Fsutil Behavior Set SymlinkEvaluation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "behavior " and ProcessCommandLine contains "set " and ProcessCommandLine contains "SymlinkEvaluation") and (FolderPath endswith "\\fsutil.exe" or ProcessVersionInfoOriginalFileName =~ "fsutil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_remote_execution.yml
WMIC Remote Command Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/node:" and (FolderPath endswith "\\WMIC.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")) and (not((ProcessCommandLine contains "/node:127.0.0.1 " or ProcessCommandLine contains "/node:localhost ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ntdsutil_usage.yml
Invocation of Active Directory Diagnostic Tool (ntdsutil.exe) ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\ntdsutil.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml
UAC Bypass Using DismHost ---> KQL Query:
DeviceProcessEvents
| where (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and (InitiatingProcessFolderPath contains "C:\\Users\\" and InitiatingProcessFolderPath contains "\\AppData\\Local\\Temp\\" and InitiatingProcessFolderPath contains "\\DismHost.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wuauclt_dll_loading.yml
Proxy Execution Via Wuauclt.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "UpdateDeploymentProvider" and ProcessCommandLine contains "RunHandlerComServer") and (FolderPath endswith "\\wuauclt.exe" or ProcessVersionInfoOriginalFileName =~ "wuauclt.exe")) and (not((ProcessCommandLine contains " /UpdateDeploymentProvider UpdateDeploymentProvider.dll " or (ProcessCommandLine contains ":\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy.dll /ClassId" or ProcessCommandLine contains ":\\Windows\\UUS\\amd64\\UpdateDeploy.dll /ClassId") or (ProcessCommandLine contains ":\\Windows\\WinSxS\\" and ProcessCommandLine contains "\\UpdateDeploy.dll /ClassId ") or ProcessCommandLine contains " wuaueng.dll ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_netsupport_rat.yml
Unexpected Error processing 'Renamed NetSupport RAT Execution' (sigma/rules/windows/process_creation/proc_creation_win_renamed_netsupport_rat.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_appvlp_uncommon_child_process.yml
Uncommon Child Process Of Appvlp.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\appvlp.exe" and (not((FolderPath endswith ":\\Windows\\SysWOW64\\rundll32.exe" or FolderPath endswith ":\\Windows\\System32\\rundll32.exe"))) and (not(((FolderPath contains ":\\Program Files\\Microsoft Office" and FolderPath endswith "\\msoasb.exe") or (FolderPath contains ":\\Program Files\\Microsoft Office" and FolderPath endswith "\\MSOUC.EXE") or ((FolderPath contains ":\\Program Files\\Microsoft Office" and FolderPath contains "\\SkypeSrv\\") and FolderPath endswith "\\SKYPESERVER.EXE"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_netsh_port_forwarding.yml
New Port Forwarding Rule Added Via Netsh.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\netsh.exe" or ProcessVersionInfoOriginalFileName =~ "netsh.exe") and ((ProcessCommandLine contains "interface" and ProcessCommandLine contains "portproxy" and ProcessCommandLine contains "add" and ProcessCommandLine contains "v4tov4") or (ProcessCommandLine contains "i " and ProcessCommandLine contains "p " and ProcessCommandLine contains "a " and ProcessCommandLine contains "v ") or (ProcessCommandLine contains "connectp" and ProcessCommandLine contains "listena" and ProcessCommandLine contains "c="))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rar_compress_data.yml
Files Added To An Archive Using Rar.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " a " and FolderPath endswith "\\rar.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_runxcmd.yml
PUA - RunXCmd Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /account=system " or ProcessCommandLine contains " /account=ti ") and ProcessCommandLine contains "/exec="

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_certipy.yml
HackTool - Certipy Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\Certipy.exe" or ProcessVersionInfoOriginalFileName =~ "Certipy.exe" or ProcessVersionInfoFileDescription contains "Certipy") or ((ProcessCommandLine contains " account " or ProcessCommandLine contains " auth " or ProcessCommandLine contains " cert " or ProcessCommandLine contains " find " or ProcessCommandLine contains " forge " or ProcessCommandLine contains " ptt " or ProcessCommandLine contains " relay " or ProcessCommandLine contains " req " or ProcessCommandLine contains " shadow " or ProcessCommandLine contains " template ") and (ProcessCommandLine contains " -bloodhound" or ProcessCommandLine contains " -ca-pfx " or ProcessCommandLine contains " -dc-ip " or ProcessCommandLine contains " -kirbi" or ProcessCommandLine contains " -old-bloodhound" or ProcessCommandLine contains " -pfx " or ProcessCommandLine contains " -target" or ProcessCommandLine contains " -template" or ProcessCommandLine contains " -username " or ProcessCommandLine contains " -vulnerable" or ProcessCommandLine contains "auth -pfx" or ProcessCommandLine contains "shadow auto" or ProcessCommandLine contains "shadow list"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_download.yml
Obfuscated IP Download Activity ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Invoke-WebRequest" or ProcessCommandLine contains "iwr " or ProcessCommandLine contains "wget " or ProcessCommandLine contains "curl " or ProcessCommandLine contains "DownloadFile" or ProcessCommandLine contains "DownloadString") and ((ProcessCommandLine contains " 0x" or ProcessCommandLine contains "//0x" or ProcessCommandLine contains ".0x" or ProcessCommandLine contains ".00x") or (ProcessCommandLine contains "http://%" and ProcessCommandLine contains "%2e") or (ProcessCommandLine matches regex "https?://[0-9]{1,3}\\.[0-9]{1,3}\\.0[0-9]{3,4}" or ProcessCommandLine matches regex "https?://[0-9]{1,3}\\.0[0-9]{3,7}" or ProcessCommandLine matches regex "https?://0[0-9]{3,11}" or ProcessCommandLine matches regex "https?://(0[0-9]{1,11}\\.){3}0[0-9]{1,11}" or ProcessCommandLine matches regex "https?://0[0-9]{1,11}" or ProcessCommandLine matches regex " [0-7]{7,13}")) and (not(ProcessCommandLine matches regex "https?://((25[0-5]|(2[0-4]|1\\d|[1-9])?\\d)(\\.|\\b)){4}"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_virtualbox_vboxdrvinst_execution.yml
Suspicious VBoxDrvInst.exe Parameters ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "driver" and ProcessCommandLine contains "executeinf") and FolderPath endswith "\\VBoxDrvInst.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_googleupdate_susp_child_process.yml
Potentially Suspicious GoogleUpdate Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\GoogleUpdate.exe" and (not((isnull(FolderPath) or (FolderPath contains "\\Google" or (FolderPath endswith "\\setup.exe" or FolderPath endswith "chrome_updater.exe" or FolderPath endswith "chrome_installer.exe")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_python_pty_spawn.yml
Python Spawning Pretty TTY on Windows ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "python.exe" or FolderPath endswith "python3.exe" or FolderPath endswith "python2.exe") and ((ProcessCommandLine contains "import pty" and ProcessCommandLine contains ".spawn(") or ProcessCommandLine contains "from pty import spawn")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_sliver_c2_execution_pattern.yml
HackTool - Sliver C2 Implant Activity Pattern ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_provlaunch_susp_child_process.yml
Suspicious Provlaunch.EXE Child Process ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\notepad.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (FolderPath contains ":\\PerfLogs\\" or FolderPath contains ":\\Temp\\" or FolderPath contains ":\\Users\\Public\\" or FolderPath contains "\\AppData\\Temp\\" or FolderPath contains "\\Windows\\System32\\Tasks\\" or FolderPath contains "\\Windows\\Tasks\\" or FolderPath contains "\\Windows\\Temp\\")) and InitiatingProcessFolderPath endswith "\\provlaunch.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_stracciatella_execution.yml
HackTool - Stracciatella Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\Stracciatella.exe" or ProcessVersionInfoOriginalFileName =~ "Stracciatella.exe" or ProcessVersionInfoFileDescription =~ "Stracciatella" or (SHA256 startswith "9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956" or SHA256 startswith "fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml
UAC Bypass Tools Using ComputerDefaults ---> KQL Query:
DeviceProcessEvents
| where (FolderPath =~ "C:\\Windows\\System32\\ComputerDefaults.exe" and (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288"))) and (not((InitiatingProcessFolderPath contains ":\\Windows\\System32" or InitiatingProcessFolderPath contains ":\\Program Files")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winget_add_custom_source.yml
Add New Download Source To Winget ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "source " and ProcessCommandLine contains "add ") and (FolderPath endswith "\\winget.exe" or ProcessVersionInfoOriginalFileName =~ "winget.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_mftrace_child_process.yml
Potential Mftrace.EXE Abuse ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\mftrace.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wermgr_susp_child_process.yml
Suspicious Child Process Of Wermgr.EXE ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\ipconfig.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\netstat.exe" or FolderPath endswith "\\nslookup.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\whoami.exe" or FolderPath endswith "\\wscript.exe") and InitiatingProcessFolderPath endswith "\\wermgr.exe") and (not(((ProcessCommandLine contains "-queuereporting" or ProcessCommandLine contains "-responsepester") and (ProcessCommandLine contains "C:\\Windows\\system32\\WerConCpl.dll" and ProcessCommandLine contains "LaunchErcApp ") and FolderPath endswith "\\rundll32.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dumpminitool_execution.yml
DumpMinitool Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " Full" or ProcessCommandLine contains " Mini" or ProcessCommandLine contains " WithHeap") and ((FolderPath endswith "\\DumpMinitool.exe" or FolderPath endswith "\\DumpMinitool.x86.exe" or FolderPath endswith "\\DumpMinitool.arm64.exe") or (ProcessVersionInfoOriginalFileName in~ ("DumpMinitool.exe", "DumpMinitool.x86.exe", "DumpMinitool.arm64.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_visualuiaverifynative.yml
Use of VisualUiaVerifyNative.exe ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\VisualUiaVerifyNative.exe" or ProcessVersionInfoOriginalFileName =~ "VisualUiaVerifyNative.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_deviceenroller_dll_sideloading.yml
Potential DLL Sideloading Via DeviceEnroller.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "/PhoneDeepLink" and (FolderPath endswith "\\deviceenroller.exe" or ProcessVersionInfoOriginalFileName =~ "deviceenroller.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_lsa_ppl_protection_disabled.yml
LSA PPL Protection Disabled Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "SYSTEM\\CurrentControlSet\\Control\\Lsa" and (ProcessCommandLine contains " add " and ProcessCommandLine contains " /d 0" and ProcessCommandLine contains " /v RunAsPPL ")) and (FolderPath endswith "\\reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_manage_bde.yml
Potential Manage-bde.wsf Abuse To Proxy Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "manage-bde.wsf" and (FolderPath endswith "\\wscript.exe" or ProcessVersionInfoOriginalFileName =~ "wscript.exe")) or ((InitiatingProcessCommandLine contains "manage-bde.wsf" and (InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe")) and (not(FolderPath endswith "\\cmd.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_defaultpack_uncommon_child_process.yml
Uncommon Child Process Of Defaultpack.EXE ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\DefaultPack.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_tracker.yml
Potential DLL Injection Or Execution Using Tracker.exe ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " /d " or ProcessCommandLine contains " /c ") and (FolderPath endswith "\\tracker.exe" or ProcessVersionInfoFileDescription =~ "Tracker")) and (not((ProcessCommandLine contains " /ERRORREPORT:PROMPT " or (InitiatingProcessFolderPath endswith "\\Msbuild\\Current\\Bin\\MSBuild.exe" or InitiatingProcessFolderPath endswith "\\Msbuild\\Current\\Bin\\amd64\\MSBuild.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_shadow_copies_creation.yml
Shadow Copies Creation Using Operating Systems Utilities ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "shadow" and ProcessCommandLine contains "create") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\vssadmin.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll", "wmic.exe", "VSSADMIN.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_process_hacker.yml
PUA - Process Hacker Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath contains "\\ProcessHacker_" or FolderPath endswith "\\ProcessHacker.exe" or (ProcessVersionInfoOriginalFileName in~ ("ProcessHacker.exe", "Process Hacker")) or ProcessVersionInfoFileDescription =~ "Process Hacker" or ProcessVersionInfoProductName =~ "Process Hacker" or ((MD5 startswith "68F9B52895F4D34E74112F3129B3B00D" or MD5 startswith "B365AF317AE730A67C936F21432B9C71") or (SHA1 startswith "A0BDFAC3CE1880B32FF9B696458327CE352E3B1D" or SHA1 startswith "C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E") or (SHA256 startswith "D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F" or SHA256 startswith "BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_query_interesting_services.yml
Interesting Service Enumeration Via Sc.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "query" and ProcessCommandLine contains "termservice" and (FolderPath endswith "\\sc.exe" or ProcessVersionInfoOriginalFileName =~ "sc.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_execution.yml
Suspicious Usage Of ShellExec_RunDLL ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "ShellExec_RunDLL" and (ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Temp\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "comspec" or ProcessCommandLine contains "iex" or ProcessCommandLine contains "Invoke-" or ProcessCommandLine contains "msiexec" or ProcessCommandLine contains "odbcconf" or ProcessCommandLine contains "regsvr32")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_vslsagent_agentextensionpath_load.yml
Suspicious Vsls-Agent Command With AgentExtensionPath Load ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--agentExtensionPath" and FolderPath endswith "\\vsls-agent.exe") and (not(ProcessCommandLine contains "Microsoft.VisualStudio.LiveShare.Agent."))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_handlekatz.yml
Unexpected Error processing 'HackTool - HandleKatz LSASS Dumper Execution' (sigma/rules/windows/process_creation/proc_creation_win_hktl_handlekatz.yml): No valid hash algo found in Hashes field. Please use one of the following: MD5, SHA1, SHA256 (while applying processing pipeline on rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wget_download_direct_ip.yml
Suspicious File Download From IP Via Wget.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith ".ps1" or ProcessCommandLine endswith ".ps1'" or ProcessCommandLine endswith ".ps1\"" or ProcessCommandLine endswith ".dat" or ProcessCommandLine endswith ".dat'" or ProcessCommandLine endswith ".dat\"" or ProcessCommandLine endswith ".msi" or ProcessCommandLine endswith ".msi'" or ProcessCommandLine endswith ".msi\"" or ProcessCommandLine endswith ".bat" or ProcessCommandLine endswith ".bat'" or ProcessCommandLine endswith ".bat\"" or ProcessCommandLine endswith ".exe" or ProcessCommandLine endswith ".exe'" or ProcessCommandLine endswith ".exe\"" or ProcessCommandLine endswith ".vbs" or ProcessCommandLine endswith ".vbs'" or ProcessCommandLine endswith ".vbs\"" or ProcessCommandLine endswith ".vbe" or ProcessCommandLine endswith ".vbe'" or ProcessCommandLine endswith ".vbe\"" or ProcessCommandLine endswith ".hta" or ProcessCommandLine endswith ".hta'" or ProcessCommandLine endswith ".hta\"" or ProcessCommandLine endswith ".dll" or ProcessCommandLine endswith ".dll'" or ProcessCommandLine endswith ".dll\"" or ProcessCommandLine endswith ".psm1" or ProcessCommandLine endswith ".psm1'" or ProcessCommandLine endswith ".psm1\"") and (ProcessCommandLine matches regex "\\s-O\\s" or ProcessCommandLine contains "--output-document") and ProcessCommandLine contains "http" and (FolderPath endswith "\\wget.exe" or ProcessVersionInfoOriginalFileName =~ "wget.exe") and ProcessCommandLine matches regex "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msbuild_susp_parent_process.yml
Suspicious Msbuild Execution By Uncommon Parent Process ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\MSBuild.exe" or ProcessVersionInfoOriginalFileName =~ "MSBuild.exe") and (not((InitiatingProcessFolderPath endswith "\\devenv.exe" or InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\msbuild.exe" or InitiatingProcessFolderPath endswith "\\python.exe" or InitiatingProcessFolderPath endswith "\\explorer.exe" or InitiatingProcessFolderPath endswith "\\nuget.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_eventlog_content_recon.yml
Potentially Suspicious EventLog Recon Activity Using Log Query Utilities ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains "-InstanceId 462") or (ProcessCommandLine contains ".eventid -eq 462") or (ProcessCommandLine contains "EventCode=" and ProcessCommandLine contains "462") or (ProcessCommandLine contains "EventIdentifier=" and ProcessCommandLine contains "462") or (ProcessCommandLine contains "System[EventID=462" and ProcessCommandLine contains "]") or ProcessCommandLine contains "-InstanceId 4778" or ProcessCommandLine contains ".eventid -eq 4778" or ProcessCommandLine contains "System[EventID=4778]" or (ProcessCommandLine contains "EventCode=" and ProcessCommandLine contains "4778") or (ProcessCommandLine contains "EventIdentifier=" and ProcessCommandLine contains "4778") or ProcessCommandLine contains "-InstanceId 25" or ProcessCommandLine contains ".eventid -eq 25" or ProcessCommandLine contains "System[EventID=25]" or (ProcessCommandLine contains "EventCode=" and ProcessCommandLine contains "25") or (ProcessCommandLine contains "EventIdentifier=" and ProcessCommandLine contains "25")) or (ProcessCommandLine contains "Microsoft-Windows-PowerShell" or ProcessCommandLine contains "Microsoft-Windows-Security-Auditing" or ProcessCommandLine contains "Microsoft-Windows-TerminalServices-LocalSessionManager" or ProcessCommandLine contains "Microsoft-Windows-TerminalServices-RemoteConnectionManager" or ProcessCommandLine contains "Microsoft-Windows-Windows Defender" or ProcessCommandLine contains "PowerShellCore" or ProcessCommandLine contains "Security" or ProcessCommandLine contains "Windows PowerShell")) and ((ProcessCommandLine contains "Select" and ProcessCommandLine contains "Win32_NTLogEvent") or ((ProcessCommandLine contains " qe " or ProcessCommandLine contains " query-events ") and (FolderPath endswith "\\wevtutil.exe" or ProcessVersionInfoOriginalFileName =~ "wevtutil.exe")) or (ProcessCommandLine contains " ntevent" and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")) or (ProcessCommandLine contains "Get-WinEvent " or ProcessCommandLine contains "get-eventlog "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_setupapi_installhinfsection.yml
Suspicious Rundll32 Setupapi.dll Activity ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\runonce.exe" and (InitiatingProcessCommandLine contains "setupapi.dll" and InitiatingProcessCommandLine contains "InstallHinfSection") and InitiatingProcessFolderPath endswith "\\rundll32.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_activity.yml
Potentially Suspicious Rundll32 Activity ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "javascript:" and ProcessCommandLine contains ".RegisterXLL") or (ProcessCommandLine contains "url.dll" and ProcessCommandLine contains "OpenURL") or (ProcessCommandLine contains "url.dll" and ProcessCommandLine contains "OpenURLA") or (ProcessCommandLine contains "url.dll" and ProcessCommandLine contains "FileProtocolHandler") or (ProcessCommandLine contains "zipfldr.dll" and ProcessCommandLine contains "RouteTheCall") or (ProcessCommandLine contains "shell32.dll" and ProcessCommandLine contains "Control_RunDLL") or (ProcessCommandLine contains "shell32.dll" and ProcessCommandLine contains "ShellExec_RunDLL") or (ProcessCommandLine contains "mshtml.dll" and ProcessCommandLine contains "PrintHTML") or (ProcessCommandLine contains "advpack.dll" and ProcessCommandLine contains "LaunchINFSection") or (ProcessCommandLine contains "advpack.dll" and ProcessCommandLine contains "RegisterOCX") or (ProcessCommandLine contains "ieadvpack.dll" and ProcessCommandLine contains "LaunchINFSection") or (ProcessCommandLine contains "ieadvpack.dll" and ProcessCommandLine contains "RegisterOCX") or (ProcessCommandLine contains "ieframe.dll" and ProcessCommandLine contains "OpenURL") or (ProcessCommandLine contains "shdocvw.dll" and ProcessCommandLine contains "OpenURL") or (ProcessCommandLine contains "syssetup.dll" and ProcessCommandLine contains "SetupInfObjectInstallAction") or (ProcessCommandLine contains "setupapi.dll" and ProcessCommandLine contains "InstallHinfSection") or (ProcessCommandLine contains "pcwutl.dll" and ProcessCommandLine contains "LaunchApplication") or (ProcessCommandLine contains "dfshim.dll" and ProcessCommandLine contains "ShOpenVerbApplication") or (ProcessCommandLine contains "dfshim.dll" and ProcessCommandLine contains "ShOpenVerbShortcut") or (ProcessCommandLine contains "scrobj.dll" and ProcessCommandLine contains "GenerateTypeLib" and ProcessCommandLine contains "http") or (ProcessCommandLine contains "shimgvw.dll" and ProcessCommandLine contains "ImageView_Fullscreen" and ProcessCommandLine contains "http") or (ProcessCommandLine contains "comsvcs.dll" and ProcessCommandLine contains "MiniDump")) and (not((((ProcessCommandLine contains "Shell32.dll" and ProcessCommandLine contains "Control_RunDLL" and ProcessCommandLine contains ".cpl") and InitiatingProcessCommandLine contains ".cpl" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\control.exe") or ProcessCommandLine contains "shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver" or (ProcessCommandLine endswith ".cpl\"," and ProcessCommandLine startswith "\"C:\\Windows\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \"C:\\Windows\\System32\\" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\control.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution_susp.yml
Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\curl.exe" or FolderPath endswith "\\dllhost.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wevtutil.exe") and (InitiatingProcessCommandLine contains ":\\Windows\\TEMP\\ScreenConnect\\" and InitiatingProcessCommandLine contains "run.cmd")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_nltest_execution.yml
Nltest.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\nltest.exe" or ProcessVersionInfoOriginalFileName =~ "nltestrk.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_browsers_chromium_mockbin_abuse.yml
Chromium Browser Headless Execution To Mockbin Like Site ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "--headless" and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\vivaldi.exe") and (ProcessCommandLine contains "://run.mocky" or ProcessCommandLine contains "://mockbin")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_subfolder_search.yml
Insensitive Subfolder Search Via Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "findstr" or FolderPath endswith "findstr.exe" or ProcessVersionInfoOriginalFileName =~ "FINDSTR.EXE") and ((ProcessCommandLine contains " -i " or ProcessCommandLine contains " /i " or ProcessCommandLine contains " i " or ProcessCommandLine contains " i " or ProcessCommandLine contains " i ") and (ProcessCommandLine contains " -s " or ProcessCommandLine contains " /s " or ProcessCommandLine contains " s " or ProcessCommandLine contains " s " or ProcessCommandLine contains " s "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_w32tm.yml
Use of W32tm as Timer ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/stripchart" and ProcessCommandLine contains "/computer:" and ProcessCommandLine contains "/period:" and ProcessCommandLine contains "/dataonly" and ProcessCommandLine contains "/samples:") and (FolderPath endswith "\\w32tm.exe" or ProcessVersionInfoOriginalFileName =~ "w32time.dll")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_msra_process_injection.yml
Potential Process Injection Via Msra.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\arp.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\netstat.exe" or FolderPath endswith "\\nslookup.exe" or FolderPath endswith "\\route.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\whoami.exe") and InitiatingProcessCommandLine endswith "msra.exe" and InitiatingProcessFolderPath endswith "\\msra.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_cmdline_reversed_strings.yml
Potential PowerShell Obfuscation Via Reversed Commands ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "hctac" or ProcessCommandLine contains "kaerb" or ProcessCommandLine contains "dnammoc" or ProcessCommandLine contains "ekovn" or ProcessCommandLine contains "eliFd" or ProcessCommandLine contains "rahc" or ProcessCommandLine contains "etirw" or ProcessCommandLine contains "golon" or ProcessCommandLine contains "tninon" or ProcessCommandLine contains "eddih" or ProcessCommandLine contains "tpircS" or ProcessCommandLine contains "ssecorp" or ProcessCommandLine contains "llehsrewop" or ProcessCommandLine contains "esnopser" or ProcessCommandLine contains "daolnwod" or ProcessCommandLine contains "tneilCbeW" or ProcessCommandLine contains "tneilc" or ProcessCommandLine contains "ptth" or ProcessCommandLine contains "elifotevas" or ProcessCommandLine contains "46esab" or ProcessCommandLine contains "htaPpmeTteG" or ProcessCommandLine contains "tcejbO" or ProcessCommandLine contains "maerts" or ProcessCommandLine contains "hcaerof" or ProcessCommandLine contains "retupmoc") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))) and (not((ProcessCommandLine contains " -EncodedCommand " or ProcessCommandLine contains " -enc ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_registered_com_objects.yml
Rundll32 Registered COM Objects ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "-sta " or ProcessCommandLine contains "-localserver ") and (ProcessCommandLine contains "{" and ProcessCommandLine contains "}")) and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_fodhelper.yml
Bypass UAC via Fodhelper.exe ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\fodhelper.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pcalua.yml
Use of Pcalua For Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -a" and FolderPath endswith "\\pcalua.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_gotoopener.yml
Remote Access Tool - GoToAssist Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "GoTo Opener" or ProcessVersionInfoProductName =~ "GoTo Opener" or ProcessVersionInfoCompanyName =~ "LogMeIn, Inc."

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_explorer_nouaccheck.yml
Explorer NOUACCHECK Flag ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/NOUACCHECK" and FolderPath endswith "\\explorer.exe") and (not((InitiatingProcessCommandLine =~ "C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule" or InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\svchost.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_procdump_lsass.yml
Potential LSASS Process Dump Via Procdump ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -ma " or ProcessCommandLine contains " /ma " or ProcessCommandLine contains " ma " or ProcessCommandLine contains " ma " or ProcessCommandLine contains " ma ") and ProcessCommandLine contains " ls"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_mppreference.yml
Powershell Base64 Encoded MpPreference Cmdlet ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "QWRkLU1wUHJlZmVyZW5jZS" or ProcessCommandLine contains "FkZC1NcFByZWZlcmVuY2Ug" or ProcessCommandLine contains "BZGQtTXBQcmVmZXJlbmNlI" or ProcessCommandLine contains "U2V0LU1wUHJlZmVyZW5jZS" or ProcessCommandLine contains "NldC1NcFByZWZlcmVuY2Ug" or ProcessCommandLine contains "TZXQtTXBQcmVmZXJlbmNlI" or ProcessCommandLine contains "YWRkLW1wcHJlZmVyZW5jZS" or ProcessCommandLine contains "FkZC1tcHByZWZlcmVuY2Ug" or ProcessCommandLine contains "hZGQtbXBwcmVmZXJlbmNlI" or ProcessCommandLine contains "c2V0LW1wcHJlZmVyZW5jZS" or ProcessCommandLine contains "NldC1tcHByZWZlcmVuY2Ug" or ProcessCommandLine contains "zZXQtbXBwcmVmZXJlbmNlI") or (ProcessCommandLine contains "QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA" or ProcessCommandLine contains "EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA" or ProcessCommandLine contains "BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA" or ProcessCommandLine contains "UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA" or ProcessCommandLine contains "MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA" or ProcessCommandLine contains "TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA" or ProcessCommandLine contains "YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA" or ProcessCommandLine contains "EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA" or ProcessCommandLine contains "hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA" or ProcessCommandLine contains "cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA" or ProcessCommandLine contains "MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA" or ProcessCommandLine contains "zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_process_creation.yml
New Process Created Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "process" and ProcessCommandLine contains "call" and ProcessCommandLine contains "create") and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_node_adobe_creative_cloud_abuse.yml
Node Process Executions ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\Adobe Creative Cloud Experience\\libs\\node.exe" and (not(ProcessCommandLine contains "Adobe Creative Cloud Experience\\js"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_scriptrunner.yml
Use of Scriptrunner.exe ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -appvscript " and (FolderPath endswith "\\ScriptRunner.exe" or ProcessVersionInfoOriginalFileName =~ "ScriptRunner.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_modules.yml
Operator Bloopers Cobalt Strike Modules ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Invoke-UserHunter" or ProcessCommandLine contains "Invoke-ShareFinder" or ProcessCommandLine contains "Invoke-Kerberoast" or ProcessCommandLine contains "Invoke-SMBAutoBrute" or ProcessCommandLine contains "Invoke-Nightmare" or ProcessCommandLine contains "zerologon" or ProcessCommandLine contains "av_query") and (ProcessVersionInfoOriginalFileName =~ "Cmd.Exe" or FolderPath endswith "\\cmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_create_service.yml
New Service Creation Using PowerShell ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "New-Service" and ProcessCommandLine contains "-BinaryPathName"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_run_script_from_input_stream.yml
Run PowerShell Script from Redirected Input Stream ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "\\s-\\s*<" and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect.yml
Remote Access Tool - ScreenConnect Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "ScreenConnect Service" or ProcessVersionInfoProductName =~ "ScreenConnect" or ProcessVersionInfoCompanyName =~ "ScreenConnect Software"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pubprn.yml
Pubprn.vbs Proxy Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\pubprn.vbs" and ProcessCommandLine contains "script:"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_abusing_debug_privilege.yml
Abused Debug Privilege by Arbitrary Parent Processes ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\cmd.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll", "Cmd.Exe"))) and ((InitiatingProcessFolderPath endswith "\\winlogon.exe" or InitiatingProcessFolderPath endswith "\\services.exe" or InitiatingProcessFolderPath endswith "\\lsass.exe" or InitiatingProcessFolderPath endswith "\\csrss.exe" or InitiatingProcessFolderPath endswith "\\smss.exe" or InitiatingProcessFolderPath endswith "\\wininit.exe" or InitiatingProcessFolderPath endswith "\\spoolsv.exe" or InitiatingProcessFolderPath endswith "\\searchindexer.exe") and (AccountName contains "AUTHORI" or AccountName contains "AUTORI"))) and (not((ProcessCommandLine contains " route " and ProcessCommandLine contains " ADD ")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_schtasks_creation.yml
Scheduled Task Creation Via Schtasks.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " /create " and FolderPath endswith "\\schtasks.exe") and (not((AccountName contains "AUTHORI" or AccountName contains "AUTORI")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_unquoted_service_search.yml
Potential Unquoted Service Path Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " service get " and ProcessCommandLine contains "name,displayname,pathname,startmode") and (ProcessVersionInfoOriginalFileName =~ "wmic.exe" or FolderPath endswith "\\WMIC.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dism_remove.yml
Dism Remove Online Package ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "/Online" and ProcessCommandLine contains "/Disable-Feature") and FolderPath endswith "\\Dism.exe") or (FolderPath endswith "\\DismHost.exe" and (InitiatingProcessCommandLine contains "/Online" and InitiatingProcessCommandLine contains "/Disable-Feature"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_webshell_recon_commands_and_processes.yml
Webshell Detection With Command Line Keywords ---> KQL Query:
DeviceProcessEvents
| where (((InitiatingProcessFolderPath contains "-tomcat-" or InitiatingProcessFolderPath contains "\\tomcat") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or ((ProcessCommandLine contains "catalina.jar" or ProcessCommandLine contains "CATALINA_HOME") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or (InitiatingProcessFolderPath endswith "\\w3wp.exe" or InitiatingProcessFolderPath endswith "\\php-cgi.exe" or InitiatingProcessFolderPath endswith "\\nginx.exe" or InitiatingProcessFolderPath endswith "\\httpd.exe" or InitiatingProcessFolderPath endswith "\\caddy.exe" or InitiatingProcessFolderPath endswith "\\ws_tomcatservice.exe")) and ((ProcessCommandLine contains "&cd&echo" or ProcessCommandLine contains "cd /d ") or ((FolderPath endswith "\\dsquery.exe" or FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe" or FolderPath endswith "\\ipconfig.exe" or FolderPath endswith "\\netstat.exe" or FolderPath endswith "\\nslookup.exe" or FolderPath endswith "\\pathping.exe" or FolderPath endswith "\\quser.exe" or FolderPath endswith "\\schtasks.exe" or FolderPath endswith "\\systeminfo.exe" or FolderPath endswith "\\tasklist.exe" or FolderPath endswith "\\tracert.exe" or FolderPath endswith "\\ver.exe" or FolderPath endswith "\\wevtutil.exe" or FolderPath endswith "\\whoami.exe") or (ProcessVersionInfoOriginalFileName in~ ("dsquery.exe", "find.exe", "findstr.exe", "ipconfig.exe", "netstat.exe", "nslookup.exe", "pathping.exe", "quser.exe", "schtasks.exe", "sysinfo.exe", "tasklist.exe", "tracert.exe", "ver.exe", "VSSADMIN.EXE", "wevtutil.exe", "whoami.exe"))) or (ProcessCommandLine contains " Test-NetConnection " or ProcessCommandLine contains "dir \\") or ((ProcessCommandLine contains " user " or ProcessCommandLine contains " use " or ProcessCommandLine contains " group ") and (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe"))) or (ProcessCommandLine contains " -n " and ProcessVersionInfoOriginalFileName =~ "ping.exe") or ((ProcessCommandLine contains " -enc " or ProcessCommandLine contains " -EncodedCommand " or ProcessCommandLine contains " -w hidden " or ProcessCommandLine contains " -windowstyle hidden" or ProcessCommandLine contains ".WebClient).Download") and (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) or (ProcessCommandLine contains " /node:" and ProcessVersionInfoOriginalFileName =~ "wmic.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wget_download_susp_locations.yml
Suspicious File Download From IP Via Wget.EXE - Paths ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine matches regex "\\s-O\\s" or ProcessCommandLine contains "--output-document") and ProcessCommandLine contains "http" and (FolderPath endswith "\\wget.exe" or ProcessVersionInfoOriginalFileName =~ "wget.exe") and ProcessCommandLine matches regex "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}" and ((ProcessCommandLine contains ":\\PerfLogs\\" or ProcessCommandLine contains ":\\Temp\\" or ProcessCommandLine contains ":\\Users\\Public\\" or ProcessCommandLine contains ":\\Windows\\Help\\" or ProcessCommandLine contains ":\\Windows\\Temp\\" or ProcessCommandLine contains "\\Temporary Internet") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favorites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Favourites\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Contacts\\") or (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\Pictures\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_secutyxploded.yml
HackTool - SecurityXploded Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoCompanyName =~ "SecurityXploded" or FolderPath endswith "PasswordDump.exe" or ProcessVersionInfoOriginalFileName endswith "PasswordDump.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_setres_uncommon_child_process.yml
Uncommon Child Process Of Setres.EXE ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "\\choice" and InitiatingProcessFolderPath endswith "\\setres.exe") and (not((FolderPath endswith "C:\\Windows\\System32\\choice.exe" or FolderPath endswith "C:\\Windows\\SysWOW64\\choice.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_lsass_dmp_cli_keywords.yml
LSASS Dump Keyword In CommandLine ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "lsass.dmp" or ProcessCommandLine contains "lsass.zip" or ProcessCommandLine contains "lsass.rar" or ProcessCommandLine contains "Andrew.dmp" or ProcessCommandLine contains "Coredump.dmp" or ProcessCommandLine contains "NotLSASS.zip" or ProcessCommandLine contains "lsass_2" or ProcessCommandLine contains "lsassdump" or ProcessCommandLine contains "lsassdmp") or (ProcessCommandLine contains "lsass" and ProcessCommandLine contains ".dmp") or (ProcessCommandLine contains "SQLDmpr" and ProcessCommandLine contains ".mdmp") or (ProcessCommandLine contains "nanodump" and ProcessCommandLine contains ".dmp")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_type_arbitrary_file_download.yml
Potential Download/Upload Activity Using Type Command ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "type \\\\" and ProcessCommandLine contains " > ") or (ProcessCommandLine contains "type " and ProcessCommandLine contains " > \\\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml
Raccine Uninstall ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "taskkill " and ProcessCommandLine contains "RaccineSettings.exe") or (ProcessCommandLine contains "reg.exe" and ProcessCommandLine contains "delete" and ProcessCommandLine contains "Raccine Tray") or (ProcessCommandLine contains "schtasks" and ProcessCommandLine contains "/DELETE" and ProcessCommandLine contains "Raccine Rules Updater")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmi_persistence_script_event_consumer.yml
WMI Persistence - Script Event Consumer ---> KQL Query:
DeviceProcessEvents
| where FolderPath =~ "C:\\WINDOWS\\system32\\wbem\\scrcons.exe" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\svchost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_browser_launch_from_document_reader_process.yml
Potential Suspicious Browser Launch From Document Reader Process ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "http" and (FolderPath endswith "\\brave.exe" or FolderPath endswith "\\chrome.exe" or FolderPath endswith "\\firefox.exe" or FolderPath endswith "\\msedge.exe" or FolderPath endswith "\\opera.exe" or FolderPath endswith "\\maxthon.exe" or FolderPath endswith "\\seamonkey.exe" or FolderPath endswith "\\vivaldi.exe" or FolderPath startswith "") and (InitiatingProcessFolderPath contains "Acrobat Reader" or InitiatingProcessFolderPath contains "Microsoft Office" or InitiatingProcessFolderPath contains "PDF Reader")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_ssh_port_forward.yml
Port Forwarding Activity Via SSH.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -R " or ProcessCommandLine contains " /R " or ProcessCommandLine contains " R " or ProcessCommandLine contains " R " or ProcessCommandLine contains " R ") and FolderPath endswith "\\ssh.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_write_protect_for_storage_disabled.yml
Write Protect For Storage Disabled ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "\\System\\CurrentControlSet\\Control" and ProcessCommandLine contains "Write Protection" and ProcessCommandLine contains "0" and ProcessCommandLine contains "storage"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_module_install.yml
IIS Native-Code Module Command Line Installation ---> KQL Query:
DeviceProcessEvents
| where (((ProcessCommandLine contains "install" and ProcessCommandLine contains "module") and (ProcessCommandLine contains "-name:" or ProcessCommandLine contains "/name:" or ProcessCommandLine contains "name:" or ProcessCommandLine contains "name:" or ProcessCommandLine contains "name:")) and (FolderPath endswith "\\appcmd.exe" or ProcessVersionInfoOriginalFileName =~ "appcmd.exe")) and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\inetsrv\\iissetup.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_protocolhandler_download.yml
File Download Using ProtocolHandler.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "ftp://" or ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and (FolderPath endswith "\\protocolhandler.exe" or ProcessVersionInfoOriginalFileName =~ "ProtocolHandler.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp_com_object_access.yml
CMSTP UAC Bypass via COM Object Access ---> KQL Query:
DeviceProcessEvents
| where (ProcessIntegrityLevel in~ ("High", "System", "S-1-16-16384", "S-1-16-12288")) and (InitiatingProcessCommandLine contains " /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}" or InitiatingProcessCommandLine contains " /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}" or InitiatingProcessCommandLine contains " /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}" or InitiatingProcessCommandLine contains " /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}" or InitiatingProcessCommandLine contains " /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}") and InitiatingProcessFolderPath endswith "\\DllHost.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_customshellhost.yml
Suspicious CustomShellHost Execution ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\CustomShellHost.exe" and (not(FolderPath =~ "C:\\Windows\\explorer.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_tasklist_module_enumeration.yml
Loaded Module Enumeration Via Tasklist.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-m" or ProcessCommandLine contains "/m" or ProcessCommandLine contains "m" or ProcessCommandLine contains "m" or ProcessCommandLine contains "m") and (FolderPath endswith "\\tasklist.exe" or ProcessVersionInfoOriginalFileName =~ "tasklist.exe") and ProcessCommandLine contains "rdpcorets.dll"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_screensaver.yml
Suspicious ScreenSave Change by Reg.exe ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "HKEY_CURRENT_USER\\Control Panel\\Desktop" or ProcessCommandLine contains "HKCU\\Control Panel\\Desktop") and FolderPath endswith "\\reg.exe") and ((ProcessCommandLine contains "/v ScreenSaveActive" and ProcessCommandLine contains "/t REG_SZ" and ProcessCommandLine contains "/d 1" and ProcessCommandLine contains "/f") or (ProcessCommandLine contains "/v ScreenSaveTimeout" and ProcessCommandLine contains "/t REG_SZ" and ProcessCommandLine contains "/d " and ProcessCommandLine contains "/f") or (ProcessCommandLine contains "/v ScreenSaverIsSecure" and ProcessCommandLine contains "/t REG_SZ" and ProcessCommandLine contains "/d 0" and ProcessCommandLine contains "/f") or (ProcessCommandLine contains "/v SCRNSAVE.EXE" and ProcessCommandLine contains "/t REG_SZ" and ProcessCommandLine contains "/d " and ProcessCommandLine contains ".scr" and ProcessCommandLine contains "/f"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_delete_safeboot.yml
SafeBoot Registry Key Deleted Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " delete " and ProcessCommandLine contains "\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot") and (FolderPath endswith "reg.exe" or ProcessVersionInfoOriginalFileName =~ "reg.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wsl_child_processes_anomalies.yml
WSL Child Process Anomaly ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\wsl.exe" or InitiatingProcessFolderPath endswith "\\wslhost.exe") and ((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (FolderPath contains "\\AppData\\Local\\Temp\\" or FolderPath contains "C:\\Users\\Public\\" or FolderPath contains "C:\\Windows\\Temp\\" or FolderPath contains "C:\\Temp\\" or FolderPath contains "\\Downloads\\" or FolderPath contains "\\Desktop\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_amsi_null_bits_bypass.yml
Potential AMSI Bypass Using NULL Bits ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "if(0){{{0}}}' -f $(0 -as [char]) +" or ProcessCommandLine contains "#<NULL>"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_advancedrun_priv_user.yml
PUA - AdvancedRun Suspicious Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/EXEFilename" or ProcessCommandLine contains "/CommandLine") and ((ProcessCommandLine contains " /RunAs 8 " or ProcessCommandLine contains " /RunAs 4 " or ProcessCommandLine contains " /RunAs 10 " or ProcessCommandLine contains " /RunAs 11 ") or (ProcessCommandLine endswith "/RunAs 8" or ProcessCommandLine endswith "/RunAs 4" or ProcessCommandLine endswith "/RunAs 10" or ProcessCommandLine endswith "/RunAs 11"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_utilityfunctions.yml
UtilityFunctions.ps1 Proxy Dll ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "UtilityFunctions.ps1" or ProcessCommandLine contains "RegSnapin "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_stop_service.yml
Stop Windows Service Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " stop " and ((ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")) or (FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_cleanwipe.yml
PUA - CleanWipe Execution ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\SepRemovalToolNative_x64.exe" or (ProcessCommandLine contains "--uninstall" and FolderPath endswith "\\CATClean.exe") or (ProcessCommandLine contains "-r" and FolderPath endswith "\\NetInstaller.exe") or ((ProcessCommandLine contains "/uninstall" and ProcessCommandLine contains "/enterprise") and FolderPath endswith "\\WFPUnins.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_xwizard_runwizard_com_object_exec.yml
COM Object Execution via Xwizard.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine =~ "RunWizard" and ProcessCommandLine matches regex "\\{[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}\\}"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_openconsole.yml
Use of OpenConsole ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName =~ "OpenConsole.exe" or FolderPath endswith "\\OpenConsole.exe") and (not(FolderPath startswith "C:\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_eventvwr_susp_child_process.yml
Potentially Suspicious Event Viewer Child Process ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\eventvwr.exe" and (not((FolderPath endswith ":\\Windows\\System32\\mmc.exe" or FolderPath endswith ":\\Windows\\System32\\WerFault.exe" or FolderPath endswith ":\\Windows\\SysWOW64\\WerFault.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_exec_from_trusted_locations.yml
Potentially Suspicious Office Document Executed From Trusted Location ---> KQL Query:
DeviceProcessEvents
| where (((FolderPath endswith "\\EXCEL.EXE" or FolderPath endswith "\\POWERPNT.EXE" or FolderPath endswith "\\WINWORD.exe") or (ProcessVersionInfoOriginalFileName in~ ("Excel.exe", "POWERPNT.EXE", "WinWord.exe"))) and (InitiatingProcessFolderPath endswith "\\explorer.exe" or InitiatingProcessFolderPath endswith "\\dopus.exe") and (ProcessCommandLine contains "\\AppData\\Roaming\\Microsoft\\Templates" or ProcessCommandLine contains "\\AppData\\Roaming\\Microsoft\\Word\\Startup\\" or ProcessCommandLine contains "\\Microsoft Office\\root\\Templates\\" or ProcessCommandLine contains "\\Microsoft Office\\Templates\\")) and (not((ProcessCommandLine endswith ".dotx" or ProcessCommandLine endswith ".xltx" or ProcessCommandLine endswith ".potx")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_runscripthelper.yml
Suspicious Runscripthelper.exe ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "surfacecheck" and FolderPath endswith "\\Runscripthelper.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_winrar_uncommon_folder_execution.yml
Winrar Execution in Non-Standard Folder ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\rar.exe" or FolderPath endswith "\\winrar.exe") or ProcessVersionInfoFileDescription =~ "Command line RAR") and (not(((FolderPath contains ":\\Program Files (x86)\\WinRAR\\" or FolderPath contains ":\\Program Files\\WinRAR\\") or FolderPath endswith "\\UnRAR.exe"))) and (not(FolderPath contains ":\\Windows\\Temp\\"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution.yml
HackTool - CrackMapExec Execution ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\crackmapexec.exe" or (ProcessCommandLine contains " --local-auth" and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -x ") or (ProcessCommandLine contains " --local-auth" and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -p " and ProcessCommandLine contains " -H 'NTHASH'") or (ProcessCommandLine contains " mssql " and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -p " and ProcessCommandLine contains " -M " and ProcessCommandLine contains " -d ") or (ProcessCommandLine contains " smb " and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -H " and ProcessCommandLine contains " -M " and ProcessCommandLine contains " -o ") or (ProcessCommandLine contains " smb " and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -p " and ProcessCommandLine contains " --local-auth") or ProcessCommandLine contains " -M pe_inject ") or ((ProcessCommandLine contains " --local-auth" and ProcessCommandLine contains " -u " and ProcessCommandLine contains " -p ") and (ProcessCommandLine contains " 10." and ProcessCommandLine contains " 192.168." and ProcessCommandLine contains "/24 "))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_firewall.yml
Windows Firewall Disabled via PowerShell ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Set-NetFirewallProfile " and ProcessCommandLine contains " -Enabled " and ProcessCommandLine contains " False") and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\powershell_ise.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll"))) and (ProcessCommandLine contains " -All " or ProcessCommandLine contains "Public" or ProcessCommandLine contains "Domain" or ProcessCommandLine contains "Private")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_appx_execution.yml
Potentially Suspicious Windows App Activity ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath contains "C:\\Program Files\\WindowsApps\\" and ((ProcessCommandLine contains "cmd /c" or ProcessCommandLine contains "Invoke-" or ProcessCommandLine contains "Base64") or (FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe")) and (not(((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\pwsh.exe") and InitiatingProcessFolderPath contains ":\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal" and InitiatingProcessFolderPath endswith "\\WindowsTerminal.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_msteams.yml
Renamed Microsoft Teams Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName in~ ("msteams.exe", "teams.exe")) and (not((FolderPath endswith "\\msteams.exe" or FolderPath endswith "\\teams.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_stdin_redirect.yml
Read Contents From Stdin Via Cmd.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "<" and (ProcessVersionInfoOriginalFileName =~ "Cmd.Exe" or FolderPath endswith "\\cmd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_nteventlogfile_usage.yml
Potentially Suspicious Call To Win32_NTEventlogFile Class ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Win32_NTEventlogFile" and (ProcessCommandLine contains ".BackupEventlog(" or ProcessCommandLine contains ".ChangeSecurityPermissions(" or ProcessCommandLine contains ".ChangeSecurityPermissionsEx(" or ProcessCommandLine contains ".ClearEventLog(" or ProcessCommandLine contains ".Delete(" or ProcessCommandLine contains ".DeleteEx(" or ProcessCommandLine contains ".Rename(" or ProcessCommandLine contains ".TakeOwnerShip(" or ProcessCommandLine contains ".TakeOwnerShipEx(")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_eventlog_clear.yml
Suspicious Eventlog Clearing or Configuration Change Activity ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "clear-log " or ProcessCommandLine contains " cl " or ProcessCommandLine contains "set-log " or ProcessCommandLine contains " sl " or ProcessCommandLine contains "lfn:") and (FolderPath endswith "\\wevtutil.exe" or ProcessVersionInfoOriginalFileName =~ "wevtutil.exe")) or (((ProcessCommandLine contains "Clear-EventLog " or ProcessCommandLine contains "Remove-EventLog " or ProcessCommandLine contains "Limit-EventLog " or ProcessCommandLine contains "Clear-WinEvent ") or (ProcessCommandLine contains "Eventing.Reader.EventLogSession" and ProcessCommandLine contains "ClearLog") or (ProcessCommandLine contains "Diagnostics.EventLog" and ProcessCommandLine contains "Clear")) and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\pwsh.exe")) or ((ProcessCommandLine contains "ClearEventLog" and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\wmic.exe")) and (not((ProcessCommandLine contains " sl " and (InitiatingProcessFolderPath in~ ("C:\\Windows\\SysWOW64\\msiexec.exe", "C:\\Windows\\System32\\msiexec.exe"))))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_msdt.yml
Renamed Msdt.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "msdt.exe" and (not(FolderPath endswith "\\msdt.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_service_imagepath_change.yml
Changing Existing Service ImagePath Value Via Reg.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "add " and ProcessCommandLine contains "SYSTEM\\CurrentControlSet\\Services\\" and ProcessCommandLine contains " ImagePath ") and FolderPath endswith "\\reg.exe") and (ProcessCommandLine contains " -d " or ProcessCommandLine contains " /d " or ProcessCommandLine contains " d " or ProcessCommandLine contains " d " or ProcessCommandLine contains " d ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_installscreensaver.yml
Rundll32 InstallScreenSaver Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "InstallScreenSaver" and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.EXE")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_squirrel_proxy_execution.yml
Process Proxy Execution Via Squirrel.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "--processStart" or ProcessCommandLine contains "--processStartAndWait" or ProcessCommandLine contains "--createShortcut") and (FolderPath endswith "\\squirrel.exe" or FolderPath endswith "\\update.exe")) and (not(((ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\Discord\\Update.exe" and ProcessCommandLine contains " --processStart" and ProcessCommandLine contains "Discord.exe") or ((ProcessCommandLine contains "--createShortcut" or ProcessCommandLine contains "--processStartAndWait") and (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\GitHubDesktop\\Update.exe" and ProcessCommandLine contains "GitHubDesktop.exe")) or ((ProcessCommandLine contains "--processStart" or ProcessCommandLine contains "--createShortcut") and (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\Microsoft\\Teams\\Update.exe" and ProcessCommandLine contains "Teams.exe")) or ((ProcessCommandLine contains "--processStart" or ProcessCommandLine contains "--createShortcut") and (ProcessCommandLine contains ":\\Users\\" and ProcessCommandLine contains "\\AppData\\Local\\yammerdesktop\\Update.exe" and ProcessCommandLine contains "Yammer.exe")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_crypto_mining_monero.yml
Potential Crypto Mining Activity ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " --cpu-priority=" or ProcessCommandLine contains "--donate-level=0" or ProcessCommandLine contains " -o pool." or ProcessCommandLine contains " --nicehash" or ProcessCommandLine contains " --algo=rx/0 " or ProcessCommandLine contains "stratum+tcp://" or ProcessCommandLine contains "stratum+udp://" or ProcessCommandLine contains "LS1kb25hdGUtbGV2ZWw9" or ProcessCommandLine contains "0tZG9uYXRlLWxldmVsP" or ProcessCommandLine contains "tLWRvbmF0ZS1sZXZlbD" or ProcessCommandLine contains "c3RyYXR1bSt0Y3A6Ly" or ProcessCommandLine contains "N0cmF0dW0rdGNwOi8v" or ProcessCommandLine contains "zdHJhdHVtK3RjcDovL" or ProcessCommandLine contains "c3RyYXR1bSt1ZHA6Ly" or ProcessCommandLine contains "N0cmF0dW0rdWRwOi8v" or ProcessCommandLine contains "zdHJhdHVtK3VkcDovL") and (not((ProcessCommandLine contains " pool.c " or ProcessCommandLine contains " pool.o " or ProcessCommandLine contains "gcc -")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_dump.yml
VeeamBackup Database Credentials Dump Via Sqlcmd.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "SELECT" and ProcessCommandLine contains "TOP" and ProcessCommandLine contains "[VeeamBackup].[dbo].[Credentials]") and FolderPath endswith "\\sqlcmd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gfxdownloadwrapper_arbitrary_file_download.yml
Arbitrary File Download Via GfxDownloadWrapper.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "http://" or ProcessCommandLine contains "https://") and FolderPath endswith "\\GfxDownloadWrapper.exe") and (not(ProcessCommandLine contains "https://gameplayapi.intel.com/"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_public_folder.yml
Execution of Powershell Script in Public Folder ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-f C:\\Users\\Public" or ProcessCommandLine contains "-f \"C:\\Users\\Public" or ProcessCommandLine contains "-f %Public%" or ProcessCommandLine contains "-fi C:\\Users\\Public" or ProcessCommandLine contains "-fi \"C:\\Users\\Public" or ProcessCommandLine contains "-fi %Public%" or ProcessCommandLine contains "-fil C:\\Users\\Public" or ProcessCommandLine contains "-fil \"C:\\Users\\Public" or ProcessCommandLine contains "-fil %Public%" or ProcessCommandLine contains "-file C:\\Users\\Public" or ProcessCommandLine contains "-file \"C:\\Users\\Public" or ProcessCommandLine contains "-file %Public%") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_set_acl_susp_location.yml
PowerShell Set-Acl On Windows Folder ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Set-Acl " and ProcessCommandLine contains "-AclObject ") and ((ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")) or (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) and (ProcessCommandLine contains "-Path \"C:\\Windows" or ProcessCommandLine contains "-Path 'C:\\Windows" or ProcessCommandLine contains "-Path %windir%" or ProcessCommandLine contains "-Path $env:windir") and (ProcessCommandLine contains "FullControl" or ProcessCommandLine contains "Allow")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_susp_execution.yml
Suspicious Active Directory Database Snapshot Via ADExplorer ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "snapshot" and (FolderPath endswith "\\ADExplorer.exe" or ProcessVersionInfoOriginalFileName =~ "AdExp") and (ProcessCommandLine contains "\\Downloads\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\AppData\\" or ProcessCommandLine contains "\\Windows\\Temp\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_product_class.yml
Potential Product Class Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "AntiVirusProduct" or ProcessCommandLine contains "AntiSpywareProduct" or ProcessCommandLine contains "FirewallProduct") and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sc_change_sevice_image_path_by_non_admin.yml
Possible Privilege Escalation via Weak Service Permissions ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\sc.exe" and (ProcessIntegrityLevel in~ ("Medium", "S-1-16-8192"))) and ((ProcessCommandLine contains "config" and ProcessCommandLine contains "binPath") or (ProcessCommandLine contains "failure" and ProcessCommandLine contains "command"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wpbbin_potential_persistence.yml
UEFI Persistence Via Wpbbin - ProcessCreation ---> KQL Query:
DeviceProcessEvents
| where FolderPath =~ "C:\\Windows\\System32\\wpbbin.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_grpconv.yml
Suspicious GrpConv Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "grpconv.exe -o" or ProcessCommandLine contains "grpconv -o"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_private_keys_recon.yml
Private Keys Reconnaissance Via CommandLine Tools ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".key" or ProcessCommandLine contains ".pgp" or ProcessCommandLine contains ".gpg" or ProcessCommandLine contains ".ppk" or ProcessCommandLine contains ".p12" or ProcessCommandLine contains ".pem" or ProcessCommandLine contains ".pfx" or ProcessCommandLine contains ".cer" or ProcessCommandLine contains ".p7b" or ProcessCommandLine contains ".asc") and ((ProcessCommandLine contains "dir " and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")) or (ProcessCommandLine contains "Get-ChildItem " and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))) or (FolderPath endswith "\\findstr.exe" or ProcessVersionInfoOriginalFileName =~ "FINDSTR.EXE"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_teamviewer_incoming_connection.yml
Remote Access Tool - Team Viewer Session Started On Windows Host ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine endswith "TeamViewer_Desktop.exe --IPCport 5939 --Module 1" and FolderPath =~ "TeamViewer_Desktop.exe" and InitiatingProcessFolderPath =~ "TeamViewer_Service.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_powershell_execution_via_dll.yml
Potential PowerShell Execution Via DLL ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Default.GetString" or ProcessCommandLine contains "DownloadString" or ProcessCommandLine contains "FromBase64String" or ProcessCommandLine contains "ICM " or ProcessCommandLine contains "IEX " or ProcessCommandLine contains "Invoke-Command" or ProcessCommandLine contains "Invoke-Expression") and ((FolderPath endswith "\\InstallUtil.exe" or FolderPath endswith "\\RegAsm.exe" or FolderPath endswith "\\RegSvcs.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe") or (ProcessVersionInfoOriginalFileName in~ ("InstallUtil.exe", "RegAsm.exe", "RegSvcs.exe", "REGSVR32.EXE", "RUNDLL32.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_sftp.yml
Use Of The SFTP.EXE Binary As A LOLBIN ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -D .." or ProcessCommandLine contains " -D C:\\") and FolderPath endswith "\\sftp.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pdqdeploy_runner_susp_children.yml
Potentially Suspicious Execution Of PDQDeployRunner ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\bash.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\csc.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\dllhost.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\msiexec.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\scriptrunner.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\wsl.exe") or (FolderPath contains ":\\ProgramData\\" or FolderPath contains ":\\Users\\Public\\" or FolderPath contains ":\\Windows\\TEMP\\" or FolderPath contains "\\AppData\\Local\\Temp") or (ProcessCommandLine contains " -decode " or ProcessCommandLine contains " -enc " or ProcessCommandLine contains " -encodedcommand " or ProcessCommandLine contains " -w hidden" or ProcessCommandLine contains "DownloadString" or ProcessCommandLine contains "FromBase64String" or ProcessCommandLine contains "http" or ProcessCommandLine contains "iex " or ProcessCommandLine contains "Invoke-")) and InitiatingProcessFolderPath contains "\\PDQDeployRunner-"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_pester_1.yml
Execute Code with Pester.bat ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "Pester" and ProcessCommandLine contains "Get-Help") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")) or (((ProcessCommandLine contains "pester" and ProcessCommandLine contains ";") and FolderPath endswith "\\cmd.exe") and (ProcessCommandLine contains "help" or ProcessCommandLine contains "?"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_install_unsigned_appx_packages.yml
Unsigned AppX Installation Attempt Using Add-AppxPackage ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Add-AppPackage " or ProcessCommandLine contains "Add-AppxPackage ") and ProcessCommandLine contains " -AllowUnsigned" and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_stdin.yml
Invoke-Obfuscation STDIN+ Launcher ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine matches regex "cmd.{0,5}(?:/c|/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\""

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_workfolders.yml
Execution via WorkFolders.exe ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\control.exe" and InitiatingProcessFolderPath endswith "\\WorkFolders.exe") and (not(FolderPath =~ "C:\\Windows\\System32\\control.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_rundll32_susp_execution_with_image_extension.yml
Suspicious Rundll32 Execution With Image Extension ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains ".bmp" or ProcessCommandLine contains ".cr2" or ProcessCommandLine contains ".eps" or ProcessCommandLine contains ".gif" or ProcessCommandLine contains ".ico" or ProcessCommandLine contains ".jpeg" or ProcessCommandLine contains ".jpg" or ProcessCommandLine contains ".nef" or ProcessCommandLine contains ".orf" or ProcessCommandLine contains ".png" or ProcessCommandLine contains ".raw" or ProcessCommandLine contains ".sr2" or ProcessCommandLine contains ".tif" or ProcessCommandLine contains ".tiff") and (FolderPath endswith "\\rundll32.exe" or ProcessVersionInfoOriginalFileName =~ "RUNDLL32.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_findstr_recon_everyone.yml
Permission Misconfiguration Reconnaissance Via Findstr.EXE ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains "\"Everyone\"" or ProcessCommandLine contains "'Everyone'" or ProcessCommandLine contains "\"BUILTIN\\\"" or ProcessCommandLine contains "'BUILTIN\\'") and ((FolderPath endswith "\\find.exe" or FolderPath endswith "\\findstr.exe") or (ProcessVersionInfoOriginalFileName in~ ("FIND.EXE", "FINDSTR.EXE")))) or (ProcessCommandLine contains "icacls " and ProcessCommandLine contains "findstr " and ProcessCommandLine contains "Everyone")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pdqdeploy_execution.yml
PDQ Deploy Remote Adminstartion Tool Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoFileDescription =~ "PDQ Deploy Console" or ProcessVersionInfoProductName =~ "PDQ Deploy" or ProcessVersionInfoCompanyName =~ "PDQ.com" or ProcessVersionInfoOriginalFileName =~ "PDQDeployConsole.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_cl_invocation.yml
Potential Process Execution Proxy Via CL_Invocation.ps1 ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "SyncInvoke "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_webshell_susp_process_spawned_from_webserver.yml
Suspicious Process By Web Server Process ---> KQL Query:
DeviceProcessEvents
| where (((InitiatingProcessFolderPath contains "-tomcat-" or InitiatingProcessFolderPath contains "\\tomcat") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or ((InitiatingProcessCommandLine contains "CATALINA_HOME" or InitiatingProcessCommandLine contains "catalina.home" or InitiatingProcessCommandLine contains "catalina.jar") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or (InitiatingProcessFolderPath endswith "\\caddy.exe" or InitiatingProcessFolderPath endswith "\\httpd.exe" or InitiatingProcessFolderPath endswith "\\nginx.exe" or InitiatingProcessFolderPath endswith "\\php-cgi.exe" or InitiatingProcessFolderPath endswith "\\php.exe" or InitiatingProcessFolderPath endswith "\\tomcat.exe" or InitiatingProcessFolderPath endswith "\\UMWorkerProcess.exe" or InitiatingProcessFolderPath endswith "\\w3wp.exe" or InitiatingProcessFolderPath endswith "\\ws_TomcatService.exe")) and (FolderPath endswith "\\arp.exe" or FolderPath endswith "\\at.exe" or FolderPath endswith "\\bash.exe" or FolderPath endswith "\\bitsadmin.exe" or FolderPath endswith "\\certutil.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\dsget.exe" or FolderPath endswith "\\hostname.exe" or FolderPath endswith "\\nbtstat.exe" or FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe" or FolderPath endswith "\\netdom.exe" or FolderPath endswith "\\netsh.exe" or FolderPath endswith "\\nltest.exe" or FolderPath endswith "\\ntdsutil.exe" or FolderPath endswith "\\powershell_ise.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\qprocess.exe" or FolderPath endswith "\\query.exe" or FolderPath endswith "\\qwinsta.exe" or FolderPath endswith "\\reg.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\sc.exe" or FolderPath endswith "\\sh.exe" or FolderPath endswith "\\wmic.exe" or FolderPath endswith "\\wscript.exe" or FolderPath endswith "\\wusa.exe") and (not(((ProcessCommandLine endswith "Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager \"Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt" and InitiatingProcessFolderPath endswith "\\java.exe") or ((ProcessCommandLine contains "sc query" and ProcessCommandLine contains "ADManager Plus") and InitiatingProcessFolderPath endswith "\\java.exe"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_livekd_kernel_memory_dump.yml
Kernel Memory Dump Via LiveKD ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -m" or ProcessCommandLine contains " /m" or ProcessCommandLine contains " m" or ProcessCommandLine contains " m" or ProcessCommandLine contains " m") and ((FolderPath endswith "\\livekd.exe" or FolderPath endswith "\\livekd64.exe") or ProcessVersionInfoOriginalFileName =~ "livekd.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_getprocess_lsass.yml
PowerShell Get-Process LSASS ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Get-Process lsas" or ProcessCommandLine contains "ps lsas" or ProcessCommandLine contains "gps lsas"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_reg_enumeration_for_credentials_in_registry.yml
Enumeration for Credentials in Registry ---> KQL Query:
DeviceProcessEvents
| where ((ProcessCommandLine contains " query " and ProcessCommandLine contains "/t " and ProcessCommandLine contains "REG_SZ" and ProcessCommandLine contains "/s") and FolderPath endswith "\\reg.exe") and ((ProcessCommandLine contains "/f " and ProcessCommandLine contains "HKLM") or (ProcessCommandLine contains "/f " and ProcessCommandLine contains "HKCU") or ProcessCommandLine contains "HKCU\\Software\\SimonTatham\\PuTTY\\Sessions")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_git_susp_clone.yml
Suspicious Git Clone ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " clone " or ProcessCommandLine contains "git-remote-https ") and ((FolderPath endswith "\\git.exe" or FolderPath endswith "\\git-remote-https.exe") or ProcessVersionInfoOriginalFileName =~ "git.exe") and (ProcessCommandLine contains "exploit" or ProcessCommandLine contains "Vulns" or ProcessCommandLine contains "vulnerability" or ProcessCommandLine contains "RemoteCodeExecution" or ProcessCommandLine contains "Invoke-" or ProcessCommandLine contains "CVE-" or ProcessCommandLine contains "poc-" or ProcessCommandLine contains "ProofOfConcept" or ProcessCommandLine contains "proxyshell" or ProcessCommandLine contains "log4shell" or ProcessCommandLine contains "eternalblue" or ProcessCommandLine contains "eternal-blue" or ProcessCommandLine contains "MS17-")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_non_exe_image.yml
Execution of Suspicious File Type Extension ---> KQL Query:
DeviceProcessEvents
| where (not((FolderPath endswith ".bin" or FolderPath endswith ".cgi" or FolderPath endswith ".com" or FolderPath endswith ".exe" or FolderPath endswith ".scr" or FolderPath endswith ".tmp"))) and (not((FolderPath contains ":\\$Extend\\$Deleted\\" or FolderPath contains ":\\Windows\\System32\\DriverStore\\FileRepository\\" or (FolderPath in~ ("-", "")) or (FolderPath in~ ("System", "Registry", "MemCompression", "vmmem")) or FolderPath contains ":\\Windows\\Installer\\MSI" or (FolderPath contains ":\\Config.Msi\\" and (FolderPath endswith ".rbf" or FolderPath endswith ".rbs")) or isnull(FolderPath) or (InitiatingProcessFolderPath contains ":\\Windows\\Temp\\" or FolderPath contains ":\\Windows\\Temp\\")))) and (not((InitiatingProcessFolderPath contains ":\\ProgramData\\Avira\\" or (FolderPath endswith "com.docker.service" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\services.exe") or FolderPath contains ":\\Program Files\\Mozilla Firefox\\" or FolderPath endswith "\\LZMA_EXE" or (FolderPath endswith ":\\Program Files (x86)\\MyQ\\Server\\pcltool.dll" or FolderPath endswith ":\\Program Files\\MyQ\\Server\\pcltool.dll") or (FolderPath contains "NVIDIA\\NvBackend\\" and FolderPath endswith ".dat") or ((FolderPath contains ":\\Program Files (x86)\\WINPAKPRO\\" or FolderPath contains ":\\Program Files\\WINPAKPRO\\") and FolderPath endswith ".ngn") or (FolderPath contains "\\AppData\\Local\\Packages\\" and FolderPath contains "\\LocalState\\rootfs\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_unusual_parent.yml
Unusual Parent Process For Cmd.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\cmd.exe" and (InitiatingProcessFolderPath endswith "\\csrss.exe" or InitiatingProcessFolderPath endswith "\\ctfmon.exe" or InitiatingProcessFolderPath endswith "\\dllhost.exe" or InitiatingProcessFolderPath endswith "\\epad.exe" or InitiatingProcessFolderPath endswith "\\FlashPlayerUpdateService.exe" or InitiatingProcessFolderPath endswith "\\GoogleUpdate.exe" or InitiatingProcessFolderPath endswith "\\jucheck.exe" or InitiatingProcessFolderPath endswith "\\jusched.exe" or InitiatingProcessFolderPath endswith "\\LogonUI.exe" or InitiatingProcessFolderPath endswith "\\lsass.exe" or InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\SearchIndexer.exe" or InitiatingProcessFolderPath endswith "\\SearchProtocolHost.exe" or InitiatingProcessFolderPath endswith "\\SIHClient.exe" or InitiatingProcessFolderPath endswith "\\sihost.exe" or InitiatingProcessFolderPath endswith "\\slui.exe" or InitiatingProcessFolderPath endswith "\\spoolsv.exe" or InitiatingProcessFolderPath endswith "\\sppsvc.exe" or InitiatingProcessFolderPath endswith "\\taskhostw.exe" or InitiatingProcessFolderPath endswith "\\unsecapp.exe" or InitiatingProcessFolderPath endswith "\\WerFault.exe" or InitiatingProcessFolderPath endswith "\\wermgr.exe" or InitiatingProcessFolderPath endswith "\\wlanext.exe" or InitiatingProcessFolderPath endswith "\\WUDFHost.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml
Powershell Defender Exclusion ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Add-MpPreference " or ProcessCommandLine contains "Set-MpPreference ") and (ProcessCommandLine contains " -ExclusionPath " or ProcessCommandLine contains " -ExclusionExtension " or ProcessCommandLine contains " -ExclusionProcess " or ProcessCommandLine contains " -ExclusionIpAddress ")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_vmnat.yml
Renamed Vmnat.exe Execution ---> KQL Query:
DeviceProcessEvents
| where ProcessVersionInfoOriginalFileName =~ "vmnat.exe" and (not(FolderPath endswith "vmnat.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gpresult_execution.yml
Gpresult Display Group Policy Information ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/z" or ProcessCommandLine contains "/v") and FolderPath endswith "\\gpresult.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_gup_suspicious_execution.yml
Suspicious GUP Usage ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "\\GUP.exe" and (not(((FolderPath endswith "\\Program Files\\Notepad++\\updater\\GUP.exe" or FolderPath endswith "\\Program Files (x86)\\Notepad++\\updater\\GUP.exe") or (FolderPath contains "\\Users\\" and (FolderPath endswith "\\AppData\\Local\\Notepad++\\updater\\GUP.exe" or FolderPath endswith "\\AppData\\Roaming\\Notepad++\\updater\\GUP.exe")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_sdclt.yml
Potential UAC Bypass Via Sdclt.EXE ---> KQL Query:
DeviceProcessEvents
| where FolderPath endswith "sdclt.exe" and (ProcessIntegrityLevel in~ ("High", "S-1-16-12288"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load_obfusc.yml
Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ" or ProcessCommandLine contains "oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA" or ProcessCommandLine contains "6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA" or ProcessCommandLine contains "OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ" or ProcessCommandLine contains "oAOgAoACIATABvACIAKwAiAGEAZAAiACkA" or ProcessCommandLine contains "6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA" or ProcessCommandLine contains "OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ" or ProcessCommandLine contains "oAOgAoACIATABvAGEAIgArACIAZAAiACkA" or ProcessCommandLine contains "6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA" or ProcessCommandLine contains "OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ" or ProcessCommandLine contains "oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA" or ProcessCommandLine contains "6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA" or ProcessCommandLine contains "OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ" or ProcessCommandLine contains "oAOgAoACcATABvACcAKwAnAGEAZAAnACkA" or ProcessCommandLine contains "6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA" or ProcessCommandLine contains "OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ" or ProcessCommandLine contains "oAOgAoACcATABvAGEAJwArACcAZAAnACkA" or ProcessCommandLine contains "6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_active_directory_module_dll_import.yml
Potential Active Directory Enumeration Using AD Module - ProcCreation ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "Import-Module " or ProcessCommandLine contains "ipmo ") and ProcessCommandLine contains "Microsoft.ActiveDirectory.Management.dll" and ((FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe") or (ProcessVersionInfoOriginalFileName in~ ("PowerShell.EXE", "pwsh.dll")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_chcp_codepage_lookup.yml
Console CodePage Lookup Via CHCP ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine endswith "chcp" or ProcessCommandLine endswith "chcp " or ProcessCommandLine endswith "chcp  ") and FolderPath endswith "\\chcp.com" and (InitiatingProcessCommandLine contains " -c " or InitiatingProcessCommandLine contains " /c " or InitiatingProcessCommandLine contains " c " or InitiatingProcessCommandLine contains " c " or InitiatingProcessCommandLine contains " c " or InitiatingProcessCommandLine contains " -r " or InitiatingProcessCommandLine contains " /r " or InitiatingProcessCommandLine contains " r " or InitiatingProcessCommandLine contains " r " or InitiatingProcessCommandLine contains " r " or InitiatingProcessCommandLine contains " -k " or InitiatingProcessCommandLine contains " /k " or InitiatingProcessCommandLine contains " k " or InitiatingProcessCommandLine contains " k " or InitiatingProcessCommandLine contains " k ") and InitiatingProcessFolderPath endswith "\\cmd.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_assoc_execution.yml
Change Default File Association Via Assoc ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "assoc" and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_provlaunch_potential_abuse.yml
Potential Provlaunch.EXE Binary Proxy Execution Abuse ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath endswith "\\provlaunch.exe" and (not(((FolderPath endswith "\\calc.exe" or FolderPath endswith "\\cmd.exe" or FolderPath endswith "\\cscript.exe" or FolderPath endswith "\\mshta.exe" or FolderPath endswith "\\notepad.exe" or FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe" or FolderPath endswith "\\regsvr32.exe" or FolderPath endswith "\\rundll32.exe" or FolderPath endswith "\\wscript.exe") or (FolderPath contains ":\\PerfLogs\\" or FolderPath contains ":\\Temp\\" or FolderPath contains ":\\Users\\Public\\" or FolderPath contains "\\AppData\\Temp\\" or FolderPath contains "\\Windows\\System32\\Tasks\\" or FolderPath contains "\\Windows\\Tasks\\" or FolderPath contains "\\Windows\\Temp\\"))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_msdeploy.yml
Execute Files with Msdeploy.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "verb:sync" and ProcessCommandLine contains "-source:RunCommand" and ProcessCommandLine contains "-dest:runCommand") and FolderPath endswith "\\msdeploy.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_regsvr32_susp_parent.yml
Scripting/CommandLine Process Spawned Regsvr32 ---> KQL Query:
DeviceProcessEvents
| where (FolderPath endswith "\\regsvr32.exe" and (InitiatingProcessFolderPath endswith "\\cmd.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe" or InitiatingProcessFolderPath endswith "\\mshta.exe" or InitiatingProcessFolderPath endswith "\\powershell_ise.exe" or InitiatingProcessFolderPath endswith "\\powershell.exe" or InitiatingProcessFolderPath endswith "\\pwsh.exe" or InitiatingProcessFolderPath endswith "\\wscript.exe")) and (not((ProcessCommandLine endswith " /s C:\\Windows\\System32\\RpcProxy\\RpcProxy.dll" and InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\cmd.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_renamed_curl.yml
Renamed CURL.EXE Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessVersionInfoOriginalFileName =~ "curl.exe" or ProcessVersionInfoFileDescription =~ "The curl executable") and (not(FolderPath contains "\\curl"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml
Webshell Hacking Activity Patterns ---> KQL Query:
DeviceProcessEvents
| where (((InitiatingProcessFolderPath contains "-tomcat-" or InitiatingProcessFolderPath contains "\\tomcat") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or ((ProcessCommandLine contains "catalina.jar" or ProcessCommandLine contains "CATALINA_HOME") and (InitiatingProcessFolderPath endswith "\\java.exe" or InitiatingProcessFolderPath endswith "\\javaw.exe")) or (InitiatingProcessFolderPath endswith "\\caddy.exe" or InitiatingProcessFolderPath endswith "\\httpd.exe" or InitiatingProcessFolderPath endswith "\\nginx.exe" or InitiatingProcessFolderPath endswith "\\php-cgi.exe" or InitiatingProcessFolderPath endswith "\\w3wp.exe" or InitiatingProcessFolderPath endswith "\\ws_tomcatservice.exe")) and ((ProcessCommandLine contains "rundll32" and ProcessCommandLine contains "comsvcs") or (ProcessCommandLine contains " -hp" and ProcessCommandLine contains " a " and ProcessCommandLine contains " -m") or (ProcessCommandLine contains "net" and ProcessCommandLine contains " user " and ProcessCommandLine contains " /add") or (ProcessCommandLine contains "net" and ProcessCommandLine contains " localgroup " and ProcessCommandLine contains " administrators " and ProcessCommandLine contains "/add") or (FolderPath endswith "\\ntdsutil.exe" or FolderPath endswith "\\ldifde.exe" or FolderPath endswith "\\adfind.exe" or FolderPath endswith "\\procdump.exe" or FolderPath endswith "\\Nanodump.exe" or FolderPath endswith "\\vssadmin.exe" or FolderPath endswith "\\fsutil.exe") or (ProcessCommandLine contains " -decode " or ProcessCommandLine contains " -NoP " or ProcessCommandLine contains " -W Hidden " or ProcessCommandLine contains " /decode " or ProcessCommandLine contains " /ticket:" or ProcessCommandLine contains " sekurlsa" or ProcessCommandLine contains ".dmp full" or ProcessCommandLine contains ".downloadfile(" or ProcessCommandLine contains ".downloadstring(" or ProcessCommandLine contains "FromBase64String" or ProcessCommandLine contains "process call create" or ProcessCommandLine contains "reg save " or ProcessCommandLine contains "whoami /priv"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_parameter_variation.yml
Suspicious PowerShell Parameter Substring ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " -windowstyle h " or ProcessCommandLine contains " -windowstyl h" or ProcessCommandLine contains " -windowsty h" or ProcessCommandLine contains " -windowst h" or ProcessCommandLine contains " -windows h" or ProcessCommandLine contains " -windo h" or ProcessCommandLine contains " -wind h" or ProcessCommandLine contains " -win h" or ProcessCommandLine contains " -wi h" or ProcessCommandLine contains " -win h " or ProcessCommandLine contains " -win hi " or ProcessCommandLine contains " -win hid " or ProcessCommandLine contains " -win hidd " or ProcessCommandLine contains " -win hidde " or ProcessCommandLine contains " -NoPr " or ProcessCommandLine contains " -NoPro " or ProcessCommandLine contains " -NoProf " or ProcessCommandLine contains " -NoProfi " or ProcessCommandLine contains " -NoProfil " or ProcessCommandLine contains " -nonin " or ProcessCommandLine contains " -nonint " or ProcessCommandLine contains " -noninte " or ProcessCommandLine contains " -noninter " or ProcessCommandLine contains " -nonintera " or ProcessCommandLine contains " -noninterac " or ProcessCommandLine contains " -noninteract " or ProcessCommandLine contains " -noninteracti " or ProcessCommandLine contains " -noninteractiv " or ProcessCommandLine contains " -ec " or ProcessCommandLine contains " -encodedComman " or ProcessCommandLine contains " -encodedComma " or ProcessCommandLine contains " -encodedComm " or ProcessCommandLine contains " -encodedCom " or ProcessCommandLine contains " -encodedCo " or ProcessCommandLine contains " -encodedC " or ProcessCommandLine contains " -encoded " or ProcessCommandLine contains " -encode " or ProcessCommandLine contains " -encod " or ProcessCommandLine contains " -enco " or ProcessCommandLine contains " -en " or ProcessCommandLine contains " -executionpolic " or ProcessCommandLine contains " -executionpoli " or ProcessCommandLine contains " -executionpol " or ProcessCommandLine contains " -executionpo " or ProcessCommandLine contains " -executionp " or ProcessCommandLine contains " -execution bypass" or ProcessCommandLine contains " -executio bypass" or ProcessCommandLine contains " -executi bypass" or ProcessCommandLine contains " -execut bypass" or ProcessCommandLine contains " -execu bypass" or ProcessCommandLine contains " -exec bypass" or ProcessCommandLine contains " -exe bypass" or ProcessCommandLine contains " -ex bypass" or ProcessCommandLine contains " -ep bypass" or ProcessCommandLine contains " /windowstyle h " or ProcessCommandLine contains " /windowstyl h" or ProcessCommandLine contains " /windowsty h" or ProcessCommandLine contains " /windowst h" or ProcessCommandLine contains " /windows h" or ProcessCommandLine contains " /windo h" or ProcessCommandLine contains " /wind h" or ProcessCommandLine contains " /win h" or ProcessCommandLine contains " /wi h" or ProcessCommandLine contains " /win h " or ProcessCommandLine contains " /win hi " or ProcessCommandLine contains " /win hid " or ProcessCommandLine contains " /win hidd " or ProcessCommandLine contains " /win hidde " or ProcessCommandLine contains " /NoPr " or ProcessCommandLine contains " /NoPro " or ProcessCommandLine contains " /NoProf " or ProcessCommandLine contains " /NoProfi " or ProcessCommandLine contains " /NoProfil " or ProcessCommandLine contains " /nonin " or ProcessCommandLine contains " /nonint " or ProcessCommandLine contains " /noninte " or ProcessCommandLine contains " /noninter " or ProcessCommandLine contains " /nonintera " or ProcessCommandLine contains " /noninterac " or ProcessCommandLine contains " /noninteract " or ProcessCommandLine contains " /noninteracti " or ProcessCommandLine contains " /noninteractiv " or ProcessCommandLine contains " /ec " or ProcessCommandLine contains " /encodedComman " or ProcessCommandLine contains " /encodedComma " or ProcessCommandLine contains " /encodedComm " or ProcessCommandLine contains " /encodedCom " or ProcessCommandLine contains " /encodedCo " or ProcessCommandLine contains " /encodedC " or ProcessCommandLine contains " /encoded " or ProcessCommandLine contains " /encode " or ProcessCommandLine contains " /encod " or ProcessCommandLine contains " /enco " or ProcessCommandLine contains " /en " or ProcessCommandLine contains " /executionpolic " or ProcessCommandLine contains " /executionpoli " or ProcessCommandLine contains " /executionpol " or ProcessCommandLine contains " /executionpo " or ProcessCommandLine contains " /executionp " or ProcessCommandLine contains " /execution bypass" or ProcessCommandLine contains " /executio bypass" or ProcessCommandLine contains " /executi bypass" or ProcessCommandLine contains " /execut bypass" or ProcessCommandLine contains " /execu bypass" or ProcessCommandLine contains " /exec bypass" or ProcessCommandLine contains " /exe bypass" or ProcessCommandLine contains " /ex bypass" or ProcessCommandLine contains " /ep bypass") and (FolderPath endswith "\\powershell.exe" or FolderPath endswith "\\pwsh.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_certutil_encode_susp_location.yml
File In Suspicious Location Encoded To Base64 Via Certutil.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-encode" or ProcessCommandLine contains "/encode" or ProcessCommandLine contains "encode" or ProcessCommandLine contains "encode" or ProcessCommandLine contains "encode") and (ProcessCommandLine contains "\\AppData\\Roaming\\" or ProcessCommandLine contains "\\Desktop\\" or ProcessCommandLine contains "\\Local\\Temp\\" or ProcessCommandLine contains "\\PerfLogs\\" or ProcessCommandLine contains "\\Users\\Public\\" or ProcessCommandLine contains "\\Windows\\Temp\\" or ProcessCommandLine contains "$Recycle.Bin") and (FolderPath endswith "\\certutil.exe" or ProcessVersionInfoOriginalFileName =~ "CertUtil.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_registry_special_accounts_hide_user.yml
Hiding User Account Via SpecialAccounts Registry Key - CommandLine ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList" and ProcessCommandLine contains "add" and ProcessCommandLine contains "/v" and ProcessCommandLine contains "/d 0") and FolderPath endswith "\\reg.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_user_add_never_expire.yml
New User Created Via Net.EXE With Never Expire Option ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "user" and ProcessCommandLine contains "add" and ProcessCommandLine contains "expires:never") and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_lolbin_susp_sqldumper_activity.yml
Dumping Process via Sqldumper.exe ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "0x0110" or ProcessCommandLine contains "0x01100:40") and FolderPath endswith "\\sqldumper.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_parents.yml
Suspicious Process Parents ---> KQL Query:
DeviceProcessEvents
| where (InitiatingProcessFolderPath endswith "\\minesweeper.exe" or InitiatingProcessFolderPath endswith "\\winver.exe" or InitiatingProcessFolderPath endswith "\\bitsadmin.exe") or ((InitiatingProcessFolderPath endswith "\\csrss.exe" or InitiatingProcessFolderPath endswith "\\certutil.exe" or InitiatingProcessFolderPath endswith "\\eventvwr.exe" or InitiatingProcessFolderPath endswith "\\calc.exe" or InitiatingProcessFolderPath endswith "\\notepad.exe") and (not((isnull(FolderPath) or (FolderPath endswith "\\WerFault.exe" or FolderPath endswith "\\wermgr.exe" or FolderPath endswith "\\conhost.exe" or FolderPath endswith "\\mmc.exe" or FolderPath endswith "\\win32calc.exe" or FolderPath endswith "\\notepad.exe")))))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc_as_system.yml
PsExec Service Child Process Execution as LOCAL SYSTEM ---> KQL Query:
DeviceProcessEvents
| where InitiatingProcessFolderPath =~ "C:\\Windows\\PSEXESVC.exe" and (AccountName contains "AUTHORI" or AccountName contains "AUTORI")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_dxcap_arbitrary_binary_execution.yml
New Capture Session Launched Via DXCap.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " -c " and (FolderPath endswith "\\DXCap.exe" or ProcessVersionInfoOriginalFileName =~ "DXCap.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_recon.yml
Recon Information for Export with Command Prompt ---> KQL Query:
DeviceProcessEvents
| where ((FolderPath endswith "\\tree.com" or FolderPath endswith "\\WMIC.exe" or FolderPath endswith "\\doskey.exe" or FolderPath endswith "\\sc.exe") or (ProcessVersionInfoOriginalFileName in~ ("wmic.exe", "DOSKEY.EXE", "sc.exe"))) and (InitiatingProcessCommandLine contains " > %TEMP%\\" or InitiatingProcessCommandLine contains " > %TMP%\\")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_hktl_evil_winrm.yml
HackTool - WinRM Access Via Evil-WinRM ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "-i " and ProcessCommandLine contains "-u " and ProcessCommandLine contains "-p ") and FolderPath endswith "\\ruby.exe"

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_image.yml
Use NTFS Short Name in Image ---> KQL Query:
DeviceProcessEvents
| where (FolderPath contains "~1.bat" or FolderPath contains "~1.dll" or FolderPath contains "~1.exe" or FolderPath contains "~1.hta" or FolderPath contains "~1.js" or FolderPath contains "~1.msi" or FolderPath contains "~1.ps1" or FolderPath contains "~1.tmp" or FolderPath contains "~1.vbe" or FolderPath contains "~1.vbs" or FolderPath contains "~2.bat" or FolderPath contains "~2.dll" or FolderPath contains "~2.exe" or FolderPath contains "~2.hta" or FolderPath contains "~2.js" or FolderPath contains "~2.msi" or FolderPath contains "~2.ps1" or FolderPath contains "~2.tmp" or FolderPath contains "~2.vbe" or FolderPath contains "~2.vbs") and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\explorer.exe")) and (not((InitiatingProcessFolderPath endswith "\\thor\\thor64.exe" or FolderPath endswith "\\VCREDI~1.EXE" or InitiatingProcessFolderPath endswith "\\WebEx\\WebexHost.exe" or FolderPath =~ "C:\\PROGRA~1\\WinZip\\WZPREL~1.EXE")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_net_share_unmount.yml
Unmount Share Via Net.EXE ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "share" and ProcessCommandLine contains "/delete") and ((FolderPath endswith "\\net.exe" or FolderPath endswith "\\net1.exe") or (ProcessVersionInfoOriginalFileName in~ ("net.exe", "net1.exe")))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_cmd_dir_execution.yml
File And SubFolder Enumeration Via Dir Command ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine =~ "*dir*-s*" or ProcessCommandLine =~ "*dir*/s*" or ProcessCommandLine =~ "*dir*s*" or ProcessCommandLine =~ "*dir*s*" or ProcessCommandLine =~ "*dir*s*") and (FolderPath endswith "\\cmd.exe" or ProcessVersionInfoOriginalFileName =~ "Cmd.Exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_product.yml
Potential Product Reconnaissance Via Wmic.EXE ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains "Product" and (FolderPath endswith "\\wmic.exe" or ProcessVersionInfoOriginalFileName =~ "wmic.exe")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_nircmd_as_system.yml
PUA - NirCmd Execution As LOCAL SYSTEM ---> KQL Query:
DeviceProcessEvents
| where ProcessCommandLine contains " runassystem "

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_rcedit_execution.yml
PUA - Potential PE Metadata Tamper Using Rcedit ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "OriginalFileName" or ProcessCommandLine contains "CompanyName" or ProcessCommandLine contains "FileDescription" or ProcessCommandLine contains "ProductName" or ProcessCommandLine contains "ProductVersion" or ProcessCommandLine contains "LegalCopyright") and ProcessCommandLine contains "--set-" and ((FolderPath endswith "\\rcedit-x64.exe" or FolderPath endswith "\\rcedit-x86.exe") or ProcessVersionInfoFileDescription =~ "Edit resources of exe" or ProcessVersionInfoProductName =~ "rcedit")

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_sysinternals_psloglist.yml
Suspicious Use of PsLogList ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains " security" or ProcessCommandLine contains " application" or ProcessCommandLine contains " system") and (ProcessCommandLine contains " -d" or ProcessCommandLine contains " /d" or ProcessCommandLine contains " d" or ProcessCommandLine contains " d" or ProcessCommandLine contains " d" or ProcessCommandLine contains " -x" or ProcessCommandLine contains " /x" or ProcessCommandLine contains " x" or ProcessCommandLine contains " x" or ProcessCommandLine contains " x" or ProcessCommandLine contains " -s" or ProcessCommandLine contains " /s" or ProcessCommandLine contains " s" or ProcessCommandLine contains " s" or ProcessCommandLine contains " s" or ProcessCommandLine contains " -c" or ProcessCommandLine contains " /c" or ProcessCommandLine contains " c" or ProcessCommandLine contains " c" or ProcessCommandLine contains " c" or ProcessCommandLine contains " -g" or ProcessCommandLine contains " /g" or ProcessCommandLine contains " g" or ProcessCommandLine contains " g" or ProcessCommandLine contains " g") and (ProcessVersionInfoOriginalFileName =~ "psloglist.exe" or (FolderPath endswith "\\psloglist.exe" or FolderPath endswith "\\psloglist64.exe"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_pua_rclone_execution.yml
PUA - Rclone Execution ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "--config " and ProcessCommandLine contains "--no-check-certificate " and ProcessCommandLine contains " copy ") or ((ProcessCommandLine contains "pass" or ProcessCommandLine contains "user" or ProcessCommandLine contains "copy" or ProcessCommandLine contains "sync" or ProcessCommandLine contains "config" or ProcessCommandLine contains "lsd" or ProcessCommandLine contains "remote" or ProcessCommandLine contains "ls" or ProcessCommandLine contains "mega" or ProcessCommandLine contains "pcloud" or ProcessCommandLine contains "ftp" or ProcessCommandLine contains "ignore-existing" or ProcessCommandLine contains "auto-confirm" or ProcessCommandLine contains "transfers" or ProcessCommandLine contains "multi-thread-streams" or ProcessCommandLine contains "no-check-certificate ") and (FolderPath endswith "\\rclone.exe" or ProcessVersionInfoFileDescription =~ "Rsync for cloud storage"))

----------------------------------------
Processing: sigma/rules/windows/process_creation/proc_creation_win_office_winword_dll_load.yml
Potential Arbitrary DLL Load Using Winword ---> KQL Query:
DeviceProcessEvents
| where (ProcessCommandLine contains "/l " and ProcessCommandLine contains ".dll") and (FolderPath endswith "\\WINWORD.exe" or ProcessVersionInfoOriginalFileName =~ "WinWord.exe")

----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_vuln_hevd_driver.yml
Sigma Transformation Error for 'Vulnerable HackSys Extreme Vulnerable Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_mal_drivers.yml
Sigma Transformation Error for 'Malicious Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_vuln_winring0_driver.yml
Sigma Transformation Error for 'Vulnerable WinRing0 Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_windivert.yml
Sigma Transformation Error for 'WinDivert Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_vuln_drivers_names.yml
Sigma Transformation Error for 'Vulnerable Driver Load By Name': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_vuln_drivers.yml
Sigma Transformation Error for 'Vulnerable Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_mal_drivers_names.yml
Sigma Transformation Error for 'Malicious Driver Load By Name': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_susp_temp_use.yml
Sigma Transformation Error for 'Driver Load From A Temporary Directory': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_pua_process_hacker.yml
Sigma Transformation Error for 'PUA - Process Hacker Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/driver_load/driver_load_win_pua_system_informer.yml
Sigma Transformation Error for 'PUA - System Informer Driver Load': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/sysmon/sysmon_file_executable_detected.yml
Unexpected Error processing 'Sysmon File Executable Creation Detected' (sigma/rules/windows/sysmon/sysmon_file_executable_detected.yml): Unexpected data type in condition parse tree: NoneType (while converting rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/sysmon/sysmon_config_modification_status.yml
Sigma Transformation Error for 'Sysmon Configuration Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/sysmon/sysmon_file_block_executable.yml
Unexpected Error processing 'Sysmon Blocked Executable' (sigma/rules/windows/sysmon/sysmon_file_block_executable.yml): Unexpected data type in condition parse tree: NoneType (while converting rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/sysmon/sysmon_config_modification.yml
Sigma Transformation Error for 'Sysmon Configuration Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/sysmon/sysmon_file_block_shredding.yml
Unexpected Error processing 'Sysmon Blocked File Shredding' (sigma/rules/windows/sysmon/sysmon_file_block_shredding.yml): Unexpected data type in condition parse tree: NoneType (while converting rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/sysmon/sysmon_config_modification_error.yml
Sigma Transformation Error for 'Sysmon Configuration Error': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/win_alert_mimikatz_keywords.yml
Sigma Transformation Error for 'Mimikatz Use': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/servicebus/win_hybridconnectionmgr_svc_running.yml
Sigma Transformation Error for 'HybridConnectionManager Service Running': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/certificate_services_client_lifecycle_system/win_certificateservicesclient_lifecycle_system_cert_exported.yml
Sigma Transformation Error for 'Certificate Exported From Local Certificate Store': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/applocker/win_applocker_file_was_not_allowed_to_run.yml
Sigma Transformation Error for 'File Was Not Allowed To Run': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_setting_change.yml
Sigma Transformation Error for 'Windows Firewall Settings Have Been Changed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_add_rule_wmiprvse.yml
Sigma Transformation Error for 'New Firewall Rule Added In Windows Firewall Exception List Via WmiPrvSE.EXE': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_add_rule_susp_folder.yml
Sigma Transformation Error for 'New Firewall Rule Added In Windows Firewall Exception List For Potential Suspicious Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_delete_rule.yml
Sigma Transformation Error for 'A Rule Has Been Deleted From The Windows Firewall Exception List': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_add_rule.yml
Sigma Transformation Error for 'Uncommon New Firewall Rule Added In Windows Firewall Exception List': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_reset_config.yml
Sigma Transformation Error for 'Windows Defender Firewall Has Been Reset To Its Default Configuration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_failed_load_gpo.yml
Sigma Transformation Error for 'The Windows Defender Firewall Service Failed To Load Group Policy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/firewall_as/win_firewall_as_delete_all_rules.yml
Sigma Transformation Error for 'All Rules Have Been Deleted From The Windows Firewall Configuration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_lolbin_execution_via_task_scheduler.yml
Sigma Transformation Error for 'Scheduled Task Executed Uncommon LOLBIN': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_execution_from_susp_locations.yml
Sigma Transformation Error for 'Scheduled Task Executed From A Suspicious Location': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/taskscheduler/win_taskscheduler_susp_schtasks_delete.yml
Sigma Transformation Error for 'Important Scheduled Task Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxpackaging_om/win_appxpackaging_om_sups_appx_signature.yml
Sigma Transformation Error for 'Suspicious Digital Signature Of AppX Package': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/capi2/win_capi2_acquire_certificate_private_key.yml
Sigma Transformation Error for 'Certificate Private Key Acquired': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_server/win_dns_server_failed_dns_zone_transfer.yml
Sigma Transformation Error for 'Failed DNS Zone Transfer': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_server/win_dns_server_susp_server_level_plugin_dll.yml
Sigma Transformation Error for 'DNS Server Error Failed Loading the ServerLevelPluginDLL': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_possible_shadow_credentials_added.yml
Sigma Transformation Error for 'Possible Shadow Credentials Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_new_or_renamed_user_account_with_dollar_sign.yml
Sigma Transformation Error for 'New or Renamed User Account with '$' Character': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_user_added_to_local_administrators.yml
Sigma Transformation Error for 'User Added to Local Administrator Group': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_hidden_user_creation.yml
Sigma Transformation Error for 'Hidden Local User Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_registry_permissions_weakness_check.yml
Sigma Transformation Error for 'Service Registry Key Read Access Request': Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_ad_replication_non_machine_account.yml
Sigma Transformation Error for 'Active Directory Replication from Non Machine Account': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_windows_defender_exclusions_write_access.yml
Sigma Transformation Error for 'Windows Defender Exclusion Registry Key - Write Access Requested': Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_syskey_registry_access.yml
SysKey Registry Keys Access ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "lsa\\JD" or RegistryKey endswith "lsa\\GBG" or RegistryKey endswith "lsa\\Skew1" or RegistryKey endswith "lsa\\Data"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_replay_attack_detected.yml
Sigma Transformation Error for 'Replay Attack Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_service_install_remote_access_software.yml
Sigma Transformation Error for 'Remote Access Tool Services Have Been Installed - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_workstation_was_locked.yml
Unexpected Error processing 'Locked Workstation' (sigma/rules/windows/builtin/security/win_security_workstation_was_locked.yml): Unexpected data type in condition parse tree: NoneType (while converting rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_meterpreter_or_cobaltstrike_getsystem_service_install.yml
Sigma Transformation Error for 'Meterpreter or Cobalt Strike Getsystem Service Installation - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_metasploit_authentication.yml
Sigma Transformation Error for 'Metasploit SMB Authentication': Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_svcctl_remote_service.yml
Sigma Transformation Error for 'Remote Service Activity via SVCCTL Named Pipe': Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_gpo_scheduledtasks.yml
Sigma Transformation Error for 'Persistence and Execution at Scale via GPO Scheduled Task': Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_teams_suspicious_objectaccess.yml
Suspicious Teams Application Related ObjectAcess Event ---> KQL Query:
DeviceRegistryEvents
| where (RegistryKey contains "\\Microsoft\\Teams\\Cookies" or RegistryKey contains "\\Microsoft\\Teams\\Local Storage\\leveldb") and (not(InitiatingProcessFolderPath contains "\\Microsoft\\Teams\\current\\Teams.exe"))

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_tap_driver_installation.yml
Sigma Transformation Error for 'Tap Driver Installation - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_time_modification.yml
Sigma Transformation Error for 'Unauthorized System Time Modification': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_net_share_obj_susp_desktop_ini.yml
Sigma Transformation Error for 'Windows Network Access Suspicious desktop.ini Action': Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_smb_file_creation_admin_shares.yml
Sigma Transformation Error for 'SMB Create Remote File Admin Share': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_clip_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation CLIP+ Launcher - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_add_remove_computer.yml
Sigma Transformation Error for 'Add or Remove Computer from DC': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_wmiprvse_wbemcomn_dll_hijack.yml
Sigma Transformation Error for 'T1047 Wmiprvse Wbemcomn DLL Hijack': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_mal_wceaux_dll.yml
WCE wceaux.dll Access ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\wceaux.dll"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_rundll32_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Rundll32 - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_dpapi_domain_backupkey_extraction.yml
Sigma Transformation Error for 'DPAPI Domain Backup Key Extraction': Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_register_new_logon_process_by_rubeus.yml
Sigma Transformation Error for 'Register new Logon Process by Rubeus': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_aadhealth_mon_agent_regkey_access.yml
Azure AD Health Monitoring Agent Registry Keys Access ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey =~ "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Microsoft Online\\Reporting\\MonitoringAgent" and (not((InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.InsightsService.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.PshSurrogate.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe")))

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_obfuscated_iex_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation Obfuscated IEX Invocation - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_ad_object_writedac_access.yml
Sigma Transformation Error for 'AD Object WriteDAC Access': Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_not_allowed_rdp_access.yml
Sigma Transformation Error for 'Denied Access To Remote Desktop': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_dcom_iertutil_dll_hijack.yml
Sigma Transformation Error for 'DCOM InternetExplorer.Application Iertutil DLL Hijack - Security': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_scm_database_handle_failure.yml
Sigma Transformation Error for 'SCM Database Handle Failure': Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_windows_defender_exclusions_registry_modified.yml
Windows Defender Exclusion List Modified ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\Microsoft\\Windows Defender\\Exclusions*"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_scheduled_task_creation.yml
Sigma Transformation Error for 'Suspicious Scheduled Task Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_lsass_dump.yml
Sigma Transformation Error for 'Password Dumper Activity on LSASS': Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_lsass_dump_generic.yml
Sigma Transformation Error for 'Potentially Suspicious AccessMask Requested From LSASS': Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_dcsync.yml
Sigma Transformation Error for 'Mimikatz DC Sync': Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_group_policy_abuse_privilege_addition.yml
Sigma Transformation Error for 'Group Policy Abuse for Privilege Addition': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml
Sigma Transformation Error for 'Metasploit Or Impacket Service Installation Via SMB PsExec': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_add_domain_trust.yml
Sigma Transformation Error for 'A New Trust Was Created To A Domain': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_wmi_persistence.yml
WMI Persistence - Security ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "subscription"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_dce_rpc_smb_spoolss_named_pipe.yml
Sigma Transformation Error for 'DCERPC SMB Spoolss Named Pipe': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_computer_name.yml
Sigma Transformation Error for 'Win Susp Computer Name Containing Samtheadmin': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_disable_event_auditing.yml
Sigma Transformation Error for 'Windows Event Auditing Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_outlook.yml
Sigma Transformation Error for 'Password Protected ZIP File Opened (Email Attachment)': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_audit_log_cleared.yml
Sigma Transformation Error for 'Security Eventlog Cleared': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_compress_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation COMPRESS OBFUSCATION - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability_eku.yml
Sigma Transformation Error for 'ADCS Certificate Template Configuration Vulnerability with Risky EKU': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_user_driver_loaded.yml
Sigma Transformation Error for 'Potential Privileged System Service Operation - SeLoadDriverPrivilege': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_ldap_dataexchange.yml
Sigma Transformation Error for 'Suspicious LDAP-Attributes Used': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_disable_event_auditing_critical.yml
Sigma Transformation Error for 'Important Windows Event Auditing Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_camera_microphone_access.yml
Processes Accessing the Microphone and Webcam ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone\\NonPackaged" or RegistryKey contains "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\webcam\\NonPackaged"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_protected_storage_service_access.yml
Sigma Transformation Error for 'Protected Storage Service Access': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_codeintegrity_check_failure.yml
Sigma Transformation Error for 'Failed Code Integrity Checks': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_password_policy_enumerated.yml
Sigma Transformation Error for 'Password Policy Enumerated': Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_hybridconnectionmgr_svc_installation.yml
Sigma Transformation Error for 'HybridConnectionManager Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_remote_powershell_session.yml
Sigma Transformation Error for 'Remote PowerShell Sessions Network Connections (WinRM)': Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_alert_ruler.yml
Sigma Transformation Error for 'Hacktool Ruler': Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_failed_logon_reasons.yml
Sigma Transformation Error for 'Account Tampering - Suspicious Failed Logon Reasons': Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_petitpotam_network_share.yml
Sigma Transformation Error for 'Possible PetitPotam Coerce Authentication Attempt': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_local_anon_logon_created.yml
Sigma Transformation Error for 'Suspicious Windows ANONYMOUS LOGON Local Account Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability.yml
Sigma Transformation Error for 'ADCS Certificate Template Configuration Vulnerability': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_var_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR+ Launcher - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_impacket_psexec.yml
Sigma Transformation Error for 'Impacket PsExec Execution': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_logon_explicit_credentials.yml
Sigma Transformation Error for 'Suspicious Remote Logon with Explicit Credentials': Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_atsvc_task.yml
Sigma Transformation Error for 'Remote Task Creation via ATSVC Named Pipe': Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_iso_mount.yml
Sigma Transformation Error for 'ISO Image Mounted': Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_stdin_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Stdin - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_rc4_kerberos.yml
Sigma Transformation Error for 'Suspicious Kerberos RC4 Ticket Encryption': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_net_recon_activity.yml
Sigma Transformation Error for 'Reconnaissance Activity': Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_powershell_script_installed_as_service.yml
Sigma Transformation Error for 'PowerShell Scripts Installed as Services - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_service_installation_by_unusal_client.yml
Sigma Transformation Error for 'Service Installed By Unusual Client - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_lm_namedpipe.yml
Sigma Transformation Error for 'First Time Seen Remote Named Pipe': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_dot_net_etw_tamper.yml
Sigma Transformation Error for 'ETW Logging Disabled In .NET Processes - Registry': Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_psexec.yml
Sigma Transformation Error for 'Suspicious PsExec Execution': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_sam_registry_hive_handle_request.yml
SAM Registry Hive Handle Request ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith "\\SAM"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_var_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_account_backdoor_dcsync_rights.yml
Sigma Transformation Error for 'Powerview Add-DomainObjectAcl DCSync AD Extend Right': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_kerberoasting_activity.yml
Sigma Transformation Error for 'Kerberoasting Activity - Initial Query': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_user_creation.yml
Sigma Transformation Error for 'Local User Creation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_kerberos_manipulation.yml
Sigma Transformation Error for 'Kerberos Manipulation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_net_ntlm_downgrade.yml
Sigma Transformation Error for 'NetNTLM Downgrade Attack': Invalid SigmaDetectionItem field name encountered: ObjectValueName. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_external_device.yml
Sigma Transformation Error for 'External Disk Drive Or USB Storage Device Was Recognized By The System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_filename.yml
Sigma Transformation Error for 'Password Protected ZIP File Opened (Suspicious Filenames)': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_group_policy_startup_script_added_to_gpo.yml
Sigma Transformation Error for 'Startup/Logon Script Added to Group Policy Object': Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_add_sid_history.yml
Sigma Transformation Error for 'Addition of SID History to Active Directory Object': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_stdin_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation STDIN+ Launcher - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_mal_creddumper.yml
Sigma Transformation Error for 'Credential Dumping Tools Service Execution - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_opened_encrypted_zip.yml
Sigma Transformation Error for 'Password Protected ZIP File Opened': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_alert_ad_user_backdoors.yml
Sigma Transformation Error for 'Active Directory User Backdoors': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_user_logoff.yml
Unexpected Error processing 'User Logoff Event' (sigma/rules/windows/builtin/security/win_security_user_logoff.yml): Unexpected data type in condition parse tree: NoneType (while converting rule None). Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_sdelete_potential_secure_deletion.yml
Potential Secure Deletion with SDelete ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey endswith ".AAA" or RegistryKey endswith ".ZZZ"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_vssaudit_secevent_source_registration.yml
Sigma Transformation Error for 'VSSAudit Security Event Source Registration': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_account_discovery.yml
Sigma Transformation Error for 'AD Privileged Users or Groups Reconnaissance': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: ObjectValueName. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_alert_enable_weak_encryption.yml
Sigma Transformation Error for 'Weak Encryption Enabled and Kerberoast': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_user_couldnt_call_priv_service_lsaregisterlogonprocess.yml
Sigma Transformation Error for 'User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_aadhealth_svc_agent_regkey_access.yml
Azure AD Health Service Agents Registry Keys Access ---> KQL Query:
DeviceRegistryEvents
| where RegistryKey =~ "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\ADHealthAgent" and (not((InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.InsightsService.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Adfs.PshSurrogate.exe" or InitiatingProcessFolderPath contains "Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe")))

----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_hktl_nofilter.yml
Sigma Transformation Error for 'HackTool - NoFilter Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_hktl_edr_silencer.yml
Sigma Transformation Error for 'HackTool - EDRSilencer Execution - Filter Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_transf_files_with_cred_data_via_network_shares.yml
Sigma Transformation Error for 'Transferring Files with Credential Data via Network Shares': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_rdp_reverse_tunnel.yml
Sigma Transformation Error for 'RDP over Reverse SSH Tunnel WFP': Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_dsrm_password_change.yml
Sigma Transformation Error for 'Password Change on Directory Service Restore Mode (DSRM) Account': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_scm_database_privileged_operation.yml
Sigma Transformation Error for 'SCM Database Privileged Operation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_impacket_secretdump.yml
Sigma Transformation Error for 'Possible Impacket SecretDump Remote Activity': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_lsass_access_non_system_account.yml
Sigma Transformation Error for 'LSASS Access From Non System Account': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: ObjectValueName. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_device_installation_blocked.yml
Sigma Transformation Error for 'Device Installation Blocked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_raccess_sensitive_fext.yml
Sigma Transformation Error for 'Suspicious Access to Sensitive File Extensions': Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_alert_active_directory_user_control.yml
Sigma Transformation Error for 'Enabled User Right in AD to Control User Objects': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_clip_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Clip - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_possible_dc_shadow.yml
Sigma Transformation Error for 'Possible DC Shadow Attack': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_outbound_kerberos_connection.yml
Sigma Transformation Error for 'Uncommon Outbound Kerberos Connection - Security': Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_petitpotam_susp_tgt_request.yml
Sigma Transformation Error for 'PetitPotam Suspicious Kerberos TGT Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_admin_share_access.yml
Sigma Transformation Error for 'Access To ADMIN$ Network Share': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_pcap_drivers.yml
Sigma Transformation Error for 'Windows Pcap Drivers': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_dpapi_domain_masterkey_backup_attempt.yml
Sigma Transformation Error for 'DPAPI Domain Master Key Backup Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_rundll_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation RUNDLL LAUNCHER - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_scheduled_task_update.yml
Sigma Transformation Error for 'Suspicious Scheduled Task Update': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_susp_scheduled_task_delete_or_disable.yml
Sigma Transformation Error for 'Important Scheduled Task Deleted/Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_ad_user_enumeration.yml
Sigma Transformation Error for 'Potential AD User Enumeration From Non-Machine Account': Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: ObjectValueName. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_mshta_services_security.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use MSHTA - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml
Sigma Transformation Error for 'CobaltStrike Service Installations - Security': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/win_security_sysmon_channel_reference_deletion.yml
Sigma Transformation Error for 'Sysmon Channel Reference Deletion': Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: ObjectValueName. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: ObjectServer. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectDomainName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: SubjectLogonId. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessMask. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Invalid SigmaDetectionItem field name encountered: NewName. Please use valid fields for the DeviceRegistryEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AppGuardContainerId, CommandLine, Company, Description, Details, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousRegistryKey, PreviousRegistryValueData, PreviousRegistryValueName, ProcessId, ProcessName, Product, RegistryKey, RegistryValueData, RegistryValueName, RegistryValueType, ReportId, SourceImage, TargetObject, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_susp_privesc_kerberos_relay_over_ldap.yml
Sigma Transformation Error for 'Potential Privilege Escalation via Local Kerberos Relay over LDAP': Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_diagtrack_eop_default_login_username.yml
Sigma Transformation Error for 'DiagTrackEoP Default Login Username': Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_rdp_localhost_login.yml
Sigma Transformation Error for 'RDP Login from Localhost': Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_security_enabled_global_group_deleted.yml
Sigma Transformation Error for 'A Security-Enabled Global Group Was Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_successful_external_remote_smb_login.yml
Sigma Transformation Error for 'External Remote SMB Logon from Public IP': Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_susp_rottenpotato.yml
Sigma Transformation Error for 'RottenPotato Like Attack Pattern': Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_susp_logon_newcredentials.yml
Outgoing Logon with New Credentials ---> KQL Query:
DeviceLogonEvents
| where LogonType == 9

----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_rdp_bluekeep_poc_scanner.yml
Sigma Transformation Error for 'Scanner PoC for CVE-2019-0708 RDP RCE Vuln': Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_successful_external_remote_rdp_login.yml
Sigma Transformation Error for 'External Remote RDP Logon from Public IP': Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_susp_failed_logon_source.yml
Sigma Transformation Error for 'Failed Logon From Public IP': Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_susp_wmi_login.yml
Successful Account Login Via WMI ---> KQL Query:
DeviceLogonEvents
| where InitiatingProcessFolderPath endswith "\\WmiPrvSE.exe"

----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_pass_the_hash_2.yml
Sigma Transformation Error for 'Pass the Hash Activity 2': Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_member_removed_security_enabled_global_group.yml
Sigma Transformation Error for 'A Member Was Removed From a Security-Enabled Global Group': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_access_token_abuse.yml
Sigma Transformation Error for 'Potential Access Token Abuse': Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_member_added_security_enabled_global_group.yml
Sigma Transformation Error for 'A Member Was Added to a Security-Enabled Global Group': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_overpass_the_hash.yml
Sigma Transformation Error for 'Successful Overpass the Hash Attempt': Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/account_management/win_security_admin_rdp_login.yml
Sigma Transformation Error for 'Admin User Remote Logon': Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetUserName. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: IpAddress. Invalid SigmaDetectionItem field name encountered: TargetOutboundUserName. Invalid SigmaDetectionItem field name encountered: IpPort. Invalid SigmaDetectionItem field name encountered: TargetServerName. Invalid SigmaDetectionItem field name encountered: SubjectUserSid. Invalid SigmaDetectionItem field name encountered: Workstation. Invalid SigmaDetectionItem field name encountered: AuthenticationPackageName. Please use valid fields for the DeviceLogonEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FailureReason, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsLocalAdmin, LogonId, LogonType, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteDeviceName, RemoteIP, RemoteIPType, RemotePort, ReportId, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security/object_access/win_security_wfp_endpoint_agent_blocked.yml
Sigma Transformation Error for 'Windows Filtering Platform Blocked Connection From EDR Agent Binary': Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/wmi/win_wmi_persistence.yml
Sigma Transformation Error for 'WMI Persistence': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_saving_susp_extensions.yml
Sigma Transformation Error for 'BITS Transfer Job Downloading File Potential Suspicious Extension': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_trasnfer_susp_local_folder.yml
Sigma Transformation Error for 'BITS Transfer Job Download To Potential Suspicious Folder': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_ip_address.yml
Sigma Transformation Error for 'BITS Transfer Job Download From Direct IP': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_job_via_bitsadmin.yml
Sigma Transformation Error for 'New BITS Job Created Via Bitsadmin': Invalid SigmaDetectionItem field name encountered: processPath. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_job_via_powershell.yml
Sigma Transformation Error for 'New BITS Job Created Via PowerShell': Invalid SigmaDetectionItem field name encountered: processPath. Invalid SigmaDetectionItem field name encountered: processPath. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_uncommon_tld.yml
Sigma Transformation Error for 'BITS Transfer Job With Uncommon Or Suspicious Remote TLD': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/bits_client/win_bits_client_new_transfer_via_file_sharing_domains.yml
Sigma Transformation Error for 'BITS Transfer Job Download From File Sharing Domains': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/iis-configuration/win_iis_module_added.yml
Sigma Transformation Error for 'New Module Module Added To IIS Server': Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/iis-configuration/win_iis_module_removed.yml
Sigma Transformation Error for 'Previously Installed IIS Module Was Removed': Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/iis-configuration/win_iis_logging_http_disabled.yml
Sigma Transformation Error for 'HTTP Logging Disabled On IIS Server': Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/iis-configuration/win_iis_logging_etw_disabled.yml
Sigma Transformation Error for 'ETW Logging/Processing Option Disabled On IIS Server': Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/ntlm/win_susp_ntlm_auth.yml
Sigma Transformation Error for 'NTLM Logon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/ntlm/win_susp_ntlm_rdp.yml
Sigma Transformation Error for 'Potential Remote Desktop Connection to Non-Domain Host': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/ntlm/win_susp_ntlm_brute_force.yml
Sigma Transformation Error for 'NTLM Brute Force': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/ldap/win_ldap_recon.yml
Sigma Transformation Error for 'Potential Active Directory Reconnaissance/Enumeration Via LDAP': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/openssh/win_sshd_openssh_server_listening_on_socket.yml
Sigma Transformation Error for 'OpenSSH Server Listening On Socket': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security_mitigations/win_security_mitigations_defender_load_unsigned_dll.yml
Sigma Transformation Error for 'Microsoft Defender Blocked from Loading Unsigned DLL': Invalid SigmaDetectionItem field name encountered: ProcessPath. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/security_mitigations/win_security_mitigations_unsigned_dll_from_susp_location.yml
Sigma Transformation Error for 'Unsigned Binary Loaded From Suspicious Location': Invalid SigmaDetectionItem field name encountered: ImageName. Invalid SigmaDetectionItem field name encountered: ProcessPath. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/shell_core/win_shell_core_susp_packages_installed.yml
Sigma Transformation Error for 'Suspicious Application Installed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/terminalservices/win_terminalservices_rdp_ngrok.yml
Sigma Transformation Error for 'Ngrok Usage with Remote Desktop Service': Invalid SigmaDetectionItem field name encountered: Address. Please use valid fields for the DeviceEvents table, or the following fields that have keymappings in this pipeline:
 InitiatingProcessVersionInfoInternalFileName, AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LocalIP, LocalPort, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, Product, RegistryKey, RegistryValueData, RegistryValueName, RemoteDeviceName, RemoteIP, RemotePort, RemoteUrl, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appmodel_runtime/win_appmodel_runtime_sysinternals_tools_appx_execution.yml
Sigma Transformation Error for 'Sysinternals Tools AppX Versions Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/termdd/win_system_rdp_potential_cve_2019_0708.yml
Sigma Transformation Error for 'Potential RDP Exploit CVE-2019-0708': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_directory_services_sam/win_system_exploit_cve_2021_42287.yml
Sigma Transformation Error for 'Potential CVE-2021-42287 Exploitation Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_mshta_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use MSHTA - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_defender_disabled.yml
Sigma Transformation Error for 'Windows Defender Threat Detection Service Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_anydesk.yml
Sigma Transformation Error for 'Anydesk Remote Access Software Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_uncommon.yml
Sigma Transformation Error for 'Uncommon Service Installation Image Path': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_cobaltstrike_service_installs.yml
Sigma Transformation Error for 'CobaltStrike Service Installations - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_rundll_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation RUNDLL LAUNCHER - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_remote_utilities.yml
Sigma Transformation Error for 'Remote Utilities Host Service Install': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_remcom.yml
Sigma Transformation Error for 'RemCom Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_folder.yml
Sigma Transformation Error for 'Service Installation in Suspicious Folder': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_mesh_agent.yml
Sigma Transformation Error for 'Mesh Agent Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_sysinternals_psexec.yml
Sigma Transformation Error for 'PsExec Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_sliver.yml
Sigma Transformation Error for 'Sliver C2 Default Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_script.yml
Sigma Transformation Error for 'Suspicious Service Installation Script': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_pua_proceshacker.yml
Sigma Transformation Error for 'ProcessHacker Privilege Elevation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_rtcore64_service_install.yml
Sigma Transformation Error for 'RTCore Suspicious Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_compress_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation COMPRESS OBFUSCATION - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_meterpreter_or_cobaltstrike_getsystem_service_installation.yml
Sigma Transformation Error for 'Meterpreter or Cobalt Strike Getsystem Service Installation - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_error_important.yml
Sigma Transformation Error for 'Important Windows Service Terminated With Error': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_powershell_script_installed_as_service.yml
Sigma Transformation Error for 'PowerShell Scripts Installed as Services': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_mal_creddumper.yml
Sigma Transformation Error for 'Credential Dumping Tools Service Execution - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_susp_service_installation_folder_pattern.yml
Sigma Transformation Error for 'Service Installation with Suspicious Folder Pattern': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_susp.yml
Sigma Transformation Error for 'Suspicious Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_clip_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation CLIP+ Launcher - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_hacktools.yml
Sigma Transformation Error for 'HackTool Service Registration or Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_pdqdeploy.yml
Sigma Transformation Error for 'New PDQDeploy Service - Server Side': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_paexec.yml
Sigma Transformation Error for 'PAExec Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_moriya_rootkit.yml
Sigma Transformation Error for 'Moriya Rootkit - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_tap_driver.yml
Sigma Transformation Error for 'Tap Driver Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_var_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_sups_unusal_client.yml
Sigma Transformation Error for 'Service Installed By Unusual Client - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_pdqdeploy_runner.yml
Sigma Transformation Error for 'New PDQDeploy Service - Client Side': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_stdin_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Stdin - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_stdin_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation STDIN+ Launcher - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_krbrelayup_service_installation.yml
Sigma Transformation Error for 'KrbRelayUp Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_hack_smbexec.yml
Sigma Transformation Error for 'smbexec.py Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_unexpectedly.yml
Sigma Transformation Error for 'Important Windows Service Terminated Unexpectedly': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_obfuscated_iex_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation Obfuscated IEX Invocation - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_clip_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Clip - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_var_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation VAR+ Launcher - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_tacticalrmm.yml
Sigma Transformation Error for 'TacticalRMM Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_invoke_obfuscation_via_use_rundll32_services.yml
Sigma Transformation Error for 'Invoke-Obfuscation Via Use Rundll32 - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_netsupport_manager.yml
Sigma Transformation Error for 'NetSupport Manager Service Install': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_terminated_error_generic.yml
Sigma Transformation Error for 'Windows Service Terminated With Error': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_remote_access_software.yml
Sigma Transformation Error for 'Remote Access Tool Services Have Been Installed - System': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/service_control_manager/win_system_service_install_csexecsvc.yml
Sigma Transformation Error for 'CSExec Service Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_user_profiles_service/win_system_susp_vuln_cve_2022_21919_or_cve_2021_34484.yml
Sigma Transformation Error for 'Suspicious Usage of CVE_2021_34484 or CVE 2022_21919': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_windows_update_client/win_system_susp_system_update_error.yml
Sigma Transformation Error for 'Windows Update Error': Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: Address. Please use valid fields for the DeviceEvents table, or the following fields that have keymappings in this pipeline:
 InitiatingProcessVersionInfoInternalFileName, AccountDomain, AccountName, AccountSid, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LocalIP, LocalPort, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, Product, RegistryKey, RegistryValueData, RegistryValueName, RemoteDeviceName, RemoteIP, RemotePort, RemoteUrl, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_eventlog/win_system_susp_eventlog_cleared.yml
Sigma Transformation Error for 'Important Windows Eventlog Cleared': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_eventlog/win_system_eventlog_cleared.yml
Sigma Transformation Error for 'Eventlog Cleared': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_ntfs/win_system_volume_shadow_copy_mount.yml
Sigma Transformation Error for 'Volume Shadow Copy Mount': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/netlogon/win_system_possible_zerologon_exploitation_using_wellknown_tools.yml
Sigma Transformation Error for 'Zerologon Exploitation Using Well-known Tools': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/netlogon/win_system_vul_cve_2020_1472.yml
Sigma Transformation Error for 'Vulnerable Netlogon Secure Channel Connection Allowed': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_kerberos_key_distribution_center/win_system_kdcsvc_tgs_no_suitable_encryption_key_found.yml
Sigma Transformation Error for 'No Suitable Encryption Key Found For Generating Kerberos Ticket': Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: ImageName. Invalid SigmaDetectionItem field name encountered: ProcessPath. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_kerberos_key_distribution_center/win_system_kdcsvc_rc4_downgrade.yml
Sigma Transformation Error for 'KDC RC4-HMAC Downgrade CVE-2022-37966': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_kerberos_key_distribution_center/win_system_kdcsvc_cert_use_no_strong_mapping.yml
Sigma Transformation Error for 'Certificate Use With No Strong Mapping': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_distributed_com/win_system_lpe_indicators_tabtip.yml
Sigma Transformation Error for 'Local Privilege Escalation Indicator TabTip': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_certification_authority/win_system_adcs_enrollment_request_denied.yml
Sigma Transformation Error for 'Active Directory Certificate Services Denied Certificate Enrollment Request': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_kernel_general/win_system_susp_critical_hive_location_access_bits_cleared.yml
Sigma Transformation Error for 'Critical Hive In Suspicious Location Access Bits Cleared': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/lsasrv/win_system_lsasrv_ntlmv1.yml
Sigma Transformation Error for 'NTLMv1 Logon Between Client and Server': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_dhcp_server/win_system_susp_dhcp_config_failed.yml
Sigma Transformation Error for 'DHCP Server Error Failed Loading the CallOut DLL': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/microsoft_windows_dhcp_server/win_system_susp_dhcp_config.yml
Sigma Transformation Error for 'DHCP Server Loaded the CallOut DLL': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/ntfs/win_system_ntfs_vuln_exploit.yml
Sigma Transformation Error for 'NTFS Vulnerability Exploitation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/system/application_popup/win_system_application_sysmon_crash.yml
Sigma Transformation Error for 'Sysmon Application Crashed': Invalid SigmaDetectionItem field name encountered: Caption. Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: ImageName. Invalid SigmaDetectionItem field name encountered: ProcessPath. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: Configuration. Invalid SigmaDetectionItem field name encountered: NewValue. Invalid SigmaDetectionItem field name encountered: CreationUtcTime. Invalid SigmaDetectionItem field name encountered: InitiatingProcessParentCommandLine. Invalid SigmaDetectionItem field name encountered: SourceFilename. Please use valid fields for the DeviceFileEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DeviceId, DeviceName, EventType, FileName, FileOriginIP, FileOriginReferrerUrl, FileOriginUrl, FileSize, FolderPath, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsAzureInfoProtectionApplied, IsInitiatingProcessRemoteSession, MD5, ObjectName, OriginalFileName, ParentCommandLine, ParentProcessId, PreviousFileName, PreviousFolderPath, ProcessId, ProcessName, Product, ReportId, RequestAccountDomain, RequestAccountName, RequestAccountSid, RequestProtocol, RequestSourceIP, RequestSourcePort, SHA1, SHA256, SensitivityLabel, SensitivitySubLabel, ShareName, SourceImage, TargetFilename, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_certificate_generation.yml
Sigma Transformation Error for 'Certificate Request Export to Exchange Webserver': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_transportagent.yml
Sigma Transformation Error for 'MSExchange Transport Agent Installation - Builtin': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_set_oabvirtualdirectory_externalurl.yml
Sigma Transformation Error for 'Exchange Set OabVirtualDirectory ExternalUrl Property': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_transportagent_failed.yml
Sigma Transformation Error for 'Failed MSExchange Transport Agent Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_remove_mailbox_export.yml
Sigma Transformation Error for 'Remove Exported Mailbox from Exchange Webserver': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_proxylogon_oabvirtualdir.yml
Sigma Transformation Error for 'ProxyLogon MSExchange OabVirtualDirectory': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_mailbox_export.yml
Sigma Transformation Error for 'Mailbox Export to Exchange Webserver': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/smbclient/security/win_smbclient_security_susp_failed_guest_logon.yml
Sigma Transformation Error for 'Suspicious Rejected SMB Guest Logon From IP': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_config_change_exploit_guard_tamper.yml
Sigma Transformation Error for 'Windows Defender Exploit Guard Tamper': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_restored_quarantine_file.yml
Sigma Transformation Error for 'Win Defender Restored Quarantine File': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_asr_psexec_wmi.yml
Sigma Transformation Error for 'PSExec and WMI Process Creations Block': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_tamper_protection_trigger.yml
Sigma Transformation Error for 'Microsoft Defender Tamper Protection Trigger': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_antimalware_platform_expired.yml
Sigma Transformation Error for 'Windows Defender Grace Period Expired': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_threat.yml
Sigma Transformation Error for 'Windows Defender Threat Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_malware_detected_amsi_source.yml
Sigma Transformation Error for 'Windows Defender AMSI Trigger Detected': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_real_time_protection_disabled.yml
Sigma Transformation Error for 'Windows Defender Real-time Protection Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_asr_lsass_access.yml
Sigma Transformation Error for 'LSASS Access Detected via Attack Surface Reduction': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_real_time_protection_errors.yml
Sigma Transformation Error for 'Windows Defender Real-Time Protection Failure/Restart': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_history_delete.yml
Sigma Transformation Error for 'Windows Defender Malware Detection History Deletion': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_config_change_sample_submission_consent.yml
Sigma Transformation Error for 'Windows Defender Submit Sample Feature Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_suspicious_features_tampering.yml
Sigma Transformation Error for 'Windows Defender Configuration Changes': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_virus_scan_disabled.yml
Sigma Transformation Error for 'Windows Defender Virus Scanning Feature Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_config_change_exclusion_added.yml
Sigma Transformation Error for 'Windows Defender Exclusions Added': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/windefend/win_defender_malware_and_pua_scan_disabled.yml
Sigma Transformation Error for 'Windows Defender Malware And PUA Scanning Disabled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_client/win_dns_client_tor_onion.yml
Sigma Transformation Error for 'Query Tor Onion Address - DNS Client': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_client/win_dns_client_put_io.yml
Sigma Transformation Error for 'DNS Query To Put.io - DNS Client': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_client/win_dns_client_anonymfiles_com.yml
Sigma Transformation Error for 'DNS Query for Anonfiles.com Domain - DNS Client': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_client/win_dns_client__mal_cobaltstrike.yml
Sigma Transformation Error for 'Suspicious Cobalt Strike DNS Beaconing - DNS Client': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_client/win_dns_client_ufile_io.yml
Sigma Transformation Error for 'DNS Query To Ufile.io - DNS Client': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/dns_client/win_dns_client_mega_nz.yml
Sigma Transformation Error for 'DNS Query To MEGA Hosting Website - DNS Client': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/application_error/win_application_msmpeng_crash_error.yml
Sigma Transformation Error for 'Microsoft Malware Protection Engine Crash': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/application_error/win_werfault_susp_lsass_credential_dump.yml
Sigma Transformation Error for 'Potential Credential Dumping Via WER - Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/microsoft-windows_audit_cve/win_audit_cve.yml
Sigma Transformation Error for 'Audit CVE Event': Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: Provider_Name. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Invalid SigmaDetectionItem field name encountered: CurrentDirectory. Please use valid fields for the DeviceProcessEvents table, or the following fields that have keymappings in this pipeline:
AccountDomain, AccountName, AccountObjectId, AccountSid, AccountUpn, ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, CreatedProcessSessionId, Description, DeviceId, DeviceName, EventType, FileName, FileSize, FileVersion, FolderPath, GrandParentImage, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessLogonId, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessSignatureStatus, InitiatingProcessSignerType, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IntegrityLevel, IsInitiatingProcessRemoteSession, IsProcessRemoteSession, LogonId, MD5, OriginalFileName, ParentCommandLine, ParentImage, ParentProcessId, ParentUser, ProcessCommandLine, ProcessCreationTime, ProcessId, ProcessIntegrityLevel, ProcessName, ProcessRemoteSessionDeviceName, ProcessRemoteSessionIP, ProcessTokenElevation, ProcessVersionInfoCompanyName, ProcessVersionInfoFileDescription, ProcessVersionInfoInternalFileName, ProcessVersionInfoOriginalFileName, ProcessVersionInfoProductName, ProcessVersionInfoProductVersion, Product, ReportId, SHA1, SHA256, SourceImage, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/Other/win_av_relevant_match.yml
Sigma Transformation Error for 'Relevant Anti-Virus Signature Keywords In Application Log': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/microsoft_windows_software_restriction_policies/win_software_restriction_policies_block.yml
Sigma Transformation Error for 'Restricted Software Access By SRP': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/msiinstaller/win_software_atera_rmm_agent_install.yml
Sigma Transformation Error for 'Atera Agent Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/msiinstaller/win_builtin_remove_application.yml
Sigma Transformation Error for 'Application Uninstalled': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/msiinstaller/win_msi_install_from_susp_locations.yml
Sigma Transformation Error for 'MSI Installation From Suspicious Locations': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/msiinstaller/win_msi_install_from_web.yml
Sigma Transformation Error for 'MSI Installation From Web': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_change.yml
Sigma Transformation Error for 'MSSQL XPCmdshell Option Change': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_disable_audit_settings.yml
Sigma Transformation Error for 'MSSQL Disable Audit Settings': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_add_sysadmin_account.yml
Sigma Transformation Error for 'MSSQL Add Account To Sysadmin Role': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_failed_logon.yml
Sigma Transformation Error for 'MSSQL Server Failed Logon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_failed_logon_from_external_network.yml
Sigma Transformation Error for 'MSSQL Server Failed Logon From External Network': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_sp_procoption_set.yml
Sigma Transformation Error for 'MSSQL SPProcoption Set': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_audit_log.yml
Sigma Transformation Error for 'MSSQL XPCmdshell Suspicious Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/esent/win_esent_ntdsutil_abuse_susp_location.yml
Sigma Transformation Error for 'Dump Ntds.dit To Suspicious Location': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/esent/win_esent_ntdsutil_abuse.yml
Sigma Transformation Error for 'Ntdsutil Abuse': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/microsoft_windows_backup/win_susp_backup_delete.yml
Sigma Transformation Error for 'Backup Catalog Deleted': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/screenconnect/win_app_remote_access_tools_screenconnect_command_exec.yml
Sigma Transformation Error for 'Remote Access Tool - ScreenConnect Command Execution': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/screenconnect/win_app_remote_access_tools_screenconnect_file_transfer.yml
Sigma Transformation Error for 'Remote Access Tool - ScreenConnect File Transfer': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/application/windows_error_reporting/win_application_msmpeng_crash_wer.yml
Sigma Transformation Error for 'Microsoft Malware Protection Engine Crash - WER': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/driverframeworks/win_usb_device_plugged.yml
Sigma Transformation Error for 'USB Device Plugged': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_applocker_block.yml
Sigma Transformation Error for 'Deployment AppX Package Was Blocked By AppLocker': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_susp_package_locations.yml
Sigma Transformation Error for 'Suspicious AppX Package Locations': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_policy_block.yml
Sigma Transformation Error for 'Deployment Of The AppX Package Was Blocked By The Policy': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_susp_domains.yml
Sigma Transformation Error for 'Suspicious Remote AppX Package Locations': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_uncommon_package_locations.yml
Sigma Transformation Error for 'Uncommon AppX Package Locations': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_mal_appx_names.yml
Sigma Transformation Error for 'Potential Malicious AppX Package Installation Attempts': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_susp_appx_package_installation.yml
Sigma Transformation Error for 'Suspicious AppX Package Installation Attempt': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/lsa_server/win_lsa_server_normal_user_admin.yml
Sigma Transformation Error for 'Standard User In High Privileged Group': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_driver_blocked.yml
Sigma Transformation Error for 'CodeIntegrity - Blocked Driver Load With Revoked Certificate': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_blocked_protected_process_file.yml
Sigma Transformation Error for 'CodeIntegrity - Disallowed File For Protected Processes Has Been Blocked': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_image_blocked.yml
Sigma Transformation Error for 'CodeIntegrity - Blocked Image Load With Revoked Certificate': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_attempted_dll_load.yml
Sigma Transformation Error for 'CodeIntegrity - Unmet Signing Level Requirements By File Under Validation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_unsigned_image_loaded.yml
Sigma Transformation Error for 'CodeIntegrity - Unsigned Image Loaded': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_image_loaded.yml
Sigma Transformation Error for 'CodeIntegrity - Revoked Image Loaded': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_revoked_driver_loaded.yml
Sigma Transformation Error for 'CodeIntegrity - Revoked Kernel Driver Loaded': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_whql_failure.yml
Sigma Transformation Error for 'CodeIntegrity - Unmet WHQL Requirements For Loaded Kernel Module': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_unsigned_driver_loaded.yml
Sigma Transformation Error for 'CodeIntegrity - Unsigned Kernel Module Loaded': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/code_integrity/win_codeintegrity_enforced_policy_block.yml
Sigma Transformation Error for 'CodeIntegrity - Blocked Image/Driver Load For Policy Violation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/builtin/diagnosis/scripted/win_diagnosis_scripted_load_remote_diagcab.yml
Sigma Transformation Error for 'Loading Diagcab Package From Remote Path': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_vscode_tunnel_communication.yml
Sigma Transformation Error for 'DNS Query To Visual Studio Code Tunnels Domain': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_teamviewer_domain_query_by_uncommon_app.yml
Sigma Transformation Error for 'TeamViewer Domain Query By Non-TeamViewer Application': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_domain_azurewebsites.yml
Sigma Transformation Error for 'DNS Query To AzureWebsites.NET By Non-Browser Process': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_onelaunch_update_service.yml
Sigma Transformation Error for 'DNS Query Request To OneLaunch Update Service': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_devtunnels_communication.yml
Sigma Transformation Error for 'DNS Query To Devtunnels Domain': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_cloudflared_communication.yml
Sigma Transformation Error for 'Cloudflared Tunnels Related DNS Requests': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_hybridconnectionmgr_servicebus.yml
Sigma Transformation Error for 'DNS HybridConnectionManager Service Bus': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_regsvr32_dns_query.yml
Sigma Transformation Error for 'DNS Query Request By Regsvr32.EXE': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_quickassist.yml
Sigma Transformation Error for 'DNS Query Request By QuickAssist.EXE': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_dns_server_discovery_via_ldap_query.yml
Sigma Transformation Error for 'DNS Server Discovery Via LDAP Query': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_anonymfiles_com.yml
Sigma Transformation Error for 'DNS Query for Anonfiles.com Domain - Sysmon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_ufile_io_query.yml
Sigma Transformation Error for 'DNS Query To Ufile.io': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_susp_external_ip_lookup.yml
Sigma Transformation Error for 'Suspicious DNS Query for IP Lookup Service APIs': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_tor_onion_domain_query.yml
Sigma Transformation Error for 'DNS Query Tor .Onion Address - Sysmon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_appinstaller.yml
Sigma Transformation Error for 'AppX Package Installation Attempts Via AppInstaller.EXE': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_mega_nz.yml
Sigma Transformation Error for 'DNS Query To MEGA Hosting Website': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_remote_access_software_domains_non_browsers.yml
Sigma Transformation Error for 'DNS Query To Remote Access Software Domain From Non-Browser App': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/dns_query/dns_query_win_mal_cobaltstrike.yml
Sigma Transformation Error for 'Suspicious Cobalt Strike DNS Beaconing - Sysmon': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_dead_drop_resolvers.yml
New Connection Initiated To Potential Dead Drop Resolver Domain ---> KQL Query:
DeviceNetworkEvents
| where (RemoteUrl endswith ".t.me" or RemoteUrl endswith "4shared.com" or RemoteUrl endswith "abuse.ch" or RemoteUrl endswith "anonfiles.com" or RemoteUrl endswith "cdn.discordapp.com" or RemoteUrl endswith "cloudflare.com" or RemoteUrl endswith "ddns.net" or RemoteUrl endswith "discord.com" or RemoteUrl endswith "docs.google.com" or RemoteUrl endswith "drive.google.com" or RemoteUrl endswith "dropbox.com" or RemoteUrl endswith "dropmefiles.com" or RemoteUrl endswith "facebook.com" or RemoteUrl endswith "feeds.rapidfeeds.com" or RemoteUrl endswith "fotolog.com" or RemoteUrl endswith "ghostbin.co/" or RemoteUrl endswith "githubusercontent.com" or RemoteUrl endswith "gofile.io" or RemoteUrl endswith "hastebin.com" or RemoteUrl endswith "imgur.com" or RemoteUrl endswith "livejournal.com" or RemoteUrl endswith "mediafire.com" or RemoteUrl endswith "mega.co.nz" or RemoteUrl endswith "mega.nz" or RemoteUrl endswith "onedrive.com" or RemoteUrl endswith "pages.dev" or RemoteUrl endswith "paste.ee" or RemoteUrl endswith "pastebin.com" or RemoteUrl endswith "pastebin.pl" or RemoteUrl endswith "pastetext.net" or RemoteUrl endswith "pixeldrain.com" or RemoteUrl endswith "privatlab.com" or RemoteUrl endswith "privatlab.net" or RemoteUrl endswith "reddit.com" or RemoteUrl endswith "send.exploit.in" or RemoteUrl endswith "sendspace.com" or RemoteUrl endswith "steamcommunity.com" or RemoteUrl endswith "storage.googleapis.com" or RemoteUrl endswith "technet.microsoft.com" or RemoteUrl endswith "temp.sh" or RemoteUrl endswith "transfer.sh" or RemoteUrl endswith "trycloudflare.com" or RemoteUrl endswith "twitter.com" or RemoteUrl endswith "ufile.io" or RemoteUrl endswith "vimeo.com" or RemoteUrl endswith "w3spaces.com" or RemoteUrl endswith "wetransfer.com" or RemoteUrl endswith "workers.dev" or RemoteUrl endswith "youtube.com") and (not(((InitiatingProcessFolderPath endswith "\\avant.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Avant Browser\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Avant Browser\\")) or (InitiatingProcessFolderPath endswith "\\brave.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\BraveSoftware\\") or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe" and InitiatingProcessFolderPath startswith "C:\\Users\\") or ((InitiatingProcessFolderPath contains "C:\\Program Files\\Windows Defender Advanced Threat Protection\\" or InitiatingProcessFolderPath contains "C:\\Program Files\\Windows Defender\\" or InitiatingProcessFolderPath contains "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\") and (InitiatingProcessFolderPath endswith "\\MsMpEng.exe" or InitiatingProcessFolderPath endswith "\\MsSense.exe")) or ((RemoteUrl endswith "discord.com" or RemoteUrl endswith "cdn.discordapp.com") and InitiatingProcessFolderPath contains "\\AppData\\Local\\Discord\\" and InitiatingProcessFolderPath endswith "\\Discord.exe") or (RemoteUrl endswith "dropbox.com" and (InitiatingProcessFolderPath endswith "\\Dropbox.exe" or InitiatingProcessFolderPath endswith "\\DropboxInstaller.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Dropbox\\Client\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Dropbox\\Client\\")) or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe", "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"))) or ((InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\EdgeCore\\")) or InitiatingProcessFolderPath =~ "" or (InitiatingProcessFolderPath endswith "\\falkon.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Falkon\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Falkon\\")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Mozilla Firefox\\firefox.exe", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe")) or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\Mozilla Firefox\\firefox.exe" and InitiatingProcessFolderPath startswith "C:\\Users\\") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Flock\\" and InitiatingProcessFolderPath endswith "\\Flock.exe") or (RemoteUrl endswith "drive.google.com" and (InitiatingProcessFolderPath contains "C:\\Program Files\\Google\\Drive File Stream\\" or InitiatingProcessFolderPath contains "C:\\Program Files (x86)\\Google\\Drive File Stream\\") and InitiatingProcessFolderPath endswith "GoogleDriveFS.exe") or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "C:\\Program Files\\Internet Explorer\\iexplore.exe")) or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Maxthon\\" and InitiatingProcessFolderPath endswith "\\maxthon.exe") or ((RemoteUrl endswith "mega.co.nz" or RemoteUrl endswith "mega.nz") and (InitiatingProcessFolderPath endswith "\\MEGAsync.exe" or (InitiatingProcessFolderPath contains "\\MEGAsyncSetup32_" and InitiatingProcessFolderPath contains "RC.exe") or InitiatingProcessFolderPath endswith "\\MEGAsyncSetup32.exe" or InitiatingProcessFolderPath endswith "\\MEGAsyncSetup64.exe" or InitiatingProcessFolderPath endswith "\\MEGAupdater.exe")) or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Programs\\midori-ng\\" and InitiatingProcessFolderPath endswith "\\Midori Next Generation.exe") or isnull(InitiatingProcessFolderPath) or (RemoteUrl endswith "onedrive.com" and InitiatingProcessFolderPath contains "\\AppData\\Local\\Microsoft\\OneDrive\\" and InitiatingProcessFolderPath endswith "\\OneDrive.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Programs\\Opera\\" and InitiatingProcessFolderPath endswith "\\opera.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Phoebe\\" and InitiatingProcessFolderPath endswith "\\Phoebe.exe") or (InitiatingProcessFolderPath endswith "C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe" or InitiatingProcessFolderPath endswith "C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe") or (InitiatingProcessFolderPath endswith "\\QtWeb.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\QtWeb\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\QtWeb\\")) or ((InitiatingProcessFolderPath contains "C:\\Program Files (x86)\\Safari\\" or InitiatingProcessFolderPath contains "C:\\Program Files\\Safari\\") and InitiatingProcessFolderPath endswith "\\safari.exe") or (InitiatingProcessFolderPath endswith "\\seamonkey.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\SeaMonkey\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\SeaMonkey\\")) or (InitiatingProcessFolderPath endswith "\\slimbrowser.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\SlimBrowser\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\SlimBrowser\\")) or (RemoteUrl endswith ".t.me" and InitiatingProcessFolderPath contains "\\AppData\\Roaming\\Telegram Desktop\\" and InitiatingProcessFolderPath endswith "\\Telegram.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Vivaldi\\" and InitiatingProcessFolderPath endswith "\\vivaldi.exe") or (InitiatingProcessFolderPath endswith "\\whale.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Naver\\Naver Whale\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Naver\\Naver Whale\\")) or (InitiatingProcessFolderPath endswith "\\Waterfox.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Waterfox\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Waterfox\\")) or (RemoteUrl endswith "facebook.com" and InitiatingProcessFolderPath endswith "\\WhatsApp.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\WindowsApps\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\WindowsApps\\")))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_cmstp_initiated_connection.yml
Outbound Network Connection Initiated By Cmstp.EXE ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\cmstp.exe" and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_adws_unusual_connection.yml
Uncommon Connection to Active Directory Web Services ---> KQL Query:
DeviceNetworkEvents
| where RemotePort == 9389 and (not((InitiatingProcessFolderPath =~ "C:\\Windows\\system32\\dsac.exe" or InitiatingProcessFolderPath =~ "C:\\Program Files\\Microsoft Monitoring Agent\\" or (InitiatingProcessFolderPath startswith "C:\\Program Files\\PowerShell\\7\\pwsh.exe" or InitiatingProcessFolderPath startswith "C:\\Program Files\\PowerShell\\7-preview\\pwsh.ex" or InitiatingProcessFolderPath startswith "C:\\Windows\\System32\\WindowsPowerShell\\" or InitiatingProcessFolderPath startswith "C:\\Windows\\SysWOW64\\WindowsPowerShell\\"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml
Uncommon Network Connection Initiated By Certutil.EXE ---> KQL Query:
DeviceNetworkEvents
| where (RemotePort in~ ("80", "135", "443", "445")) and InitiatingProcessFolderPath endswith "\\certutil.exe"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_wordpad_uncommon_ports.yml
Suspicious Wordpad Outbound Connections ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\wordpad.exe" and (not((RemotePort in~ ("80", "139", "443", "445", "465", "587", "993", "995"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_addinutil_initiated.yml
Network Connection Initiated By AddinUtil.EXE ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\addinutil.exe"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_azurewebsites.yml
Network Connection Initiated To AzureWebsites.NET By Non-Browser Process ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith "azurewebsites.net" and (not(((InitiatingProcessFolderPath endswith "\\avant.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Avant Browser\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Avant Browser\\")) or (InitiatingProcessFolderPath endswith "\\brave.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\BraveSoftware\\") or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe" and InitiatingProcessFolderPath startswith "C:\\Users\\") or ((InitiatingProcessFolderPath contains "C:\\Program Files\\Windows Defender Advanced Threat Protection\\" or InitiatingProcessFolderPath contains "C:\\Program Files\\Windows Defender\\" or InitiatingProcessFolderPath contains "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\") and (InitiatingProcessFolderPath endswith "\\MsMpEng.exe" or InitiatingProcessFolderPath endswith "\\MsSense.exe")) or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Discord\\" and InitiatingProcessFolderPath endswith "\\Discord.exe") or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe", "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"))) or ((InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\EdgeCore\\")) or InitiatingProcessFolderPath =~ "" or (InitiatingProcessFolderPath endswith "\\falkon.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Falkon\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Falkon\\")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Mozilla Firefox\\firefox.exe", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe")) or (InitiatingProcessFolderPath endswith "\\AppData\\Local\\Mozilla Firefox\\firefox.exe" and InitiatingProcessFolderPath startswith "C:\\Users\\") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Flock\\" and InitiatingProcessFolderPath endswith "\\Flock.exe") or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "C:\\Program Files\\Internet Explorer\\iexplore.exe")) or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Maxthon\\" and InitiatingProcessFolderPath endswith "\\maxthon.exe") or isnull(InitiatingProcessFolderPath) or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Programs\\Opera\\" and InitiatingProcessFolderPath endswith "\\opera.exe") or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Phoebe\\" and InitiatingProcessFolderPath endswith "\\Phoebe.exe") or (InitiatingProcessFolderPath endswith "C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe" or InitiatingProcessFolderPath endswith "C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe") or (InitiatingProcessFolderPath endswith "\\QtWeb.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\QtWeb\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\QtWeb\\")) or ((InitiatingProcessFolderPath contains "C:\\Program Files (x86)\\Safari\\" or InitiatingProcessFolderPath contains "C:\\Program Files\\Safari\\") and InitiatingProcessFolderPath endswith "\\safari.exe") or (InitiatingProcessFolderPath endswith "\\seamonkey.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\SeaMonkey\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\SeaMonkey\\")) or (InitiatingProcessFolderPath endswith "\\slimbrowser.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\SlimBrowser\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\SlimBrowser\\")) or (InitiatingProcessFolderPath contains "\\AppData\\Local\\Vivaldi\\" and InitiatingProcessFolderPath endswith "\\vivaldi.exe") or (InitiatingProcessFolderPath endswith "\\whale.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Naver\\Naver Whale\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Naver\\Naver Whale\\")) or (InitiatingProcessFolderPath endswith "\\Waterfox.exe" and (InitiatingProcessFolderPath startswith "C:\\Program Files\\Waterfox\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Waterfox\\")))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_mega_nz.yml
Network Connection Initiated To Mega.nz ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith "mega.co.nz" or RemoteUrl endswith "mega.nz"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_rdp_outbound_over_non_standard_tools.yml
Outbound RDP Connections Over Non-Standard Tools ---> KQL Query:
DeviceNetworkEvents
| where RemotePort == 3389 and (not((InitiatingProcessFolderPath in~ ("C:\\Windows\\System32\\mstsc.exe", "C:\\Windows\\SysWOW64\\mstsc.exe")))) and (not(((InitiatingProcessFolderPath endswith "\\Avast Software\\Avast\\AvastSvc.exe" or InitiatingProcessFolderPath endswith "\\Avast\\AvastSvc.exe") or InitiatingProcessFolderPath =~ "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe" or (InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\dns.exe" and Protocol =~ "udp" and LocalPort == 53) or InitiatingProcessFolderPath =~ "" or InitiatingProcessFolderPath =~ "C:\\Program Files\\Mozilla Firefox\\firefox.exe" or isnull(InitiatingProcessFolderPath) or InitiatingProcessFolderPath endswith "\\Ranger\\SentinelRanger.exe" or InitiatingProcessFolderPath startswith "C:\\Program Files\\SplunkUniversalForwarder\\bin\\" or InitiatingProcessFolderPath endswith "\\RDCMan.exe" or (InitiatingProcessFolderPath endswith "\\FSAssessment.exe" or InitiatingProcessFolderPath endswith "\\FSDiscovery.exe" or InitiatingProcessFolderPath endswith "\\MobaRTE.exe" or InitiatingProcessFolderPath endswith "\\mRemote.exe" or InitiatingProcessFolderPath endswith "\\mRemoteNG.exe" or InitiatingProcessFolderPath endswith "\\Passwordstate.exe" or InitiatingProcessFolderPath endswith "\\RemoteDesktopManager.exe" or InitiatingProcessFolderPath endswith "\\RemoteDesktopManager64.exe" or InitiatingProcessFolderPath endswith "\\RemoteDesktopManagerFree.exe" or InitiatingProcessFolderPath endswith "\\RSSensor.exe" or InitiatingProcessFolderPath endswith "\\RTS2App.exe" or InitiatingProcessFolderPath endswith "\\RTSApp.exe" or InitiatingProcessFolderPath endswith "\\spiceworks-finder.exe" or InitiatingProcessFolderPath endswith "\\Terminals.exe" or InitiatingProcessFolderPath endswith "\\ws_TunnelService.exe") or (InitiatingProcessFolderPath endswith "\\thor.exe" or InitiatingProcessFolderPath endswith "\\thor64.exe") or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\TSplus\\Java\\bin\\HTML5service.exe", "C:\\Program Files (x86)\\TSplus\\Java\\bin\\HTML5service.exe")) or InitiatingProcessFolderPath =~ "<unknown process>")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_outbound_kerberos_connection.yml
Uncommon Outbound Kerberos Connection ---> KQL Query:
DeviceNetworkEvents
| where RemotePort == 88 and (not(InitiatingProcessFolderPath =~ "C:\\Windows\\System32\\lsass.exe")) and (not(((InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe", "C:\\Program Files\\Mozilla Firefox\\firefox.exe")) or InitiatingProcessFolderPath endswith "\\tomcat\\bin\\tomcat8.exe")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_ngrok_tunnel.yml
Communication To Ngrok Tunneling Service Initiated ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl contains "tunnel.us.ngrok.com" or RemoteUrl contains "tunnel.eu.ngrok.com" or RemoteUrl contains "tunnel.ap.ngrok.com" or RemoteUrl contains "tunnel.au.ngrok.com" or RemoteUrl contains "tunnel.sa.ngrok.com" or RemoteUrl contains "tunnel.jp.ngrok.com" or RemoteUrl contains "tunnel.in.ngrok.com"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_wscript_cscript_local_connection.yml
Local Network Connection Initiated By Script Interpreter ---> KQL Query:
DeviceNetworkEvents
| where (ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")) and (InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe")

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_cloudflared_communication.yml
Network Connection Initiated To Cloudflared Tunnels Domains ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".v2.argotunnel.com" or RemoteUrl endswith "protocol-v2.argotunnel.com" or RemoteUrl endswith "trycloudflare.com" or RemoteUrl endswith "update.argotunnel.com"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_rdp_to_http.yml
RDP to HTTP or HTTPS Target Ports ---> KQL Query:
DeviceNetworkEvents
| where (RemotePort in~ ("80", "443")) and InitiatingProcessFolderPath endswith "\\svchost.exe" and LocalPort == 3389

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_malware_callback_port.yml
Potentially Suspicious Malware Callback Communication ---> KQL Query:
DeviceNetworkEvents
| where (RemotePort in~ ("100", "198", "200", "243", "473", "666", "700", "743", "777", "1443", "1515", "1777", "1817", "1904", "1960", "2443", "2448", "3360", "3675", "3939", "4040", "4433", "4438", "4443", "4444", "4455", "5445", "5552", "5649", "6625", "7210", "7777", "8143", "8843", "9631", "9943", "10101", "12102", "12103", "12322", "13145", "13394", "13504", "13505", "13506", "13507", "14102", "14103", "14154", "49180", "65520", "65535")) and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")))) and (not((InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_binary_no_cmdline.yml
Suspicious Network Connection Binary No CommandLine ---> KQL Query:
DeviceNetworkEvents
| where ((InitiatingProcessCommandLine endswith "\\regsvr32.exe" or InitiatingProcessCommandLine endswith "\\rundll32.exe" or InitiatingProcessCommandLine endswith "\\dllhost.exe") and (InitiatingProcessFolderPath endswith "\\regsvr32.exe" or InitiatingProcessFolderPath endswith "\\rundll32.exe" or InitiatingProcessFolderPath endswith "\\dllhost.exe")) and (not((InitiatingProcessCommandLine =~ "" or isnull(InitiatingProcessCommandLine))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_eqnedt.yml
Network Connection Initiated By Eqnedt32.EXE ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\eqnedt32.exe"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_regasm_network_activity.yml
RegAsm.EXE Initiating Network Connection To Public IP ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\regasm.exe" and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_wuauclt_network_connection.yml
Potentially Suspicious Wuauclt Network Connection ---> KQL Query:
DeviceNetworkEvents
| where (InitiatingProcessCommandLine contains " /RunHandlerComServer" and InitiatingProcessFolderPath contains "wuauclt") and (not((InitiatingProcessCommandLine =~ "" or isnull(InitiatingProcessCommandLine) or (ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")) or (ipv4_is_in_range(RemoteIP, "20.184.0.0/13") or ipv4_is_in_range(RemoteIP, "20.192.0.0/10") or ipv4_is_in_range(RemoteIP, "23.79.0.0/16") or ipv4_is_in_range(RemoteIP, "51.10.0.0/15") or ipv4_is_in_range(RemoteIP, "51.103.0.0/16") or ipv4_is_in_range(RemoteIP, "51.104.0.0/15") or ipv4_is_in_range(RemoteIP, "52.224.0.0/11")) or (InitiatingProcessCommandLine contains ":\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy.dll /ClassId" or InitiatingProcessCommandLine contains ":\\Windows\\UUS\\amd64\\UpdateDeploy.dll /ClassId") or (InitiatingProcessCommandLine contains ":\\Windows\\WinSxS\\" and InitiatingProcessCommandLine contains "\\UpdateDeploy.dll /ClassId "))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_python.yml
Python Initiated Connection ---> KQL Query:
DeviceNetworkEvents
| where (InitiatingProcessFolderPath contains "\\python" and InitiatingProcessFolderPath contains ".exe") and (not(((RemoteIP =~ "127.0.0.1" and LocalIP =~ "127.0.0.1") or (InitiatingProcessCommandLine contains "pip.exe" and InitiatingProcessCommandLine contains "install")))) and (not((((InitiatingProcessCommandLine contains ":\\ProgramData\\Anaconda3\\Scripts\\conda-script.py" and InitiatingProcessCommandLine contains "update") and InitiatingProcessParentFileName =~ "conda.exe") or (InitiatingProcessCommandLine contains "C:\\ProgramData\\Anaconda3\\Scripts\\jupyter-notebook-script.py" and InitiatingProcessParentFileName =~ "python.exe"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_office_uncommon_ports.yml
Office Application Initiated Network Connection Over Uncommon Ports ---> KQL Query:
DeviceNetworkEvents
| where (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe") and (not(((RemotePort in~ ("53", "80", "139", "443", "445")) or ((RemotePort in~ ("143", "465", "587", "993", "995")) and InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft Office\\" and InitiatingProcessFolderPath endswith "\\OUTLOOK.EXE"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_initiated_uncommon_or_suspicious_locations.yml
Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location ---> KQL Query:
DeviceNetworkEvents
| where (InitiatingProcessFolderPath contains ":\\$Recycle.bin" or InitiatingProcessFolderPath contains ":\\Perflogs\\" or InitiatingProcessFolderPath contains ":\\Temp\\" or InitiatingProcessFolderPath contains ":\\Users\\Default\\" or InitiatingProcessFolderPath contains ":\\Windows\\Fonts\\" or InitiatingProcessFolderPath contains ":\\Windows\\IME\\" or InitiatingProcessFolderPath contains ":\\Windows\\System32\\Tasks\\" or InitiatingProcessFolderPath contains ":\\Windows\\Tasks\\" or InitiatingProcessFolderPath contains "\\config\\systemprofile\\" or InitiatingProcessFolderPath contains "\\Windows\\addins\\") and (not((RemoteUrl endswith ".githubusercontent.com" or RemoteUrl endswith "anonfiles.com" or RemoteUrl endswith "cdn.discordapp.com" or RemoteUrl endswith "ddns.net" or RemoteUrl endswith "dl.dropboxusercontent.com" or RemoteUrl endswith "ghostbin.co" or RemoteUrl endswith "glitch.me" or RemoteUrl endswith "gofile.io" or RemoteUrl endswith "hastebin.com" or RemoteUrl endswith "mediafire.com" or RemoteUrl endswith "mega.co.nz" or RemoteUrl endswith "mega.nz" or RemoteUrl endswith "onrender.com" or RemoteUrl endswith "pages.dev" or RemoteUrl endswith "paste.ee" or RemoteUrl endswith "pastebin.com" or RemoteUrl endswith "pastebin.pl" or RemoteUrl endswith "pastetext.net" or RemoteUrl endswith "portmap.io" or RemoteUrl endswith "privatlab.com" or RemoteUrl endswith "privatlab.net" or RemoteUrl endswith "send.exploit.in" or RemoteUrl endswith "sendspace.com" or RemoteUrl endswith "storage.googleapis.com" or RemoteUrl endswith "storjshare.io" or RemoteUrl endswith "supabase.co" or RemoteUrl endswith "temp.sh" or RemoteUrl endswith "transfer.sh" or RemoteUrl endswith "trycloudflare.com" or RemoteUrl endswith "ufile.io" or RemoteUrl endswith "w3spaces.com" or RemoteUrl endswith "workers.dev")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_external_ip_lookup.yml
Suspicious Network Connection to IP Lookup Service APIs ---> KQL Query:
DeviceNetworkEvents
| where ((RemoteUrl in~ ("www.ip.cn", "l2.io")) or (RemoteUrl contains "api.2ip.ua" or RemoteUrl contains "api.bigdatacloud.net" or RemoteUrl contains "api.ipify.org" or RemoteUrl contains "bot.whatismyipaddress.com" or RemoteUrl contains "canireachthe.net" or RemoteUrl contains "checkip.amazonaws.com" or RemoteUrl contains "checkip.dyndns.org" or RemoteUrl contains "curlmyip.com" or RemoteUrl contains "db-ip.com" or RemoteUrl contains "edns.ip-api.com" or RemoteUrl contains "eth0.me" or RemoteUrl contains "freegeoip.app" or RemoteUrl contains "geoipy.com" or RemoteUrl contains "getip.pro" or RemoteUrl contains "icanhazip.com" or RemoteUrl contains "ident.me" or RemoteUrl contains "ifconfig.io" or RemoteUrl contains "ifconfig.me" or RemoteUrl contains "ip-api.com" or RemoteUrl contains "ip.360.cn" or RemoteUrl contains "ip.anysrc.net" or RemoteUrl contains "ip.taobao.com" or RemoteUrl contains "ip.tyk.nu" or RemoteUrl contains "ipaddressworld.com" or RemoteUrl contains "ipapi.co" or RemoteUrl contains "ipconfig.io" or RemoteUrl contains "ipecho.net" or RemoteUrl contains "ipinfo.io" or RemoteUrl contains "ipip.net" or RemoteUrl contains "ipof.in" or RemoteUrl contains "ipv4.icanhazip.com" or RemoteUrl contains "ipv4bot.whatismyipaddress.com" or RemoteUrl contains "ipv6-test.com" or RemoteUrl contains "ipwho.is" or RemoteUrl contains "jsonip.com" or RemoteUrl contains "myexternalip.com" or RemoteUrl contains "seeip.org" or RemoteUrl contains "wgetip.com" or RemoteUrl contains "whatismyip.akamai.com" or RemoteUrl contains "whois.pconline.com.cn" or RemoteUrl contains "wtfismyip.com")) and (not((InitiatingProcessFolderPath endswith "\\brave.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe", "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"))) or ((InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\EdgeCore\\")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Mozilla Firefox\\firefox.exe", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "C:\\Program Files\\Internet Explorer\\iexplore.exe")) or InitiatingProcessFolderPath endswith "\\maxthon.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\seamonkey.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_google_api_non_browser_access.yml
Suspicious Non-Browser Network Communication With Google API ---> KQL Query:
DeviceNetworkEvents
| where (RemoteUrl contains "drive.googleapis.com" or RemoteUrl contains "oauth2.googleapis.com" or RemoteUrl contains "sheets.googleapis.com" or RemoteUrl contains "www.googleapis.com") and (not((InitiatingProcessFolderPath =~ "" or isnull(InitiatingProcessFolderPath)))) and (not((InitiatingProcessFolderPath endswith "\\brave.exe" or (InitiatingProcessFolderPath endswith ":\\Program Files\\Google\\Chrome\\Application\\chrome.exe" or InitiatingProcessFolderPath endswith ":\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe") or (InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or (InitiatingProcessFolderPath endswith ":\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe" or InitiatingProcessFolderPath endswith ":\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe")) or ((InitiatingProcessFolderPath contains ":\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath contains ":\\Program Files\\Microsoft\\EdgeCore\\") and (InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe")) or (InitiatingProcessFolderPath endswith ":\\Program Files\\Mozilla Firefox\\firefox.exe" or InitiatingProcessFolderPath endswith ":\\Program Files (x86)\\Mozilla Firefox\\firefox.exe") or (InitiatingProcessFolderPath contains ":\\Program Files\\Google\\Drive File Stream\\" and InitiatingProcessFolderPath endswith "\\GoogleDriveFS.exe") or InitiatingProcessFolderPath endswith "\\GoogleUpdate.exe" or (InitiatingProcessFolderPath endswith ":\\Program Files (x86)\\Internet Explorer\\iexplore.exe" or InitiatingProcessFolderPath endswith ":\\Program Files\\Internet Explorer\\iexplore.exe") or InitiatingProcessFolderPath endswith "\\maxthon.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\seamonkey.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_imewdbld.yml
Network Connection Initiated By IMEWDBLD.EXE ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\IMEWDBLD.exe"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_remote_powershell_session.yml
Sigma Transformation Error for 'Potential Remote PowerShell Session Initiated': Invalid SigmaDetectionItem field name encountered: SourceIsIpv6. Invalid SigmaDetectionItem field name encountered: processPath. Invalid SigmaDetectionItem field name encountered: processPath. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: Application. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: DestPort. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: RelativeTargetName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: SubjectUserName. Invalid SigmaDetectionItem field name encountered: AccessList. Invalid SigmaDetectionItem field name encountered: AttributeLDAPDisplayName. Invalid SigmaDetectionItem field name encountered: AccessList. Please use valid fields for the DeviceNetworkEvents table, or the following fields that have keymappings in this pipeline:
ActionType, AdditionalFields, AppGuardContainerId, CommandLine, Company, Description, DestinationHostname, DestinationIp, DestinationPort, DeviceId, DeviceName, EventType, Hashes, Image, InitiatingProcessAccountDomain, InitiatingProcessAccountName, InitiatingProcessAccountObjectId, InitiatingProcessAccountSid, InitiatingProcessAccountUpn, InitiatingProcessCommandLine, InitiatingProcessCreationTime, InitiatingProcessFileName, InitiatingProcessFileSize, InitiatingProcessFolderPath, InitiatingProcessId, InitiatingProcessIntegrityLevel, InitiatingProcessMD5, InitiatingProcessParentCreationTime, InitiatingProcessParentFileName, InitiatingProcessParentId, InitiatingProcessRemoteSessionDeviceName, InitiatingProcessRemoteSessionIP, InitiatingProcessSHA1, InitiatingProcessSHA256, InitiatingProcessSessionId, InitiatingProcessTokenElevation, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, IsInitiatingProcessRemoteSession, LocalIP, LocalIPType, LocalPort, OriginalFileName, ParentCommandLine, ParentProcessId, ProcessId, ProcessName, Product, Protocol, RemoteIP, RemoteIPType, RemotePort, RemoteUrl, ReportId, SourceHostname, SourceImage, SourceIp, SourcePort, Timestamp, User, md5, sha1, sha256. Skipping.
----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_outbound_smtp_connections.yml
Suspicious Outbound SMTP Connections ---> KQL Query:
DeviceNetworkEvents
| where (RemotePort in~ ("25", "587", "465", "2525")) and (not(((InitiatingProcessFolderPath endswith "\\thunderbird.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe") or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\Exchange Server\\" or (InitiatingProcessFolderPath endswith "\\HxTsr.exe" and InitiatingProcessFolderPath startswith "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_malware_callback_ports_uncommon.yml
Communication To Uncommon Destination Ports ---> KQL Query:
DeviceNetworkEvents
| where (RemotePort in~ ("8080", "8888")) and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")))) and (not((InitiatingProcessFolderPath startswith "C:\\Program Files\\" or InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_winlogon_net_connections.yml
Outbound Network Connection To Public IP Via Winlogon ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\winlogon.exe" and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_notepad.yml
Network Connection Initiated Via Notepad.EXE ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\notepad.exe" and (not(RemotePort == 9100))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_telegram_api_non_browser_access.yml
Suspicious Non-Browser Network Communication With Telegram API ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl contains "api.telegram.org" and (not((InitiatingProcessFolderPath endswith "\\brave.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe", "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"))) or ((InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\EdgeCore\\")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Mozilla Firefox\\firefox.exe", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "C:\\Program Files\\Internet Explorer\\iexplore.exe")) or InitiatingProcessFolderPath endswith "\\maxthon.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\seamonkey.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_dialer_initiated_connection.yml
Outbound Network Connection Initiated By Microsoft Dialer ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith ":\\Windows\\System32\\dialer.exe" and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_notion_api_susp_communication.yml
Potentially Suspicious Network Connection To Notion API ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl contains "api.notion.com" and (not((InitiatingProcessFolderPath endswith "\\brave.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe", "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe")) or (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\" or InitiatingProcessFolderPath endswith "\\WindowsApps\\MicrosoftEdge.exe" or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe", "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"))) or ((InitiatingProcessFolderPath endswith "\\msedge.exe" or InitiatingProcessFolderPath endswith "\\msedgewebview2.exe") and (InitiatingProcessFolderPath startswith "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\" or InitiatingProcessFolderPath startswith "C:\\Program Files\\Microsoft\\EdgeCore\\")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files\\Mozilla Firefox\\firefox.exe", "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe")) or (InitiatingProcessFolderPath in~ ("C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe", "C:\\Program Files\\Internet Explorer\\iexplore.exe")) or InitiatingProcessFolderPath endswith "\\maxthon.exe" or InitiatingProcessFolderPath endswith "\\AppData\\Local\\Programs\\Notion\\Notion.exe" or InitiatingProcessFolderPath endswith "\\opera.exe" or InitiatingProcessFolderPath endswith "\\safari.exe" or InitiatingProcessFolderPath endswith "\\seamonkey.exe" or InitiatingProcessFolderPath endswith "\\vivaldi.exe" or InitiatingProcessFolderPath endswith "\\whale.exe")))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_btunnels.yml
Network Connection Initiated To BTunnels Domains ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".btunnel.co.in"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_outbound_mobsync_connection.yml
Microsoft Sync Center Suspicious Network Connections ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\mobsync.exe" and (not((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml
Rundll32 Internet Connection ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\rundll32.exe" and (not((InitiatingProcessCommandLine endswith "\\system32\\PcaSvc.dll,PcaPatchSdbTask" or DeviceName endswith ".internal.cloudapp.net" or (ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")) or (ipv4_is_in_range(RemoteIP, "20.0.0.0/8") or ipv4_is_in_range(RemoteIP, "51.103.0.0/16") or ipv4_is_in_range(RemoteIP, "51.104.0.0/16") or ipv4_is_in_range(RemoteIP, "51.105.0.0/16")) or (RemotePort == 443 and InitiatingProcessParentFileName =~ "svchost.exe"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_wscript_cscript_outbound_connection.yml
Outbound Network Connection Initiated By Script Interpreter ---> KQL Query:
DeviceNetworkEvents
| where (InitiatingProcessFolderPath endswith "\\wscript.exe" or InitiatingProcessFolderPath endswith "\\cscript.exe") and (not(((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")) or ipv4_is_in_range(RemoteIP, "20.0.0.0/11"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_crypto_mining_pools.yml
Network Communication With Crypto Mining Pool ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl in~ ("alimabi.cn", "ap.luckpool.net", "bcn.pool.minergate.com", "bcn.vip.pool.minergate.com", "bohemianpool.com", "ca-aipg.miningocean.org", "ca-dynex.miningocean.org", "ca-neurai.miningocean.org", "ca-qrl.miningocean.org", "ca-upx.miningocean.org", "ca-zephyr.miningocean.org", "ca.minexmr.com", "ca.monero.herominers.com", "cbd.monerpool.org", "cbdv2.monerpool.org", "cryptmonero.com", "crypto-pool.fr", "crypto-pool.info", "cryptonight-hub.miningpoolhub.com", "d1pool.ddns.net", "d5pool.us", "daili01.monerpool.org", "de-aipg.miningocean.org", "de-dynex.miningocean.org", "de-zephyr.miningocean.org", "de.minexmr.com", "dl.nbminer.com", "donate.graef.in", "donate.ssl.xmrig.com", "donate.v2.xmrig.com", "donate.xmrig.com", "donate2.graef.in", "drill.moneroworld.com", "dwarfpool.com", "emercoin.com", "emercoin.net", "emergate.net", "ethereumpool.co", "eu.luckpool.net", "eu.minerpool.pw", "fcn-xmr.pool.minergate.com", "fee.xmrig.com", "fr-aipg.miningocean.org", "fr-dynex.miningocean.org", "fr-neurai.miningocean.org", "fr-qrl.miningocean.org", "fr-upx.miningocean.org", "fr-zephyr.miningocean.org", "fr.minexmr.com", "hellominer.com", "herominers.com", "hk-aipg.miningocean.org", "hk-dynex.miningocean.org", "hk-neurai.miningocean.org", "hk-qrl.miningocean.org", "hk-upx.miningocean.org", "hk-zephyr.miningocean.org", "huadong1-aeon.ppxxmr.com", "iwanttoearn.money", "jw-js1.ppxxmr.com", "koto-pool.work", "lhr.nbminer.com", "lhr3.nbminer.com", "linux.monerpool.org", "lokiturtle.herominers.com", "luckpool.net", "masari.miner.rocks", "mine.c3pool.com", "mine.moneropool.com", "mine.ppxxmr.com", "mine.zpool.ca", "mine1.ppxxmr.com", "minemonero.gq", "miner.ppxxmr.com", "miner.rocks", "minercircle.com", "minergate.com", "minerpool.pw", "minerrocks.com", "miners.pro", "minerxmr.ru", "minexmr.cn", "minexmr.com", "mining-help.ru", "miningpoolhub.com", "mixpools.org", "moner.monerpool.org", "moner1min.monerpool.org", "monero-master.crypto-pool.fr", "monero.crypto-pool.fr", "monero.hashvault.pro", "monero.herominers.com", "monero.lindon-pool.win", "monero.miners.pro", "monero.riefly.id", "monero.us.to", "monerocean.stream", "monerogb.com", "monerohash.com", "moneroocean.stream", "moneropool.com", "moneropool.nl", "monerorx.com", "monerpool.org", "moriaxmr.com", "mro.pool.minergate.com", "multipool.us", "myxmr.pw", "na.luckpool.net", "nanopool.org", "nbminer.com", "node3.luckpool.net", "noobxmr.com", "pangolinminer.comgandalph3000.com", "pool.4i7i.com", "pool.armornetwork.org", "pool.cortins.tk", "pool.gntl.co.uk", "pool.hashvault.pro", "pool.minergate.com", "pool.minexmr.com", "pool.monero.hashvault.pro", "pool.ppxxmr.com", "pool.somec.cc", "pool.support", "pool.supportxmr.com", "pool.usa-138.com", "pool.xmr.pt", "pool.xmrfast.com", "pool2.armornetwork.org", "poolchange.ppxxmr.com", "pooldd.com", "poolmining.org", "poolto.be", "ppxvip1.ppxxmr.com", "ppxxmr.com", "prohash.net", "r.twotouchauthentication.online", "randomx.xmrig.com", "ratchetmining.com", "seed.emercoin.com", "seed.emercoin.net", "seed.emergate.net", "seed1.joulecoin.org", "seed2.joulecoin.org", "seed3.joulecoin.org", "seed4.joulecoin.org", "seed5.joulecoin.org", "seed6.joulecoin.org", "seed7.joulecoin.org", "seed8.joulecoin.org", "sg-aipg.miningocean.org", "sg-dynex.miningocean.org", "sg-neurai.miningocean.org", "sg-qrl.miningocean.org", "sg-upx.miningocean.org", "sg-zephyr.miningocean.org", "sg.minexmr.com", "sheepman.mine.bz", "siamining.com", "sumokoin.minerrocks.com", "supportxmr.com", "suprnova.cc", "teracycle.net", "trtl.cnpool.cc", "trtl.pool.mine2gether.com", "turtle.miner.rocks", "us-aipg.miningocean.org", "us-dynex.miningocean.org", "us-neurai.miningocean.org", "us-west.minexmr.com", "us-zephyr.miningocean.org", "usxmrpool.com", "viaxmr.com", "webservicepag.webhop.net", "xiazai.monerpool.org", "xiazai1.monerpool.org", "xmc.pool.minergate.com", "xmo.pool.minergate.com", "xmr-asia1.nanopool.org", "xmr-au1.nanopool.org", "xmr-eu1.nanopool.org", "xmr-eu2.nanopool.org", "xmr-jp1.nanopool.org", "xmr-us-east1.nanopool.org", "xmr-us-west1.nanopool.org", "xmr-us.suprnova.cc", "xmr-usa.dwarfpool.com", "xmr.2miners.com", "xmr.5b6b7b.ru", "xmr.alimabi.cn", "xmr.bohemianpool.com", "xmr.crypto-pool.fr", "xmr.crypto-pool.info", "xmr.f2pool.com", "xmr.hashcity.org", "xmr.hex7e4.ru", "xmr.ip28.net", "xmr.monerpool.org", "xmr.mypool.online", "xmr.nanopool.org", "xmr.pool.gntl.co.uk", "xmr.pool.minergate.com", "xmr.poolto.be", "xmr.ppxxmr.com", "xmr.prohash.net", "xmr.simka.pw", "xmr.somec.cc", "xmr.suprnova.cc", "xmr.usa-138.com", "xmr.vip.pool.minergate.com", "xmr1min.monerpool.org", "xmrf.520fjh.org", "xmrf.fjhan.club", "xmrfast.com", "xmrigcc.graef.in", "xmrminer.cc", "xmrpool.de", "xmrpool.eu", "xmrpool.me", "xmrpool.net", "xmrpool.xyz", "xx11m.monerpool.org", "xx11mv2.monerpool.org", "xxx.hex7e4.ru", "zarabotaibitok.ru", "zer0day.ru")

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_dropbox_api.yml
Suspicious Dropbox API Usage ---> KQL Query:
DeviceNetworkEvents
| where (RemoteUrl endswith "api.dropboxapi.com" or RemoteUrl endswith "content.dropboxapi.com") and (not(InitiatingProcessFolderPath contains "\\Dropbox"))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_ngrok.yml
Process Initiated Network  Connection To Ngrok Domain ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".ngrok-free.app" or RemoteUrl endswith ".ngrok-free.dev" or RemoteUrl endswith ".ngrok.app" or RemoteUrl endswith ".ngrok.dev" or RemoteUrl endswith ".ngrok.io"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_regsvr32_network_activity.yml
Network Connection Initiated By Regsvr32.EXE ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\regsvr32.exe"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_susp_file_sharing_domains_susp_folders.yml
Network Communication Initiated To File Sharing Domains From Process Located In Suspicious Folder ---> KQL Query:
DeviceNetworkEvents
| where (RemoteUrl endswith ".githubusercontent.com" or RemoteUrl endswith "anonfiles.com" or RemoteUrl endswith "cdn.discordapp.com" or RemoteUrl endswith "ddns.net" or RemoteUrl endswith "dl.dropboxusercontent.com" or RemoteUrl endswith "ghostbin.co" or RemoteUrl endswith "glitch.me" or RemoteUrl endswith "gofile.io" or RemoteUrl endswith "hastebin.com" or RemoteUrl endswith "mediafire.com" or RemoteUrl endswith "mega.co.nz" or RemoteUrl endswith "mega.nz" or RemoteUrl endswith "onrender.com" or RemoteUrl endswith "pages.dev" or RemoteUrl endswith "paste.ee" or RemoteUrl endswith "pastebin.com" or RemoteUrl endswith "pastebin.pl" or RemoteUrl endswith "pastetext.net" or RemoteUrl endswith "pixeldrain.com" or RemoteUrl endswith "privatlab.com" or RemoteUrl endswith "privatlab.net" or RemoteUrl endswith "send.exploit.in" or RemoteUrl endswith "sendspace.com" or RemoteUrl endswith "storage.googleapis.com" or RemoteUrl endswith "storjshare.io" or RemoteUrl endswith "supabase.co" or RemoteUrl endswith "temp.sh" or RemoteUrl endswith "transfer.sh" or RemoteUrl endswith "trycloudflare.com" or RemoteUrl endswith "ufile.io" or RemoteUrl endswith "w3spaces.com" or RemoteUrl endswith "workers.dev") and (InitiatingProcessFolderPath contains ":\\$Recycle.bin" or InitiatingProcessFolderPath contains ":\\Perflogs\\" or InitiatingProcessFolderPath contains ":\\Temp\\" or InitiatingProcessFolderPath contains ":\\Users\\Default\\" or InitiatingProcessFolderPath contains ":\\Users\\Public\\" or InitiatingProcessFolderPath contains ":\\Windows\\Fonts\\" or InitiatingProcessFolderPath contains ":\\Windows\\IME\\" or InitiatingProcessFolderPath contains ":\\Windows\\System32\\Tasks\\" or InitiatingProcessFolderPath contains ":\\Windows\\Tasks\\" or InitiatingProcessFolderPath contains ":\\Windows\\Temp\\" or InitiatingProcessFolderPath contains "\\AppData\\Temp\\" or InitiatingProcessFolderPath contains "\\config\\systemprofile\\" or InitiatingProcessFolderPath contains "\\Windows\\addins\\")

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_remote_access_tools_anydesk_incoming_connection.yml
Remote Access Tool - AnyDesk Incoming Connection ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\AnyDesk.exe" or InitiatingProcessFolderPath endswith "\\AnyDeskMSI.exe"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_portmap.yml
Network Communication Initiated To Portmap.IO Domain ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".portmap.io"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml
RDP Over Reverse SSH Tunnel ---> KQL Query:
DeviceNetworkEvents
| where (ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "::1/128")) and (InitiatingProcessFolderPath endswith "\\svchost.exe" and LocalPort == 3389)

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_office_outbound_non_local_ip.yml
Office Application Initiated Network Connection To Non-Local IP ---> KQL Query:
DeviceNetworkEvents
| where (InitiatingProcessFolderPath endswith "\\excel.exe" or InitiatingProcessFolderPath endswith "\\outlook.exe" or InitiatingProcessFolderPath endswith "\\powerpnt.exe" or InitiatingProcessFolderPath endswith "\\winword.exe" or InitiatingProcessFolderPath endswith "\\wordview.exe") and (not(((ipv4_is_in_range(RemoteIP, "127.0.0.0/8") or ipv4_is_in_range(RemoteIP, "10.0.0.0/8") or ipv4_is_in_range(RemoteIP, "172.16.0.0/12") or ipv4_is_in_range(RemoteIP, "192.168.0.0/16") or ipv4_is_in_range(RemoteIP, "169.254.0.0/16") or ipv4_is_in_range(RemoteIP, "::1/128") or ipv4_is_in_range(RemoteIP, "fe80::/10") or ipv4_is_in_range(RemoteIP, "fc00::/7")) or ((ipv4_is_in_range(RemoteIP, "13.107.6.152/31") or ipv4_is_in_range(RemoteIP, "13.107.18.10/31") or ipv4_is_in_range(RemoteIP, "13.107.128.0/22") or ipv4_is_in_range(RemoteIP, "23.103.160.0/20") or ipv4_is_in_range(RemoteIP, "40.96.0.0/13") or ipv4_is_in_range(RemoteIP, "40.104.0.0/15") or ipv4_is_in_range(RemoteIP, "52.96.0.0/14") or ipv4_is_in_range(RemoteIP, "131.253.33.215/32") or ipv4_is_in_range(RemoteIP, "132.245.0.0/16") or ipv4_is_in_range(RemoteIP, "150.171.32.0/22") or ipv4_is_in_range(RemoteIP, "204.79.197.215/32") or ipv4_is_in_range(RemoteIP, "2603:1006::/40") or ipv4_is_in_range(RemoteIP, "2603:1016::/36") or ipv4_is_in_range(RemoteIP, "2603:1026::/36") or ipv4_is_in_range(RemoteIP, "2603:1036::/36") or ipv4_is_in_range(RemoteIP, "2603:1046::/36") or ipv4_is_in_range(RemoteIP, "2603:1056::/36") or ipv4_is_in_range(RemoteIP, "2620:1ec:4::152/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:4::153/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:c::10/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:c::11/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:d::10/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:d::11/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:8f0::/46") or ipv4_is_in_range(RemoteIP, "2620:1ec:900::/46") or ipv4_is_in_range(RemoteIP, "2620:1ec:a92::152/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:a92::153/128")) and (RemotePort in~ ("80", "443"))) or ((ipv4_is_in_range(RemoteIP, "13.107.6.152/31") or ipv4_is_in_range(RemoteIP, "13.107.18.10/31") or ipv4_is_in_range(RemoteIP, "13.107.128.0/22") or ipv4_is_in_range(RemoteIP, "23.103.160.0/20") or ipv4_is_in_range(RemoteIP, "40.96.0.0/13") or ipv4_is_in_range(RemoteIP, "40.104.0.0/15") or ipv4_is_in_range(RemoteIP, "52.96.0.0/14") or ipv4_is_in_range(RemoteIP, "131.253.33.215/32") or ipv4_is_in_range(RemoteIP, "132.245.0.0/16") or ipv4_is_in_range(RemoteIP, "150.171.32.0/22") or ipv4_is_in_range(RemoteIP, "204.79.197.215/32") or ipv4_is_in_range(RemoteIP, "2603:1006::/40") or ipv4_is_in_range(RemoteIP, "2603:1016::/36") or ipv4_is_in_range(RemoteIP, "2603:1026::/36") or ipv4_is_in_range(RemoteIP, "2603:1036::/36") or ipv4_is_in_range(RemoteIP, "2603:1046::/36") or ipv4_is_in_range(RemoteIP, "2603:1056::/36") or ipv4_is_in_range(RemoteIP, "2620:1ec:4::152/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:4::153/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:c::10/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:c::11/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:d::10/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:d::11/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:8f0::/46") or ipv4_is_in_range(RemoteIP, "2620:1ec:900::/46") or ipv4_is_in_range(RemoteIP, "2620:1ec:a92::152/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:a92::153/128")) and (RemotePort in~ ("143", "587", "993", "995")) and Protocol =~ "tcp") or ((ipv4_is_in_range(RemoteIP, "40.92.0.0/15") or ipv4_is_in_range(RemoteIP, "40.107.0.0/16") or ipv4_is_in_range(RemoteIP, "52.100.0.0/14") or ipv4_is_in_range(RemoteIP, "52.238.78.88/32") or ipv4_is_in_range(RemoteIP, "104.47.0.0/17") or ipv4_is_in_range(RemoteIP, "2a01:111:f400::/48") or ipv4_is_in_range(RemoteIP, "2a01:111:f403::/48")) and RemotePort == 443) or ((ipv4_is_in_range(RemoteIP, "40.92.0.0/15") or ipv4_is_in_range(RemoteIP, "40.107.0.0/16") or ipv4_is_in_range(RemoteIP, "52.100.0.0/14") or ipv4_is_in_range(RemoteIP, "52.238.78.88/32") or ipv4_is_in_range(RemoteIP, "104.47.0.0/17") or ipv4_is_in_range(RemoteIP, "2a01:111:f400::/48") or ipv4_is_in_range(RemoteIP, "2a01:111:f403::/48")) and RemotePort == 25) or (ipv4_is_in_range(RemoteIP, "20.184.0.0/13") or ipv4_is_in_range(RemoteIP, "20.192.0.0/10") or ipv4_is_in_range(RemoteIP, "23.72.0.0/13") or ipv4_is_in_range(RemoteIP, "40.76.0.0/14") or ipv4_is_in_range(RemoteIP, "51.10.0.0/15") or ipv4_is_in_range(RemoteIP, "51.103.0.0/16") or ipv4_is_in_range(RemoteIP, "51.104.0.0/15") or ipv4_is_in_range(RemoteIP, "51.142.136.0/22") or ipv4_is_in_range(RemoteIP, "52.160.0.0/11") or ipv4_is_in_range(RemoteIP, "204.79.197.0/24")) or ((ipv4_is_in_range(RemoteIP, "13.107.6.171/32") or ipv4_is_in_range(RemoteIP, "13.107.18.15/32") or ipv4_is_in_range(RemoteIP, "13.107.140.6/32") or ipv4_is_in_range(RemoteIP, "52.108.0.0/14") or ipv4_is_in_range(RemoteIP, "52.244.37.168/32") or ipv4_is_in_range(RemoteIP, "2603:1006:1400::/40") or ipv4_is_in_range(RemoteIP, "2603:1016:2400::/40") or ipv4_is_in_range(RemoteIP, "2603:1026:2400::/40") or ipv4_is_in_range(RemoteIP, "2603:1036:2400::/40") or ipv4_is_in_range(RemoteIP, "2603:1046:1400::/40") or ipv4_is_in_range(RemoteIP, "2603:1056:1400::/40") or ipv4_is_in_range(RemoteIP, "2603:1063:2000::/38") or ipv4_is_in_range(RemoteIP, "2620:1ec:c::15/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:8fc::6/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:a92::171/128") or ipv4_is_in_range(RemoteIP, "2a01:111:f100:2000::a83e:3019/128") or ipv4_is_in_range(RemoteIP, "2a01:111:f100:2002::8975:2d79/128") or ipv4_is_in_range(RemoteIP, "2a01:111:f100:2002::8975:2da8/128") or ipv4_is_in_range(RemoteIP, "2a01:111:f100:7000::6fdd:6cd5/128") or ipv4_is_in_range(RemoteIP, "2a01:111:f100:a004::bfeb:88cf/128")) and (RemotePort in~ ("80", "443")) and Protocol =~ "tcp") or ((ipv4_is_in_range(RemoteIP, "20.20.32.0/19") or ipv4_is_in_range(RemoteIP, "20.190.128.0/18") or ipv4_is_in_range(RemoteIP, "20.231.128.0/19") or ipv4_is_in_range(RemoteIP, "40.126.0.0/18") or ipv4_is_in_range(RemoteIP, "2603:1006:2000::/48") or ipv4_is_in_range(RemoteIP, "2603:1007:200::/48") or ipv4_is_in_range(RemoteIP, "2603:1016:1400::/48") or ipv4_is_in_range(RemoteIP, "2603:1017::/48") or ipv4_is_in_range(RemoteIP, "2603:1026:3000::/48") or ipv4_is_in_range(RemoteIP, "2603:1027:1::/48") or ipv4_is_in_range(RemoteIP, "2603:1036:3000::/48") or ipv4_is_in_range(RemoteIP, "2603:1037:1::/48") or ipv4_is_in_range(RemoteIP, "2603:1046:2000::/48") or ipv4_is_in_range(RemoteIP, "2603:1047:1::/48") or ipv4_is_in_range(RemoteIP, "2603:1056:2000::/48") or ipv4_is_in_range(RemoteIP, "2603:1057:2::/48")) and (RemotePort in~ ("80", "443")) and Protocol =~ "tcp") or ((ipv4_is_in_range(RemoteIP, "13.107.6.192/32") or ipv4_is_in_range(RemoteIP, "13.107.9.192/32") or ipv4_is_in_range(RemoteIP, "52.108.0.0/14") or ipv4_is_in_range(RemoteIP, "2620:1ec:4::192/128") or ipv4_is_in_range(RemoteIP, "2620:1ec:a92::192/128")) and RemotePort == 443 and Protocol =~ "tcp") or ((ipv4_is_in_range(RemoteIP, "13.107.136.0/22") or ipv4_is_in_range(RemoteIP, "40.108.128.0/17") or ipv4_is_in_range(RemoteIP, "52.104.0.0/14") or ipv4_is_in_range(RemoteIP, "104.146.128.0/17") or ipv4_is_in_range(RemoteIP, "150.171.40.0/22") or ipv4_is_in_range(RemoteIP, "2603:1061:1300::/40") or ipv4_is_in_range(RemoteIP, "2620:1ec:8f8::/46") or ipv4_is_in_range(RemoteIP, "2620:1ec:908::/46") or ipv4_is_in_range(RemoteIP, "2a01:111:f402::/48")) and (RemotePort in~ ("80", "443")) and Protocol =~ "tcp"))))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_devtunnels.yml
Network Connection Initiated To DevTunnels Domain ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".devtunnels.ms"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_silenttrinity_stager_msbuild_activity.yml
Silenttrinity Stager Msbuild Activity ---> KQL Query:
DeviceNetworkEvents
| where InitiatingProcessFolderPath endswith "\\msbuild.exe" and (RemotePort in~ ("80", "443"))

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_vscode_tunnel_connection.yml
Network Connection Initiated To Visual Studio Code Tunnels Domain ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".tunnels.api.visualstudio.com"

----------------------------------------
Processing: sigma/rules/windows/network_connection/net_connection_win_domain_localtonet_tunnel.yml
Communication To LocaltoNet Tunneling Service Initiated ---> KQL Query:
DeviceNetworkEvents
| where RemoteUrl endswith ".localto.net" or RemoteUrl endswith ".localtonet.com"

----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_susp_ip_domains.yml
Sigma Transformation Error for 'Unusual File Download from Direct IP Address': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_zip_tld_download.yml
Sigma Transformation Error for 'Potentially Suspicious File Download From ZIP TLD': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_creation_internet_file.yml
Sigma Transformation Error for 'Creation Of a Suspicious ADS File Outside a Browser Download': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_file_sharing_domains_download_unusual_extension.yml
Sigma Transformation Error for 'Unusual File Download From File Sharing Websites - File Stream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_ads_executable.yml
Sigma Transformation Error for 'Hidden Executable In NTFS Alternate Data Stream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_winget_susp_package_source.yml
Sigma Transformation Error for 'Potential Suspicious Winget Package Installation': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_regedit_export_to_ads.yml
Sigma Transformation Error for 'Exports Registry Key To an Alternate Data Stream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_file_sharing_domains_download_susp_extension.yml
Sigma Transformation Error for 'Suspicious File Download From File Sharing Websites -  File Stream': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Processing: sigma/rules/windows/create_stream_hash/create_stream_hash_hktl_generic_download.yml
Sigma Transformation Error for 'HackTool Named File Stream Created': Unable to determine table name from rule.  The query table is determined in the following order of priority:
  1) The value provided to processing pipeline's query_table parameter, if using a Python script.
  2) If the query_table is already set in the pipeline state, such as from a custom user-defined pipeline if using sigma-cli.
  3) If the rule's logsource category is present in the pipeline's category_to_table_mappings dictionary in mappings.py, use that value.
  4) If the rule has an EventID, use the table name from the pipeline's eventid_to_table_mappings dictionary in mappings.py.
For more details, see https://github.com/AttackIQ/pySigma-backend-kusto/blob/main/README.md#%EF%B8%8F-custom-table-names-new-in-030-beta.. Skipping.
----------------------------------------
Successfully wrote KQL total of: 1813/2987

Processing complete.
